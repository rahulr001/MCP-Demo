"use strict";var yte=Object.create;var EE=Object.defineProperty;var a9=Object.getOwnPropertyDescriptor;var bte=Object.getOwnPropertyNames;var Ite=Object.getPrototypeOf,Ste=Object.prototype.hasOwnProperty;var ee=(r,e)=>()=>(r&&(e=r(r=0)),e);var z=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports),Nm=(r,e)=>{for(var t in e)EE(r,t,{get:e[t],enumerable:!0})},l9=(r,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of bte(e))!Ste.call(r,i)&&i!==t&&EE(r,i,{get:()=>e[i],enumerable:!(n=a9(e,i))||n.enumerable});return r};var $=(r,e,t)=>(t=r!=null?yte(Ite(r)):{},l9(e||!r||!r.__esModule?EE(t,"default",{value:r,enumerable:!0}):t,r)),qD=r=>l9(EE({},"__esModule",{value:!0}),r),E=(r,e,t,n)=>{for(var i=n>1?void 0:n?a9(e,t):e,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=(n?s(e,t,i):s(i))||i);return n&&i&&EE(e,t,i),i},I=(r,e)=>(t,n)=>e(t,n,r);var process,u=ee(()=>{"use strict";process={platform:"web",cwd:()=>"",env:{NODE_ENV:"production"}}});var u9=z(()=>{u();var c9;(function(r){(function(e){var t=typeof this=="object"?this:typeof self=="object"?self:typeof this=="object"?this:Function("return this;")(),n=i(r);typeof t.Reflect=="undefined"?t.Reflect=r:n=i(t.Reflect,n),e(n);function i(o,s){return function(a,l){typeof o[a]!="function"&&Object.defineProperty(o,a,{configurable:!0,writable:!0,value:l}),s&&s(a,l)}}})(function(e){var t=Object.prototype.hasOwnProperty,n=typeof Symbol=="function",i=n&&typeof Symbol.toPrimitive!="undefined"?Symbol.toPrimitive:"@@toPrimitive",o=n&&typeof Symbol.iterator!="undefined"?Symbol.iterator:"@@iterator",s=typeof Object.create=="function",a={__proto__:[]}instanceof Array,l=!s&&!a,c={create:s?function(){return ue(Object.create(null))}:a?function(){return ue({__proto__:null})}:function(){return ue({})},has:l?function(k,O){return t.call(k,O)}:function(k,O){return O in k},get:l?function(k,O){return t.call(k,O)?k[O]:void 0}:function(k,O){return k[O]}},d=Object.getPrototypeOf(Function),p=typeof process=="object"&&process.env&&process.env.REFLECT_METADATA_USE_MAP_POLYFILL==="true",f=!p&&typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:Ot(),m=!p&&typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:Dr(),g=!p&&typeof WeakMap=="function"?WeakMap:F(),h=new g;function v(k,O,X,ce){if(de(X)){if(!Ze(k))throw new TypeError;if(!W(O))throw new TypeError;return R(k,O)}else{if(!Ze(k))throw new TypeError;if(!Ce(O))throw new TypeError;if(!Ce(ce)&&!de(ce)&&!Pe(ce))throw new TypeError;return Pe(ce)&&(ce=void 0),X=Oe(X),Z(k,O,X,ce)}}e("decorate",v);function S(k,O){function X(ce,he){if(!Ce(ce))throw new TypeError;if(!de(he)&&!pe(he))throw new TypeError;yr(k,O,ce,he)}return X}e("metadata",S);function _(k,O,X,ce){if(!Ce(X))throw new TypeError;return de(ce)||(ce=Oe(ce)),yr(k,O,X,ce)}e("defineMetadata",_);function D(k,O,X){if(!Ce(O))throw new TypeError;return de(X)||(X=Oe(X)),Le(k,O,X)}e("hasMetadata",D);function P(k,O,X){if(!Ce(O))throw new TypeError;return de(X)||(X=Oe(X)),Ee(k,O,X)}e("hasOwnMetadata",P);function M(k,O,X){if(!Ce(O))throw new TypeError;return de(X)||(X=Oe(X)),ae(k,O,X)}e("getMetadata",M);function x(k,O,X){if(!Ce(O))throw new TypeError;return de(X)||(X=Oe(X)),kt(k,O,X)}e("getOwnMetadata",x);function A(k,O){if(!Ce(k))throw new TypeError;return de(O)||(O=Oe(O)),We(k,O)}e("getMetadataKeys",A);function j(k,O){if(!Ce(k))throw new TypeError;return de(O)||(O=Oe(O)),$r(k,O)}e("getOwnMetadataKeys",j);function re(k,O,X){if(!Ce(O))throw new TypeError;de(X)||(X=Oe(X));var ce=ge(O,X,!1);if(de(ce)||!ce.delete(k))return!1;if(ce.size>0)return!0;var he=h.get(O);return he.delete(X),he.size>0||h.delete(O),!0}e("deleteMetadata",re);function R(k,O){for(var X=k.length-1;X>=0;--X){var ce=k[X],he=ce(O);if(!de(he)&&!Pe(he)){if(!W(he))throw new TypeError;O=he}}return O}function Z(k,O,X,ce){for(var he=k.length-1;he>=0;--he){var V=k[he],G=V(O,X,ce);if(!de(G)&&!Pe(G)){if(!Ce(G))throw new TypeError;ce=G}}return ce}function ge(k,O,X){var ce=h.get(k);if(de(ce)){if(!X)return;ce=new f,h.set(k,ce)}var he=ce.get(O);if(de(he)){if(!X)return;he=new f,ce.set(O,he)}return he}function Le(k,O,X){var ce=Ee(k,O,X);if(ce)return!0;var he=Qt(O);return Pe(he)?!1:Le(k,he,X)}function Ee(k,O,X){var ce=ge(O,X,!1);return de(ce)?!1:me(ce.has(k))}function ae(k,O,X){var ce=Ee(k,O,X);if(ce)return kt(k,O,X);var he=Qt(O);if(!Pe(he))return ae(k,he,X)}function kt(k,O,X){var ce=ge(O,X,!1);if(!de(ce))return ce.get(k)}function yr(k,O,X,ce){var he=ge(X,ce,!0);he.set(k,O)}function We(k,O){var X=$r(k,O),ce=Qt(k);if(ce===null)return X;var he=We(ce,O);if(he.length<=0)return X;if(X.length<=0)return he;for(var V=new m,G=[],Y=0,oe=X;Y<oe.length;Y++){var be=oe[Y],q=V.has(be);q||(V.add(be),G.push(be))}for(var se=0,K=he;se<K.length;se++){var be=K[se],q=V.has(be);q||(V.add(be),G.push(be))}return G}function $r(k,O){var X=[],ce=ge(k,O,!1);if(de(ce))return X;for(var he=ce.keys(),V=Re(he),G=0;;){var Y=$e(V);if(!Y)return X.length=G,X;var oe=Gt(Y);try{X[G]=oe}catch(be){try{yt(V)}finally{throw be}}G++}}function H(k){if(k===null)return 1;switch(typeof k){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return k===null?1:6;default:return 6}}function de(k){return k===void 0}function Pe(k){return k===null}function ye(k){return typeof k=="symbol"}function Ce(k){return typeof k=="object"?k!==null:typeof k=="function"}function L(k,O){switch(H(k)){case 0:return k;case 1:return k;case 2:return k;case 3:return k;case 4:return k;case 5:return k}var X=O===3?"string":O===5?"number":"default",ce=Se(k,i);if(ce!==void 0){var he=ce.call(k,X);if(Ce(he))throw new TypeError;return he}return le(k,X==="default"?"number":X)}function le(k,O){if(O==="string"){var X=k.toString;if(N(X)){var ce=X.call(k);if(!Ce(ce))return ce}var he=k.valueOf;if(N(he)){var ce=he.call(k);if(!Ce(ce))return ce}}else{var he=k.valueOf;if(N(he)){var ce=he.call(k);if(!Ce(ce))return ce}var V=k.toString;if(N(V)){var ce=V.call(k);if(!Ce(ce))return ce}}throw new TypeError}function me(k){return!!k}function we(k){return""+k}function Oe(k){var O=L(k,3);return ye(O)?O:we(O)}function Ze(k){return Array.isArray?Array.isArray(k):k instanceof Object?k instanceof Array:Object.prototype.toString.call(k)==="[object Array]"}function N(k){return typeof k=="function"}function W(k){return typeof k=="function"}function pe(k){switch(H(k)){case 3:return!0;case 4:return!0;default:return!1}}function Se(k,O){var X=k[O];if(X!=null){if(!N(X))throw new TypeError;return X}}function Re(k){var O=Se(k,o);if(!N(O))throw new TypeError;var X=O.call(k);if(!Ce(X))throw new TypeError;return X}function Gt(k){return k.value}function $e(k){var O=k.next();return O.done?!1:O}function yt(k){var O=k.return;O&&O.call(k)}function Qt(k){var O=Object.getPrototypeOf(k);if(typeof k!="function"||k===d||O!==d)return O;var X=k.prototype,ce=X&&Object.getPrototypeOf(X);if(ce==null||ce===Object.prototype)return O;var he=ce.constructor;return typeof he!="function"||he===k?O:he}function Ot(){var k={},O=[],X=function(){function G(Y,oe,be){this._index=0,this._keys=Y,this._values=oe,this._selector=be}return G.prototype["@@iterator"]=function(){return this},G.prototype[o]=function(){return this},G.prototype.next=function(){var Y=this._index;if(Y>=0&&Y<this._keys.length){var oe=this._selector(this._keys[Y],this._values[Y]);return Y+1>=this._keys.length?(this._index=-1,this._keys=O,this._values=O):this._index++,{value:oe,done:!1}}return{value:void 0,done:!0}},G.prototype.throw=function(Y){throw this._index>=0&&(this._index=-1,this._keys=O,this._values=O),Y},G.prototype.return=function(Y){return this._index>=0&&(this._index=-1,this._keys=O,this._values=O),{value:Y,done:!0}},G}();return function(){function G(){this._keys=[],this._values=[],this._cacheKey=k,this._cacheIndex=-2}return Object.defineProperty(G.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),G.prototype.has=function(Y){return this._find(Y,!1)>=0},G.prototype.get=function(Y){var oe=this._find(Y,!1);return oe>=0?this._values[oe]:void 0},G.prototype.set=function(Y,oe){var be=this._find(Y,!0);return this._values[be]=oe,this},G.prototype.delete=function(Y){var oe=this._find(Y,!1);if(oe>=0){for(var be=this._keys.length,q=oe+1;q<be;q++)this._keys[q-1]=this._keys[q],this._values[q-1]=this._values[q];return this._keys.length--,this._values.length--,Y===this._cacheKey&&(this._cacheKey=k,this._cacheIndex=-2),!0}return!1},G.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=k,this._cacheIndex=-2},G.prototype.keys=function(){return new X(this._keys,this._values,ce)},G.prototype.values=function(){return new X(this._keys,this._values,he)},G.prototype.entries=function(){return new X(this._keys,this._values,V)},G.prototype["@@iterator"]=function(){return this.entries()},G.prototype[o]=function(){return this.entries()},G.prototype._find=function(Y,oe){return this._cacheKey!==Y&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=Y)),this._cacheIndex<0&&oe&&(this._cacheIndex=this._keys.length,this._keys.push(Y),this._values.push(void 0)),this._cacheIndex},G}();function ce(G,Y){return G}function he(G,Y){return Y}function V(G,Y){return[G,Y]}}function Dr(){return function(){function k(){this._map=new f}return Object.defineProperty(k.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),k.prototype.has=function(O){return this._map.has(O)},k.prototype.add=function(O){return this._map.set(O,O),this},k.prototype.delete=function(O){return this._map.delete(O)},k.prototype.clear=function(){this._map.clear()},k.prototype.keys=function(){return this._map.keys()},k.prototype.values=function(){return this._map.values()},k.prototype.entries=function(){return this._map.entries()},k.prototype["@@iterator"]=function(){return this.keys()},k.prototype[o]=function(){return this.keys()},k}()}function F(){var k=16,O=c.create(),X=ce();return function(){function oe(){this._key=ce()}return oe.prototype.has=function(be){var q=he(be,!1);return q!==void 0?c.has(q,this._key):!1},oe.prototype.get=function(be){var q=he(be,!1);return q!==void 0?c.get(q,this._key):void 0},oe.prototype.set=function(be,q){var se=he(be,!0);return se[this._key]=q,this},oe.prototype.delete=function(be){var q=he(be,!1);return q!==void 0?delete q[this._key]:!1},oe.prototype.clear=function(){this._key=ce()},oe}();function ce(){var oe;do oe="@@WeakMap@@"+Y();while(c.has(O,oe));return O[oe]=!0,oe}function he(oe,be){if(!t.call(oe,X)){if(!be)return;Object.defineProperty(oe,X,{value:c.create()})}return oe[X]}function V(oe,be){for(var q=0;q<be;++q)oe[q]=Math.random()*255|0;return oe}function G(oe){return typeof Uint8Array=="function"?typeof crypto!="undefined"?crypto.getRandomValues(new Uint8Array(oe)):typeof msCrypto!="undefined"?msCrypto.getRandomValues(new Uint8Array(oe)):V(new Uint8Array(oe),oe):V(new Array(oe),oe)}function Y(){var oe=G(k);oe[6]=oe[6]&79|64,oe[8]=oe[8]&191|128;for(var be="",q=0;q<k;++q){var se=oe[q];(q===4||q===6||q===8)&&(be+="-"),se<16&&(be+="0"),be+=se.toString(16).toLowerCase()}return be}}function ue(k){return k.__=void 0,delete k.__,k}})})(c9||(c9={}))});var d9={};Nm(d9,{isPreRelesVersionOfJupyterExtension:()=>_te});var _te,p9=ee(()=>{"use strict";u();_te=!1});var Un=z(rr=>{"use strict";u();Object.defineProperty(rr,"__esModule",{value:!0});rr.NON_CUSTOM_TAG_KEYS=rr.PRE_DESTROY=rr.POST_CONSTRUCT=rr.DESIGN_PARAM_TYPES=rr.PARAM_TYPES=rr.TAGGED_PROP=rr.TAGGED=rr.MULTI_INJECT_TAG=rr.INJECT_TAG=rr.OPTIONAL_TAG=rr.UNMANAGED_TAG=rr.NAME_TAG=rr.NAMED_TAG=void 0;rr.NAMED_TAG="named";rr.NAME_TAG="name";rr.UNMANAGED_TAG="unmanaged";rr.OPTIONAL_TAG="optional";rr.INJECT_TAG="inject";rr.MULTI_INJECT_TAG="multi_inject";rr.TAGGED="inversify:tagged";rr.TAGGED_PROP="inversify:tagged_props";rr.PARAM_TYPES="inversify:paramtypes";rr.DESIGN_PARAM_TYPES="design:paramtypes";rr.POST_CONSTRUCT="post_construct";rr.PRE_DESTROY="pre_destroy";function Yte(){return[rr.INJECT_TAG,rr.MULTI_INJECT_TAG,rr.NAME_TAG,rr.UNMANAGED_TAG,rr.NAMED_TAG,rr.OPTIONAL_TAG]}rr.NON_CUSTOM_TAG_KEYS=Yte()});var Ua=z(Ip=>{"use strict";u();Object.defineProperty(Ip,"__esModule",{value:!0});Ip.TargetTypeEnum=Ip.BindingTypeEnum=Ip.BindingScopeEnum=void 0;var $te={Request:"Request",Singleton:"Singleton",Transient:"Transient"};Ip.BindingScopeEnum=$te;var zte={ConstantValue:"ConstantValue",Constructor:"Constructor",DynamicValue:"DynamicValue",Factory:"Factory",Function:"Function",Instance:"Instance",Invalid:"Invalid",Provider:"Provider"};Ip.BindingTypeEnum=zte;var Qte={ClassProperty:"ClassProperty",ConstructorArgument:"ConstructorArgument",Variable:"Variable"};Ip.TargetTypeEnum=Qte});var Sp=z(yP=>{"use strict";u();Object.defineProperty(yP,"__esModule",{value:!0});yP.id=void 0;var Xte=0;function Zte(){return Xte++}yP.id=Zte});var sB=z(bP=>{"use strict";u();Object.defineProperty(bP,"__esModule",{value:!0});bP.Binding=void 0;var oB=Ua(),ere=Sp(),tre=function(){function r(e,t){this.id=(0,ere.id)(),this.activated=!1,this.serviceIdentifier=e,this.scope=t,this.type=oB.BindingTypeEnum.Invalid,this.constraint=function(n){return!0},this.implementationType=null,this.cache=null,this.factory=null,this.provider=null,this.onActivation=null,this.onDeactivation=null,this.dynamicValue=null}return r.prototype.clone=function(){var e=new r(this.serviceIdentifier,this.scope);return e.activated=e.scope===oB.BindingScopeEnum.Singleton?this.activated:!1,e.implementationType=this.implementationType,e.dynamicValue=this.dynamicValue,e.scope=this.scope,e.type=this.type,e.factory=this.factory,e.provider=this.provider,e.constraint=this.constraint,e.onActivation=this.onActivation,e.onDeactivation=this.onDeactivation,e.cache=this.cache,e},r}();bP.Binding=tre});var qi=z(Ve=>{"use strict";u();Object.defineProperty(Ve,"__esModule",{value:!0});Ve.STACK_OVERFLOW=Ve.CIRCULAR_DEPENDENCY_IN_FACTORY=Ve.ON_DEACTIVATION_ERROR=Ve.PRE_DESTROY_ERROR=Ve.POST_CONSTRUCT_ERROR=Ve.ASYNC_UNBIND_REQUIRED=Ve.MULTIPLE_POST_CONSTRUCT_METHODS=Ve.MULTIPLE_PRE_DESTROY_METHODS=Ve.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK=Ve.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE=Ve.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE=Ve.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT=Ve.ARGUMENTS_LENGTH_MISMATCH=Ve.INVALID_DECORATOR_OPERATION=Ve.INVALID_TO_SELF_VALUE=Ve.LAZY_IN_SYNC=Ve.INVALID_FUNCTION_BINDING=Ve.INVALID_MIDDLEWARE_RETURN=Ve.NO_MORE_SNAPSHOTS_AVAILABLE=Ve.INVALID_BINDING_TYPE=Ve.NOT_IMPLEMENTED=Ve.CIRCULAR_DEPENDENCY=Ve.UNDEFINED_INJECT_ANNOTATION=Ve.MISSING_INJECT_ANNOTATION=Ve.MISSING_INJECTABLE_ANNOTATION=Ve.NOT_REGISTERED=Ve.CANNOT_UNBIND=Ve.AMBIGUOUS_MATCH=Ve.KEY_NOT_FOUND=Ve.NULL_ARGUMENT=Ve.DUPLICATED_METADATA=Ve.DUPLICATED_INJECTABLE_DECORATOR=void 0;Ve.DUPLICATED_INJECTABLE_DECORATOR="Cannot apply @injectable decorator multiple times.";Ve.DUPLICATED_METADATA="Metadata key was used more than once in a parameter:";Ve.NULL_ARGUMENT="NULL argument";Ve.KEY_NOT_FOUND="Key Not Found";Ve.AMBIGUOUS_MATCH="Ambiguous match found for serviceIdentifier:";Ve.CANNOT_UNBIND="Could not unbind serviceIdentifier:";Ve.NOT_REGISTERED="No matching bindings found for serviceIdentifier:";Ve.MISSING_INJECTABLE_ANNOTATION="Missing required @injectable annotation in:";Ve.MISSING_INJECT_ANNOTATION="Missing required @inject or @multiInject annotation in:";var rre=function(r){return"@inject called with undefined this could mean that the class "+r+" has a circular dependency problem. You can use a LazyServiceIdentifer to  overcome this limitation."};Ve.UNDEFINED_INJECT_ANNOTATION=rre;Ve.CIRCULAR_DEPENDENCY="Circular dependency found:";Ve.NOT_IMPLEMENTED="Sorry, this feature is not fully implemented yet.";Ve.INVALID_BINDING_TYPE="Invalid binding type:";Ve.NO_MORE_SNAPSHOTS_AVAILABLE="No snapshot available to restore.";Ve.INVALID_MIDDLEWARE_RETURN="Invalid return type in middleware. Middleware must return!";Ve.INVALID_FUNCTION_BINDING="Value provided to function binding must be a function!";var nre=function(r){return"You are attempting to construct '"+r+`' in a synchronous way
 but it has asynchronous dependencies.`};Ve.LAZY_IN_SYNC=nre;Ve.INVALID_TO_SELF_VALUE="The toSelf function can only be applied when a constructor is used as service identifier";Ve.INVALID_DECORATOR_OPERATION="The @inject @multiInject @tagged and @named decorators must be applied to the parameters of a class constructor or a class property.";var ire=function(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];return"The number of constructor arguments in the derived class "+(r[0]+" must be >= than the number of constructor arguments of its base class.")};Ve.ARGUMENTS_LENGTH_MISMATCH=ire;Ve.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT="Invalid Container constructor argument. Container options must be an object.";Ve.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE="Invalid Container option. Default scope must be a string ('singleton' or 'transient').";Ve.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE="Invalid Container option. Auto bind injectable must be a boolean";Ve.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK="Invalid Container option. Skip base check must be a boolean";Ve.MULTIPLE_PRE_DESTROY_METHODS="Cannot apply @preDestroy decorator multiple times in the same class";Ve.MULTIPLE_POST_CONSTRUCT_METHODS="Cannot apply @postConstruct decorator multiple times in the same class";Ve.ASYNC_UNBIND_REQUIRED="Attempting to unbind dependency with asynchronous destruction (@preDestroy or onDeactivation)";var ore=function(r,e){return"@postConstruct error in class "+r+": "+e};Ve.POST_CONSTRUCT_ERROR=ore;var sre=function(r,e){return"@preDestroy error in class "+r+": "+e};Ve.PRE_DESTROY_ERROR=sre;var are=function(r,e){return"onDeactivation() error in class "+r+": "+e};Ve.ON_DEACTIVATION_ERROR=are;var lre=function(r,e){return"It looks like there is a circular dependency in one of the '"+r+"' bindings. Please investigate bindings with"+("service identifier '"+e+"'.")};Ve.CIRCULAR_DEPENDENCY_IN_FACTORY=lre;Ve.STACK_OVERFLOW="Maximum call stack size exceeded"});var BO=z(oc=>{"use strict";u();var cre=oc&&oc.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),ure=oc&&oc.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),dre=oc&&oc.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&cre(e,r,t);return ure(e,r),e};Object.defineProperty(oc,"__esModule",{value:!0});oc.MetadataReader=void 0;var jO=dre(Un()),pre=function(){function r(){}return r.prototype.getConstructorMetadata=function(e){var t=Reflect.getMetadata(jO.PARAM_TYPES,e),n=Reflect.getMetadata(jO.TAGGED,e);return{compilerGeneratedMetadata:t,userGeneratedMetadata:n||{}}},r.prototype.getPropertiesMetadata=function(e){var t=Reflect.getMetadata(jO.TAGGED_PROP,e)||[];return t},r}();oc.MetadataReader=pre});var aB=z(IP=>{"use strict";u();Object.defineProperty(IP,"__esModule",{value:!0});IP.BindingCount=void 0;var fre={MultipleBindingsAvailable:2,NoBindingsAvailable:0,OnlyOneBindingAvailable:1};IP.BindingCount=fre});var HO=z(ta=>{"use strict";u();var mre=ta&&ta.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),gre=ta&&ta.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),hre=ta&&ta.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&mre(e,r,t);return gre(e,r),e};Object.defineProperty(ta,"__esModule",{value:!0});ta.tryAndThrowErrorIfStackOverflow=ta.isStackOverflowExeption=void 0;var vre=hre(qi());function lB(r){return r instanceof RangeError||r.message===vre.STACK_OVERFLOW}ta.isStackOverflowExeption=lB;var yre=function(r,e){try{return r()}catch(t){throw lB(t)&&(t=e()),t}};ta.tryAndThrowErrorIfStackOverflow=yre});var Yv=z(Wn=>{"use strict";u();var bre=Wn&&Wn.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Ire=Wn&&Wn.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Sre=Wn&&Wn.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&bre(e,r,t);return Ire(e,r),e};Object.defineProperty(Wn,"__esModule",{value:!0});Wn.getSymbolDescription=Wn.circularDependencyToException=Wn.listMetadataForTarget=Wn.listRegisteredBindingsForServiceIdentifier=Wn.getServiceIdentifierAsString=Wn.getFunctionName=void 0;var _re=Sre(qi());function cB(r){if(typeof r=="function"){var e=r;return e.name}else{if(typeof r=="symbol")return r.toString();var e=r;return e}}Wn.getServiceIdentifierAsString=cB;function Ere(r,e,t){var n="",i=t(r,e);return i.length!==0&&(n=`
Registered bindings:`,i.forEach(function(o){var s="Object";o.implementationType!==null&&(s=pB(o.implementationType)),n=n+`
 `+s,o.constraint.metaData&&(n=n+" - "+o.constraint.metaData)})),n}Wn.listRegisteredBindingsForServiceIdentifier=Ere;function uB(r,e){return r.parentRequest===null?!1:r.parentRequest.serviceIdentifier===e?!0:uB(r.parentRequest,e)}function Cre(r){function e(n,i){i===void 0&&(i=[]);var o=cB(n.serviceIdentifier);return i.push(o),n.parentRequest!==null?e(n.parentRequest,i):i}var t=e(r);return t.reverse().join(" --> ")}function dB(r){r.childRequests.forEach(function(e){if(uB(e,e.serviceIdentifier)){var t=Cre(e);throw new Error(_re.CIRCULAR_DEPENDENCY+" "+t)}else dB(e)})}Wn.circularDependencyToException=dB;function wre(r,e){if(e.isTagged()||e.isNamed()){var t="",n=e.getNamedTag(),i=e.getCustomTags();return n!==null&&(t+=n.toString()+`
`),i!==null&&i.forEach(function(o){t+=o.toString()+`
`})," "+r+`
 `+r+" - "+t}else return" "+r}Wn.listMetadataForTarget=wre;function pB(r){if(r.name)return r.name;var e=r.toString(),t=e.match(/^function\s*([^\s(]+)/);return t?t[1]:"Anonymous function: "+e}Wn.getFunctionName=pB;function xre(r){return r.toString().slice(7,-1)}Wn.getSymbolDescription=xre});var fB=z(SP=>{"use strict";u();Object.defineProperty(SP,"__esModule",{value:!0});SP.Context=void 0;var Dre=Sp(),Pre=function(){function r(e){this.id=(0,Dre.id)(),this.container=e}return r.prototype.addPlan=function(e){this.plan=e},r.prototype.setCurrentRequest=function(e){this.currentRequest=e},r}();SP.Context=Pre});var Wa=z(sc=>{"use strict";u();var Tre=sc&&sc.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),kre=sc&&sc.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Nre=sc&&sc.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Tre(e,r,t);return kre(e,r),e};Object.defineProperty(sc,"__esModule",{value:!0});sc.Metadata=void 0;var Rre=Nre(Un()),Are=function(){function r(e,t){this.key=e,this.value=t}return r.prototype.toString=function(){return this.key===Rre.NAMED_TAG?"named: "+String(this.value).toString()+" ":"tagged: { key:"+this.key.toString()+", value: "+String(this.value)+" }"},r}();sc.Metadata=Are});var mB=z(_P=>{"use strict";u();Object.defineProperty(_P,"__esModule",{value:!0});_P.Plan=void 0;var Mre=function(){function r(e,t){this.parentContext=e,this.rootRequest=t}return r}();_P.Plan=Mre});var JO=z(EP=>{"use strict";u();Object.defineProperty(EP,"__esModule",{value:!0});EP.LazyServiceIdentifer=void 0;var Ore=function(){function r(e){this._cb=e}return r.prototype.unwrap=function(){return this._cb()},r}();EP.LazyServiceIdentifer=Ore});var gB=z(CP=>{"use strict";u();Object.defineProperty(CP,"__esModule",{value:!0});CP.QueryableString=void 0;var Lre=function(){function r(e){this.str=e}return r.prototype.startsWith=function(e){return this.str.indexOf(e)===0},r.prototype.endsWith=function(e){var t="",n=e.split("").reverse().join("");return t=this.str.split("").reverse().join(""),this.startsWith.call({str:t},n)},r.prototype.contains=function(e){return this.str.indexOf(e)!==-1},r.prototype.equals=function(e){return this.str===e},r.prototype.value=function(){return this.str},r}();CP.QueryableString=Lre});var qO=z(ac=>{"use strict";u();var Kre=ac&&ac.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Fre=ac&&ac.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Ure=ac&&ac.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Kre(e,r,t);return Fre(e,r),e};Object.defineProperty(ac,"__esModule",{value:!0});ac.Target=void 0;var Mu=Ure(Un()),Wre=Sp(),Vre=Yv(),hB=Wa(),jre=gB(),Bre=function(){function r(e,t,n,i){this.id=(0,Wre.id)(),this.type=e,this.serviceIdentifier=n;var o=typeof t=="symbol"?(0,Vre.getSymbolDescription)(t):t;this.name=new jre.QueryableString(o||""),this.identifier=t,this.metadata=new Array;var s=null;typeof i=="string"?s=new hB.Metadata(Mu.NAMED_TAG,i):i instanceof hB.Metadata&&(s=i),s!==null&&this.metadata.push(s)}return r.prototype.hasTag=function(e){for(var t=0,n=this.metadata;t<n.length;t++){var i=n[t];if(i.key===e)return!0}return!1},r.prototype.isArray=function(){return this.hasTag(Mu.MULTI_INJECT_TAG)},r.prototype.matchesArray=function(e){return this.matchesTag(Mu.MULTI_INJECT_TAG)(e)},r.prototype.isNamed=function(){return this.hasTag(Mu.NAMED_TAG)},r.prototype.isTagged=function(){return this.metadata.some(function(e){return Mu.NON_CUSTOM_TAG_KEYS.every(function(t){return e.key!==t})})},r.prototype.isOptional=function(){return this.matchesTag(Mu.OPTIONAL_TAG)(!0)},r.prototype.getNamedTag=function(){return this.isNamed()?this.metadata.filter(function(e){return e.key===Mu.NAMED_TAG})[0]:null},r.prototype.getCustomTags=function(){return this.isTagged()?this.metadata.filter(function(e){return Mu.NON_CUSTOM_TAG_KEYS.every(function(t){return e.key!==t})}):null},r.prototype.matchesNamedTag=function(e){return this.matchesTag(Mu.NAMED_TAG)(e)},r.prototype.matchesTag=function(e){var t=this;return function(n){for(var i=0,o=t.metadata;i<o.length;i++){var s=o[i];if(s.key===e&&s.value===n)return!0}return!1}},r}();ac.Target=Bre});var CB=z(Gi=>{"use strict";u();var Hre=Gi&&Gi.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Jre=Gi&&Gi.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),vB=Gi&&Gi.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Hre(e,r,t);return Jre(e,r),e},wP=Gi&&Gi.__spreadArray||function(r,e,t){if(t||arguments.length===2)for(var n=0,i=e.length,o;n<i;n++)(o||!(n in e))&&(o||(o=Array.prototype.slice.call(e,0,n)),o[n]=e[n]);return r.concat(o||Array.prototype.slice.call(e))};Object.defineProperty(Gi,"__esModule",{value:!0});Gi.getFunctionName=Gi.getBaseClassDependencyCount=Gi.getDependencies=void 0;var qre=JO(),GO=vB(qi()),yB=Ua(),FE=vB(Un()),YO=Yv();Object.defineProperty(Gi,"getFunctionName",{enumerable:!0,get:function(){return YO.getFunctionName}});var bB=qO();function Gre(r,e){var t=(0,YO.getFunctionName)(e);return IB(r,t,e,!1)}Gi.getDependencies=Gre;function IB(r,e,t,n){var i=r.getConstructorMetadata(t),o=i.compilerGeneratedMetadata;if(o===void 0){var s=GO.MISSING_INJECTABLE_ANNOTATION+" "+e+".";throw new Error(s)}var a=i.userGeneratedMetadata,l=Object.keys(a),c=t.length===0&&l.length>0,d=l.length>t.length,p=c||d?l.length:t.length,f=$re(n,e,o,a,p),m=SB(r,t,e),g=wP(wP([],f,!0),m,!0);return g}function Yre(r,e,t,n,i){var o=i[r.toString()]||[],s=EB(o),a=s.unmanaged!==!0,l=n[r],c=s.inject||s.multiInject;if(l=c||l,l instanceof qre.LazyServiceIdentifer&&(l=l.unwrap()),a){var d=l===Object,p=l===Function,f=l===void 0,m=d||p||f;if(!e&&m){var g=GO.MISSING_INJECT_ANNOTATION+" argument "+r+" in class "+t+".";throw new Error(g)}var h=new bB.Target(yB.TargetTypeEnum.ConstructorArgument,s.targetName,l);return h.metadata=o,h}return null}function $re(r,e,t,n,i){for(var o=[],s=0;s<i;s++){var a=s,l=Yre(a,r,e,t,n);l!==null&&o.push(l)}return o}function zre(r,e,t,n){var i=r||e;if(i===void 0){var o=GO.MISSING_INJECTABLE_ANNOTATION+" for property "+String(t)+" in class "+n+".";throw new Error(o)}return i}function SB(r,e,t){for(var n=r.getPropertiesMetadata(e),i=[],o=Object.getOwnPropertySymbols(n),s=Object.keys(n),a=s.concat(o),l=0,c=a;l<c.length;l++){var d=c[l],p=n[d],f=EB(p),m=f.targetName||d,g=zre(f.inject,f.multiInject,d,t),h=new bB.Target(yB.TargetTypeEnum.ClassProperty,m,g);h.metadata=p,i.push(h)}var v=Object.getPrototypeOf(e.prototype).constructor;if(v!==Object){var S=SB(r,v,t);i=wP(wP([],i,!0),S,!0)}return i}function _B(r,e){var t=Object.getPrototypeOf(e.prototype).constructor;if(t!==Object){var n=(0,YO.getFunctionName)(t),i=IB(r,n,t,!0),o=i.map(function(l){return l.metadata.filter(function(c){return c.key===FE.UNMANAGED_TAG})}),s=[].concat.apply([],o).length,a=i.length-s;return a>0?a:_B(r,t)}else return 0}Gi.getBaseClassDependencyCount=_B;function EB(r){var e={};return r.forEach(function(t){e[t.key.toString()]=t.value}),{inject:e[FE.INJECT_TAG],multiInject:e[FE.MULTI_INJECT_TAG],targetName:e[FE.NAME_TAG],unmanaged:e[FE.UNMANAGED_TAG]}}});var wB=z(xP=>{"use strict";u();Object.defineProperty(xP,"__esModule",{value:!0});xP.Request=void 0;var Qre=Sp(),Xre=function(){function r(e,t,n,i,o){this.id=(0,Qre.id)(),this.serviceIdentifier=e,this.parentContext=t,this.parentRequest=n,this.target=o,this.childRequests=[],this.bindings=Array.isArray(i)?i:[i],this.requestScope=n===null?new Map:null}return r.prototype.addChildRequest=function(e,t,n){var i=new r(e,this.parentContext,this,t,n);return this.childRequests.push(i),i},r}();xP.Request=Xre});var ZO=z(Vo=>{"use strict";u();var Zre=Vo&&Vo.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),ene=Vo&&Vo.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),PB=Vo&&Vo.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Zre(e,r,t);return ene(e,r),e};Object.defineProperty(Vo,"__esModule",{value:!0});Vo.getBindingDictionary=Vo.createMockRequest=Vo.plan=void 0;var DP=aB(),zO=PB(qi()),TB=Ua(),xB=PB(Un()),tne=HO(),$v=Yv(),kB=fB(),QO=Wa(),rne=mB(),$O=CB(),XO=wB(),NB=qO();function RB(r){return r._bindingDictionary}Vo.getBindingDictionary=RB;function nne(r,e,t,n,i,o){var s=r?xB.MULTI_INJECT_TAG:xB.INJECT_TAG,a=new QO.Metadata(s,t),l=new NB.Target(e,n,t,a);if(i!==void 0){var c=new QO.Metadata(i,o);l.metadata.push(c)}return l}function DB(r,e,t,n,i){var o=UE(t.container,i.serviceIdentifier),s=[];return o.length===DP.BindingCount.NoBindingsAvailable&&t.container.options.autoBindInjectable&&typeof i.serviceIdentifier=="function"&&r.getConstructorMetadata(i.serviceIdentifier).compilerGeneratedMetadata&&(t.container.bind(i.serviceIdentifier).toSelf(),o=UE(t.container,i.serviceIdentifier)),e?s=o:s=o.filter(function(a){var l=new XO.Request(a.serviceIdentifier,t,n,a,i);return a.constraint(l)}),ine(i.serviceIdentifier,s,i,t.container),s}function ine(r,e,t,n){switch(e.length){case DP.BindingCount.NoBindingsAvailable:if(t.isOptional())return e;var i=(0,$v.getServiceIdentifierAsString)(r),o=zO.NOT_REGISTERED;throw o+=(0,$v.listMetadataForTarget)(i,t),o+=(0,$v.listRegisteredBindingsForServiceIdentifier)(n,i,UE),new Error(o);case DP.BindingCount.OnlyOneBindingAvailable:return e;case DP.BindingCount.MultipleBindingsAvailable:default:if(t.isArray())return e;var i=(0,$v.getServiceIdentifierAsString)(r),o=zO.AMBIGUOUS_MATCH+" "+i;throw o+=(0,$v.listRegisteredBindingsForServiceIdentifier)(n,i,UE),new Error(o)}}function AB(r,e,t,n,i,o){var s,a;if(i===null){s=DB(r,e,n,null,o),a=new XO.Request(t,n,null,s,o);var l=new rne.Plan(n,a);n.addPlan(l)}else s=DB(r,e,n,i,o),a=i.addChildRequest(o.serviceIdentifier,s,o);s.forEach(function(c){var d=null;if(o.isArray())d=a.addChildRequest(c.serviceIdentifier,c,o);else{if(c.cache)return;d=a}if(c.type===TB.BindingTypeEnum.Instance&&c.implementationType!==null){var p=(0,$O.getDependencies)(r,c.implementationType);if(!n.container.options.skipBaseClassChecks){var f=(0,$O.getBaseClassDependencyCount)(r,c.implementationType);if(p.length<f){var m=zO.ARGUMENTS_LENGTH_MISMATCH((0,$O.getFunctionName)(c.implementationType));throw new Error(m)}}p.forEach(function(g){AB(r,!1,g.serviceIdentifier,n,d,g)})}})}function UE(r,e){var t=[],n=RB(r);return n.hasKey(e)?t=n.get(e):r.parent!==null&&(t=UE(r.parent,e)),t}function one(r,e,t,n,i,o,s,a){a===void 0&&(a=!1);var l=new kB.Context(e),c=nne(t,n,i,"",o,s);try{return AB(r,a,i,l,null,c),l}catch(d){throw(0,tne.isStackOverflowExeption)(d)&&(0,$v.circularDependencyToException)(l.plan.rootRequest),d}}Vo.plan=one;function sne(r,e,t,n){var i=new NB.Target(TB.TargetTypeEnum.Variable,"",e,new QO.Metadata(t,n)),o=new kB.Context(r),s=new XO.Request(e,o,null,[],i);return s}Vo.createMockRequest=sne});var WE=z(zv=>{"use strict";u();Object.defineProperty(zv,"__esModule",{value:!0});zv.isPromiseOrContainsPromise=zv.isPromise=void 0;function eL(r){var e=typeof r=="object"&&r!==null||typeof r=="function";return e&&typeof r.then=="function"}zv.isPromise=eL;function ane(r){return eL(r)?!0:Array.isArray(r)&&r.some(eL)}zv.isPromiseOrContainsPromise=ane});var MB=z(lc=>{"use strict";u();var lne=lc&&lc.__awaiter||function(r,e,t,n){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(d){try{c(n.next(d))}catch(p){s(p)}}function l(d){try{c(n.throw(d))}catch(p){s(p)}}function c(d){d.done?o(d.value):i(d.value).then(a,l)}c((n=n.apply(r,e||[])).next())})},cne=lc&&lc.__generator||function(r,e){var t={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},n,i,o,s;return s={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(c){return function(d){return l([c,d])}}function l(c){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,i&&(o=c[0]&2?i.return:c[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,c[1])).done)return o;switch(i=0,o&&(c=[c[0]&2,o.value]),c[0]){case 0:case 1:o=c;break;case 4:return t.label++,{value:c[1],done:!1};case 5:t.label++,i=c[1],c=[0];continue;case 7:c=t.ops.pop(),t.trys.pop();continue;default:if(o=t.trys,!(o=o.length>0&&o[o.length-1])&&(c[0]===6||c[0]===2)){t=0;continue}if(c[0]===3&&(!o||c[1]>o[0]&&c[1]<o[3])){t.label=c[1];break}if(c[0]===6&&t.label<o[1]){t.label=o[1],o=c;break}if(o&&t.label<o[2]){t.label=o[2],t.ops.push(c);break}o[2]&&t.ops.pop(),t.trys.pop();continue}c=e.call(r,t)}catch(d){c=[6,d],i=0}finally{n=o=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}};Object.defineProperty(lc,"__esModule",{value:!0});lc.saveToScope=lc.tryGetFromScope=void 0;var PP=te(),une=WE(),dne=function(r,e){return e.scope===PP.BindingScopeEnum.Singleton&&e.activated?e.cache:e.scope===PP.BindingScopeEnum.Request&&r.has(e.id)?r.get(e.id):null};lc.tryGetFromScope=dne;var pne=function(r,e,t){e.scope===PP.BindingScopeEnum.Singleton&&mne(e,t),e.scope===PP.BindingScopeEnum.Request&&fne(r,e,t)};lc.saveToScope=pne;var fne=function(r,e,t){r.has(e.id)||r.set(e.id,t)},mne=function(r,e){r.cache=e,r.activated=!0,(0,une.isPromise)(e)&&gne(r,e)},gne=function(r,e){return lne(void 0,void 0,void 0,function(){var t,n;return cne(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,e];case 1:return t=i.sent(),r.cache=t,[3,3];case 2:throw n=i.sent(),r.cache=null,r.activated=!1,n;case 3:return[2]}})})}});var OB=z(VE=>{"use strict";u();Object.defineProperty(VE,"__esModule",{value:!0});VE.FactoryType=void 0;var hne;(function(r){r.DynamicValue="toDynamicValue",r.Factory="toFactory",r.Provider="toProvider"})(hne=VE.FactoryType||(VE.FactoryType={}))});var rL=z(jo=>{"use strict";u();var vne=jo&&jo.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),yne=jo&&jo.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),bne=jo&&jo.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&vne(e,r,t);return yne(e,r),e};Object.defineProperty(jo,"__esModule",{value:!0});jo.getFactoryDetails=jo.ensureFullyBound=jo.multiBindToService=void 0;var Ine=te(),Sne=bne(qi()),cc=Ua(),tL=OB(),_ne=function(r){return function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return t.forEach(function(i){return r.bind(i).toService(e)})}}};jo.multiBindToService=_ne;var Ene=function(r){var e=null;switch(r.type){case cc.BindingTypeEnum.ConstantValue:case cc.BindingTypeEnum.Function:e=r.cache;break;case cc.BindingTypeEnum.Constructor:case cc.BindingTypeEnum.Instance:e=r.implementationType;break;case cc.BindingTypeEnum.DynamicValue:e=r.dynamicValue;break;case cc.BindingTypeEnum.Provider:e=r.provider;break;case cc.BindingTypeEnum.Factory:e=r.factory;break}if(e===null){var t=(0,Ine.getServiceIdentifierAsString)(r.serviceIdentifier);throw new Error(Sne.INVALID_BINDING_TYPE+" "+t)}};jo.ensureFullyBound=Ene;var Cne=function(r){switch(r.type){case cc.BindingTypeEnum.Factory:return{factory:r.factory,factoryType:tL.FactoryType.Factory};case cc.BindingTypeEnum.Provider:return{factory:r.provider,factoryType:tL.FactoryType.Provider};case cc.BindingTypeEnum.DynamicValue:return{factory:r.dynamicValue,factoryType:tL.FactoryType.DynamicValue};default:throw new Error("Unexpected factory type "+r.type)}};jo.getFactoryDetails=Cne});var VB=z(gi=>{"use strict";u();var Qv=gi&&gi.__assign||function(){return Qv=Object.assign||function(r){for(var e,t=1,n=arguments.length;t<n;t++){e=arguments[t];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=e[i])}return r},Qv.apply(this,arguments)},wne=gi&&gi.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),xne=gi&&gi.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Dne=gi&&gi.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&wne(e,r,t);return xne(e,r),e},FB=gi&&gi.__awaiter||function(r,e,t,n){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(d){try{c(n.next(d))}catch(p){s(p)}}function l(d){try{c(n.throw(d))}catch(p){s(p)}}function c(d){d.done?o(d.value):i(d.value).then(a,l)}c((n=n.apply(r,e||[])).next())})},UB=gi&&gi.__generator||function(r,e){var t={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},n,i,o,s;return s={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(c){return function(d){return l([c,d])}}function l(c){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,i&&(o=c[0]&2?i.return:c[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,c[1])).done)return o;switch(i=0,o&&(c=[c[0]&2,o.value]),c[0]){case 0:case 1:o=c;break;case 4:return t.label++,{value:c[1],done:!1};case 5:t.label++,i=c[1],c=[0];continue;case 7:c=t.ops.pop(),t.trys.pop();continue;default:if(o=t.trys,!(o=o.length>0&&o[o.length-1])&&(c[0]===6||c[0]===2)){t=0;continue}if(c[0]===3&&(!o||c[1]>o[0]&&c[1]<o[3])){t.label=c[1];break}if(c[0]===6&&t.label<o[1]){t.label=o[1],o=c;break}if(o&&t.label<o[2]){t.label=o[2],t.ops.push(c);break}o[2]&&t.ops.pop(),t.trys.pop();continue}c=e.call(r,t)}catch(d){c=[6,d],i=0}finally{n=o=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}},Pne=gi&&gi.__spreadArray||function(r,e,t){if(t||arguments.length===2)for(var n=0,i=e.length,o;n<i;n++)(o||!(n in e))&&(o||(o=Array.prototype.slice.call(e,0,n)),o[n]=e[n]);return r.concat(o||Array.prototype.slice.call(e))};Object.defineProperty(gi,"__esModule",{value:!0});gi.resolveInstance=void 0;var nL=qi(),oL=Ua(),iL=Dne(Un()),sL=WE();function Tne(r,e){return r.reduce(function(t,n){var i=e(n),o=n.target.type;return o===oL.TargetTypeEnum.ConstructorArgument?t.constructorInjections.push(i):(t.propertyRequests.push(n),t.propertyInjections.push(i)),t.isAsync||(t.isAsync=(0,sL.isPromiseOrContainsPromise)(i)),t},{constructorInjections:[],propertyInjections:[],propertyRequests:[],isAsync:!1})}function kne(r,e,t){var n;if(e.length>0){var i=Tne(e,t),o=Qv(Qv({},i),{constr:r});i.isAsync?n=Nne(o):n=WB(o)}else n=new r;return n}function WB(r){var e,t=new((e=r.constr).bind.apply(e,Pne([void 0],r.constructorInjections,!1)));return r.propertyRequests.forEach(function(n,i){var o=n.target.identifier,s=r.propertyInjections[i];t[o]=s}),t}function Nne(r){return FB(this,void 0,void 0,function(){var e,t;return UB(this,function(n){switch(n.label){case 0:return[4,LB(r.constructorInjections)];case 1:return e=n.sent(),[4,LB(r.propertyInjections)];case 2:return t=n.sent(),[2,WB(Qv(Qv({},r),{constructorInjections:e,propertyInjections:t}))]}})})}function LB(r){return FB(this,void 0,void 0,function(){var e,t,n,i;return UB(this,function(o){for(e=[],t=0,n=r;t<n.length;t++)i=n[t],Array.isArray(i)?e.push(Promise.all(i)):e.push(i);return[2,Promise.all(e)]})})}function KB(r,e){var t=Rne(r,e);return(0,sL.isPromise)(t)?t.then(function(){return e}):e}function Rne(r,e){var t,n;if(Reflect.hasMetadata(iL.POST_CONSTRUCT,r)){var i=Reflect.getMetadata(iL.POST_CONSTRUCT,r);try{return(n=(t=e)[i.value])===null||n===void 0?void 0:n.call(t)}catch(o){throw new Error((0,nL.POST_CONSTRUCT_ERROR)(r.name,o.message))}}}function Ane(r,e){r.scope!==oL.BindingScopeEnum.Singleton&&Mne(r,e)}function Mne(r,e){var t="Class cannot be instantiated in "+(r.scope===oL.BindingScopeEnum.Request?"request":"transient")+" scope.";if(typeof r.onDeactivation=="function")throw new Error((0,nL.ON_DEACTIVATION_ERROR)(e.name,t));if(Reflect.hasMetadata(iL.PRE_DESTROY,e))throw new Error((0,nL.PRE_DESTROY_ERROR)(e.name,t))}function One(r,e,t,n){Ane(r,e);var i=kne(e,t,n);return(0,sL.isPromise)(i)?i.then(function(o){return KB(e,o)}):KB(e,i)}gi.resolveInstance=One});var qB=z(Bo=>{"use strict";u();var Lne=Bo&&Bo.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Kne=Bo&&Bo.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Fne=Bo&&Bo.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Lne(e,r,t);return Kne(e,r),e},Une=Bo&&Bo.__awaiter||function(r,e,t,n){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(d){try{c(n.next(d))}catch(p){s(p)}}function l(d){try{c(n.throw(d))}catch(p){s(p)}}function c(d){d.done?o(d.value):i(d.value).then(a,l)}c((n=n.apply(r,e||[])).next())})},Wne=Bo&&Bo.__generator||function(r,e){var t={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},n,i,o,s;return s={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(c){return function(d){return l([c,d])}}function l(c){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,i&&(o=c[0]&2?i.return:c[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,c[1])).done)return o;switch(i=0,o&&(c=[c[0]&2,o.value]),c[0]){case 0:case 1:o=c;break;case 4:return t.label++,{value:c[1],done:!1};case 5:t.label++,i=c[1],c=[0];continue;case 7:c=t.ops.pop(),t.trys.pop();continue;default:if(o=t.trys,!(o=o.length>0&&o[o.length-1])&&(c[0]===6||c[0]===2)){t=0;continue}if(c[0]===3&&(!o||c[1]>o[0]&&c[1]<o[3])){t.label=c[1];break}if(c[0]===6&&t.label<o[1]){t.label=o[1],o=c;break}if(o&&t.label<o[2]){t.label=o[2],t.ops.push(c);break}o[2]&&t.ops.pop(),t.trys.pop();continue}c=e.call(r,t)}catch(d){c=[6,d],i=0}finally{n=o=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}};Object.defineProperty(Bo,"__esModule",{value:!0});Bo.resolve=void 0;var Vne=Fne(qi()),TP=Ua(),jne=ZO(),jB=MB(),aL=WE(),HB=rL(),Bne=HO(),Hne=VB(),lL=function(r){return function(e){e.parentContext.setCurrentRequest(e);var t=e.bindings,n=e.childRequests,i=e.target&&e.target.isArray(),o=!e.parentRequest||!e.parentRequest.target||!e.target||!e.parentRequest.target.matchesArray(e.target.serviceIdentifier);if(i&&o)return n.map(function(a){var l=lL(r);return l(a)});if(e.target.isOptional()&&t.length===0)return;var s=t[0];return Yne(r,e,s)}},Jne=function(r,e){var t=(0,HB.getFactoryDetails)(r);return(0,Bne.tryAndThrowErrorIfStackOverflow)(function(){return t.factory.bind(r)(e)},function(){return new Error(Vne.CIRCULAR_DEPENDENCY_IN_FACTORY(t.factoryType,e.currentRequest.serviceIdentifier.toString()))})},qne=function(r,e,t){var n,i=e.childRequests;switch((0,HB.ensureFullyBound)(t),t.type){case TP.BindingTypeEnum.ConstantValue:case TP.BindingTypeEnum.Function:n=t.cache;break;case TP.BindingTypeEnum.Constructor:n=t.implementationType;break;case TP.BindingTypeEnum.Instance:n=(0,Hne.resolveInstance)(t,t.implementationType,i,lL(r));break;default:n=Jne(t,e.parentContext)}return n},Gne=function(r,e,t){var n=(0,jB.tryGetFromScope)(r,e);return n!==null||(n=t(),(0,jB.saveToScope)(r,e,n)),n},Yne=function(r,e,t){return Gne(r,t,function(){var n=qne(r,e,t);return(0,aL.isPromise)(n)?n=n.then(function(i){return BB(e,t,i)}):n=BB(e,t,n),n})};function BB(r,e,t){var n=$ne(r.parentContext,e,t),i=Xne(r.parentContext.container),o,s=i.next();do{o=s.value;var a=r.parentContext,l=r.serviceIdentifier,c=Qne(o,l);(0,aL.isPromise)(n)?n=JB(c,a,n):n=zne(c,a,n),s=i.next()}while(s.done!==!0&&!(0,jne.getBindingDictionary)(o).hasKey(r.serviceIdentifier));return n}var $ne=function(r,e,t){var n;return typeof e.onActivation=="function"?n=e.onActivation(r,t):n=t,n},zne=function(r,e,t){for(var n=r.next();!n.done;){if(t=n.value(e,t),(0,aL.isPromise)(t))return JB(r,e,t);n=r.next()}return t},JB=function(r,e,t){return Une(void 0,void 0,void 0,function(){var n,i;return Wne(this,function(o){switch(o.label){case 0:return[4,t];case 1:n=o.sent(),i=r.next(),o.label=2;case 2:return i.done?[3,4]:[4,i.value(e,n)];case 3:return n=o.sent(),i=r.next(),[3,2];case 4:return[2,n]}})})},Qne=function(r,e){var t=r._activations;return t.hasKey(e)?t.get(e).values():[].values()},Xne=function(r){for(var e=[r],t=r.parent;t!==null;)e.push(t),t=t.parent;var n=function(){var o=e.pop();return o!==void 0?{done:!1,value:o}:{done:!0,value:void 0}},i={next:n};return i};function Zne(r){var e=lL(r.plan.rootRequest.requestScope);return e(r.plan.rootRequest)}Bo.resolve=Zne});var cL=z(Yi=>{"use strict";u();var eie=Yi&&Yi.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),tie=Yi&&Yi.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),rie=Yi&&Yi.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&eie(e,r,t);return tie(e,r),e};Object.defineProperty(Yi,"__esModule",{value:!0});Yi.typeConstraint=Yi.namedConstraint=Yi.taggedConstraint=Yi.traverseAncerstors=void 0;var nie=rie(Un()),iie=Wa(),GB=function(r,e){var t=r.parentRequest;return t!==null?e(t)?!0:GB(t,e):!1};Yi.traverseAncerstors=GB;var YB=function(r){return function(e){var t=function(n){return n!==null&&n.target!==null&&n.target.matchesTag(r)(e)};return t.metaData=new iie.Metadata(r,e),t}};Yi.taggedConstraint=YB;var oie=YB(nie.NAMED_TAG);Yi.namedConstraint=oie;var sie=function(r){return function(e){var t=null;if(e!==null)if(t=e.bindings[0],typeof r=="string"){var n=t.serviceIdentifier;return n===r}else{var i=e.bindings[0].implementationType;return r===i}return!1}};Yi.typeConstraint=sie});var NP=z(kP=>{"use strict";u();Object.defineProperty(kP,"__esModule",{value:!0});kP.BindingWhenSyntax=void 0;var vo=RP(),Qn=cL(),aie=function(){function r(e){this._binding=e}return r.prototype.when=function(e){return this._binding.constraint=e,new vo.BindingOnSyntax(this._binding)},r.prototype.whenTargetNamed=function(e){return this._binding.constraint=(0,Qn.namedConstraint)(e),new vo.BindingOnSyntax(this._binding)},r.prototype.whenTargetIsDefault=function(){return this._binding.constraint=function(e){if(e===null)return!1;var t=e.target!==null&&!e.target.isNamed()&&!e.target.isTagged();return t},new vo.BindingOnSyntax(this._binding)},r.prototype.whenTargetTagged=function(e,t){return this._binding.constraint=(0,Qn.taggedConstraint)(e)(t),new vo.BindingOnSyntax(this._binding)},r.prototype.whenInjectedInto=function(e){return this._binding.constraint=function(t){return t!==null&&(0,Qn.typeConstraint)(e)(t.parentRequest)},new vo.BindingOnSyntax(this._binding)},r.prototype.whenParentNamed=function(e){return this._binding.constraint=function(t){return t!==null&&(0,Qn.namedConstraint)(e)(t.parentRequest)},new vo.BindingOnSyntax(this._binding)},r.prototype.whenParentTagged=function(e,t){return this._binding.constraint=function(n){return n!==null&&(0,Qn.taggedConstraint)(e)(t)(n.parentRequest)},new vo.BindingOnSyntax(this._binding)},r.prototype.whenAnyAncestorIs=function(e){return this._binding.constraint=function(t){return t!==null&&(0,Qn.traverseAncerstors)(t,(0,Qn.typeConstraint)(e))},new vo.BindingOnSyntax(this._binding)},r.prototype.whenNoAncestorIs=function(e){return this._binding.constraint=function(t){return t!==null&&!(0,Qn.traverseAncerstors)(t,(0,Qn.typeConstraint)(e))},new vo.BindingOnSyntax(this._binding)},r.prototype.whenAnyAncestorNamed=function(e){return this._binding.constraint=function(t){return t!==null&&(0,Qn.traverseAncerstors)(t,(0,Qn.namedConstraint)(e))},new vo.BindingOnSyntax(this._binding)},r.prototype.whenNoAncestorNamed=function(e){return this._binding.constraint=function(t){return t!==null&&!(0,Qn.traverseAncerstors)(t,(0,Qn.namedConstraint)(e))},new vo.BindingOnSyntax(this._binding)},r.prototype.whenAnyAncestorTagged=function(e,t){return this._binding.constraint=function(n){return n!==null&&(0,Qn.traverseAncerstors)(n,(0,Qn.taggedConstraint)(e)(t))},new vo.BindingOnSyntax(this._binding)},r.prototype.whenNoAncestorTagged=function(e,t){return this._binding.constraint=function(n){return n!==null&&!(0,Qn.traverseAncerstors)(n,(0,Qn.taggedConstraint)(e)(t))},new vo.BindingOnSyntax(this._binding)},r.prototype.whenAnyAncestorMatches=function(e){return this._binding.constraint=function(t){return t!==null&&(0,Qn.traverseAncerstors)(t,e)},new vo.BindingOnSyntax(this._binding)},r.prototype.whenNoAncestorMatches=function(e){return this._binding.constraint=function(t){return t!==null&&!(0,Qn.traverseAncerstors)(t,e)},new vo.BindingOnSyntax(this._binding)},r}();kP.BindingWhenSyntax=aie});var RP=z(AP=>{"use strict";u();Object.defineProperty(AP,"__esModule",{value:!0});AP.BindingOnSyntax=void 0;var $B=NP(),lie=function(){function r(e){this._binding=e}return r.prototype.onActivation=function(e){return this._binding.onActivation=e,new $B.BindingWhenSyntax(this._binding)},r.prototype.onDeactivation=function(e){return this._binding.onDeactivation=e,new $B.BindingWhenSyntax(this._binding)},r}();AP.BindingOnSyntax=lie});var uL=z(MP=>{"use strict";u();Object.defineProperty(MP,"__esModule",{value:!0});MP.BindingWhenOnSyntax=void 0;var cie=RP(),uie=NP(),die=function(){function r(e){this._binding=e,this._bindingWhenSyntax=new uie.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new cie.BindingOnSyntax(this._binding)}return r.prototype.when=function(e){return this._bindingWhenSyntax.when(e)},r.prototype.whenTargetNamed=function(e){return this._bindingWhenSyntax.whenTargetNamed(e)},r.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},r.prototype.whenTargetTagged=function(e,t){return this._bindingWhenSyntax.whenTargetTagged(e,t)},r.prototype.whenInjectedInto=function(e){return this._bindingWhenSyntax.whenInjectedInto(e)},r.prototype.whenParentNamed=function(e){return this._bindingWhenSyntax.whenParentNamed(e)},r.prototype.whenParentTagged=function(e,t){return this._bindingWhenSyntax.whenParentTagged(e,t)},r.prototype.whenAnyAncestorIs=function(e){return this._bindingWhenSyntax.whenAnyAncestorIs(e)},r.prototype.whenNoAncestorIs=function(e){return this._bindingWhenSyntax.whenNoAncestorIs(e)},r.prototype.whenAnyAncestorNamed=function(e){return this._bindingWhenSyntax.whenAnyAncestorNamed(e)},r.prototype.whenAnyAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenAnyAncestorTagged(e,t)},r.prototype.whenNoAncestorNamed=function(e){return this._bindingWhenSyntax.whenNoAncestorNamed(e)},r.prototype.whenNoAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenNoAncestorTagged(e,t)},r.prototype.whenAnyAncestorMatches=function(e){return this._bindingWhenSyntax.whenAnyAncestorMatches(e)},r.prototype.whenNoAncestorMatches=function(e){return this._bindingWhenSyntax.whenNoAncestorMatches(e)},r.prototype.onActivation=function(e){return this._bindingOnSyntax.onActivation(e)},r.prototype.onDeactivation=function(e){return this._bindingOnSyntax.onDeactivation(e)},r}();MP.BindingWhenOnSyntax=die});var zB=z(OP=>{"use strict";u();Object.defineProperty(OP,"__esModule",{value:!0});OP.BindingInSyntax=void 0;var dL=Ua(),pL=uL(),pie=function(){function r(e){this._binding=e}return r.prototype.inRequestScope=function(){return this._binding.scope=dL.BindingScopeEnum.Request,new pL.BindingWhenOnSyntax(this._binding)},r.prototype.inSingletonScope=function(){return this._binding.scope=dL.BindingScopeEnum.Singleton,new pL.BindingWhenOnSyntax(this._binding)},r.prototype.inTransientScope=function(){return this._binding.scope=dL.BindingScopeEnum.Transient,new pL.BindingWhenOnSyntax(this._binding)},r}();OP.BindingInSyntax=pie});var QB=z(LP=>{"use strict";u();Object.defineProperty(LP,"__esModule",{value:!0});LP.BindingInWhenOnSyntax=void 0;var fie=zB(),mie=RP(),gie=NP(),hie=function(){function r(e){this._binding=e,this._bindingWhenSyntax=new gie.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new mie.BindingOnSyntax(this._binding),this._bindingInSyntax=new fie.BindingInSyntax(e)}return r.prototype.inRequestScope=function(){return this._bindingInSyntax.inRequestScope()},r.prototype.inSingletonScope=function(){return this._bindingInSyntax.inSingletonScope()},r.prototype.inTransientScope=function(){return this._bindingInSyntax.inTransientScope()},r.prototype.when=function(e){return this._bindingWhenSyntax.when(e)},r.prototype.whenTargetNamed=function(e){return this._bindingWhenSyntax.whenTargetNamed(e)},r.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},r.prototype.whenTargetTagged=function(e,t){return this._bindingWhenSyntax.whenTargetTagged(e,t)},r.prototype.whenInjectedInto=function(e){return this._bindingWhenSyntax.whenInjectedInto(e)},r.prototype.whenParentNamed=function(e){return this._bindingWhenSyntax.whenParentNamed(e)},r.prototype.whenParentTagged=function(e,t){return this._bindingWhenSyntax.whenParentTagged(e,t)},r.prototype.whenAnyAncestorIs=function(e){return this._bindingWhenSyntax.whenAnyAncestorIs(e)},r.prototype.whenNoAncestorIs=function(e){return this._bindingWhenSyntax.whenNoAncestorIs(e)},r.prototype.whenAnyAncestorNamed=function(e){return this._bindingWhenSyntax.whenAnyAncestorNamed(e)},r.prototype.whenAnyAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenAnyAncestorTagged(e,t)},r.prototype.whenNoAncestorNamed=function(e){return this._bindingWhenSyntax.whenNoAncestorNamed(e)},r.prototype.whenNoAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenNoAncestorTagged(e,t)},r.prototype.whenAnyAncestorMatches=function(e){return this._bindingWhenSyntax.whenAnyAncestorMatches(e)},r.prototype.whenNoAncestorMatches=function(e){return this._bindingWhenSyntax.whenNoAncestorMatches(e)},r.prototype.onActivation=function(e){return this._bindingOnSyntax.onActivation(e)},r.prototype.onDeactivation=function(e){return this._bindingOnSyntax.onDeactivation(e)},r}();LP.BindingInWhenOnSyntax=hie});var eH=z(uc=>{"use strict";u();var vie=uc&&uc.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),yie=uc&&uc.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),bie=uc&&uc.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&vie(e,r,t);return yie(e,r),e};Object.defineProperty(uc,"__esModule",{value:!0});uc.BindingToSyntax=void 0;var XB=bie(qi()),yo=Ua(),ZB=QB(),Xv=uL(),Iie=function(){function r(e){this._binding=e}return r.prototype.to=function(e){return this._binding.type=yo.BindingTypeEnum.Instance,this._binding.implementationType=e,new ZB.BindingInWhenOnSyntax(this._binding)},r.prototype.toSelf=function(){if(typeof this._binding.serviceIdentifier!="function")throw new Error(""+XB.INVALID_TO_SELF_VALUE);var e=this._binding.serviceIdentifier;return this.to(e)},r.prototype.toConstantValue=function(e){return this._binding.type=yo.BindingTypeEnum.ConstantValue,this._binding.cache=e,this._binding.dynamicValue=null,this._binding.implementationType=null,this._binding.scope=yo.BindingScopeEnum.Singleton,new Xv.BindingWhenOnSyntax(this._binding)},r.prototype.toDynamicValue=function(e){return this._binding.type=yo.BindingTypeEnum.DynamicValue,this._binding.cache=null,this._binding.dynamicValue=e,this._binding.implementationType=null,new ZB.BindingInWhenOnSyntax(this._binding)},r.prototype.toConstructor=function(e){return this._binding.type=yo.BindingTypeEnum.Constructor,this._binding.implementationType=e,this._binding.scope=yo.BindingScopeEnum.Singleton,new Xv.BindingWhenOnSyntax(this._binding)},r.prototype.toFactory=function(e){return this._binding.type=yo.BindingTypeEnum.Factory,this._binding.factory=e,this._binding.scope=yo.BindingScopeEnum.Singleton,new Xv.BindingWhenOnSyntax(this._binding)},r.prototype.toFunction=function(e){if(typeof e!="function")throw new Error(XB.INVALID_FUNCTION_BINDING);var t=this.toConstantValue(e);return this._binding.type=yo.BindingTypeEnum.Function,this._binding.scope=yo.BindingScopeEnum.Singleton,t},r.prototype.toAutoFactory=function(e){return this._binding.type=yo.BindingTypeEnum.Factory,this._binding.factory=function(t){var n=function(){return t.container.get(e)};return n},this._binding.scope=yo.BindingScopeEnum.Singleton,new Xv.BindingWhenOnSyntax(this._binding)},r.prototype.toAutoNamedFactory=function(e){return this._binding.type=yo.BindingTypeEnum.Factory,this._binding.factory=function(t){return function(n){return t.container.getNamed(e,n)}},new Xv.BindingWhenOnSyntax(this._binding)},r.prototype.toProvider=function(e){return this._binding.type=yo.BindingTypeEnum.Provider,this._binding.provider=e,this._binding.scope=yo.BindingScopeEnum.Singleton,new Xv.BindingWhenOnSyntax(this._binding)},r.prototype.toService=function(e){this.toDynamicValue(function(t){return t.container.get(e)})},r}();uc.BindingToSyntax=Iie});var tH=z(KP=>{"use strict";u();Object.defineProperty(KP,"__esModule",{value:!0});KP.ContainerSnapshot=void 0;var Sie=function(){function r(){}return r.of=function(e,t,n,i,o){var s=new r;return s.bindings=e,s.middleware=t,s.deactivations=i,s.activations=n,s.moduleActivationStore=o,s},r}();KP.ContainerSnapshot=Sie});var rH=z(FP=>{"use strict";u();Object.defineProperty(FP,"__esModule",{value:!0});FP.isClonable=void 0;function _ie(r){return typeof r=="object"&&r!==null&&"clone"in r&&typeof r.clone=="function"}FP.isClonable=_ie});var fL=z(dc=>{"use strict";u();var Eie=dc&&dc.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Cie=dc&&dc.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),wie=dc&&dc.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Eie(e,r,t);return Cie(e,r),e};Object.defineProperty(dc,"__esModule",{value:!0});dc.Lookup=void 0;var Am=wie(qi()),xie=rH(),Die=function(){function r(){this._map=new Map}return r.prototype.getMap=function(){return this._map},r.prototype.add=function(e,t){if(e==null)throw new Error(Am.NULL_ARGUMENT);if(t==null)throw new Error(Am.NULL_ARGUMENT);var n=this._map.get(e);n!==void 0?n.push(t):this._map.set(e,[t])},r.prototype.get=function(e){if(e==null)throw new Error(Am.NULL_ARGUMENT);var t=this._map.get(e);if(t!==void 0)return t;throw new Error(Am.KEY_NOT_FOUND)},r.prototype.remove=function(e){if(e==null)throw new Error(Am.NULL_ARGUMENT);if(!this._map.delete(e))throw new Error(Am.KEY_NOT_FOUND)},r.prototype.removeIntersection=function(e){var t=this;this.traverse(function(n,i){var o=e.hasKey(n)?e.get(n):void 0;if(o!==void 0){var s=i.filter(function(a){return!o.some(function(l){return a===l})});t._setValue(n,s)}})},r.prototype.removeByCondition=function(e){var t=this,n=[];return this._map.forEach(function(i,o){for(var s=[],a=0,l=i;a<l.length;a++){var c=l[a],d=e(c);d?n.push(c):s.push(c)}t._setValue(o,s)}),n},r.prototype.hasKey=function(e){if(e==null)throw new Error(Am.NULL_ARGUMENT);return this._map.has(e)},r.prototype.clone=function(){var e=new r;return this._map.forEach(function(t,n){t.forEach(function(i){return e.add(n,(0,xie.isClonable)(i)?i.clone():i)})}),e},r.prototype.traverse=function(e){this._map.forEach(function(t,n){e(n,t)})},r.prototype._setValue=function(e,t){t.length>0?this._map.set(e,t):this._map.delete(e)},r}();dc.Lookup=Die});var iH=z(UP=>{"use strict";u();Object.defineProperty(UP,"__esModule",{value:!0});UP.ModuleActivationStore=void 0;var nH=fL(),Pie=function(){function r(){this._map=new Map}return r.prototype.remove=function(e){if(this._map.has(e)){var t=this._map.get(e);return this._map.delete(e),t}return this._getEmptyHandlersStore()},r.prototype.addDeactivation=function(e,t,n){this._getModuleActivationHandlers(e).onDeactivations.add(t,n)},r.prototype.addActivation=function(e,t,n){this._getModuleActivationHandlers(e).onActivations.add(t,n)},r.prototype.clone=function(){var e=new r;return this._map.forEach(function(t,n){e._map.set(n,{onActivations:t.onActivations.clone(),onDeactivations:t.onDeactivations.clone()})}),e},r.prototype._getModuleActivationHandlers=function(e){var t=this._map.get(e);return t===void 0&&(t=this._getEmptyHandlersStore(),this._map.set(e,t)),t},r.prototype._getEmptyHandlersStore=function(){var e={onActivations:new nH.Lookup,onDeactivations:new nH.Lookup};return e},r}();UP.ModuleActivationStore=Pie});var mL=z(hi=>{"use strict";u();var VP=hi&&hi.__assign||function(){return VP=Object.assign||function(r){for(var e,t=1,n=arguments.length;t<n;t++){e=arguments[t];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=e[i])}return r},VP.apply(this,arguments)},Tie=hi&&hi.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),kie=hi&&hi.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),oH=hi&&hi.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Tie(e,r,t);return kie(e,r),e},ra=hi&&hi.__awaiter||function(r,e,t,n){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(d){try{c(n.next(d))}catch(p){s(p)}}function l(d){try{c(n.throw(d))}catch(p){s(p)}}function c(d){d.done?o(d.value):i(d.value).then(a,l)}c((n=n.apply(r,e||[])).next())})},na=hi&&hi.__generator||function(r,e){var t={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},n,i,o,s;return s={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(c){return function(d){return l([c,d])}}function l(c){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,i&&(o=c[0]&2?i.return:c[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,c[1])).done)return o;switch(i=0,o&&(c=[c[0]&2,o.value]),c[0]){case 0:case 1:o=c;break;case 4:return t.label++,{value:c[1],done:!1};case 5:t.label++,i=c[1],c=[0];continue;case 7:c=t.ops.pop(),t.trys.pop();continue;default:if(o=t.trys,!(o=o.length>0&&o[o.length-1])&&(c[0]===6||c[0]===2)){t=0;continue}if(c[0]===3&&(!o||c[1]>o[0]&&c[1]<o[3])){t.label=c[1];break}if(c[0]===6&&t.label<o[1]){t.label=o[1],o=c;break}if(o&&t.label<o[2]){t.label=o[2],t.ops.push(c);break}o[2]&&t.ops.pop(),t.trys.pop();continue}c=e.call(r,t)}catch(d){c=[6,d],i=0}finally{n=o=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}},Nie=hi&&hi.__spreadArray||function(r,e,t){if(t||arguments.length===2)for(var n=0,i=e.length,o;n<i;n++)(o||!(n in e))&&(o||(o=Array.prototype.slice.call(e,0,n)),o[n]=e[n]);return r.concat(o||Array.prototype.slice.call(e))};Object.defineProperty(hi,"__esModule",{value:!0});hi.Container=void 0;var Rie=sB(),Va=oH(qi()),Zv=Ua(),Mm=oH(Un()),Aie=BO(),WP=ZO(),Mie=qB(),Oie=eH(),Om=WE(),Lie=Sp(),Kie=Yv(),Fie=tH(),jE=fL(),Uie=iH(),Wie=function(){function r(e){var t=e||{};if(typeof t!="object")throw new Error(""+Va.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT);if(t.defaultScope===void 0)t.defaultScope=Zv.BindingScopeEnum.Transient;else if(t.defaultScope!==Zv.BindingScopeEnum.Singleton&&t.defaultScope!==Zv.BindingScopeEnum.Transient&&t.defaultScope!==Zv.BindingScopeEnum.Request)throw new Error(""+Va.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE);if(t.autoBindInjectable===void 0)t.autoBindInjectable=!1;else if(typeof t.autoBindInjectable!="boolean")throw new Error(""+Va.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE);if(t.skipBaseClassChecks===void 0)t.skipBaseClassChecks=!1;else if(typeof t.skipBaseClassChecks!="boolean")throw new Error(""+Va.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK);this.options={autoBindInjectable:t.autoBindInjectable,defaultScope:t.defaultScope,skipBaseClassChecks:t.skipBaseClassChecks},this.id=(0,Lie.id)(),this._bindingDictionary=new jE.Lookup,this._snapshots=[],this._middleware=null,this._activations=new jE.Lookup,this._deactivations=new jE.Lookup,this.parent=null,this._metadataReader=new Aie.MetadataReader,this._moduleActivationStore=new Uie.ModuleActivationStore}return r.merge=function(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];var o=new r,s=Nie([e,t],n,!0).map(function(c){return(0,WP.getBindingDictionary)(c)}),a=(0,WP.getBindingDictionary)(o);function l(c,d){c.traverse(function(p,f){f.forEach(function(m){d.add(m.serviceIdentifier,m.clone())})})}return s.forEach(function(c){l(c,a)}),o},r.prototype.load=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=this._getContainerModuleHelpersFactory(),i=0,o=e;i<o.length;i++){var s=o[i],a=n(s.id);s.registry(a.bindFunction,a.unbindFunction,a.isboundFunction,a.rebindFunction,a.unbindAsyncFunction,a.onActivationFunction,a.onDeactivationFunction)}},r.prototype.loadAsync=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return ra(this,void 0,void 0,function(){var n,i,o,s,a;return na(this,function(l){switch(l.label){case 0:n=this._getContainerModuleHelpersFactory(),i=0,o=e,l.label=1;case 1:return i<o.length?(s=o[i],a=n(s.id),[4,s.registry(a.bindFunction,a.unbindFunction,a.isboundFunction,a.rebindFunction,a.unbindAsyncFunction,a.onActivationFunction,a.onDeactivationFunction)]):[3,4];case 2:l.sent(),l.label=3;case 3:return i++,[3,1];case 4:return[2]}})})},r.prototype.unload=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];t.forEach(function(i){var o=e._removeModuleBindings(i.id);e._deactivateSingletons(o),e._removeModuleHandlers(i.id)})},r.prototype.unloadAsync=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return ra(this,void 0,void 0,function(){var n,i,o,s;return na(this,function(a){switch(a.label){case 0:n=0,i=e,a.label=1;case 1:return n<i.length?(o=i[n],s=this._removeModuleBindings(o.id),[4,this._deactivateSingletonsAsync(s)]):[3,4];case 2:a.sent(),this._removeModuleHandlers(o.id),a.label=3;case 3:return n++,[3,1];case 4:return[2]}})})},r.prototype.bind=function(e){var t=this.options.defaultScope||Zv.BindingScopeEnum.Transient,n=new Rie.Binding(e,t);return this._bindingDictionary.add(e,n),new Oie.BindingToSyntax(n)},r.prototype.rebind=function(e){return this.unbind(e),this.bind(e)},r.prototype.rebindAsync=function(e){return ra(this,void 0,void 0,function(){return na(this,function(t){switch(t.label){case 0:return[4,this.unbindAsync(e)];case 1:return t.sent(),[2,this.bind(e)]}})})},r.prototype.unbind=function(e){if(this._bindingDictionary.hasKey(e)){var t=this._bindingDictionary.get(e);this._deactivateSingletons(t)}this._removeServiceFromDictionary(e)},r.prototype.unbindAsync=function(e){return ra(this,void 0,void 0,function(){var t;return na(this,function(n){switch(n.label){case 0:return this._bindingDictionary.hasKey(e)?(t=this._bindingDictionary.get(e),[4,this._deactivateSingletonsAsync(t)]):[3,2];case 1:n.sent(),n.label=2;case 2:return this._removeServiceFromDictionary(e),[2]}})})},r.prototype.unbindAll=function(){var e=this;this._bindingDictionary.traverse(function(t,n){e._deactivateSingletons(n)}),this._bindingDictionary=new jE.Lookup},r.prototype.unbindAllAsync=function(){return ra(this,void 0,void 0,function(){var e,t=this;return na(this,function(n){switch(n.label){case 0:return e=[],this._bindingDictionary.traverse(function(i,o){e.push(t._deactivateSingletonsAsync(o))}),[4,Promise.all(e)];case 1:return n.sent(),this._bindingDictionary=new jE.Lookup,[2]}})})},r.prototype.onActivation=function(e,t){this._activations.add(e,t)},r.prototype.onDeactivation=function(e,t){this._deactivations.add(e,t)},r.prototype.isBound=function(e){var t=this._bindingDictionary.hasKey(e);return!t&&this.parent&&(t=this.parent.isBound(e)),t},r.prototype.isCurrentBound=function(e){return this._bindingDictionary.hasKey(e)},r.prototype.isBoundNamed=function(e,t){return this.isBoundTagged(e,Mm.NAMED_TAG,t)},r.prototype.isBoundTagged=function(e,t,n){var i=!1;if(this._bindingDictionary.hasKey(e)){var o=this._bindingDictionary.get(e),s=(0,WP.createMockRequest)(this,e,t,n);i=o.some(function(a){return a.constraint(s)})}return!i&&this.parent&&(i=this.parent.isBoundTagged(e,t,n)),i},r.prototype.snapshot=function(){this._snapshots.push(Fie.ContainerSnapshot.of(this._bindingDictionary.clone(),this._middleware,this._activations.clone(),this._deactivations.clone(),this._moduleActivationStore.clone()))},r.prototype.restore=function(){var e=this._snapshots.pop();if(e===void 0)throw new Error(Va.NO_MORE_SNAPSHOTS_AVAILABLE);this._bindingDictionary=e.bindings,this._activations=e.activations,this._deactivations=e.deactivations,this._middleware=e.middleware,this._moduleActivationStore=e.moduleActivationStore},r.prototype.createChild=function(e){var t=new r(e||this.options);return t.parent=this,t},r.prototype.applyMiddleware=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=this._middleware?this._middleware:this._planAndResolve();this._middleware=e.reduce(function(i,o){return o(i)},n)},r.prototype.applyCustomMetadataReader=function(e){this._metadataReader=e},r.prototype.get=function(e){var t=this._getNotAllArgs(e,!1);return this._getButThrowIfAsync(t)},r.prototype.getAsync=function(e){return ra(this,void 0,void 0,function(){var t;return na(this,function(n){return t=this._getNotAllArgs(e,!1),[2,this._get(t)]})})},r.prototype.getTagged=function(e,t,n){var i=this._getNotAllArgs(e,!1,t,n);return this._getButThrowIfAsync(i)},r.prototype.getTaggedAsync=function(e,t,n){return ra(this,void 0,void 0,function(){var i;return na(this,function(o){return i=this._getNotAllArgs(e,!1,t,n),[2,this._get(i)]})})},r.prototype.getNamed=function(e,t){return this.getTagged(e,Mm.NAMED_TAG,t)},r.prototype.getNamedAsync=function(e,t){return this.getTaggedAsync(e,Mm.NAMED_TAG,t)},r.prototype.getAll=function(e){var t=this._getAllArgs(e);return this._getButThrowIfAsync(t)},r.prototype.getAllAsync=function(e){var t=this._getAllArgs(e);return this._getAll(t)},r.prototype.getAllTagged=function(e,t,n){var i=this._getNotAllArgs(e,!0,t,n);return this._getButThrowIfAsync(i)},r.prototype.getAllTaggedAsync=function(e,t,n){var i=this._getNotAllArgs(e,!0,t,n);return this._getAll(i)},r.prototype.getAllNamed=function(e,t){return this.getAllTagged(e,Mm.NAMED_TAG,t)},r.prototype.getAllNamedAsync=function(e,t){return this.getAllTaggedAsync(e,Mm.NAMED_TAG,t)},r.prototype.resolve=function(e){var t=this.isBound(e);t||this.bind(e).toSelf();var n=this.get(e);return t||this.unbind(e),n},r.prototype._preDestroy=function(e,t){if(Reflect.hasMetadata(Mm.PRE_DESTROY,e)){var n=Reflect.getMetadata(Mm.PRE_DESTROY,e);return t[n.value]()}},r.prototype._removeModuleHandlers=function(e){var t=this._moduleActivationStore.remove(e);this._activations.removeIntersection(t.onActivations),this._deactivations.removeIntersection(t.onDeactivations)},r.prototype._removeModuleBindings=function(e){return this._bindingDictionary.removeByCondition(function(t){return t.moduleId===e})},r.prototype._deactivate=function(e,t){var n=this,i=Object.getPrototypeOf(t).constructor;try{if(this._deactivations.hasKey(e.serviceIdentifier)){var o=this._deactivateContainer(t,this._deactivations.get(e.serviceIdentifier).values());if((0,Om.isPromise)(o))return this._handleDeactivationError(o.then(function(){return n._propagateContainerDeactivationThenBindingAndPreDestroyAsync(e,t,i)}),i)}var s=this._propagateContainerDeactivationThenBindingAndPreDestroy(e,t,i);if((0,Om.isPromise)(s))return this._handleDeactivationError(s,i)}catch(a){throw new Error(Va.ON_DEACTIVATION_ERROR(i.name,a.message))}},r.prototype._handleDeactivationError=function(e,t){return ra(this,void 0,void 0,function(){var n;return na(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,e];case 1:return i.sent(),[3,3];case 2:throw n=i.sent(),new Error(Va.ON_DEACTIVATION_ERROR(t.name,n.message));case 3:return[2]}})})},r.prototype._deactivateContainer=function(e,t){for(var n=this,i=t.next();i.value;){var o=i.value(e);if((0,Om.isPromise)(o))return o.then(function(){return n._deactivateContainerAsync(e,t)});i=t.next()}},r.prototype._deactivateContainerAsync=function(e,t){return ra(this,void 0,void 0,function(){var n;return na(this,function(i){switch(i.label){case 0:n=t.next(),i.label=1;case 1:return n.value?[4,n.value(e)]:[3,3];case 2:return i.sent(),n=t.next(),[3,1];case 3:return[2]}})})},r.prototype._getContainerModuleHelpersFactory=function(){var e=this,t=function(d,p){d._binding.moduleId=p},n=function(d){return function(p){var f=e.bind(p);return t(f,d),f}},i=function(){return function(d){return e.unbind(d)}},o=function(){return function(d){return e.unbindAsync(d)}},s=function(){return function(d){return e.isBound(d)}},a=function(d){return function(p){var f=e.rebind(p);return t(f,d),f}},l=function(d){return function(p,f){e._moduleActivationStore.addActivation(d,p,f),e.onActivation(p,f)}},c=function(d){return function(p,f){e._moduleActivationStore.addDeactivation(d,p,f),e.onDeactivation(p,f)}};return function(d){return{bindFunction:n(d),isboundFunction:s(),onActivationFunction:l(d),onDeactivationFunction:c(d),rebindFunction:a(d),unbindFunction:i(),unbindAsyncFunction:o()}}},r.prototype._getAll=function(e){return Promise.all(this._get(e))},r.prototype._get=function(e){var t=VP(VP({},e),{contextInterceptor:function(i){return i},targetType:Zv.TargetTypeEnum.Variable});if(this._middleware){var n=this._middleware(t);if(n==null)throw new Error(Va.INVALID_MIDDLEWARE_RETURN);return n}return this._planAndResolve()(t)},r.prototype._getButThrowIfAsync=function(e){var t=this._get(e);if((0,Om.isPromiseOrContainsPromise)(t))throw new Error(Va.LAZY_IN_SYNC(e.serviceIdentifier));return t},r.prototype._getAllArgs=function(e){var t={avoidConstraints:!0,isMultiInject:!0,serviceIdentifier:e};return t},r.prototype._getNotAllArgs=function(e,t,n,i){var o={avoidConstraints:!1,isMultiInject:t,serviceIdentifier:e,key:n,value:i};return o},r.prototype._planAndResolve=function(){var e=this;return function(t){var n=(0,WP.plan)(e._metadataReader,e,t.isMultiInject,t.targetType,t.serviceIdentifier,t.key,t.value,t.avoidConstraints);n=t.contextInterceptor(n);var i=(0,Mie.resolve)(n);return i}},r.prototype._deactivateIfSingleton=function(e){var t=this;if(e.activated)return(0,Om.isPromise)(e.cache)?e.cache.then(function(n){return t._deactivate(e,n)}):this._deactivate(e,e.cache)},r.prototype._deactivateSingletons=function(e){for(var t=0,n=e;t<n.length;t++){var i=n[t],o=this._deactivateIfSingleton(i);if((0,Om.isPromise)(o))throw new Error(Va.ASYNC_UNBIND_REQUIRED)}},r.prototype._deactivateSingletonsAsync=function(e){return ra(this,void 0,void 0,function(){var t=this;return na(this,function(n){switch(n.label){case 0:return[4,Promise.all(e.map(function(i){return t._deactivateIfSingleton(i)}))];case 1:return n.sent(),[2]}})})},r.prototype._propagateContainerDeactivationThenBindingAndPreDestroy=function(e,t,n){return this.parent?this._deactivate.bind(this.parent)(e,t):this._bindingDeactivationAndPreDestroy(e,t,n)},r.prototype._propagateContainerDeactivationThenBindingAndPreDestroyAsync=function(e,t,n){return ra(this,void 0,void 0,function(){return na(this,function(i){switch(i.label){case 0:return this.parent?[4,this._deactivate.bind(this.parent)(e,t)]:[3,2];case 1:return i.sent(),[3,4];case 2:return[4,this._bindingDeactivationAndPreDestroyAsync(e,t,n)];case 3:i.sent(),i.label=4;case 4:return[2]}})})},r.prototype._removeServiceFromDictionary=function(e){try{this._bindingDictionary.remove(e)}catch(t){throw new Error(Va.CANNOT_UNBIND+" "+(0,Kie.getServiceIdentifierAsString)(e))}},r.prototype._bindingDeactivationAndPreDestroy=function(e,t,n){var i=this;if(typeof e.onDeactivation=="function"){var o=e.onDeactivation(t);if((0,Om.isPromise)(o))return o.then(function(){return i._preDestroy(n,t)})}return this._preDestroy(n,t)},r.prototype._bindingDeactivationAndPreDestroyAsync=function(e,t,n){return ra(this,void 0,void 0,function(){return na(this,function(i){switch(i.label){case 0:return typeof e.onDeactivation!="function"?[3,2]:[4,e.onDeactivation(t)];case 1:i.sent(),i.label=2;case 2:return[4,this._preDestroy(n,t)];case 3:return i.sent(),[2]}})})},r}();hi.Container=Wie});var aH=z(ey=>{"use strict";u();Object.defineProperty(ey,"__esModule",{value:!0});ey.AsyncContainerModule=ey.ContainerModule=void 0;var sH=Sp(),Vie=function(){function r(e){this.id=(0,sH.id)(),this.registry=e}return r}();ey.ContainerModule=Vie;var jie=function(){function r(e){this.id=(0,sH.id)(),this.registry=e}return r}();ey.AsyncContainerModule=jie});var lH=z(jP=>{"use strict";u();Object.defineProperty(jP,"__esModule",{value:!0});jP.getFirstArrayDuplicate=void 0;function Bie(r){for(var e=new Set,t=0,n=r;t<n.length;t++){var i=n[t];if(e.has(i))return i;e.add(i)}}jP.getFirstArrayDuplicate=Bie});var Ou=z($i=>{"use strict";u();var Hie=$i&&$i.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Jie=$i&&$i.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),uH=$i&&$i.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Hie(e,r,t);return Jie(e,r),e};Object.defineProperty($i,"__esModule",{value:!0});$i.createTaggedDecorator=$i.tagProperty=$i.tagParameter=$i.decorate=void 0;var BP=uH(qi()),dH=uH(Un()),qie=lH();function Gie(r){return r.prototype!==void 0}function Yie(r){if(r!==void 0)throw new Error(BP.INVALID_DECORATOR_OPERATION)}function pH(r,e,t,n){Yie(e),mH(dH.TAGGED,r,t.toString(),n)}$i.tagParameter=pH;function fH(r,e,t){if(Gie(r))throw new Error(BP.INVALID_DECORATOR_OPERATION);mH(dH.TAGGED_PROP,r.constructor,e,t)}$i.tagProperty=fH;function $ie(r){var e=[];if(Array.isArray(r)){e=r;var t=(0,qie.getFirstArrayDuplicate)(e.map(function(n){return n.key}));if(t!==void 0)throw new Error(BP.DUPLICATED_METADATA+" "+t.toString())}else e=[r];return e}function mH(r,e,t,n){var i=$ie(n),o={};Reflect.hasOwnMetadata(r,e)&&(o=Reflect.getMetadata(r,e));var s=o[t];if(s===void 0)s=[];else for(var a=function(p){if(i.some(function(f){return f.key===p.key}))throw new Error(BP.DUPLICATED_METADATA+" "+p.key.toString())},l=0,c=s;l<c.length;l++){var d=c[l];a(d)}s.push.apply(s,i),o[t]=s,Reflect.defineMetadata(r,o,e)}function zie(r){return function(e,t,n){typeof n=="number"?pH(e,t,n,r):fH(e,t,r)}}$i.createTaggedDecorator=zie;function cH(r,e){Reflect.decorate(r,e)}function Qie(r,e){return function(t,n){e(t,n,r)}}function Xie(r,e,t){typeof t=="number"?cH([Qie(t,r)],e):typeof t=="string"?Reflect.decorate([r],e,t):cH([r],e)}$i.decorate=Xie});var hH=z(pc=>{"use strict";u();var Zie=pc&&pc.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),eoe=pc&&pc.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),gH=pc&&pc.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Zie(e,r,t);return eoe(e,r),e};Object.defineProperty(pc,"__esModule",{value:!0});pc.injectable=void 0;var toe=gH(qi()),gL=gH(Un());function roe(){return function(r){if(Reflect.hasOwnMetadata(gL.PARAM_TYPES,r))throw new Error(toe.DUPLICATED_INJECTABLE_DECORATOR);var e=Reflect.getMetadata(gL.DESIGN_PARAM_TYPES,r)||[];return Reflect.defineMetadata(gL.PARAM_TYPES,e,r),r}}pc.injectable=roe});var vH=z(HP=>{"use strict";u();Object.defineProperty(HP,"__esModule",{value:!0});HP.tagged=void 0;var noe=Wa(),ioe=Ou();function ooe(r,e){return(0,ioe.createTaggedDecorator)(new noe.Metadata(r,e))}HP.tagged=ooe});var yH=z(fc=>{"use strict";u();var soe=fc&&fc.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),aoe=fc&&fc.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),loe=fc&&fc.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&soe(e,r,t);return aoe(e,r),e};Object.defineProperty(fc,"__esModule",{value:!0});fc.named=void 0;var coe=loe(Un()),uoe=Wa(),doe=Ou();function poe(r){return(0,doe.createTaggedDecorator)(new uoe.Metadata(coe.NAMED_TAG,r))}fc.named=poe});var hL=z(JP=>{"use strict";u();Object.defineProperty(JP,"__esModule",{value:!0});JP.injectBase=void 0;var foe=qi(),moe=Wa(),goe=Ou();function hoe(r){return function(e){return function(t,n,i){if(e===void 0){var o=typeof t=="function"?t.name:t.constructor.name;throw new Error((0,foe.UNDEFINED_INJECT_ANNOTATION)(o))}return(0,goe.createTaggedDecorator)(new moe.Metadata(r,e))(t,n,i)}}}JP.injectBase=hoe});var bH=z(mc=>{"use strict";u();var voe=mc&&mc.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),yoe=mc&&mc.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),boe=mc&&mc.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&voe(e,r,t);return yoe(e,r),e};Object.defineProperty(mc,"__esModule",{value:!0});mc.inject=void 0;var Ioe=boe(Un()),Soe=hL(),_oe=(0,Soe.injectBase)(Ioe.INJECT_TAG);mc.inject=_oe});var IH=z(gc=>{"use strict";u();var Eoe=gc&&gc.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Coe=gc&&gc.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),woe=gc&&gc.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Eoe(e,r,t);return Coe(e,r),e};Object.defineProperty(gc,"__esModule",{value:!0});gc.optional=void 0;var xoe=woe(Un()),Doe=Wa(),Poe=Ou();function Toe(){return(0,Poe.createTaggedDecorator)(new Doe.Metadata(xoe.OPTIONAL_TAG,!0))}gc.optional=Toe});var SH=z(hc=>{"use strict";u();var koe=hc&&hc.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Noe=hc&&hc.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Roe=hc&&hc.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&koe(e,r,t);return Noe(e,r),e};Object.defineProperty(hc,"__esModule",{value:!0});hc.unmanaged=void 0;var Aoe=Roe(Un()),Moe=Wa(),Ooe=Ou();function Loe(){return function(r,e,t){var n=new Moe.Metadata(Aoe.UNMANAGED_TAG,!0);(0,Ooe.tagParameter)(r,e,t,n)}}hc.unmanaged=Loe});var _H=z(vc=>{"use strict";u();var Koe=vc&&vc.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Foe=vc&&vc.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Uoe=vc&&vc.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Koe(e,r,t);return Foe(e,r),e};Object.defineProperty(vc,"__esModule",{value:!0});vc.multiInject=void 0;var Woe=Uoe(Un()),Voe=hL(),joe=(0,Voe.injectBase)(Woe.MULTI_INJECT_TAG);vc.multiInject=joe});var EH=z(yc=>{"use strict";u();var Boe=yc&&yc.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Hoe=yc&&yc.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Joe=yc&&yc.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Boe(e,r,t);return Hoe(e,r),e};Object.defineProperty(yc,"__esModule",{value:!0});yc.targetName=void 0;var qoe=Joe(Un()),Goe=Wa(),Yoe=Ou();function $oe(r){return function(e,t,n){var i=new Goe.Metadata(qoe.NAME_TAG,r);(0,Yoe.tagParameter)(e,t,n,i)}}yc.targetName=$oe});var vL=z(qP=>{"use strict";u();Object.defineProperty(qP,"__esModule",{value:!0});qP.propertyEventDecorator=void 0;var zoe=Wa();function Qoe(r,e){return function(){return function(t,n){var i=new zoe.Metadata(r,n);if(Reflect.hasOwnMetadata(r,t.constructor))throw new Error(e);Reflect.defineMetadata(r,i,t.constructor)}}}qP.propertyEventDecorator=Qoe});var wH=z(bc=>{"use strict";u();var Xoe=bc&&bc.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Zoe=bc&&bc.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),CH=bc&&bc.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Xoe(e,r,t);return Zoe(e,r),e};Object.defineProperty(bc,"__esModule",{value:!0});bc.postConstruct=void 0;var ese=CH(qi()),tse=CH(Un()),rse=vL(),nse=(0,rse.propertyEventDecorator)(tse.POST_CONSTRUCT,ese.MULTIPLE_POST_CONSTRUCT_METHODS);bc.postConstruct=nse});var DH=z(Ic=>{"use strict";u();var ise=Ic&&Ic.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),ose=Ic&&Ic.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),xH=Ic&&Ic.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&ise(e,r,t);return ose(e,r),e};Object.defineProperty(Ic,"__esModule",{value:!0});Ic.preDestroy=void 0;var sse=xH(qi()),ase=xH(Un()),lse=vL(),cse=(0,lse.propertyEventDecorator)(ase.PRE_DESTROY,sse.MULTIPLE_PRE_DESTROY_METHODS);Ic.preDestroy=cse});var PH=z(GP=>{"use strict";u();Object.defineProperty(GP,"__esModule",{value:!0});GP.interfaces=void 0;var yL;yL||(yL={});GP.interfaces=yL});var te=z(je=>{"use strict";u();var use=je&&je.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),dse=je&&je.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),pse=je&&je.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&use(e,r,t);return dse(e,r),e};Object.defineProperty(je,"__esModule",{value:!0});je.multiBindToService=je.getServiceIdentifierAsString=je.typeConstraint=je.namedConstraint=je.taggedConstraint=je.traverseAncerstors=je.decorate=je.interfaces=je.id=je.MetadataReader=je.preDestroy=je.postConstruct=je.targetName=je.multiInject=je.unmanaged=je.optional=je.LazyServiceIdentifer=je.inject=je.named=je.tagged=je.injectable=je.createTaggedDecorator=je.ContainerModule=je.AsyncContainerModule=je.TargetTypeEnum=je.BindingTypeEnum=je.BindingScopeEnum=je.Container=je.METADATA_KEY=void 0;var fse=pse(Un());je.METADATA_KEY=fse;var mse=mL();Object.defineProperty(je,"Container",{enumerable:!0,get:function(){return mse.Container}});var bL=Ua();Object.defineProperty(je,"BindingScopeEnum",{enumerable:!0,get:function(){return bL.BindingScopeEnum}});Object.defineProperty(je,"BindingTypeEnum",{enumerable:!0,get:function(){return bL.BindingTypeEnum}});Object.defineProperty(je,"TargetTypeEnum",{enumerable:!0,get:function(){return bL.TargetTypeEnum}});var TH=aH();Object.defineProperty(je,"AsyncContainerModule",{enumerable:!0,get:function(){return TH.AsyncContainerModule}});Object.defineProperty(je,"ContainerModule",{enumerable:!0,get:function(){return TH.ContainerModule}});var gse=Ou();Object.defineProperty(je,"createTaggedDecorator",{enumerable:!0,get:function(){return gse.createTaggedDecorator}});var hse=hH();Object.defineProperty(je,"injectable",{enumerable:!0,get:function(){return hse.injectable}});var vse=vH();Object.defineProperty(je,"tagged",{enumerable:!0,get:function(){return vse.tagged}});var yse=yH();Object.defineProperty(je,"named",{enumerable:!0,get:function(){return yse.named}});var bse=bH();Object.defineProperty(je,"inject",{enumerable:!0,get:function(){return bse.inject}});var Ise=JO();Object.defineProperty(je,"LazyServiceIdentifer",{enumerable:!0,get:function(){return Ise.LazyServiceIdentifer}});var Sse=IH();Object.defineProperty(je,"optional",{enumerable:!0,get:function(){return Sse.optional}});var _se=SH();Object.defineProperty(je,"unmanaged",{enumerable:!0,get:function(){return _se.unmanaged}});var Ese=_H();Object.defineProperty(je,"multiInject",{enumerable:!0,get:function(){return Ese.multiInject}});var Cse=EH();Object.defineProperty(je,"targetName",{enumerable:!0,get:function(){return Cse.targetName}});var wse=wH();Object.defineProperty(je,"postConstruct",{enumerable:!0,get:function(){return wse.postConstruct}});var xse=DH();Object.defineProperty(je,"preDestroy",{enumerable:!0,get:function(){return xse.preDestroy}});var Dse=BO();Object.defineProperty(je,"MetadataReader",{enumerable:!0,get:function(){return Dse.MetadataReader}});var Pse=Sp();Object.defineProperty(je,"id",{enumerable:!0,get:function(){return Pse.id}});var Tse=PH();Object.defineProperty(je,"interfaces",{enumerable:!0,get:function(){return Tse.interfaces}});var kse=Ou();Object.defineProperty(je,"decorate",{enumerable:!0,get:function(){return kse.decorate}});var YP=cL();Object.defineProperty(je,"traverseAncerstors",{enumerable:!0,get:function(){return YP.traverseAncerstors}});Object.defineProperty(je,"taggedConstraint",{enumerable:!0,get:function(){return YP.taggedConstraint}});Object.defineProperty(je,"namedConstraint",{enumerable:!0,get:function(){return YP.namedConstraint}});Object.defineProperty(je,"typeConstraint",{enumerable:!0,get:function(){return YP.typeConstraint}});var Nse=Yv();Object.defineProperty(je,"getServiceIdentifierAsString",{enumerable:!0,get:function(){return Nse.getServiceIdentifierAsString}});var Rse=rL();Object.defineProperty(je,"multiBindToService",{enumerable:!0,get:function(){return Rse.multiBindToService}})});var RH=z(_p=>{"use strict";u();Object.defineProperty(_p,"__esModule",{value:!0});_p.PythonExtension=_p.PVSC_EXTENSION_ID=void 0;var Mse=require("vscode");_p.PVSC_EXTENSION_ID="ms-python.python";var Ose;(function(r){async function e(){let t=Mse.extensions.getExtension(_p.PVSC_EXTENSION_ID);if(t===void 0)throw new Error("Python extension is not installed or is disabled");return t.isActive||await t.activate(),t.exports}r.api=e})(Ose=_p.PythonExtension||(_p.PythonExtension={}))});var _L=z((Wke,jH)=>{u();function Use(r){var e=/(%?)(%([jds]))/g,t=Array.prototype.slice.call(arguments,1);return t.length&&(r=r.replace(e,function(n,i,o,s){var a=t.shift();switch(s){case"s":a=""+a;break;case"d":a=Number(a);break;case"j":a=JSON.stringify(a);break}return i?(t.unshift(a),n):a})),t.length&&(r+=" "+t.join(" ")),r=r.replace(/%{2,2}/g,"%"),""+r}jH.exports=Use});var d7=z((hNe,xL)=>{"use strict";u();var cy=typeof Reflect=="object"?Reflect:null,t7=cy&&typeof cy.apply=="function"?cy.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)},iT;cy&&typeof cy.ownKeys=="function"?iT=cy.ownKeys:Object.getOwnPropertySymbols?iT=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:iT=function(e){return Object.getOwnPropertyNames(e)};function Xse(r){console&&console.warn&&console.warn(r)}var n7=Number.isNaN||function(e){return e!==e};function Pr(){Pr.init.call(this)}xL.exports=Pr;xL.exports.once=rae;Pr.EventEmitter=Pr;Pr.prototype._events=void 0;Pr.prototype._eventsCount=0;Pr.prototype._maxListeners=void 0;var r7=10;function oT(r){if(typeof r!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof r)}Object.defineProperty(Pr,"defaultMaxListeners",{enumerable:!0,get:function(){return r7},set:function(r){if(typeof r!="number"||r<0||n7(r))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+r+".");r7=r}});Pr.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};Pr.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||n7(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function i7(r){return r._maxListeners===void 0?Pr.defaultMaxListeners:r._maxListeners}Pr.prototype.getMaxListeners=function(){return i7(this)};Pr.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var i=e==="error",o=this._events;if(o!==void 0)i=i&&o.error===void 0;else if(!i)return!1;if(i){var s;if(t.length>0&&(s=t[0]),s instanceof Error)throw s;var a=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw a.context=s,a}var l=o[e];if(l===void 0)return!1;if(typeof l=="function")t7(l,this,t);else for(var c=l.length,d=c7(l,c),n=0;n<c;++n)t7(d[n],this,t);return!0};function o7(r,e,t,n){var i,o,s;if(oT(t),o=r._events,o===void 0?(o=r._events=Object.create(null),r._eventsCount=0):(o.newListener!==void 0&&(r.emit("newListener",e,t.listener?t.listener:t),o=r._events),s=o[e]),s===void 0)s=o[e]=t,++r._eventsCount;else if(typeof s=="function"?s=o[e]=n?[t,s]:[s,t]:n?s.unshift(t):s.push(t),i=i7(r),i>0&&s.length>i&&!s.warned){s.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=r,a.type=e,a.count=s.length,Xse(a)}return r}Pr.prototype.addListener=function(e,t){return o7(this,e,t,!1)};Pr.prototype.on=Pr.prototype.addListener;Pr.prototype.prependListener=function(e,t){return o7(this,e,t,!0)};function Zse(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function s7(r,e,t){var n={fired:!1,wrapFn:void 0,target:r,type:e,listener:t},i=Zse.bind(n);return i.listener=t,n.wrapFn=i,i}Pr.prototype.once=function(e,t){return oT(t),this.on(e,s7(this,e,t)),this};Pr.prototype.prependOnceListener=function(e,t){return oT(t),this.prependListener(e,s7(this,e,t)),this};Pr.prototype.removeListener=function(e,t){var n,i,o,s,a;if(oT(t),i=this._events,i===void 0)return this;if(n=i[e],n===void 0)return this;if(n===t||n.listener===t)--this._eventsCount===0?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||t));else if(typeof n!="function"){for(o=-1,s=n.length-1;s>=0;s--)if(n[s]===t||n[s].listener===t){a=n[s].listener,o=s;break}if(o<0)return this;o===0?n.shift():eae(n,o),n.length===1&&(i[e]=n[0]),i.removeListener!==void 0&&this.emit("removeListener",e,a||t)}return this};Pr.prototype.off=Pr.prototype.removeListener;Pr.prototype.removeAllListeners=function(e){var t,n,i;if(n=this._events,n===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete n[e]),this;if(arguments.length===0){var o=Object.keys(n),s;for(i=0;i<o.length;++i)s=o[i],s!=="removeListener"&&this.removeAllListeners(s);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(t=n[e],typeof t=="function")this.removeListener(e,t);else if(t!==void 0)for(i=t.length-1;i>=0;i--)this.removeListener(e,t[i]);return this};function a7(r,e,t){var n=r._events;if(n===void 0)return[];var i=n[e];return i===void 0?[]:typeof i=="function"?t?[i.listener||i]:[i]:t?tae(i):c7(i,i.length)}Pr.prototype.listeners=function(e){return a7(this,e,!0)};Pr.prototype.rawListeners=function(e){return a7(this,e,!1)};Pr.listenerCount=function(r,e){return typeof r.listenerCount=="function"?r.listenerCount(e):l7.call(r,e)};Pr.prototype.listenerCount=l7;function l7(r){var e=this._events;if(e!==void 0){var t=e[r];if(typeof t=="function")return 1;if(t!==void 0)return t.length}return 0}Pr.prototype.eventNames=function(){return this._eventsCount>0?iT(this._events):[]};function c7(r,e){for(var t=new Array(e),n=0;n<e;++n)t[n]=r[n];return t}function eae(r,e){for(;e+1<r.length;e++)r[e]=r[e+1];r.pop()}function tae(r){for(var e=new Array(r.length),t=0;t<e.length;++t)e[t]=r[t].listener||r[t];return e}function rae(r,e){return new Promise(function(t,n){function i(s){r.removeListener(e,o),n(s)}function o(){typeof r.removeListener=="function"&&r.removeListener("error",i),t([].slice.call(arguments))}u7(r,e,o,{once:!0}),e!=="error"&&nae(r,i,{once:!0})})}function nae(r,e,t){typeof r.on=="function"&&u7(r,"error",e,t)}function u7(r,e,t,n){if(typeof r.on=="function")n.once?r.once(e,t):r.on(e,t);else if(typeof r.addEventListener=="function")r.addEventListener(e,function i(o){n.once&&r.removeEventListener(e,i),t(o)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof r)}});var m7=z((dy,f7)=>{"use strict";u();var iae=function(){if(typeof self!="undefined")return self;if(typeof window!="undefined")return window;if(typeof Uu!="undefined")return Uu;throw new Error("unable to locate global object")},Uu=iae();f7.exports=dy=Uu.fetch;Uu.fetch&&(dy.default=Uu.fetch.bind(Uu));dy.Headers=Uu.Headers;dy.Request=Uu.Request;dy.Response=Uu.Response});var g7=z(GE=>{u();GE.get=function(r){var e=Error.stackTraceLimit;Error.stackTraceLimit=1/0;var t={},n=Error.prepareStackTrace;Error.prepareStackTrace=function(o,s){return s},Error.captureStackTrace(t,r||GE.get);var i=t.stack;return Error.prepareStackTrace=n,Error.stackTraceLimit=e,i};GE.parse=function(r){if(!r.stack)return[];var e=this,t=r.stack.split(`
`).slice(1);return t.map(function(n){if(n.match(/^\s*[-]{4,}$/))return e._createParsedCallSite({fileName:n,lineNumber:null,functionName:null,typeName:null,methodName:null,columnNumber:null,native:null});var i=n.match(/at (?:(.+)\s+\()?(?:(.+?):(\d+)(?::(\d+))?|([^)]+))\)?/);if(i){var o=null,s=null,a=null,l=null,c=null,d=i[5]==="native";if(i[1]){a=i[1];var p=a.lastIndexOf(".");if(a[p-1]=="."&&p--,p>0){o=a.substr(0,p),s=a.substr(p+1);var f=o.indexOf(".Module");f>0&&(a=a.substr(f+1),o=o.substr(0,f))}l=null}s&&(l=o,c=s),s==="<anonymous>"&&(c=null,a=null);var m={fileName:i[2]||null,lineNumber:parseInt(i[3],10)||null,functionName:a,typeName:l,methodName:c,columnNumber:parseInt(i[4],10)||null,native:d};return e._createParsedCallSite(m)}}).filter(function(n){return!!n})};function qE(r){for(var e in r)this[e]=r[e]}var oae=["this","typeName","functionName","methodName","fileName","lineNumber","columnNumber","function","evalOrigin"],sae=["topLevel","eval","native","constructor"];oae.forEach(function(r){qE.prototype[r]=null,qE.prototype["get"+r[0].toUpperCase()+r.substr(1)]=function(){return this[r]}});sae.forEach(function(r){qE.prototype[r]=!1,qE.prototype["is"+r[0].toUpperCase()+r.substr(1)]=function(){return this[r]}});GE._createParsedCallSite=function(r){return new qE(r)}});var rn,dt,Xt,Kt,$E,Er,ia,Ja,aT,So,or,lT=ee(()=>{u();rn="function",dt="object",Xt="undefined",Kt="prototype",$E="hasOwnProperty",Er=Object,ia=Er[Kt],Ja=Er.assign,aT=Er.create,So=Er.defineProperty,or=ia[$E]});function Vn(r){r===void 0&&(r=!0);var e=r===!1?null:E7;return e||(typeof globalThis!==Xt&&(e=globalThis),!e&&typeof self!==Xt&&(e=self),!e&&typeof window!==Xt&&(e=window),!e&&typeof this!==Xt&&(e=this),E7=e),e}function oa(r){throw new TypeError(r)}function _o(r){var e=aT;if(e)return e(r);if(r==null)return{};var t=typeof r;t!==dt&&t!==rn&&oa("Object prototype may only be an Object:"+r);function n(){}return n[Kt]=r,new n}var E7,NL=ee(()=>{u();lT();E7=null});function In(r,e){typeof e!==rn&&e!==null&&oa("Class extends value "+String(e)+" is not a constructor or null"),RL(r,e);function t(){this.constructor=r}r[Kt]=e===null?_o(e):(t[Kt]=e[Kt],new t)}function Fm(r,e){for(var t=0,n=e.length,i=r.length;t<n;t++,i++)r[i]=e[t];return r}var h0e,v0e,gae,Eo,RL,C7=ee(()=>{u();lT();NL();h0e=(Vn()||{}).Symbol,v0e=(Vn()||{}).Reflect,gae=function(r){for(var e,t=1,n=arguments.length;t<n;t++){e=arguments[t];for(var i in e)ia[$E].call(e,i)&&(r[i]=e[i])}return r},Eo=Ja||gae,RL=function(r,e){return RL=Er.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)n[$E](i)&&(t[i]=n[i])},RL(r,e)}});var w7=ee(()=>{u()});var sr=ee(()=>{u();lT();NL();C7();w7()});var AL,x7=ee(()=>{"use strict";u();AL=100});var qa,Ti,zE,Ga,Ft,Cs,_c,cT,Jo,et,Um,Ur,uT,Wm,Vm,ML,QE,jm,my,XE,Wu,ws,gy,Tp,Ya,hy,Bm,xs,sa,kp,Vu,dT,Np,$a,vy,Rp,ZE,Ap,pT,yy,za,OL,LL,fT,jn,qo,eC,Hm,tC,Jm,Qa,mT,qm,by,Mp,rC,Tn=ee(()=>{u();qa="initialize",Ti="name",zE="getNotifyMgr",Ga="identifier",Ft="push",Cs="isInitialized",_c="config",cT="instrumentationKey",Jo="logger",et="length",Um="time",Ur="processNext",uT="getProcessTelContext",Wm="addNotificationListener",Vm="removeNotificationListener",ML="stopPollingInternalLogs",QE="onComplete",jm="getPlugin",my="flush",XE="_extensions",Wu="splice",ws="teardown",gy="messageId",Tp="message",Ya="isAsync",hy="_doTeardown",Bm="update",xs="getNext",sa="diagLog",kp="setNextPlugin",Vu="createNew",dT="cookieCfg",Np="indexOf",$a="substring",vy="userAgent",Rp="split",ZE="setEnabled",Ap="substr",pT="nodeType",yy="apply",za="replace",OL="enableDebugExceptions",LL="logInternalMessage",fT="toLowerCase",jn="call",qo="type",eC="handler",Hm="listeners",tC="isChildEvt",Jm="getCtx",Qa="setCtx",mT="complete",qm="traceId",by="spanId",Mp="traceFlags",rC="version"});var pt,KL,un,FL,nC,Iy,D7,Go,aa,Sy,Op,_y,Lp,gT,iC,Gm,vi=ee(()=>{u();pt="",KL="channels",un="core",FL="createPerfMgr",nC="disabled",Iy="extensionConfig",D7="extensions",Go="processTelemetry",aa="priority",Sy="eventsSent",Op="eventsDiscarded",_y="eventsSendRequest",Lp="perfEvent",gT="errorToConsole",iC="warnToConsole",Gm="getPerfMgr"});function Pae(r){if(r){if(vT)return vT(r);var e=r[hae]||r[Kt]||r[hT];if(e)return e}return null}function Ey(r,e){return typeof r===e}function dr(r){return r===void 0||typeof r===Xt}function _t(r){return r===null||dr(r)}function HL(r){return!_t(r)}function ju(r,e){return!!(r&&or[jn](r,e))}function ki(r){return!!(r&&typeof r===dt)}function Yt(r){return!!(r&&typeof r===rn)}function Ym(r){var e=r;return e&&dn(e)&&(e=e[za](wae,function(t,n){return n.toUpperCase()}),e=e[za](xae,"_"),e=e[za](Dae,function(t,n){return"_"+n})),e}function Wr(r,e){if(r)for(var t in r)or[jn](r,t)&&e[jn](r,t,r[t])}function $m(r,e){var t=!1;return r&&e&&!(t=r===e)&&(t=bae?r[L7](e):Tae(r,e)),t}function Tae(r,e){var t=!1,n=e?e[et]:0,i=r?r[et]:0;if(n&&i&&i>=n&&!(t=r===e)){for(var o=i-1,s=n-1;s>=0;s--){if(r[o]!=e[s])return!1;o--}t=!0}return t}function Cy(r,e){var t=!1;return r&&e&&!(t=r===e)&&(t=Iae?r[K7](e):kae(r,e)),t}function kae(r,e){var t=!1,n=e?e[et]:0;if(r&&n&&r[et]>=n&&!(t=r===e)){for(var i=0;i<n;i++)if(r[i]!==e[i])return!1;t=!0}return t}function kn(r,e){return r&&e?r[Np](e)!==-1:!1}function wy(r){return!!(r&&BL[jn](r)==="[object Date]")}function Nae(r){return!!(r&&BL[jn](r)==="[object Array]")}function zm(r){return!!(r&&BL[jn](r)==="[object Error]")}function dn(r){return typeof r=="string"}function Yo(r){return typeof r=="number"}function Bu(r){return typeof r=="boolean"}function A7(r){var e=!1;if(r&&typeof r=="object"){var t=vT?vT(r):Pae(r);t?(t[hT]&&or[jn](t,hT)&&(t=t[hT]),e=typeof t===rn&&U7[jn](t)===Cae):e=!0}return e}function la(r){if(r)return _ae?r[O7]():Rae(r)}function Rae(r){if(r&&r.getUTCFullYear){var e=function(t){var n=String(t);return n[et]===1&&(n="0"+n),n};return r.getUTCFullYear()+"-"+e(r.getUTCMonth()+1)+"-"+e(r.getUTCDate())+"T"+e(r.getUTCHours())+":"+e(r.getUTCMinutes())+":"+e(r.getUTCSeconds())+"."+String((r.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"}}function Ke(r,e,t){var n=r[et];try{for(var i=0;i<n&&!(i in r&&e[jn](t||r,r[i],i,r)===-1);i++);}catch(o){}}function Zn(r,e,t){if(r){if(r[P7])return r[P7](e,t);var n=r[et],i=t||0;try{for(var o=Math.max(i>=0?i:n-Math.abs(i),0);o<n;o++)if(o in r&&r[o]===e)return o}catch(s){}}return-1}function Qm(r,e,t){var n;if(r){if(r[T7])return r[T7](e,t);var i=r[et],o=t||r;n=new Array(i);try{for(var s=0;s<i;s++)s in r&&(n[s]=e[jn](o,r[s],r))}catch(a){}}return n}function Xm(r,e,t){var n;if(r){if(r[k7])return r[k7](e,t);var i=r[et],o=0;if(arguments[et]>=3)n=arguments[2];else{for(;o<i&&!(o in r);)o++;n=r[o++]}for(;o<i;)o in r&&(n=e(n,r[o],o,r)),o++}return n}function Vr(r){return r&&(r=yae&&r[WL]?r[WL]():r[za]?r[za](/^\s+|(?=\s)\s+$/g,pt):r),r}function Co(r){var e=typeof r;if(e!==rn&&(e!==dt||r===null)&&oa("objKeys called on non-object"),!M7&&R7)return R7(r);var t=[];for(var n in r)r&&or[jn](r,n)&&t[Ft](n);if(M7)for(var i=UL[et],o=0;o<i;o++)r&&or[jn](r,UL[o])&&t[Ft](UL[o]);return t}function Ds(r,e,t,n){if(N7)try{var i={enumerable:!0,configurable:!0};return t&&(i.get=t),n&&(i.set=n),N7(r,e,i),!0}catch(o){}return!1}function W7(r){return r}function JL(r){return VL&&Wr(r,function(e,t){(gt(t)||ki(t))&&VL(t)}),$o(r)}function ei(){var r=Date;return r.now?r.now():new r().getTime()}function Zm(r){return zm(r)?r[Ti]:pt}function zo(r,e,t,n,i){var o=t;return r&&(o=r[e],o!==t&&(!i||i(o))&&(!n||n(t))&&(o=t,r[e]=o)),o}function Kp(r,e,t){var n;return r?(n=r[e],!n&&_t(n)&&(n=dr(t)?{}:t,r[e]=n)):n=dr(t)?{}:t,n}function ca(r,e){return _t(r)?e:r}function GL(r){return!r}function xy(r){return!!r}function ti(r){throw new Error(r)}function V7(r,e){var t=null,n=null;return Yt(r)?t=r:n=r,function(){var i=arguments;if(t&&(n=t()),n)return n[e][yy](n,i)}}function YL(r,e,t){if(r&&e&&ki(r)&&ki(e)){var n=function(o){if(dn(o)){var s=e[o];Yt(s)?(!t||t(o,!0,e,r))&&(r[o]=V7(e,o)):(!t||t(o,!1,e,r))&&(ju(r,o)&&delete r[o],Ds(r,o,function(){return e[o]},function(a){e[o]=a})||(r[o]=s))}};for(var i in e)n(i)}return r}function Fp(r,e,t,n,i){r&&e&&t&&(i!==!1||dr(r[e]))&&(r[e]=V7(t,n))}function eg(r,e,t,n){return r&&e&&ki(r)&&gt(t)&&Ke(t,function(i){dn(i)&&Fp(r,i,e,i,n)}),r}function Hu(r){return r&&Ja&&(r=Er(Ja({},r))),r}function Dy(r,e,t,n,i,o){var s=arguments,a=s[0]||{},l=s[et],c=!1,d=1;for(l>0&&Bu(a)&&(c=a,a=s[d]||{},d++),ki(a)||(a={});d<l;d++){var p=s[d],f=gt(p),m=ki(p);for(var g in p){var h=f&&g in p||m&&or[jn](p,g);if(h){var v=p[g],S=void 0;if(c&&v&&((S=gt(v))||A7(v))){var _=a[g];S?gt(_)||(_=[]):A7(_)||(_={}),v=Dy(c,_,v)}v!==void 0&&(a[g]=v)}}}return a}var O7,L7,K7,P7,T7,k7,WL,F7,hae,hT,N7,VL,vae,R7,jL,yae,bae,Iae,Sae,_ae,Eae,BL,U7,Cae,wae,xae,Dae,vT,gt,M7,UL,$o,qL,Nn=ee(()=>{u();sr();Tn();vi();O7="toISOString",L7="endsWith",K7="startsWith",P7="indexOf",T7="map",k7="reduce",WL="trim",F7="toString",hae="__proto__",hT="constructor",N7=So,VL=Er.freeze,vae=Er.seal,R7=Er.keys,jL=String[Kt],yae=jL[WL],bae=jL[L7],Iae=jL[K7],Sae=Date[Kt],_ae=Sae[O7],Eae=Array.isArray,BL=ia[F7],U7=or[F7],Cae=U7[jn](Er),wae=/-([a-z])/g,xae=/([^\w\d_$])/g,Dae=/^(\d+[\w\d_$])/,vT=Object.getPrototypeOf;gt=Eae||Nae;M7=!{toString:null}.propertyIsEnumerable("toString"),UL=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"];$o=VL||W7,qL=vae||W7});function wo(r){var e={};return Wr(r,function(t,n){e[t]=n,e[n]=t}),JL(e)}var yT=ee(()=>{u();Nn()});var Xa,j7=ee(()=>{u();yT();Xa=wo({Unknown:0,NonRetryableStatus:1,InvalidEvent:2,SizeLimitExceeded:3,KillSwitch:4,QueueFull:5})});function Mae(){var r;return typeof globalThis!==IT&&(r=globalThis),!r&&typeof self!==IT&&(r=self),!r&&typeof window!==IT&&(r=window),!r&&typeof this!==IT&&(r=this),r||{}}function qu(r,e){return r&&PT[Ju].hasOwnProperty.call(r,e)}function $7(r){return r&&(r===PT[Ju]||r===Array[Ju])}function tK(r){return $7(r)||r===Function[Ju]}function tg(r){var e;if(r){if(sC)return sC(r);var t=r[Y7]||r[Ju]||(r[ET]?r[ET][Ju]:null);e=r[ST]||t,qu(r,ST)||(delete r[$L],e=r[ST]=r[$L]||r[ST],r[$L]=t)}return e}function xT(r,e){var t=[];if(J7)t=J7(r);else for(var n in r)typeof n=="string"&&qu(r,n)&&t.push(n);if(t&&t.length>0)for(var i=0;i<t.length;i++)e(t[i])}function rK(r,e,t){return e!==ET&&typeof r[e]===CT&&(t||qu(r,e))}function DT(r){throw new TypeError("DynamicProto: "+r)}function Oae(r){var e={};return xT(r,function(t){!e[t]&&rK(r,t,!1)&&(e[t]=r[t])}),e}function nK(r,e){for(var t=r.length-1;t>=0;t--)if(r[t]===e)return!0;return!1}function Lae(r,e,t,n){function i(l,c,d){var p=c[d];if(p[QL]&&n){var f=l[wT]||{};f[oC]!==!1&&(p=(f[c[Py]]||{})[d]||p)}return function(){return p.apply(l,arguments)}}var o={};xT(t,function(l){o[l]=i(e,t,l)});for(var s=tg(r),a=[];s&&!tK(s)&&!nK(a,s);)xT(s,function(l){!o[l]&&rK(s,l,!sC)&&(o[l]=i(e,s,l))}),a.push(s),s=tg(s);return o}function Kae(r,e,t,n){var i=null;if(r&&qu(t,Py)){var o=r[wT]||{};if(i=(o[t[Py]]||{})[e],i||DT("Missing ["+e+"] "+CT),!i[XL]&&o[oC]!==!1){for(var s=!qu(r,e),a=tg(r),l=[];s&&a&&!tK(a)&&!nK(l,a);){var c=a[e];if(c){s=c===n;break}l.push(a),a=tg(a)}try{s&&(r[e]=i),i[XL]=1}catch(d){o[oC]=!1}}}return i}function Fae(r,e,t){var n=e[r];return n===t&&(n=tg(e)[r]),typeof n!==CT&&DT("["+r+"] is not a "+CT),n}function Uae(r,e,t,n,i){function o(l,c){var d=function(){var p=Kae(this,c,l,d)||Fae(c,l,d);return p.apply(this,arguments)};return d[QL]=1,d}if(!$7(r)){var s=t[wT]=t[wT]||{},a=s[e]=s[e]||{};s[oC]!==!1&&(s[oC]=!!i),xT(t,function(l){rK(t,l,!1)&&t[l]!==n[l]&&(a[l]=t[l],delete t[l],(!qu(r,l)||r[l]&&!r[l][QL])&&(r[l]=o(r,l)))})}}function Wae(r,e){if(sC){for(var t=[],n=tg(e);n&&!tK(n)&&!nK(t,n);){if(n===r)return!0;t.push(n),n=tg(n)}return!1}return!0}function zL(r,e){return qu(r,Ju)?r.name||e||B7:((r||{})[ET]||{}).name||e||B7}function Be(r,e,t,n){qu(r,Ju)||DT("theClass is an invalid class definition.");var i=r[Ju];Wae(i,e)||DT("["+zL(r)+"] not in hierarchy of ["+zL(e)+"]");var o=null;qu(i,Py)?o=i[Py]:(o=Aae+zL(r,"_")+"$"+eK.n,eK.n++,i[Py]=o);var s=Be[G7],a=!!s[_T];a&&n&&n[_T]!==void 0&&(a=!!n[_T]);var l=Oae(e),c=Lae(i,e,l,a);t(e,c);var d=!!sC&&!!s[ZL];d&&n&&(d=!!n[ZL]),Uae(i,o,e,l,d!==!1)}var bT,IT,ET,Ju,CT,wT,QL,Py,Aae,XL,oC,G7,B7,Y7,ST,H7,$L,_T,ZL,PT,sC,J7,q7,eK,pr=ee(()=>{u();IT="undefined",ET="constructor",Ju="prototype",CT="function",wT="_dynInstFuncs",QL="_isDynProxy",Py="_dynClass",Aae="_dynCls$",XL="_dynInstChk",oC=XL,G7="_dfOpts",B7="_unknown_",Y7="__proto__",ST="_dyn"+Y7,H7="__dynProto$Gbl",$L="_dynInstProto",_T="useBaseInst",ZL="setInstFuncs",PT=Object,sC=PT.getPrototypeOf,J7=PT.getOwnPropertyNames;q7=Mae(),eK=q7[H7]||(q7[H7]={o:(bT={},bT[ZL]=!0,bT[_T]=!0,bT),n:1e3});Be[G7]=eK.o});function e8(r,e){var t=!1;if(r){try{if(t=e in r,!t){var n=r[Kt];n&&(t=e in n)}}catch(o){}if(!t)try{var i=new r;t=!dr(i[e])}catch(o){}}return t}function cK(r){Z7=r}function pn(r){var e=Vn();return e&&e[r]?e[r]:r===z7&&aC()?window:null}function aC(){return!!(typeof window===dt&&window)}function Ec(){return aC()?window:pn(z7)}function TT(){return!!(typeof document===dt&&document)}function Qo(){return TT()?document:pn(Vae)}function lC(){return!!(typeof navigator===dt&&navigator)}function Ps(){return lC()?navigator:pn(Bae)}function kT(){return!!(typeof history===dt&&history)}function uK(){return kT()?history:pn(Hae)}function rg(r){if(r&&Z7){var e=pn("__mockLocation");if(e)return e}return typeof location===dt&&location?location:pn(Jae)}function cC(){return typeof console!==Xt?console:pn(qae)}function ky(){return pn(Gae)}function ng(){return!!(typeof JSON===dt&&JSON||pn(Q7)!==null)}function Ny(){return ng()?JSON||pn(Q7):null}function uC(){return pn(Yae)}function dC(){return pn($ae)}function Gu(){var r=Ps();return r&&r.product?r.product===zae:!1}function Za(){var r=Ps();if(r&&(r[vy]!==oK||iK===null)){oK=r[vy];var e=(oK||pt)[fT]();iK=kn(e,aK)||kn(e,lK)}return iK}function dK(r){if(r===void 0&&(r=null),!r){var e=Ps()||{};r=e?(e[vy]||pt)[fT]():pt}var t=(r||pt)[fT]();if(kn(t,aK)){var n=Qo()||{};return Math.max(parseInt(t[Rp](aK)[1]),n[jae]||0)}else if(kn(t,lK)){var i=parseInt(t[Rp](lK)[1]);if(i)return i+4}return null}function nn(r){var e=Object[Kt].toString[jn](r),t=pt;return e==="[object Error]"?t="{ stack: '"+r.stack+"', message: '"+r.message+"', name: '"+r[Ti]+"'":ng()&&(t=Ny().stringify(r)),e+t}function Up(){return sK===null&&(sK=lC()&&!!Ps().sendBeacon),sK}function Ry(r){var e=!1;try{e=!!pn("fetch");var t=pn("Request");e&&r&&t&&(e=e8(t,"keepalive"))}catch(n){}return e}function ig(){return Ty===null&&(Ty=typeof XDomainRequest!==Xt,Ty&&Ay()&&(Ty=Ty&&!e8(pn(X7),"withCredentials"))),Ty}function Ay(){var r=!1;try{var e=pn(X7);r=!!e}catch(t){}return r}function t8(r,e){if(r)for(var t=0;t<r[et];t++){var n=r[t];if(n[Ti]&&n[Ti]===e)return n}return{}}function pK(r){var e=Qo();return e&&r?t8(e.querySelectorAll("meta"),r).content:null}function fK(r){var e,t=ky();if(t){var n=t.getEntriesByType("navigation")||[];e=t8((n[et]>0?n[0]:{}).serverTiming,r).description}return e}var z7,Vae,jae,Bae,Hae,Jae,qae,Gae,Q7,Yae,$ae,zae,aK,lK,X7,iK,oK,Z7,Ty,sK,ua=ee(()=>{"use strict";u();sr();Tn();Nn();vi();z7="window",Vae="document",jae="documentMode",Bae="navigator",Hae="history",Jae="location",qae="console",Gae="performance",Q7="JSON",Yae="crypto",$ae="msCrypto",zae="ReactNative",aK="msie",lK="trident/",X7="XMLHttpRequest",iK=null,oK=null,Z7=!1,Ty=null,sK=null});function Qae(r,e){return function(){var t=arguments,n=gK(e);if(n){var i=n.listener;i&&i[r]&&i[r][yy](i,t)}}}function Xae(){var r=pn("Microsoft");return r&&(RT=r.ApplicationInsights),RT}function gK(r){var e=RT;return!e&&r.disableDbgExt!==!0&&(e=RT||Xae()),e?e.ChromeDbgExt:null}function r8(r){if(!NT){NT={};for(var e=0;e<mK[et];e++)NT[mK[e]]=Qae(mK[e],r)}return NT}var mK,RT,NT,hK=ee(()=>{u();Tn();ua();mK=["eventsSent","eventsDiscarded","eventsSendRequest","perfEvent"],RT=null});function n8(r){return r?'"'+r[za](/\"/g,pt)+'"':pt}function i8(r,e){var t=cC();if(t){var n="log";t[r]&&(n=r),Yt(t[n])&&t[n](e)}}function pC(r,e){return(r||{})[Jo]||new el(e)}function vK(r){return r||new el}function Qr(r,e,t,n,i,o){o===void 0&&(o=!1),vK(r).throwInternal(e,t,n,i,o)}function tl(r,e){vK(r)[iC](e)}function yK(r,e,t){vK(r)[LL](e,t)}var Zae,ele,tle,og,el,Wp=ee(()=>{"use strict";u();pr();Tn();hK();ua();Nn();vi();Zae="AI (Internal): ",ele="AI: ",tle="AITR_";og=function(){function r(e,t,n,i){n===void 0&&(n=!1);var o=this;o[gy]=e,o[Tp]=(n?ele:Zae)+e;var s=pt;ng()&&(s=Ny().stringify(i));var a=(t?" message:"+n8(t):pt)+(i?" props:"+n8(s):pt);o[Tp]+=a}return r.dataType="MessageData",r}();el=function(){function r(e){this.identifier="DiagnosticLogger",this.queue=[];var t=0,n={},i,o,s,a;Be(r,this,function(l){d(e||{}),l.consoleLoggingLevel=function(){return i},l.telemetryLoggingLevel=function(){return o},l.maxInternalMessageLimit=function(){return s},l[OL]=function(){return a},l.throwInternal=function(m,g,h,v,S){S===void 0&&(S=!1);var _=new og(g,h,S,v);if(a)throw nn(_);var D=m===1?gT:iC;if(dr(_[Tp]))f("throw"+(m===1?"Critical":"Warning"),_);else{if(S){var P=+_[gy];!n[P]&&i>=m&&(l[D](_[Tp]),n[P]=!0)}else i>=m&&l[D](_[Tp]);c(m,_)}},l[iC]=function(m){i8("warn",m),f("warning",m)},l[gT]=function(m){i8("error",m),f("error",m)},l.resetInternalMessageCount=function(){t=0,n={}},l[LL]=c;function c(m,g){if(!p()){var h=!0,v=tle+g[gy];if(n[v]?h=!1:n[v]=!0,h&&(m<=o&&(l.queue[Ft](g),t++,f(m===1?"error":"warn",g)),t===s)){var S="Internal events throttle limit per PageView reached for this app.",_=new og(23,S,!1);l.queue[Ft](_),m===1?l[gT](S):l[iC](S)}}}function d(m){i=ca(m.loggingLevelConsole,0),o=ca(m.loggingLevelTelemetry,1),s=ca(m.maxMessageLimit,25),a=ca(m[OL],!1)}function p(){return t>=s}function f(m,g){var h=gK(e||{});h&&h[sa]&&h[sa](m,g)}})}return r.__ieDyn=1,r}()});function Sn(r,e,t,n,i){if(r){var o=r;if(o[Gm]&&(o=o[Gm]()),o){var s=void 0,a=o[Jm](bK);try{if(s=o.create(e(),n,i),s){if(a&&s[Qa]&&(s[Qa](sg[IK],a),a[Jm]&&a[Qa])){var l=a[Jm](sg[fC]);l||(l=[],a[Qa](sg[fC],l)),l[Ft](s)}return o[Qa](bK,s),t(s)}}catch(c){s&&s[Qa]&&s[Qa]("exception",c)}finally{s&&o.fire(s),o[Qa](bK,a)}}}return t()}function SK(){return rle}var My,IK,fC,rle,sg,mC,bK,gC=ee(()=>{u();pr();Tn();Nn();vi();My="ctx",IK="ParentContextKey",fC="ChildrenContextKey",rle=null,sg=function(){function r(e,t,n){var i=this,o=!1;if(i.start=ei(),i[Ti]=e,i[Ya]=n,i[tC]=function(){return!1},Yt(t)){var s;o=Ds(i,"payload",function(){return!s&&Yt(t)&&(s=t(),t=null),s})}i[Jm]=function(a){return a?a===r[IK]||a===r[fC]?i[a]:(i[My]||{})[a]:null},i[Qa]=function(a,l){if(a)if(a===r[IK])i[a]||(i[tC]=function(){return!0}),i[a]=l;else if(a===r[fC])i[a]=l;else{var c=i[My]=i[My]||{};c[a]=l}},i[mT]=function(){var a=0,l=i[Jm](r[fC]);if(gt(l))for(var c=0;c<l[et];c++){var d=l[c];d&&(a+=d[Um])}i[Um]=ei()-i.start,i.exTime=i[Um]-a,i[mT]=function(){},!o&&Yt(t)&&(i.payload=t())}}return r.ParentContextKey="parent",r.ChildrenContextKey="childEvts",r}(),mC=function(){function r(e){this.ctx={},Be(r,this,function(t){t.create=function(n,i,o){return new sg(n,i,o)},t.fire=function(n){n&&(n[mT](),e&&Yt(e[Lp])&&e[Lp](n))},t[Qa]=function(n,i){if(n){var o=t[My]=t[My]||{};o[n]=i}},t[Jm]=function(n){return(t[My]||{})[n]}})}return r.__ieDyn=1,r}(),bK="CoreUtils.doPerf"});function a8(r){r<0&&(r>>>=0),hC=123456789+r&Vp,vC=987654321-r&Vp,s8=!0}function l8(){try{var r=ei()&2147483647;a8((Math.random()*o8^r)+r)}catch(e){}}function Oy(r){return r>0?Math.floor(rl()/Vp*(r+1))>>>0:0}function rl(r){var e=0,t=uC()||dC();return t&&t.getRandomValues&&(e=t.getRandomValues(new Uint32Array(1))[0]&Vp),e===0&&Za()&&(s8||l8(),e=yC()&Vp),e===0&&(e=Math.floor(o8*Math.random()|0)),r||(e>>>=0),e}function AT(r){r?a8(r):l8()}function yC(r){vC=36969*(vC&65535)+(vC>>16)&Vp,hC=18e3*(hC&65535)+(hC>>16)&Vp;var e=(vC<<16)+(hC&65535)>>>0&Vp|0;return r||(e>>>=0),e}function jp(r){r===void 0&&(r=22);for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=rl()>>>0,n=0,i=pt;i[et]<r;)n++,i+=e.charAt(t&63),t>>>=6,n===5&&(t=(rl()<<2&4294967295|t&3)>>>0,n=0);return i}var o8,Vp,s8,hC,vC,MT=ee(()=>{u();Tn();ua();Nn();vi();o8=4294967296,Vp=4294967295,s8=!1,hC=123456789,vC=987654321});function ole(r,e,t){if(c8)try{return c8(r,e,{value:t,enumerable:!1,configurable:!0}),!0}catch(n){}return!1}function d8(r){return r[pT]===1||r[pT]===9||!+r[pT]}function sle(r,e){var t=e[r.id];if(!t){t={};try{d8(e)&&(ole(e,r.id,t)||(e[r.id]=t))}catch(n){}}return t}function nl(r,e){return e===void 0&&(e=!1),Ym(r+ile+++(e?"."+u8:pt)+nle)}function OT(r){var e={id:nl("_aiData-"+(r||pt)+"."+u8),accept:function(t){return d8(t)},get:function(t,n,i,o){var s=t[e.id];return s?s[Ym(n)]:(o&&(s=sle(e,t),s[Ym(n)]=i),i)},kill:function(t,n){if(t&&t[n])try{delete t[n]}catch(i){}}};return e}var c8,u8,nle,ile,bC=ee(()=>{u();sr();Tn();Nn();vi();MT();c8=So,u8="2.8.10",nle="."+jp(6),ile=0});function ale(r,e){var t=Yu[Bp]||FT[Bp];return t||(t=Yu[Bp]=Yu(r,e),FT[Bp]=t),t}function KT(r){return r?r.isEnabled():!0}function lle(r){var e=r[dT]=r[dT]||{};if(zo(e,"domain",r.cookieDomain,HL,_t),zo(e,"path",r.cookiePath||"/",null,_t),_t(e[CK])){var t=void 0;dr(r[m8])||(t=!r[m8]),dr(r[g8])||(t=!r[g8]),e[CK]=t}return e}function S8(r,e){return e&&r&&gt(r.ignoreCookies)?r.ignoreCookies[Np](e)!==-1:!1}function cle(r,e){return e&&r&&gt(r.blockedCookies)&&r.blockedCookies[Np](e)!==-1?!0:S8(r,e)}function Hp(r,e){var t;if(r)t=r.getCookieMgr();else if(e){var n=e[dT];n[Bp]?t=n[Bp]:t=Yu(e)}return t||(t=ale(e,(r||{})[Jo])),t}function Yu(r,e){var t,n=lle(r||FT),i=n.path||"/",o=n.domain,s=n[CK]!==!1,a=(t={isEnabled:function(){var l=s&&il(e),c=FT[Bp];return l&&c&&a!==c&&(l=KT(c)),l}},t[ZE]=function(l){s=l!==!1},t.set=function(l,c,d,p,f){var m=!1;if(KT(a)&&!cle(n,l)){var g={},h=Vr(c||pt),v=h[Np](";");if(v!==-1&&(h=Vr(c[$a](0,v)),g=_8(c[$a](v+1))),zo(g,"domain",p||o,xy,dr),!_t(d)){var S=Za();if(dr(g[_K])){var _=ei(),D=_+d*1e3;if(D>0){var P=new Date;P.setTime(D),zo(g,_K,y8(P,S?p8:f8)||y8(P,S?p8:f8)||pt,xy)}}S||zo(g,"max-age",pt+d,null,dr)}var M=rg();M&&M.protocol==="https:"&&(zo(g,"secure",null,null,dr),EK===null&&(EK=!Ly((Ps()||{})[vy])),EK&&zo(g,"SameSite","None",null,dr)),zo(g,"path",f||i,null,dr);var x=n.setCookie||I8;x(l,b8(h,g)),m=!0}return m},t.get=function(l){var c=pt;return KT(a)&&!S8(n,l)&&(c=(n.getCookie||ule)(l)),c},t.del=function(l,c){var d=!1;return KT(a)&&(d=a.purge(l,c)),d},t.purge=function(l,c){var d,p=!1;if(il(e)){var f=(d={},d.path=c||"/",d[_K]="Thu, 01 Jan 1970 00:00:01 GMT",d);Za()||(f["max-age"]="0");var m=n.delCookie||I8;m(l,b8(pt,f)),p=!0}return p},t);return a[Bp]=a,a}function il(r){if(LT===null){LT=!1;try{var e=IC||{};LT=e[wK]!==void 0}catch(t){Qr(r,2,68,"Cannot access document.cookie - "+Zm(t),{exception:nn(t)})}}return LT}function _8(r){var e={};if(r&&r[et]){var t=Vr(r)[Rp](";");Ke(t,function(n){if(n=Vr(n||pt),n){var i=n[Np]("=");i===-1?e[n]=null:e[Vr(n[$a](0,i))]=Vr(n[$a](i+1))}})}return e}function y8(r,e){return Yt(r[e])?r[e]():null}function b8(r,e){var t=r||pt;return Wr(e,function(n,i){t+="; "+n+(_t(i)?pt:"="+i)}),t}function ule(r){var e=pt;if(IC){var t=IC[wK]||pt;h8!==t&&(v8=_8(t),h8=t),e=Vr(v8[r]||pt)}return e}function I8(r,e){IC&&(IC[wK]=r+"="+e)}function Ly(r){return dn(r)?!!(kn(r,"CPU iPhone OS 12")||kn(r,"iPad; CPU OS 12")||kn(r,"Macintosh; Intel Mac OS X 10_14")&&kn(r,"Version/")&&kn(r,"Safari")||kn(r,"Macintosh; Intel Mac OS X 10_14")&&$m(r,"AppleWebKit/605.1.15 (KHTML, like Gecko)")||kn(r,"Chrome/5")||kn(r,"Chrome/6")||kn(r,"UnrealEngine")&&!kn(r,"Chrome")||kn(r,"UCBrowser/12")||kn(r,"UCBrowser/11")):!1}var p8,f8,wK,_K,CK,m8,g8,Bp,LT,EK,h8,IC,v8,FT,xK=ee(()=>{u();Tn();Wp();ua();Nn();vi();p8="toGMTString",f8="toUTCString",wK="cookie",_K="expires",CK="enabled",m8="isCookieUseDisabled",g8="disableCookiesUsage",Bp="_ckMgr",LT=null,EK=null,h8=null,IC=Qo(),v8={},FT={}});function D8(r){return r&&r[za]?r[za](/^[\s\.]+|(?=[\s\.])[\.\s]+$/g,pt):r}function VT(r,e){var t;if(e){var n=pt;gt(e)?(n=pt,Ke(e,function(o){o=D8(o),o&&(o[0]!=="."&&(o="."+o),n+=o)})):n=D8(e),n&&(n[0]!=="."&&(n="."+n),r=(r||pt)+n)}var i=mle.exec(r||pt)||[];return t={},t[qo]=i[1],t.ns=(i[2]||pt).replace(dle,".").replace(ple,pt)[Rp](".").sort().join("."),t}function DK(r,e,t){var n=[],i=_C.get(r,UT,{},!1),o=VT(e,t);return Wr(i,function(s,a){Ke(a,function(l){var c;(!o[qo]||o[qo]===l.evtName[qo])&&(!o.ns||o.ns===o.ns)&&n[Ft]((c={},c[Ti]=l.evtName[qo]+(l.evtName.ns?"."+l.evtName.ns:pt),c.handler=l[eC],c))})}),n}function O8(r,e,t){t===void 0&&(t=!0);var n=_C.get(r,UT,{},t),i=n[e];return i||(i=n[e]=[]),i}function L8(r,e,t,n){r&&e&&e[qo]&&(r[x8]?r[x8](e[qo],t,n):r[w8]&&r[w8](T8+e[qo],t))}function gle(r,e,t,n){var i=!1;return r&&e&&e[qo]&&t&&(r[C8]?(r[C8](e[qo],t,n),i=!0):r[E8]&&(r[E8](T8+e[qo],t),i=!0)),i}function P8(r,e,t,n){for(var i=e[et];i--;){var o=e[i];o&&(!t.ns||t.ns===o.evtName.ns)&&(!n||n(o))&&(L8(r,o.evtName,o[eC],o.capture),e[Wu](i,1))}}function hle(r,e,t){if(e[qo])P8(r,O8(r,e[qo]),e,t);else{var n=_C.get(r,UT,{});Wr(n,function(i,o){P8(r,o,e,t)}),Co(n)[et]===0&&_C.kill(r,UT)}}function $u(r,e){var t;return e?(gt(e)?t=[r].concat(e):t=[r,e],t=VT("xx",t).ns[Rp](".")):t=r,t}function ag(r,e,t,n,i){var o;i===void 0&&(i=!1);var s=!1;if(r)try{var a=VT(e,n);if(s=gle(r,a,t,i),s&&_C.accept(r)){var l=(o={guid:fle++,evtName:a},o[eC]=t,o.capture=i,o);O8(r,a.type)[Ft](l)}}catch(c){}return s}function lg(r,e,t,n,i){if(i===void 0&&(i=!1),r)try{var o=VT(e,n),s=!1;hle(r,o,function(a){return o.ns&&!t||a[eC]===t?(s=!0,!0):!1}),s||L8(r,o,t,i)}catch(a){}}function Fy(r,e,t,n){return n===void 0&&(n=!1),ag(r,e,t,null,n)}function Uy(r,e,t,n){n===void 0&&(n=!1),lg(r,e,t,null,n)}function qp(r,e,t){var n=!1,i=Ec();i&&(n=ag(i,r,e,t),n=ag(i.body,r,e,t)||n);var o=Qo();return o&&(n=ag(o,r,e,t)||n),n}function jT(r,e,t){var n=Ec();n&&(lg(n,r,e,t),lg(n.body,r,e,t));var i=Qo();i&&lg(i,r,e,t)}function Ky(r,e,t,n){var i=!1;return e&&r&&r[et]>0&&Ke(r,function(o){o&&(!t||Zn(t,o)===-1)&&(i=qp(o,e,n)||i)}),i}function BT(r,e,t,n){var i=!1;return e&&r&&gt(r)&&(i=Ky(r,e,t,n),!i&&t&&t[et]>0&&(i=Ky(r,e,null,n))),i}function Jp(r,e,t){r&&gt(r)&&Ke(r,function(n){n&&jT(n,e,t)})}function cg(r,e,t){return BT([R8,N8,WT],r,e,t)}function EC(r,e){Jp([R8,N8,WT],r,e)}function Wy(r,e,t){function n(s){var a=Qo();r&&a&&a.visibilityState==="hidden"&&r(s)}var i=$u(A8,t),o=Ky([WT],r,e,i);return(!e||Zn(e,SC)===-1)&&(o=Ky([SC],n,e,i)||o),!o&&e&&(o=Wy(r,null,t)),o}function CC(r,e){var t=$u(A8,e);Jp([WT],r,t),Jp([SC],null,t)}function Vy(r,e,t){function n(s){var a=Qo();r&&a&&a.visibilityState==="visible"&&r(s)}var i=$u(M8,t),o=Ky([k8],r,e,i);return o=Ky([SC],n,e,i)||o,!o&&e&&(o=Vy(r,null,t)),o}function wC(r,e){var t=$u(M8,e);Jp([k8],r,t),Jp([SC],null,t)}var T8,E8,C8,w8,x8,UT,SC,WT,k8,N8,R8,A8,M8,dle,ple,fle,_C,mle,PK=ee(()=>{u();Tn();bC();ua();Nn();vi();T8="on",E8="attachEvent",C8="addEventListener",w8="detachEvent",x8="removeEventListener",UT="events",SC="visibilitychange",WT="pagehide",k8="pageshow",N8="unload",R8="beforeunload",A8=nl("aiEvtPageHide"),M8=nl("aiEvtPageShow"),dle=/\.[\.]+/g,ple=/[\.]+$/,fle=1,_C=OT("events"),mle=/^([^.]*)(?:\.(.+)|)/});function jy(){var r=zu();return r[$a](0,8)+"-"+r[$a](8,12)+"-"+r[$a](12,16)+"-"+r[$a](16,20)+"-"+r[$a](20)}function By(){var r=ky();return r&&r.now?r.now():ei()}function zu(){for(var r=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],e=pt,t,n=0;n<4;n++)t=rl(),e+=r[t&15]+r[t>>4&15]+r[t>>8&15]+r[t>>12&15]+r[t>>16&15]+r[t>>20&15]+r[t>>24&15]+r[t>>28&15];var i=r[8+(rl()&3)|0];return e[Ap](0,8)+e[Ap](9,4)+"4"+e[Ap](13,3)+i+e[Ap](16,3)+e[Ap](19,12)}var TK,kK=ee(()=>{"use strict";u();Tn();ua();PK();Nn();vi();MT();TK={Attach:Fy,AttachEvent:Fy,Detach:Uy,DetachEvent:Uy}});function Qu(r,e,t){return r&&r[et]===e&&r!==t?!!r.match(/^[\da-f]*$/):!1}function F8(r,e,t){return Qu(r,e)?r:t}function U8(r){(isNaN(r)||r<0||r>255)&&(r=1);for(var e=r.toString(16);e[et]<2;)e="0"+e;return e}function AK(r,e,t,n){var i;return i={},i[rC]=Qu(n,2,RK)?n:NK,i[qm]=Hy(r)?r:zu(),i.spanId=Jy(e)?e:zu()[Ap](0,16),i.traceFlags=t>=0&&t<=255?t:1,i}function xC(r){var e;if(!r||(gt(r)&&(r=r[0]||""),!r||!dn(r)||r[et]>8192))return null;var t=vle.exec(Vr(r));return!t||t[1]===RK||t[2]===HT||t[3]===JT?null:(e={},e[rC]=t[1],e[qm]=t[2],e[by]=t[3],e[Mp]=parseInt(t[4],16),e)}function Hy(r){return Qu(r,32,HT)}function Jy(r){return Qu(r,16,JT)}function qT(r){return!(!r||!Qu(r[rC],2,RK)||!Qu(r[qm],32,HT)||!Qu(r[by],16,JT)||!Qu(U8(r[Mp]),2))}function MK(r){return qT(r)?(r[Mp]&K8)===K8:!1}function OK(r){if(r){var e=U8(r[Mp]);Qu(e,2)||(e="01");var t=r[rC]||NK;return t!=="00"&&t!=="ff"&&(t=NK),"".concat(t,"-").concat(F8(r.traceId,32,HT),"-").concat(F8(r.spanId,16,JT),"-").concat(e)}return""}function LK(){var r="traceparent",e=xC(pK(r));return e||(e=xC(fK(r))),e}var vle,NK,RK,HT,JT,K8,KK=ee(()=>{u();Tn();kK();ua();Nn();vle=/^([\da-f]{2})-([\da-f]{32})-([\da-f]{16})-([\da-f]{2})(-[^\s]*)?$/,NK="00",RK="ff",HT="00000000000000000000000000000000",JT="0000000000000000",K8=1});function Xu(r){return yle.get(r,"state",{},!0)}function GT(r,e){for(var t=[],n=null,i=r[xs](),o;i;){var s=i[jm]();if(s){n&&Yt(n[kp])&&Yt(s[Go])&&n[kp](s);var a=!1;Yt(s[Cs])?a=s[Cs]():(o=Xu(s),a=o[Cs]),a||t[Ft](s),n=s,i=i[xs]()}}Ke(t,function(l){var c=r[un]();l[qa](r.getCfg(),c,e,r[xs]()),o=Xu(l),!l[un]&&!o[un]&&(o[un]=c),o[Cs]=!0,delete o[ws]})}function YT(r){return r.sort(function(e,t){var n=0;if(t){var i=Yt(t[Go]);Yt(e[Go])?n=i?e[aa]-t[aa]:1:i&&(n=-1)}else n=e?1:-1;return n})}function W8(r){var e={};return{getName:function(){return e[Ti]},setName:function(t){r&&r.setName(t),e[Ti]=t},getTraceId:function(){return e[qm]},setTraceId:function(t){r&&r.setTraceId(t),Hy(t)&&(e[qm]=t)},getSpanId:function(){return e[by]},setSpanId:function(t){r&&r.setSpanId(t),Jy(t)&&(e[by]=t)},getTraceFlags:function(){return e[Mp]},setTraceFlags:function(t){r&&r.setTraceFlags(t),e[Mp]=t}}}var yle,$T=ee(()=>{"use strict";u();Tn();bC();Nn();vi();KK();yle=OT("plugin")});function Ile(r,e,t){for(;r;){if(r[jm]()===t)return r;r=r[xs]()}return Cc([t],e[_c]||{},e)}function FK(r,e,t,n){var i=null,o=[];n!==null&&(i=n?Ile(r,t,n):r);var s={_next:l,ctx:{core:function(){return t},diagLog:function(){return pC(t,e)},getCfg:function(){return e},getExtCfg:c,getConfig:d,hasNext:function(){return!!i},getNext:function(){return i},setNext:function(f){i=f},iterate:p,onComplete:a}};function a(f,m){for(var g=[],h=2;h<arguments.length;h++)g[h-2]=arguments[h];f&&o[Ft]({func:f,self:dr(m)?s.ctx:m,args:g})}function l(){var f=i;if(i=f?f[xs]():null,!f){var m=o;m&&m[et]>0&&(Ke(m,function(g){try{g.func[jn](g.self,g.args)}catch(h){Qr(t[Jo],2,73,"Unexpected Exception during onComplete - "+nn(h))}}),o=[])}return f}function c(f,m,g){m===void 0&&(m={}),g===void 0&&(g=0);var h;if(e){var v=e[Iy];v&&f&&(h=v[f])}if(!h)h=m;else if(ki(m)&&g!==0){var S=Dy(!0,m,h);e&&g===2&&Wr(m,function(_){if(_t(S[_])){var D=e[_];_t(D)||(S[_]=D)}}),h=S}return h}function d(f,m,g){g===void 0&&(g=!1);var h,v=c(f,null);return v&&!_t(v[m])?h=v[m]:e&&!_t(e[m])&&(h=e[m]),_t(h)?g:h}function p(f){for(var m;m=s._next();){var g=m[jm]();g&&f(g)}}return s}function Xo(r,e,t,n){var i=FK(r,e,t,n),o=i.ctx;function s(l){var c=i._next();return c&&c[Go](l,o),!c}function a(l,c){return l===void 0&&(l=null),gt(l)&&(l=Cc(l,e,t,c)),Xo(l||o[xs](),e,t,c)}return o[Ur]=s,o[Vu]=a,o}function qy(r,e,t){var n=e[_c]||{},i=FK(r,n,e,t),o=i.ctx;function s(l){var c=i._next();return c&&c.unload(o,l),!c}function a(l,c){return l===void 0&&(l=null),gt(l)&&(l=Cc(l,n,e,c)),qy(l||o[xs](),e,c)}return o[Ur]=s,o[Vu]=a,o}function DC(r,e,t){var n=e[_c]||{},i=FK(r,n,e,t),o=i.ctx;function s(l){return o.iterate(function(c){Yt(c[Bm])&&c[Bm](o,l)})}function a(l,c){return l===void 0&&(l=null),gt(l)&&(l=Cc(l,n,e,c)),DC(l||o[xs](),e,c)}return o[Ur]=s,o[Vu]=a,o}function Cc(r,e,t,n){var i=null,o=!n;if(gt(r)&&r[et]>0){var s=null;Ke(r,function(a){if(!o&&n===a&&(o=!0),o&&a&&Yt(a[Go])){var l=Sle(a,e,t);i||(i=l),s&&s._setNext(l),s=l}})}return n&&!i?Cc([n],e,t):i}function Sle(r,e,t){var n=null,i=Yt(r[Go]),o=Yt(r[kp]),s;r?s=r[Ga]+"-"+r[aa]+"-"+B8++:s="Unknown-0-"+B8++;var a={getPlugin:function(){return r},getNext:function(){return n},processTelemetry:d,unload:p,update:f,_id:s,_setNext:function(m){n=m}};function l(){var m;return r&&Yt(r[j8])&&(m=r[j8]()),m||(m=Xo(a,e,t)),m}function c(m,g,h,v,S){var _=!1,D=r?r[Ga]:ble,P=m[V8];return P||(P=m[V8]={}),m.setNext(n),r&&Sn(m[un](),function(){return D+":"+h},function(){P[s]=!0;try{var M=n?n._id:pt;M&&(P[M]=!1),_=g(m)}catch(A){var x=n?P[n._id]:!0;x&&(_=!0),(!n||!x)&&Qr(m[sa](),1,73,"Plugin ["+D+"] failed during "+h+" - "+nn(A)+", run flags: "+nn(P))}},v,S),_}function d(m,g){g=g||l();function h(v){if(!r||!i)return!1;var S=Xu(r);return S[ws]||S[nC]?!1:(o&&r[kp](n),r[Go](m,v),!0)}c(g,h,"processTelemetry",function(){return{item:m}},!m.sync)||g[Ur](m)}function p(m,g){function h(){var v=!1;if(r){var S=Xu(r),_=r[un]||S[un];r&&(!_||_===m.core())&&!S[ws]&&(S[un]=null,S[ws]=!0,S[Cs]=!1,r[ws]&&r[ws](m,g)===!0&&(v=!0))}return v}c(m,h,"unload",function(){},g[Ya])||m[Ur](g)}function f(m,g){function h(){var v=!1;if(r){var S=Xu(r),_=r[un]||S[un];r&&(!_||_===m.core())&&!S[ws]&&r[Bm]&&r[Bm](m,g)===!0&&(v=!0)}return v}c(m,h,"update",function(){},!1)||m[Ur](g)}return $o(a)}var ble,V8,j8,B8,UK,PC=ee(()=>{"use strict";u();Tn();Wp();ua();Nn();vi();gC();$T();ble="TelemetryPluginChain",V8="_hasRun",j8="_getTelCtx",B8=0;UK=function(){function r(e,t,n,i){var o=this,s=Xo(e,t,n,i);eg(o,s,Co(s))}return r}()});function H8(r,e,t){e&&gt(e)&&e[et]>0&&(e=e.sort(function(n,i){return n[aa]-i[aa]}),Ke(e,function(n){n[aa]<TC&&ti(_le+n[Ga])}),r[Ft]({queue:$o(e),chain:Cc(e,t[_c],t)}))}function J8(r,e){function t(){return Xo(null,e[_c],e,null)}function n(c,d,p,f){var m=c?c[et]+1:1;function g(){m--,m===0&&(f&&f(),f=null)}m>0&&Ke(c,function(h){if(h&&h.queue[et]>0){var v=h.chain,S=d[Vu](v);S[QE](g),p(S)}else m--}),g()}function i(c,d){var p=d||{reason:0};return n(r,c,function(f){f[Ur](p)},function(){c[Ur](p)}),!0}function o(c,d){var p=d||{reason:0,isAsync:!1};return n(r,c,function(f){f[Ur](p)},function(){c[Ur](p),a=!1}),!0}function s(c){var d=null;return r&&r[et]>0&&Ke(r,function(p){if(p&&p.queue[et]>0&&(Ke(p.queue,function(f){if(f[Ga]===c)return d=f,-1}),d))return-1}),d}var a=!1,l={identifier:"ChannelControllerPlugin",priority:TC,initialize:function(c,d,p,f){a=!0,Ke(r,function(m){m&&m.queue[et]>0&&GT(Xo(m.chain,c,d),p)})},isInitialized:function(){return a},processTelemetry:function(c,d){n(r,d||t(),function(p){p[Ur](c)},function(){d[Ur](c)})},update:i,pause:function(){n(r,t(),function(c){c.iterate(function(d){d.pause&&d.pause()})},null)},resume:function(){n(r,t(),function(c){c.iterate(function(d){d.resume&&d.resume()})},null)},teardown:o,getChannel:s,flush:function(c,d,p,f){var m=1,g=!1,h=null;f=f||5e3;function v(){m--,g&&m===0&&(h&&(clearTimeout(h),h=null),d&&d(g),d=null)}return n(r,t(),function(S){S.iterate(function(_){if(_[my]){m++;var D=!1;_[my](c,function(){D=!0,v()},p)||D||(c&&h==null?h=setTimeout(function(){h=null,v()},f):v())}})},function(){g=!0,v()}),!0},_setQueue:function(c){r=c}};return l}function q8(r,e,t){var n=[];if(r&&Ke(r,function(o){return H8(n,o,t)}),e){var i=[];Ke(e,function(o){o[aa]>TC&&i[Ft](o)}),H8(n,i,t)}return n}var TC,_le,G8=ee(()=>{u();Tn();Nn();vi();PC();$T();TC=500,_le="Channel has invalid priority - "});function ug(){var r=[];function e(n){n&&r[Ft](n)}function t(n,i){Ke(r,function(o){try{o(n,i)}catch(s){Qr(n[sa](),2,73,"Unexpected error calling unload handler - "+nn(s))}}),r=[]}return{add:e,run:t}}var zT=ee(()=>{u();Tn();Wp();ua();Nn()});var Gp,dg,WK=ee(()=>{"use strict";u();pr();Tn();Nn();vi();PC();zT();Gp="getPlugin",dg=function(){function r(){var e=this,t,n,i,o,s;c(),Be(r,e,function(d){d[qa]=function(p,f,m,g){l(p,f,g),t=!0},d[ws]=function(p,f){var m,g=d[un];if(!g||p&&g!==p[un]())return;var h,v=!1,S=p||qy(null,g,i&&i[Gp]?i[Gp]():i),_=f||(m={reason:0},m[Ya]=!1,m);function D(){if(!v){v=!0,o.run(S,f);var P=s;s=[],Ke(P,function(M){M.rm()}),h===!0&&S[Ur](_),c()}}return!d[hy]||d[hy](S,_,D)!==!0?D():h=!0,h},d[Bm]=function(p,f){var m=d[un];if(!m||p&&m!==p[un]())return;var g,h=!1,v=p||DC(null,m,i&&i[Gp]?i[Gp]():i),S=f||{reason:0};function _(){h||(h=!0,l(v.getCfg(),v.core(),v[xs]()))}return!d._doUpdate||d._doUpdate(v,S,_)!==!0?_():g=!0,g},d._addHook=function(p){p&&(gt(p)?s=s.concat(p):s[Ft](p))},Fp(d,"_addUnloadCb",function(){return o},"add")}),e[sa]=function(d){return a(d)[sa]()},e[Cs]=function(){return t},e.setInitialized=function(d){t=d},e[kp]=function(d){i=d},e[Ur]=function(d,p){p?p[Ur](d):i&&Yt(i[Go])&&i[Go](d,null)},e._getTelCtx=a;function a(d){d===void 0&&(d=null);var p=d;if(!p){var f=n||Xo(null,{},e[un]);i&&i[Gp]?p=f[Vu](null,i[Gp]):p=f[Vu](null,i)}return p}function l(d,p,f){d&&zo(d,Iy,[],null,_t),!f&&p&&(f=p[uT]()[xs]());var m=i;i&&i[Gp]&&(m=i[Gp]()),e[un]=p,n=Xo(f,d,p,m)}function c(){t=!1,e[un]=null,n=null,i=null,s=[],o=ug()}}return r.__ieDyn=1,r}()});var Y8,$8=ee(()=>{u();sr();pr();Tn();WK();Wp();ua();Nn();vi();Y8=function(r){In(e,r);function e(){var t=r.call(this)||this;t.identifier="TelemetryInitializerPlugin",t.priority=199;var n,i;o(),Be(e,t,function(s,a){s.addTelemetryInitializer=function(l){var c={id:n++,fn:l};i[Ft](c);var d={remove:function(){Ke(i,function(p,f){if(p.id===c.id)return i[Wu](f,1),-1})}};return d},s[Go]=function(l,c){for(var d=!1,p=i[et],f=0;f<p;++f){var m=i[f];if(m)try{if(m.fn[yy](null,[l])===!1){d=!0;break}}catch(g){Qr(c[sa](),1,64,"One of telemetry initializers failed, telemetry item will not be sent: "+Zm(g),{exception:nn(g)},!0)}}d||s[Ur](l,c)},s[hy]=function(){o()}});function o(){n=0,i=[]}return t}return e.__ieDyn=1,e}(dg)});function wle(r,e){return new mC(e)}function xle(r,e,t){var n,i=[],o={};return Ke(t,function(s){(_t(s)||_t(s[qa]))&&ti(Z8);var a=s[aa],l=s[Ga];s&&a&&(_t(o[a])?o[a]=l:tl(r,"Two extensions have same priority #"+a+" - "+o[a]+", "+l)),(!a||a<e)&&i[Ft](s)}),n={all:t},n[un]=i,n}function X8(r,e){var t=!1;return Ke(e,function(n){if(n===r)return t=!0,-1}),t}function Dle(){var r;return _o((r={},r[Wm]=function(e){},r[Vm]=function(e){},r[Sy]=function(e){},r[Op]=function(e,t){},r[_y]=function(e,t){},r))}var Z8,z8,Q8,Ele,Cle,pg,VK=ee(()=>{"use strict";u();sr();pr();sr();Tn();G8();xK();bC();hK();Wp();Nn();vi();gC();PC();$T();$8();zT();Z8="Plugins must provide initialize method",z8="_notificationManager",Q8="SDK is still unloading...",Ele="SDK is not initialized",Cle={loggingLevelConsole:1};pg=function(){function r(){var e,t,n,i,o,s,a,l,c,d,p,f,m,g,h,v,S,_,D,P,M=0;Be(r,this,function(x){A(),x[Cs]=function(){return t},x[qa]=function(H,de,Pe,ye){g&&ti(Q8),x[Cs]()&&ti("Core should not be initialized more than once"),e=H||{},x[_c]=e,_t(H[cT])&&ti("Please provide instrumentation key"),i=ye,x[z8]=ye,ae(),kt(),yr(),Pe&&(x[Jo]=Pe);var Ce=Kp(e,D7,[]);c=[],c[Ft].apply(c,Fm(Fm([],de,!1),Ce,!1)),f=Kp(e,KL,[]),re(null),(!m||m[et]===0)&&ti("No "+KL+" available"),t=!0,x.releaseQueue()},x.getTransmissionControls=function(){var H=[];return m&&Ke(m,function(de){H[Ft](de.queue)}),$o(H)},x.track=function(H){H.iKey=H.iKey||e[cT],H[Um]=H[Um]||la(new Date),H.ver=H.ver||"4.0",!g&&x[Cs]()?j()[Ur](H):n[Ft](H)},x[uT]=j,x[zE]=function(){return i||(i=Dle(),x[z8]=i),i},x[Wm]=function(H){i&&i[Wm](H)},x[Vm]=function(H){i&&i[Vm](H)},x.getCookieMgr=function(){return a||(a=Yu(e,x[Jo])),a},x.setCookieMgr=function(H){a=H},x[Gm]=function(){if(!o&&!s&&ca(e.enablePerfMgr)){var H=ca(e[FL]);Yt(H)&&(s=H(x,x[zE]()))}return o||s||SK()},x.setPerfMgr=function(H){o=H},x.eventCnt=function(){return n[et]},x.releaseQueue=function(){if(t&&n[et]>0){var H=n;n=[],Ke(H,function(de){j()[Ur](de)})}},x.pollInternalLogs=function(H){v=H||null;var de=ca(e.diagnosticLogInterval);return(!de||!(de>0))&&(de=1e4),M&&clearInterval(M),M=setInterval(function(){Le()},de),M},x[ML]=function(){M&&(clearInterval(M),M=0,Le())},eg(x,function(){return h},["addTelemetryInitializer"]),x.unload=function(H,de,Pe){var ye;H===void 0&&(H=!0),t||ti(Ele),g&&ti(Q8);var Ce=(ye={reason:50},ye[Ya]=H,ye.flushComplete=!1,ye),L=qy(Z(),x);L[QE](function(){A(),de&&de(Ce)},x);function le(me){Ce.flushComplete=me,g=!0,_.run(L,Ce),x[ML](),L[Ur](Ce)}Ee(H,le,6,Pe)||le(!1)},x[jm]=R,x.addPlugin=function(H,de,Pe,ye){if(!H){ye&&ye(!1),$r(Z8);return}var Ce=R(H[Ga]);if(Ce&&!de){ye&&ye(!1),$r("Plugin ["+H[Ga]+"] is already loaded!");return}var L={reason:16};function le(Oe){c[Ft](H),L.added=[H],re(L),ye&&ye(!0)}if(Ce){var me=[Ce.plugin],we={reason:2,isAsync:!!Pe};ge(me,we,function(Oe){Oe?(L.removed=me,L.reason|=32,le(!0)):ye&&ye(!1)})}else le(!1)},x.evtNamespace=function(){return S},x[my]=Ee,x.getTraceCtx=function(H){return P||(P=W8()),P},x.setTraceCtx=function(H){P=H||null},Fp(x,"addUnloadCb",function(){return _},"add");function A(){t=!1,e=Dy(!0,{},Cle),x[_c]=e,x[Jo]=new el(e),x[XE]=[],h=new Y8,n=[],i=null,o=null,s=null,a=null,l=null,d=null,c=[],p=null,f=null,m=null,g=!1,v=null,S=nl("AIBaseCore",!0),_=ug(),P=null}function j(){return Xo(Z(),e,x)}function re(H){var de=xle(x[Jo],TC,c);d=de[un],l=null;var Pe=de.all;if(m=$o(q8(f,Pe,x)),p){var ye=Zn(Pe,p);ye!==-1&&Pe[Wu](ye,1),ye=Zn(d,p),ye!==-1&&d[Wu](ye,1),p._setQueue(m)}else p=J8(m,x);Pe[Ft](p),d[Ft](p),x[XE]=YT(Pe),p[qa](e,x,Pe),GT(j(),Pe),x[XE]=$o(YT(d||[])).slice(),H&&We(H)}function R(H){var de,Pe=null,ye=null;return Ke(x[XE],function(Ce){if(Ce[Ga]===H&&Ce!==p&&Ce!==h)return ye=Ce,-1}),!ye&&p&&(ye=p.getChannel(H)),ye&&(Pe=(de={plugin:ye},de[ZE]=function(Ce){Xu(ye)[nC]=!Ce},de.isEnabled=function(){var Ce=Xu(ye);return!Ce[ws]&&!Ce[nC]},de.remove=function(Ce,L){var le;Ce===void 0&&(Ce=!0);var me=[ye],we=(le={reason:1},le[Ya]=Ce,le);ge(me,we,function(Oe){Oe&&re({reason:32,removed:me}),L&&L(Oe)})},de)),Pe}function Z(){if(!l){var H=(d||[]).slice();Zn(H,h)===-1&&H[Ft](h),l=Cc(YT(H),e,x)}return l}function ge(H,de,Pe){if(H&&H[et]>0){var ye=Cc(H,e,x),Ce=qy(ye,x);Ce[QE](function(){var L=!1,le=[];Ke(c,function(we,Oe){X8(we,H)?L=!0:le[Ft](we)}),c=le;var me=[];f&&(Ke(f,function(we,Oe){var Ze=[];Ke(we,function(N){X8(N,H)?L=!0:Ze[Ft](N)}),me[Ft](Ze)}),f=me),Pe&&Pe(L)}),Ce[Ur](de)}else Pe(!1)}function Le(){var H=x[Jo]?x[Jo].queue:[];H&&(Ke(H,function(de){var Pe,ye=(Pe={},Pe[Ti]=v||"InternalMessageId: "+de[gy],Pe.iKey=ca(e[cT]),Pe.time=la(new Date),Pe.baseType=og.dataType,Pe.baseData={message:de[Tp]},Pe);x.track(ye)}),H[et]=0)}function Ee(H,de,Pe,ye){return p?p[my](H,de,Pe||6,ye):(de&&de(!1),!0)}function ae(){var H=ca(e.disableDbgExt);H===!0&&D&&(i[Vm](D),D=null),i&&!D&&H!==!0&&(D=r8(e),i[Wm](D))}function kt(){var H=ca(e.enablePerfMgr);!H&&s&&(s=null),H&&Kp(e,FL,wle)}function yr(){var H=Kp(e,Iy,{});H.NotificationManager=i}function We(H){var de=DC(Z(),x);(!x._updateHook||x._updateHook(de,H)!==!0)&&de[Ur](H)}function $r(H){var de=x[Jo];de?Qr(de,2,73,H):ti(H)}})}return r.__ieDyn=1,r}()});function QT(r,e,t,n){Ke(r,function(i){if(i&&i[e])if(t)setTimeout(function(){return n(i)},0);else try{n(i)}catch(o){}})}var kC,jK=ee(()=>{u();pr();Tn();Nn();vi();kC=function(){function r(e){this.listeners=[];var t=!!(e||{}).perfEvtsSendAll;Be(r,this,function(n){n[Wm]=function(i){n.listeners[Ft](i)},n[Vm]=function(i){for(var o=Zn(n[Hm],i);o>-1;)n.listeners[Wu](o,1),o=Zn(n[Hm],i)},n[Sy]=function(i){QT(n[Hm],Sy,!0,function(o){o[Sy](i)})},n[Op]=function(i,o){QT(n[Hm],Op,!0,function(s){s[Op](i,o)})},n[_y]=function(i,o){QT(n[Hm],_y,o,function(s){s[_y](i,o)})},n[Lp]=function(i){i&&(t||!i[tC]())&&QT(n[Hm],Lp,!1,function(o){i[Ya]?setTimeout(function(){return o[Lp](i)},0):o[Lp](i)})}})}return r.__ieDyn=1,r}()});var NC,e5=ee(()=>{u();sr();pr();Tn();VK();Wp();Nn();vi();jK();gC();NC=function(r){In(e,r);function e(){var t=r.call(this)||this;return Be(e,t,function(n,i){n[qa]=function(a,l,c,d){i[qa](a,l,c||new el(a),d||new kC(a))},n.track=function(a){Sn(n[Gm](),function(){return"AppInsightsCore:track"},function(){a===null&&(s(a),ti("Invalid telemetry item")),o(a),i.track(a)},function(){return{item:a}},!a.sync)};function o(a){_t(a[Ti])&&(s(a),ti("telemetry name required"))}function s(a){var l=n[zE]();l&&l[Op]([a],2)}}),t}return e.__ieDyn=1,e}(pg)});var xe,Tr,fg,ol,t5,r5,XT,BK,RC,ZT,Gy,sl,Yp,Zu,AC,n5,HK,MC,i5=ee(()=>{u();yT();Tr="Failed",fg=Tr+"MonitorAjax",ol="Track",t5="Start",r5="Stop",XT="Event",BK="AuthContext",RC="Exception",ZT="Local",Gy="Session",sl="Storage",Yp="Browser",Zu="Cannot",AC="Buffer",n5="InstrumentationKey",HK=wo({CRITICAL:1,WARNING:2}),MC=wo((xe={},xe[Yp+"DoesNotSupport"+ZT+sl]=0,xe[Yp+Zu+"Read"+ZT+sl]=1,xe[Yp+Zu+"Read"+Gy+sl]=2,xe[Yp+Zu+"Write"+ZT+sl]=3,xe[Yp+Zu+"Write"+Gy+sl]=4,xe[Yp+Tr+"RemovalFrom"+ZT+sl]=5,xe[Yp+Tr+"RemovalFrom"+Gy+sl]=6,xe[Zu+"SendEmptyTelemetry"]=7,xe.ClientPerformanceMathError=8,xe["ErrorParsingAI"+Gy+"Cookie"]=9,xe.ErrorPVCalc=10,xe[RC+"WhileLoggingError"]=11,xe[Tr+"AddingTelemetryTo"+AC]=12,xe[fg+"Abort"]=13,xe[fg+"Dur"]=14,xe[fg+"Open"]=15,xe[fg+"RSC"]=16,xe[fg+"Send"]=17,xe[fg+"GetCorrelationHeader"]=18,xe[Tr+"ToAddHandlerForOnBeforeUnload"]=19,xe[Tr+"ToSendQueuedTelemetry"]=20,xe[Tr+"ToReportDataLoss"]=21,xe["Flush"+Tr]=22,xe.MessageLimitPerPVExceeded=23,xe.MissingRequiredFieldSpecification=24,xe.NavigationTimingNotSupported=25,xe.OnError=26,xe[Gy+"RenewalDateIsZero"]=27,xe.SenderNotInitialized=28,xe[t5+ol+XT+Tr]=29,xe[r5+ol+XT+Tr]=30,xe[t5+ol+Tr]=31,xe[r5+ol+Tr]=32,xe.TelemetrySampledAndNotSent=33,xe[ol+XT+Tr]=34,xe[ol+RC+Tr]=35,xe[ol+"Metric"+Tr]=36,xe[ol+"PV"+Tr]=37,xe[ol+"PV"+Tr+"Calc"]=38,xe[ol+"Trace"+Tr]=39,xe["Transmission"+Tr]=40,xe[Tr+"ToSet"+sl+AC]=41,xe[Tr+"ToRestore"+sl+AC]=42,xe.InvalidBackendResponse=43,xe[Tr+"ToFixDepricatedValues"]=44,xe.InvalidDurationValue=45,xe.TelemetryEnvelopeInvalid=46,xe.CreateEnvelopeError=47,xe[Zu+"SerializeObject"]=48,xe[Zu+"SerializeObjectNonSerializable"]=49,xe.CircularReferenceDetected=50,xe["Clear"+BK+Tr]=51,xe[RC+"Truncated"]=52,xe.IllegalCharsInName=53,xe.ItemNotInArray=54,xe.MaxAjaxPerPVExceeded=55,xe.MessageTruncated=56,xe.NameTooLong=57,xe.SampleRateOutOfRange=58,xe["Set"+BK+Tr]=59,xe["Set"+BK+Tr+"AccountName"]=60,xe.StringValueTooLong=61,xe.StartCalledMoreThanOnce=62,xe.StopCalledWithoutStart=63,xe["TelemetryInitializer"+Tr]=64,xe.TrackArgumentsNotSpecified=65,xe.UrlTooLong=66,xe[Gy+sl+AC+"Full"]=67,xe[Zu+"AccessCookie"]=68,xe.IdTooLong=69,xe.InvalidEvent=70,xe[fg+"SetRequestHeader"]=71,xe["Send"+Yp+"InfoOnUserInit"]=72,xe["Plugin"+RC]=73,xe["Notification"+RC]=74,xe.SnippetScriptLoadFailure=99,xe["Invalid"+n5]=100,xe[Zu+"ParseAiBlobValue"]=101,xe.InvalidContentBlob=102,xe[ol+"PageAction"+XT+Tr]=103,xe[Tr+"AddingCustomDefinedRequestContext"]=104,xe["InMemory"+sl+AC+"Full"]=105,xe[n5+"Deprecation"]=106,xe))});var ed=ee(()=>{u();x7();j7();e5();VK();WK();MT();kK();Nn();yT();PK();ua();sr();jK();gC();Wp();PC();i5();xK();bC();zT();KK()});var o5,s5,a5,l5,c5,u5,d5=ee(()=>{u();sr();ed();o5=wo({NotSet:0,Pii_DistinguishedName:1,Pii_GenericData:2,Pii_IPV4Address:3,Pii_IPv6Address:4,Pii_MailSubject:5,Pii_PhoneNumber:6,Pii_QueryString:7,Pii_SipAddress:8,Pii_SmtpAddress:9,Pii_Identity:10,Pii_Uri:11,Pii_Fqdn:12,Pii_IPV4AddressLegacy:13,CustomerContent_GenericContent:32}),s5=wo({Normal:1,CostDeferred:2,RealTime:3,Immediate:4}),a5=wo({Unspecified:0,String:1,Int32:2,UInt32:3,Int64:4,UInt64:5,Double:6,Bool:7,Guid:8,DateTime:9}),l5=wo({Normal:1,Critical:2}),c5=wo({NONE:0,ERROR:1,WARNING:2,INFORMATION:3}),u5=$o(Eo(Eo({},MC),wo({AuthHandShakeError:501,AuthRedirectFail:502,BrowserCannotReadLocalStorage:503,BrowserCannotWriteLocalStorage:504,BrowserDoesNotSupportLocalStorage:505,CannotParseBiBlobValue:506,CannotParseDataAttribute:507,CVPluginNotAvailable:508,DroppedEvent:509,ErrorParsingAISessionCookie:510,ErrorProvidedChannels:511,FailedToGetCookies:512,FailedToInitializeCorrelationVector:513,FailedToInitializeSDK:514,InvalidContentBlob:515,InvalidCorrelationValue:516,SessionRenewalDateIsZero:517,SendPostOnCompleteFailure:518,PostResponseHandler:519,SDKNotInitialized:520})))});var al,ek,Ple,KMe,JK,tk,OC=ee(()=>{u();al="",ek="https://browser.events.data.microsoft.com/OneCollector/1.0/",Ple="pluginVersionString",KMe=Ple+"Arr",JK="version",tk="properties"});function Bn(r){return!(r===al||_t(r))}function KC(r){if(r){var e=r.indexOf("-");if(e>-1)return r.substring(0,e)}return al}function YK(){return qK===null&&(qK=!dr(Uint8Array)&&!Ale()&&!Gu()),qK}function FC(r){return!!(r&&Yo(r)&&r>=1&&r<=4)}function UC(r,e,t){if(!e&&!Bn(e)||typeof r!="string")return null;var n=typeof e;if(n==="string"||n==="number"||n==="boolean"||gt(e))e={value:e};else if(n==="object"&&!or.call(e,"value"))e={value:t?JSON.stringify(e):e};else if(_t(e.value)||e.value===al||!dn(e.value)&&!Yo(e.value)&&!Bu(e.value)&&!gt(e.value))return null;if(gt(e.value)&&!nk(e.value))return null;if(!_t(e.kind)){if(gt(e.value)||!Yy(e.kind))return null;e.value=e.value.toString()}return e}function WC(r,e,t){var n=-1;if(!dr(r))if(e>0&&(e===32?n=8192:e<=13&&(n=e<<5)),Rle(t))n===-1&&(n=0),n|=t;else{var i=Nle[ll(r)]||-1;n!==-1&&i!==-1?n|=i:i===6&&(n=i)}return n}function $K(){Hp(null).setEnabled(!1)}function zK(r,e,t){il(null)&&Hp(null).set(r,e,t*86400,null,"/")}function QK(r){il(null)&&Hp(null).del(r)}function XK(r){return il(null)?ZK(Hp(null),r):al}function ZK(r,e,t){t===void 0&&(t=!0);var n;return r&&(n=r.get(e),t&&n&&decodeURIComponent&&(n=decodeURIComponent(n))),n||al}function eF(r){r===void 0&&(r="D");var e=jy();return r==="B"?e="{"+e+"}":r==="P"?e="("+e+")":r==="N"&&(e=e.replace(/-/g,al)),e}function $p(r,e,t,n,i){var o={},s=!1,a=0,l=arguments.length,c=Object[Kt],d=arguments;for(c.toString.call(d[0])==="[object Boolean]"&&(s=d[0],a++);a<l;a++){var r=d[a];Wr(r,function(f,m){s&&m&&ki(m)?gt(m)?(o[f]=o[f]||[],Ke(m,function(g,h){g&&ki(g)?o[f][h]=$p(!0,o[f][h],g):o[f][h]=g})):o[f]=$p(!0,o[f],m):o[f]=m})}return o}function Yy(r){return r===0||r>0&&r<=13||r===32}function Rle(r){return r>=0&&r<=9}function Ale(){var r=Ps();if(!dr(r)&&r.userAgent){var e=r.userAgent.toLowerCase();if((e.indexOf("safari")>=0||e.indexOf("firefox")>=0)&&e.indexOf("chrome")<0)return!0}return!1}function nk(r){return r.length>0}function mg(r,e){var t=r;t.timings=t.timings||{},t.timings.processTelemetryStart=t.timings.processTelemetryStart||{},t.timings.processTelemetryStart[e]=xo()}function ll(r){var e=0;if(r!=null){var t=typeof r;t==="string"?e=1:t==="number"?e=2:t==="boolean"?e=3:t===dt&&(e=4,gt(r)?(e=4096,r.length>0&&(e|=ll(r[0]))):or.call(r,"value")&&(e=8192|ll(r.value)))}return e}function ik(){return!!pn("chrome")}function ok(r,e,t,n,i,o){n===void 0&&(n=!1),i===void 0&&(i=!1);function s(l,c,d){try{l[c]=d}catch(p){}}var a=new XMLHttpRequest;return n&&s(a,Tle,n),t&&s(a,p5,t),a.open(r,e,!i),t&&s(a,p5,t),!i&&o&&s(a,kle,o),a}var td,rk,rd,Tle,p5,kle,Nle,qK,LC,GK,xo,f5,m5,VC=ee(()=>{u();ed();sr();OC();rk="3.2.9",rd="1DS-Web-JS-"+rk,Tle="Microsoft_ApplicationInsights_BypassAjaxInstrumentation",p5="withCredentials",kle="timeout",Nle=(td={},td[0]=0,td[2]=6,td[1]=1,td[3]=7,td[4098]=6,td[4097]=1,td[4099]=7,td),qK=null,LC=!!Qo(),GK=!!Ec();xo=By;f5={Version:rk,FullVersionString:rd,strUndefined:Xt,strObject:dt,Undefined:Xt,arrForEach:Ke,arrIndexOf:Zn,arrMap:Qm,arrReduce:Xm,objKeys:Co,toISOString:la,isReactNative:Gu,isString:dn,isNumber:Yo,isBoolean:Bu,isFunction:Yt,isArray:gt,isObject:ki,strTrim:Vr,isDocumentObjectAvailable:LC,isWindowObjectAvailable:GK,isValueAssigned:Bn,getTenantId:KC,isBeaconsSupported:Up,isUint8ArrayAvailable:YK,isLatency:FC,sanitizeProperty:UC,getISOString:la,useXDomainRequest:ig,getCommonSchemaMetaData:WC,cookieAvailable:il,disallowsSameSiteNone:Ly,setCookie:zK,deleteCookie:QK,getCookie:XK,createGuid:eF,extend:$p,getTime:xo,isValueKind:Yy,isArrayValid:nk,objDefineAccessors:Ds,addPageUnloadEventListener:cg,setProcessTelemetryTimings:mg,addEventHandler:qp,getFieldValueType:ll,strEndsWith:$m,objForEachKey:Wr},m5={_canUseCookies:void 0,isTypeof:Ey,isUndefined:dr,isNullOrUndefined:_t,hasOwnProperty:ju,isFunction:Yt,isObject:ki,isDate:wy,isArray:gt,isError:zm,isString:dn,isNumber:Yo,isBoolean:Bu,toISOString:la,arrForEach:Ke,arrIndexOf:Zn,arrMap:Qm,arrReduce:Xm,strTrim:Vr,objCreate:_o,objKeys:Co,objDefineAccessors:Ds,addEventHandler:qp,dateNow:ei,isIE:Za,disableCookies:$K,newGuid:jy,perfNow:By,newId:jp,randomValue:Oy,random32:rl,mwcRandomSeed:AT,mwcRandom32:yC,generateW3CId:zu}});var Mle,g5,h5=ee(()=>{u();sr();pr();ed();OC();VC();Mle=function(r){In(e,r);function e(){var t=r.call(this)||this;return t.pluginVersionStringArr=[],Be(e,t,function(n,i){(!n.logger||!n.logger.queue)&&(n.logger=new el({loggingLevelConsole:1})),n.initialize=function(o,s,a,l){Sn(n,function(){return"AppInsightsCore.initialize"},function(){var c=n.pluginVersionStringArr;if(o){o.endpointUrl||(o.endpointUrl=ek);var d=o.propertyStorageOverride;d&&(!d.getProperty||!d.setProperty)&&ti("Invalid property storage override passed."),o.channels&&Ke(o.channels,function(m){m&&Ke(m,function(g){if(g.identifier&&g.version){var h=g.identifier+"="+g.version;c.push(h)}})})}n.getWParam=function(){return typeof document!="undefined"||o.enableWParam?0:-1},s&&Ke(s,function(m){if(m&&m.identifier&&m.version){var g=m.identifier+"="+m.version;c.push(g)}}),n.pluginVersionString=c.join(";"),n.pluginVersionStringArr=c;try{i.initialize(o,s,a,l),n.pollInternalLogs("InternalLog")}catch(m){var p=n.logger,f=nn(m);f.indexOf("channels")!==-1&&(f+=`
 - Channels must be provided through config.channels only!`),Qr(p,1,514,"SDK Initialization Failed - no telemetry will be sent: "+f)}},function(){return{config:o,extensions:s,logger:a,notificationManager:l}})},n.track=function(o){Sn(n,function(){return"AppInsightsCore.track"},function(){var s=o;if(s){s.timings=s.timings||{},s.timings.trackStart=xo(),FC(s.latency)||(s.latency=1);var a=s.ext=s.ext||{};a.sdk=a.sdk||{},a.sdk.ver=rd;var l=s.baseData=s.baseData||{};l[tk]=l[tk]||{};var c=l[tk];c[JK]=c[JK]||n.pluginVersionString||al}i.track(s)},function(){return{item:o}},!o.sync)}}),t}return e.__ieDyn=1,e}(NC),g5=Mle});var Ole,v5,y5=ee(()=>{u();sr();pr();ed();OC();VC();Ole=function(r){In(e,r);function e(){var t=r.call(this)||this;return Be(e,t,function(n,i){n.initialize=function(o,s,a,l){o&&!o.endpointUrl&&(o.endpointUrl=ek),n.getWParam=function(){return LC||o.enableWParam?0:-1};try{i.initialize(o,s,a,l)}catch(c){Qr(n.logger,1,514,"Initialization Failed: "+nn(c)+`
 - Note: Channels must be provided through config.channels only`)}},n.track=function(o){var s=o;if(s){var a=s.ext=s.ext||{};a.sdk=a.sdk||{},a.sdk.ver=rd}i.track(s)}}),t}return e.__ieDyn=1,e}(pg),v5=Ole});function Lle(r,e,t){return function(n){r[e]=n,t()}}var gg,Kle,zp,tF=ee(()=>{u();pr();ed();gg=Yt;Kle=function(){function r(e){var t=0,n=null,i=[];Be(r,this,function(c){c.then=function(d,p){return new r(function(f,m){o(d,p,f,m)})},c.catch=function(d){return c.then(null,d)}});function o(c,d,p,f){i.push(function(){var m;try{t===1?m=gg(c)?c(n):n:m=gg(d)?d(n):n,m instanceof r?m.then(p,f):t===2&&!gg(d)?f(m):p(m)}catch(g){f(g);return}}),t!==0&&s()}function s(){if(i.length>0){var c=i.slice();i=[],setTimeout(function(){for(var d=0,p=c.length;d<p;++d)try{c[d]()}catch(f){}},0)}}function a(c){t===0&&(n=c,t=1,s())}function l(c){t===0&&(n=c,t=2,s())}(function(){if(!gg(e))throw new TypeError("ESPromise: resolvedFunc argument is not a Function");try{e(a,l)}catch(d){l(d)}})()}return r.resolve=function(e){return e instanceof r?e:e&&gg(e.then)?new r(function(t,n){try{e.then(t,n)}catch(i){n(i)}}):new r(function(t){t(e)})},r.reject=function(e){return new r(function(t,n){n(e)})},r.all=function(e){if(!(!e||!e.length))return new r(function(t,n){try{for(var i=[],o=0,s=0;s<e.length;s++){var a=e[s];a&&gg(a.then)?(o++,a.then(Lle(i,s,function(){--o===0&&t(i)}),n)):i[s]=a}o===0&&setTimeout(function(){t(i)},0)}catch(l){n(l)}})},r.race=function(e){return new r(function(t,n){if(!(!e||!e.length))try{for(var i=function(s){var a=e[s];a&&gg(a.then)?a.then(t,n):setTimeout(function(){t(a)},0)},o=0;o<e.length;o++)i(o)}catch(s){n(s)}})},r}(),zp=Kle});function $y(){return new Date().getTime()}var Fle,b5,jC,hg,rF,Ule,I5,S5=ee(()=>{u();pr();tF();ed();Fle=6e5,b5=0,jC=[],hg=[],rF=[];Ule=function(){function r(e,t){var n=0,i=(e||"<unnamed>")+"."+b5;b5++,Be(r,this,function(a){var l=null,c=0;a.scheduleEvent=function(p,f,m){var g=i+"."+c;c++,f&&(g+="-("+f+")");var h=g+"{"+n+"}";n++;var v={evt:null,tm:$y(),id:h,isRunning:!1,isAborted:!1};return l?v.evt=A(v,l):v.evt=x(v),l=v,l.evt._schId=h,v.evt;function S(j){for(var re=$y(),R=re-Fle,Z=j.length,ge=0;ge<Z;){var Le=j[ge];if(Le&&Le.tm<R){var Ee=null;Le.abort?(Ee="Aborting ["+Le.id+"] due to Excessive runtime ("+(re-Le.tm)+" ms)",Le.abort(Ee)):Ee="Removing ["+Le.id+"] due to Excessive runtime ("+(re-Le.tm)+" ms)",s(Ee),j.splice(ge,1),Z--}else ge++}}function _(j,re){var R=!1,Z=d(jC,j);if(Z||(Z=d(rF,j),R=!0),Z){Z.to&&(clearTimeout(Z.to),Z.to=null);var ge=$y()-Z.tm;re?R?s("Timed out event ["+j+"] finally complete -- "+ge+" ms"):o("Promise ["+j+"] Complete -- "+ge+" ms"):(rF.push(Z),s("Event ["+j+"] Timed out and removed -- "+ge+" ms"))}else o("Failed to remove ["+j+"] from running queue");l&&l.id===j&&(l=null),S(jC),S(hg),S(rF)}function D(j,re){return function(R){return _(j,!0),re&&re(R),R}}function P(j,re,R,Z){re.then(function(ge){return ge instanceof zp?(o("Event ["+j+"] returned a promise -- waiting"),P(j,ge,R,Z),ge):D(j,R)(ge)},D(j,Z))}function M(j,re){var R=j.id;return new zp(function(Z,ge){o("Event ["+R+"] Starting -- waited for "+(j.wTm||"--")+" ms"),j.isRunning=!0,j.abort=function(Ee){j.abort=null,j.isAborted=!0,_(R,!1),ge(new Error(Ee))};var Le=re(R);Le instanceof zp?(m&&(j.to=setTimeout(function(){_(R,!1),ge(new Error("Timed out after ["+m+"] ms"))},m)),P(R,Le,function(Ee){o("Event ["+R+"] Resolving after "+($y()-j.tm)+" ms"),Z(Ee)},ge)):(o("Promise ["+R+"] Auto completed as the start action did not return a promise"),Z())})}function x(j){var re=$y();return j.wTm=re-j.tm,j.tm=re,j.isAborted?zp.reject(new Error("["+g+"] was aborted")):(jC.push(j),M(j,p))}function A(j,re){var R=new zp(function(Z,ge){var Le=$y()-re.tm,Ee=re.id;o("["+g+"] is waiting for ["+Ee+":"+Le+" ms] to complete before starting -- ["+hg.length+"] waiting and ["+jC.length+"] running"),j.abort=function(ae){j.abort=null,d(hg,g),j.isAborted=!0,ge(new Error(ae))},re.evt.then(function(ae){d(hg,g),x(j).then(Z,ge)},function(ae){d(hg,g),x(j).then(Z,ge)})});return hg.push(j),R}};function d(p,f){for(var m=0;m<p.length;m++)if(p[m].id===f)return p.splice(m,1)[0];return null}});function o(a){var l=Vn();l&&l.QUnit&&console&&console.log("ESPromiseScheduler["+i+"] "+a)}function s(a){tl(t,"ESPromiseScheduler["+i+"] "+a)}}return r.incomplete=function(){return jC},r.waitingToStart=function(){return hg},r}(),I5=Ule});var _5,E5=ee(()=>{u();ed();OC();VC();_5=function(){function r(e){var t=this,n={},i=[],o=[];e&&o.push(e);function s(d,p){var f,m=n[d];if(m&&(f=m[p]),!f&&f!==null){if(dn(d)&&dn(p))if(o.length>0){for(var g=0;g<o.length;g++)if(o[g].handleField(d,p)){f={canHandle:!0,fieldHandler:o[g]};break}}else i.length===0&&(f={canHandle:!0});if(!f&&f!==null){f=null;for(var g=0;g<i.length;g++)if(i[g].handleField(d,p)){f={canHandle:!0,handler:i[g],fieldHandler:null};break}}m||(m=n[d]={}),m[p]=f}return f}t.addSanitizer=function(d){d&&(i.push(d),n={})},t.addFieldSanitizer=function(d){d&&(o.push(d),n={})},t.handleField=function(d,p){var f=s(d,p);return f?f.canHandle:!1},t.value=function(d,p,f,m){var g=s(d,p);if(g&&g.canHandle){if(!g||!g.canHandle)return null;if(g.handler)return g.handler.value(d,p,f,m);if(!dn(p)||_t(f)||f===al)return null;var h=null,v=ll(f);if((v&8192)===8192){var S=v&-8193;if(h=f,!Bn(h.value)||S!==1&&S!==2&&S!==3&&(S&4096)!==4096)return null}else v===1||v===2||v===3||(v&4096)===4096?h=l(d,p,f):v===4&&(h=l(d,p,m?JSON.stringify(f):f));if(h)return a(g,d,p,v,h,m)}return null},t.property=function(d,p,f,m){var g=s(d,p);if(!g||!g.canHandle||!dn(p)||_t(f)||!Bn(f.value))return null;var h=ll(f.value);return h===0?null:a(g,d,p,h,f,m)};function a(d,p,f,m,g,h){if(d.handler)return d.handler.property(p,f,g,h);if(!_t(g.kind)){if((m&4096)===4096||!Yy(g.kind))return null;g.value=g.value.toString()}return c(d.fieldHandler,p,f,m,g)}function l(d,p,f){return Bn(f)?{value:f}:null}function c(d,p,f,m,g){if(g&&d){var h=d.getSanitizer(p,f,m,g.kind,g.propertyType);if(h)if(m===4){var v={},S=g.value;Wr(S,function(D,P){var M=p+"."+f;if(Bn(P)){var x=l(M,D,P);x=c(d,M,D,ll(P),x),x&&(v[D]=x.value)}}),g.value=v}else{var _={path:p,name:f,type:m,prop:g,sanitizer:t};g=h.call(t,_)}}return g}}return r.getFieldType=ll,r}()});var C5={};Nm(C5,{AppInsightsCore:()=>g5,BaseCore:()=>v5,BaseTelemetryPlugin:()=>dg,CoreUtils:()=>m5,DiagnosticLogger:()=>el,ESPromise:()=>zp,ESPromiseScheduler:()=>I5,EventHelper:()=>TK,EventLatency:()=>s5,EventPersistence:()=>l5,EventPropertyType:()=>a5,EventsDiscardedReason:()=>Xa,FullVersionString:()=>rd,InternalAppInsightsCore:()=>NC,InternalBaseCore:()=>pg,LoggingSeverity:()=>HK,MinChannelPriorty:()=>AL,NotificationManager:()=>kC,PerfEvent:()=>sg,PerfManager:()=>mC,ProcessTelemetryContext:()=>UK,TraceLevel:()=>c5,Undefined:()=>Xt,Utils:()=>f5,ValueKind:()=>o5,ValueSanitizer:()=>_5,Version:()=>rk,_ExtendedInternalMessageId:()=>u5,_InternalLogMessage:()=>og,_InternalMessageId:()=>MC,__getRegisteredEvents:()=>DK,_logInternalMessage:()=>yK,_throwInternal:()=>Qr,_warnToConsole:()=>tl,addEventHandler:()=>qp,addEventListeners:()=>BT,addPageHideEventListener:()=>Wy,addPageShowEventListener:()=>Vy,addPageUnloadEventListener:()=>cg,areCookiesSupported:()=>il,arrForEach:()=>Ke,arrIndexOf:()=>Zn,arrMap:()=>Qm,arrReduce:()=>Xm,attachEvent:()=>Fy,cookieAvailable:()=>il,createCookieMgr:()=>Yu,createEnumStyle:()=>wo,createGuid:()=>eF,createProcessTelemetryContext:()=>Xo,createTraceParent:()=>AK,createUniqueNamespace:()=>nl,createUnloadHandlerContainer:()=>ug,dateNow:()=>ei,deleteCookie:()=>QK,detachEvent:()=>Uy,disableCookies:()=>$K,disallowsSameSiteNone:()=>Ly,doPerf:()=>Sn,dumpObj:()=>nn,eventOff:()=>lg,eventOn:()=>ag,extend:()=>$p,findW3cTraceParent:()=>LK,formatTraceParent:()=>OK,generateW3CId:()=>zu,getCommonSchemaMetaData:()=>WC,getConsole:()=>cC,getCookie:()=>XK,getCookieValue:()=>ZK,getCrypto:()=>uC,getDocument:()=>Qo,getExceptionName:()=>Zm,getFieldValueType:()=>ll,getGlobal:()=>Vn,getGlobalInst:()=>pn,getHistory:()=>uK,getIEVersion:()=>dK,getISOString:()=>la,getJSON:()=>Ny,getLocation:()=>rg,getMsCrypto:()=>dC,getNavigator:()=>Ps,getPerformance:()=>ky,getSetValue:()=>Kp,getTenantId:()=>KC,getTime:()=>xo,getWindow:()=>Ec,hasDocument:()=>TT,hasHistory:()=>kT,hasJSON:()=>ng,hasNavigator:()=>lC,hasOwnProperty:()=>ju,hasWindow:()=>aC,isArray:()=>gt,isArrayValid:()=>nk,isBeaconsSupported:()=>Up,isBoolean:()=>Bu,isChromium:()=>ik,isDate:()=>wy,isDocumentObjectAvailable:()=>LC,isError:()=>zm,isFetchSupported:()=>Ry,isFunction:()=>Yt,isIE:()=>Za,isLatency:()=>FC,isNotTruthy:()=>GL,isNullOrUndefined:()=>_t,isNumber:()=>Yo,isObject:()=>ki,isReactNative:()=>Gu,isSampledFlag:()=>MK,isString:()=>dn,isTruthy:()=>xy,isTypeof:()=>Ey,isUint8ArrayAvailable:()=>YK,isUndefined:()=>dr,isValidSpanId:()=>Jy,isValidTraceId:()=>Hy,isValidTraceParent:()=>qT,isValueAssigned:()=>Bn,isValueKind:()=>Yy,isWindowObjectAvailable:()=>GK,isXhrSupported:()=>Ay,mergeEvtNamespace:()=>$u,newGuid:()=>jy,newId:()=>jp,normalizeJsName:()=>Ym,objCreate:()=>_o,objDefineAccessors:()=>Ds,objForEachKey:()=>Wr,objFreeze:()=>$o,objKeys:()=>Co,objSeal:()=>qL,openXhr:()=>ok,optimizeObject:()=>Hu,parseTraceParent:()=>xC,perfNow:()=>By,proxyAssign:()=>YL,proxyFunctionAs:()=>Fp,proxyFunctions:()=>eg,random32:()=>rl,randomValue:()=>Oy,removeEventHandler:()=>jT,removeEventListeners:()=>Jp,removePageHideEventListener:()=>CC,removePageShowEventListener:()=>wC,removePageUnloadEventListener:()=>EC,safeGetCookieMgr:()=>Hp,safeGetLogger:()=>pC,sanitizeProperty:()=>UC,setCookie:()=>zK,setEnableEnvMocks:()=>cK,setProcessTelemetryTimings:()=>mg,setValue:()=>zo,strContains:()=>kn,strEndsWith:()=>$m,strFunction:()=>rn,strObject:()=>dt,strPrototype:()=>Kt,strStartsWith:()=>Cy,strTrim:()=>Vr,strUndefined:()=>Xt,throwError:()=>ti,toISOString:()=>la,useXDomainRequest:()=>ig});var vg=ee(()=>{u();d5();h5();y5();tF();S5();E5();ed();VC()});var yg,sk,ak,nF=ee(()=>{u();yg="REAL_TIME",sk="NEAR_REAL_TIME",ak="BEST_EFFORT"});var cl,lk,w5,ck,x5,iF,D5,P5,T5,oF,sF,uk,k5,aF,N5,lF,dk,cF,pk,fk,mk,BC,uF,R5,zy,dF,gk,HC=ee(()=>{u();cl="",lk="POST",w5="Microsoft_ApplicationInsights_BypassAjaxInstrumentation",ck="drop",x5="send",iF="requeue",D5="rspFail",P5="oth",T5="no-cache, no-store",oF="application/x-json-stream",sF="cache-control",uk="content-type",k5="kill-tokens",aF="kill-duration",N5="kill-duration-seconds",lF="time-delta-millis",dk="client-version",cF="client-id",pk="time-delta-to-apply-millis",fk="upload-time",mk="apikey",BC="AuthMsaDeviceTicket",uF="AuthXToken",R5="NoResponseBody",zy="msfpc",dF="trace",gk="user"});function M5(r){var e=(r.ext||{}).intweb;return e&&Bn(e[zy])?e[zy]:null}function A5(r){for(var e=null,t=0;e===null&&t<r.length;t++)e=M5(r[t]);return e}var Qy,pF=ee(()=>{u();vg();HC();Qy=function(){function r(e,t){var n=t?[].concat(t):[],i=this,o=A5(n);i.iKey=function(){return e},i.Msfpc=function(){return o||cl},i.count=function(){return n.length},i.events=function(){return n},i.addEvent=function(s){return s?(n.push(s),o||(o=M5(s)),!0):!1},i.split=function(s,a){var l;if(s<n.length){var c=n.length-s;_t(a)||(c=a<c?a:c),l=n.splice(s,c),o=A5(n)}return new r(e,l)}}return r.create=function(e,t){return new r(e,t)},r}()});var Wle,O5,L5=ee(()=>{u();pr();Wle=function(){function r(){var e=!0,t=!0,n=!0,i="use-collector-delta",o=!1;Be(r,this,function(s){s.allowRequestSending=function(){return e},s.firstRequestSent=function(){n&&(n=!1,o||(e=!1))},s.shouldAddClockSkewHeaders=function(){return t},s.getClockSkewHeaderValue=function(){return i},s.setClockSkew=function(a){o||(a?(i=a,t=!0,o=!0):t=!1,e=!0)}})}return r.__ieDyn=1,r}(),O5=Wle});var Vle,jle,K5,F5=ee(()=>{u();pr();vg();Vle=1e3,jle=function(){function r(){var e={};function t(n){var i=[];return n&&Ke(n,function(o){i.push(Vr(o))}),i}Be(r,this,function(n){n.setKillSwitchTenants=function(i,o){if(i&&o)try{var s=t(i.split(","));if(o==="this-request-only")return s;for(var a=parseInt(o,10)*Vle,l=0;l<s.length;++l)e[s[l]]=ei()+a}catch(c){return[]}return[]},n.isTenantKilled=function(i){var o=e,s=Vr(i);return o[s]!==void 0&&o[s]>ei()?!0:(delete o[s],!1)}})}return r.__ieDyn=1,r}(),K5=jle});function W5(r){return!(r>=300&&r<500&&r!=408&&r!=429||r==501||r==505)}function hk(r){var e=0,t=U5*Ble,n=U5*Hle,i=Math.floor(Math.random()*(n-t))+t;return e=Math.pow(2,r)*i,Math.min(e,Jle)}var Ble,Hle,U5,Jle,fF=ee(()=>{u();Ble=.8,Hle=1.2,U5=3e3,Jle=6e5});function j5(r,e,t,n){if(n&&r){var i=WC(n.value,n.kind,n.propertyType);if(i>-1){var o=r[V5];o||(o=r[V5]={f:{}});var s=o[vk];if(s||(s=o[vk]={}),e)for(var a=0;a<e.length;a++){var l=e[a];s[l]||(s[l]={f:{}});var c=s[l][vk];c||(c=s[l][vk]={}),s=c}s=s[t]={},gt(n.value)?s.a={t:i}:s.t=i}}}var qle,Gle,B5,H5,Yle,V5,vk,$le,J5,q5=ee(()=>{u();pr();vg();pF();HC();qle=20,Gle=3984588,B5=65e3,H5=2e6,Yle=Math.min(H5,B5),V5="metadata",vk="f",$le=/\./,J5=function(){function r(e,t,n,i){var o="data",s="baseData",a="ext",l=!!i,c=!0,d=t,p={};Be(r,this,function(f){f.createPayload=function(h,v,S,_,D,P){return{apiKeys:[],payloadBlob:cl,overflow:null,sizeExceed:[],failedEvts:[],batches:[],numEvents:0,retryCnt:h,isTeardown:v,isSync:S,isBeacon:_,sendType:P,sendReason:D}},f.appendPayload=function(h,v,S){var _=h&&v&&!h.overflow;return _&&Sn(e,function(){return"Serializer:appendPayload"},function(){for(var D=v.events(),P=h.payloadBlob,M=h.numEvents,x=!1,A=[],j=[],re=h.isBeacon,R=re?B5:Gle,Z=re?Yle:H5,ge=0,Le=0;ge<D.length;){var Ee=D[ge];if(Ee){if(M>=S){h.overflow=v.split(ge);break}var ae=f.getEventBlob(Ee);if(ae&&ae.length<=Z){var kt=ae.length,yr=P.length;if(yr+kt>R){h.overflow=v.split(ge);break}P&&(P+=`
`),P+=ae,Le++,Le>qle&&(P.substr(0,1),Le=0),x=!0,M++}else ae?A.push(Ee):j.push(Ee),D.splice(ge,1),ge--}ge++}if(A&&A.length>0&&h.sizeExceed.push(Qy.create(v.iKey(),A)),j&&j.length>0&&h.failedEvts.push(Qy.create(v.iKey(),j)),x){h.batches.push(v),h.payloadBlob=P,h.numEvents=M;var We=v.iKey();Zn(h.apiKeys,We)===-1&&h.apiKeys.push(We)}},function(){return{payload:h,theBatch:{iKey:v.iKey(),evts:v.events()},max:S}}),_},f.getEventBlob=function(h){try{return Sn(e,function(){return"Serializer.getEventBlob"},function(){var v={};v.name=h.name,v.time=h.time,v.ver=h.ver,v.iKey="o:"+KC(h.iKey);var S={},_=h[a];_&&(v[a]=S,Wr(_,function(M,x){var A=S[M]={};g(x,A,"ext."+M,!0,null,null,!0)}));var D=v[o]={};D.baseType=h.baseType;var P=D[s]={};return g(h.baseData,P,s,!1,[s],function(M,x,A){j5(S,M,x,A)},c),g(h.data,D,o,!1,[],function(M,x,A){j5(S,M,x,A)},c),JSON.stringify(v)},function(){return{item:h}})}catch(v){return null}};function m(h,v){var S=p[h];return S===void 0&&(h.length>=7&&(S=Cy(h,"ext.metadata")||Cy(h,"ext.web")),p[h]=S),S}function g(h,v,S,_,D,P,M){Wr(h,function(x,A){var j=null;if(A||Bn(A)){var re=S,R=x,Z=D,ge=v;if(l&&!_&&$le.test(x)){var Le=x.split("."),Ee=Le.length;if(Ee>1){Z&&(Z=Z.slice());for(var ae=0;ae<Ee-1;ae++){var kt=Le[ae];ge=ge[kt]=ge[kt]||{},re+="."+kt,Z&&Z.push(kt)}R=Le[Ee-1]}}var yr=_&&m(re,R);if(!yr&&d&&d.handleField(re,R)?j=d.value(re,R,A,n):j=UC(R,A,n),j){var We=j.value;if(ge[R]=We,P&&P(Z,R,j),M&&typeof We=="object"&&!gt(We)){var $r=Z;$r&&($r=$r.slice(),$r.push(R)),g(A,We,re+"."+R,_,$r,P,M)}}}})}})}return r.__ieDyn=1,r}()});function Ig(r,e,t){gF[r]=e,t!==!1&&(hF[e]=r)}function Y5(r){try{return r.responseText}catch(e){}return cl}function $5(r,e){var t=!1;if(r&&e){var n=Co(r);if(n&&n.length>0)for(var i=e.toLowerCase(),o=0;o<n.length;o++){var s=n[o];if(s&&ju(e,s)&&s.toLowerCase()===i){t=!0;break}}}return t}function Xy(r,e,t,n){e&&t&&t.length>0&&(n&&gF[e]?(r.hdrs[gF[e]]=t,r.useHdrs=!0):r.url+="&"+e+"="+t)}function z5(r,e){return e&&(Yo(e)?r=[e].concat(r):gt(e)&&(r=e.concat(r))),r}var bg,mF,G5,zle,gF,hF,Q5,X5=ee(()=>{u();pr();L5();F5();vg();HC();fF();q5();mF="sendAttempt",G5="&"+R5+"=true",zle=(bg={},bg[1]=iF,bg[100]=iF,bg[200]="sent",bg[8004]=ck,bg[8003]=ck,bg),gF={},hF={};Ig(BC,BC,!1);Ig(dk,dk);Ig(cF,"Client-Id");Ig(mk,mk);Ig(pk,pk);Ig(fk,fk);Ig(uF,uF);Q5=function(){function r(e,t,n,i,o){this._responseHandlers=[];var s="?cors=true&"+uk.toLowerCase()+"="+oF,a=new K5,l=!1,c=new O5,d=!1,p=0,f,m,g,h,v=!0,S=[],_={},D=[],P=null,M=!1,x,A=!1,j=!1,re,R,Z,ge,Le;Be(r,this,function(Ee){var ae=!0;Ee.initialize=function(F,ue,k,O,X){var ce;X||(X={}),s=F+s,j=dr(X.avoidOptions)?!0:!X.avoidOptions,h=ue,x=ue.getCookieMgr(),M=!h.config.disableEventTimings;var he=!!h.config.enableCompoundKey;f=k,m=f.diagLog();var V=X.valueSanitizer,G=X.stringifyObjects;dr(X.enableCompoundKey)||(he=!!X.enableCompoundKey),re=X.xhrTimeout,R=!!X.disableXhrSync,Z=!!X.disableFetchKeepAlive,Le=X.addNoResponse!==!1,d=!Gu(),P=new J5(h,V,G,he),_t(X.useSendBeacon)||(d=!!X.useSendBeacon);var Y=O,oe=X.alwaysUseXhrOverride?O:null,be=X.alwaysUseXhrOverride?O:null,q=[3,2];if(!O){v=!1;var se=rg();se&&se.protocol&&se.protocol.toLowerCase()==="file:"&&(ae=!1);var K=[];Gu()?(K=[2,1],q=[2,1,3]):K=[1,2,3],K=z5(K,X.transports),O=kt(K,!1),O||tl(m,"No available transport to send events"),Y=kt(K,!0)}oe||(q=z5(q,X.unloadTransports),oe=kt(q,!0)),ge=!v&&(d&&Up()||!Z&&Ry(!0)),g=(ce={},ce[0]=O,ce[1]=Y||kt([1,2,3],!0),ce[2]=oe||Y||kt([1],!0),ce[3]=be||kt([2,3],!0)||Y||kt([1],!0),ce)};function kt(F,ue){for(var k=0,O=null,X=0;O==null&&X<F.length;)k=F[X],k===1?ig()?O=yr:Ay()&&(O=$r):k===2&&Ry(ue)&&(!ue||ue&&!Z)?O=We:d&&k===3&&Up()&&(O=de),X++;return O?{_transport:k,_isSync:ue,sendPOST:O}:null}Ee._getDbgPlgTargets=function(){return[g[0],a,P,g]};function yr(F,ue,k){var O=new XDomainRequest;O.open(lk,F.urlString),F.timeout&&(O.timeout=F.timeout),O.onload=function(){var X=Y5(O);H(ue,200,{},X),Qt(X)},O.onerror=function(){H(ue,400,{})},O.ontimeout=function(){H(ue,500,{})},O.onprogress=function(){},k?O.send(F.data):o.set(function(){O.send(F.data)},0)}function We(F,ue,k){var O,X=F.urlString,ce=!1,he=!1,V=(O={body:F.data,method:lk},O[w5]=!0,O);k&&(V.keepalive=!0,F._sendReason===2&&(ce=!0,Le&&(X+=G5))),ae&&(V.credentials="include"),F.headers&&Co(F.headers).length>0&&(V.headers=F.headers),fetch(X,V).then(function(G){var Y={},oe=cl,be=G.headers;be&&be.forEach(function(q,se){Y[se]=q}),G.body&&G.text().then(function(q){oe=q}),he||(he=!0,H(ue,G.status,Y,oe),Qt(oe))}).catch(function(G){he||(he=!0,H(ue,0,{}))}),ce&&!he&&(he=!0,H(ue,200,{})),!he&&F.timeout>0&&o.set(function(){he||(he=!0,H(ue,500,{}))},F.timeout)}function $r(F,ue,k){var O=F.urlString;function X(G,Y,oe){if(!G[oe]&&Y&&Y.getResponseHeader){var be=Y.getResponseHeader(oe);be&&(G[oe]=Vr(be))}return G}function ce(G){var Y={};return G.getAllResponseHeaders?Y=$e(G.getAllResponseHeaders()):(Y=X(Y,G,lF),Y=X(Y,G,aF),Y=X(Y,G,N5)),Y}function he(G,Y){H(ue,G.status,ce(G),Y)}k&&F.disableXhrSync&&(k=!1);var V=ok(lk,O,ae,!0,k,F.timeout);Wr(F.headers,function(G,Y){V.setRequestHeader(G,Y)}),V.onload=function(){var G=Y5(V);he(V,G),Qt(G)},V.onerror=function(){he(V)},V.ontimeout=function(){he(V)},V.send(F.data)}function H(F,ue,k,O){try{F(ue,k,O)}catch(X){Qr(m,2,518,nn(X))}}function de(F,ue,k){var O=F,X=200,ce=O._thePayload,he=F.urlString+(Le?G5:cl);try{var V=Ps();if(!V.sendBeacon(he,F.data))if(ce){var G=[];Ke(ce.batches,function(Y){if(G&&Y&&Y.count()>0){for(var oe=Y.events(),be=0;be<oe.length;be++)if(!V.sendBeacon(he,P.getEventBlob(oe[be]))){G.push(Y.split(be));break}}else G.push(Y.split(0))}),Ot(G,8003,ce.sendType,!0)}else X=0}catch(Y){tl(m,"Failed to send telemetry using sendBeacon API. Ex:"+nn(Y)),X=0}finally{H(ue,X,{},cl)}}function Pe(F){return F===2||F===3}function ye(F){return A&&Pe(F)&&(F=2),F}Ee.addQueryStringParameter=function(F,ue){for(var k=0;k<S.length;k++)if(S[k].name===F){S[k].value=ue;return}S.push({name:F,value:ue})},Ee.addHeader=function(F,ue){_[F]=ue},Ee.canSendRequest=function(){return Ce()&&c.allowRequestSending()},Ee.sendQueuedRequests=function(F,ue){dr(F)&&(F=0),A&&(F=ye(F),ue=2),le(D,F,0)&&we(L(),0,!1,F,ue||0)},Ee.isCompletelyIdle=function(){return!l&&p===0&&D.length===0},Ee.setUnloading=function(F){A=F},Ee.addBatch=function(F){if(F&&F.count()>0){if(a.isTenantKilled(F.iKey()))return!1;D.push(F)}return!0},Ee.teardown=function(){D.length>0&&we(L(),0,!0,2,2)},Ee.pause=function(){l=!0},Ee.resume=function(){l=!1,Ee.sendQueuedRequests(0,4)},Ee.sendSynchronousBatch=function(F,ue,k){F&&F.count()>0&&(_t(ue)&&(ue=1),A&&(ue=ye(ue),k=2),we([F],0,!1,ue,k||0))};function Ce(){return!l&&p<t}function L(){var F=D;return D=[],F}function le(F,ue,k){var O=!1;return F&&F.length>0&&!l&&g[ue]&&P&&(O=ue!==0||Ce()&&(k>0||c.allowRequestSending())),O}function me(F){var ue={};return F&&Ke(F,function(k,O){ue[O]={iKey:k.iKey(),evts:k.events()}}),ue}function we(F,ue,k,O,X){if(!(!F||F.length===0)){if(l){Ot(F,1,O);return}O=ye(O);try{var ce=F,he=O!==0;Sn(h,function(){return"HttpManager:_sendBatches"},function(V){V&&(F=F.slice(0));for(var G=[],Y=null,oe=xo(),be=g[O]||(he?g[1]:g[0]),q=be&&be._transport,se=ge&&(A||Pe(O)||q===3||be._isSync&&q===2);le(F,O,ue);){var K=F.shift();K&&K.count()>0&&(a.isTenantKilled(K.iKey())?G.push(K):(Y=Y||P.createPayload(ue,k,he,se,X,O),P.appendPayload(Y,K,e)?Y.overflow!==null&&(F=[Y.overflow].concat(F),Y.overflow=null,N(Y,oe,xo(),X),oe=xo(),Y=null):(N(Y,oe,xo(),X),oe=xo(),F=[K].concat(F),Y=null)))}Y&&N(Y,oe,xo(),X),F.length>0&&(D=F.concat(D)),Ot(G,8004,O)},function(){return{batches:me(ce),retryCount:ue,isTeardown:k,isSynchronous:he,sendReason:X,useSendBeacon:Pe(O),sendType:O}},!he)}catch(V){Qr(m,2,48,"Unexpected Exception sending batch: "+nn(V))}}}function Oe(F,ue){var k={url:s,hdrs:{},useHdrs:!1};ue?(k.hdrs=$p(k.hdrs,_),k.useHdrs=Co(k.hdrs).length>0):Wr(_,function(V,G){hF[V]?Xy(k,hF[V],G,!1):(k.hdrs[V]=G,k.useHdrs=!0)}),Xy(k,cF,"NO_AUTH",ue),Xy(k,dk,rd,ue);var O=cl;Ke(F.apiKeys,function(V){O.length>0&&(O+=","),O+=V}),Xy(k,mk,O,ue),Xy(k,fk,ei().toString(),ue);var X=yt(F);if(Bn(X)&&(k.url+="&ext.intweb.msfpc="+X),c.shouldAddClockSkewHeaders()&&Xy(k,pk,c.getClockSkewHeaderValue(),ue),h.getWParam){var ce=h.getWParam();ce>=0&&(k.url+="&w="+ce)}for(var he=0;he<S.length;he++)k.url+="&"+S[he].name+"="+S[he].value;return k}function Ze(F,ue,k){F[ue]=F[ue]||{},F[ue][f.identifier]=k}function N(F,ue,k,O){if(F&&F.payloadBlob&&F.payloadBlob.length>0){var X=!!Ee.sendHook,ce=g[F.sendType];!Pe(F.sendType)&&F.isBeacon&&F.sendReason===2&&(ce=g[2]||g[3]||ce);var he=j;(F.isBeacon||ce._transport===3)&&(he=!1);var V=Oe(F,he);he=he||V.useHdrs;var G=xo();Sn(h,function(){return"HttpManager:_doPayloadSend"},function(){for(var Y=0;Y<F.batches.length;Y++)for(var oe=F.batches[Y],be=oe.events(),q=0;q<be.length;q++){var se=be[q];if(M){var K=se.timings=se.timings||{};Ze(K,"sendEventStart",G),Ze(K,"serializationStart",ue),Ze(K,"serializationCompleted",k)}se[mF]>0?se[mF]++:se[mF]=1}Ot(F.batches,1e3+(O||0),F.sendType,!0);var U={data:F.payloadBlob,urlString:V.url,headers:V.hdrs,_thePayload:F,_sendReason:O,timeout:re,disableXhrSync:R,disableFetchKeepAlive:Z};he&&($5(U.headers,sF)||(U.headers[sF]=T5),$5(U.headers,uk)||(U.headers[uk]=oF));var ne=null;ce&&(ne=function(ke){c.firstRequestSent();var Me=function(di,ku){pe(di,ku,F,O)},Lt=F.isTeardown||F.isSync;try{ce.sendPOST(ke,Me,Lt),Ee.sendListener&&Ee.sendListener(U,ke,Lt,F.isBeacon)}catch(di){tl(m,"Unexpected exception sending payload. Ex:"+nn(di)),H(Me,0,{})}}),Sn(h,function(){return"HttpManager:_doPayloadSend.sender"},function(){if(ne)if(F.sendType===0&&p++,X&&!F.isBeacon&&ce._transport!==3){var ke={data:U.data,urlString:U.urlString,headers:$p({},U.headers),timeout:U.timeout,disableXhrSync:U.disableXhrSync,disableFetchKeepAlive:U.disableFetchKeepAlive},Me=!1;Sn(h,function(){return"HttpManager:_doPayloadSend.sendHook"},function(){try{Ee.sendHook(ke,function(Lt){Me=!0,!v&&!Lt._thePayload&&(Lt._thePayload=Lt._thePayload||U._thePayload,Lt._sendReason=Lt._sendReason||U._sendReason),ne(Lt)},F.isSync||F.isTeardown)}catch(Lt){Me||ne(U)}})}else ne(U)})},function(){return{thePayload:F,serializationStart:ue,serializationCompleted:k,sendReason:O}},F.isSync)}F.sizeExceed&&F.sizeExceed.length>0&&Ot(F.sizeExceed,8003,F.sendType),F.failedEvts&&F.failedEvts.length>0&&Ot(F.failedEvts,8002,F.sendType)}function W(F,ue){M&&Ke(F,function(k){var O=k.timings=k.timings||{};Ze(O,"sendEventCompleted",ue)})}function pe(F,ue,k,O){var X=9e3,ce=null,he=!1,V=!1;try{var G=!0;if(typeof F!==Xt){if(ue){c.setClockSkew(ue[lF]);var Y=ue[aF]||ue["kill-duration-seconds"];Ke(a.setKillSwitchTenants(ue[k5],Y),function(be){Ke(k.batches,function(q){if(q.iKey()===be){ce=ce||[];var se=q.split(0);k.numEvents-=se.count(),ce.push(se)}})})}if(F==200||F==204){X=200;return}(!W5(F)||k.numEvents<=0)&&(G=!1),X=9e3+F%1e3}if(G){X=100;var oe=k.retryCnt;k.sendType===0&&(oe<n?(he=!0,Gt(function(){k.sendType===0&&p--,we(k.batches,oe+1,k.isTeardown,A?2:k.sendType,5)},A,hk(oe))):(V=!0,A&&(X=8001)))}}finally{he||(c.setClockSkew(),Se(k,X,O,V)),Ot(ce,8004,k.sendType)}}function Se(F,ue,k,O){try{O&&f._backOffTransmission(),ue===200&&(!O&&!F.isSync&&f._clearBackOff(),Re(F.batches)),Ot(F.batches,ue,F.sendType,!0)}finally{F.sendType===0&&(p--,k!==5&&Ee.sendQueuedRequests(F.sendType,k))}}function Re(F){if(M){var ue=xo();Ke(F,function(k){k&&k.count()>0&&W(k.events(),ue)})}}function Gt(F,ue,k){ue?F():o.set(F,k)}function $e(F){var ue={};if(dn(F)){var k=Vr(F).split(/[\r\n]+/);Ke(k,function(O){if(O){var X=O.indexOf(": ");if(X!==-1){var ce=Vr(O.substring(0,X)).toLowerCase(),he=Vr(O.substring(X+1));ue[ce]=he}else ue[Vr(O)]=1}})}return ue}function yt(F){for(var ue=0;ue<F.batches.length;ue++){var k=F.batches[ue].Msfpc();if(k)return encodeURIComponent(k)}return cl}function Qt(F){var ue=Ee._responseHandlers;try{for(var k=0;k<ue.length;k++)try{ue[k](F)}catch(X){Qr(m,1,519,"Response handler failed: "+X)}if(F){var O=JSON.parse(F);Bn(O.webResult)&&Bn(O.webResult[zy])&&x.set("MSFPC",O.webResult[zy],365*86400)}}catch(X){}}function Ot(F,ue,k,O){if(F&&F.length>0&&i){var X=i[Dr(ue)];if(X){var ce=k!==0;Sn(h,function(){return"HttpManager:_sendBatchesNotification"},function(){Gt(function(){try{X.call(i,F,ue,ce,k)}catch(he){Qr(m,1,74,"send request notification failed: "+he)}},O||ce,0)},function(){return{batches:me(F),reason:ue,isSync:ce,sendSync:O,sendType:k}},!ce)}}}function Dr(F){var ue=zle[F];return Bn(ue)||(ue=P5,F>=9e3&&F<=9999?ue=D5:F>=8e3&&F<=8999?ue=ck:F>=1e3&&F<=1999&&(ue=x5)),ue}})}return r.__ieDyn=1,r}()});function Qle(r,e){for(var t=[],n=2;n<arguments.length;n++)t[n-2]=arguments[n];return setTimeout(r,e,t)}function Xle(r){clearTimeout(r)}function JC(r,e){return{set:r||Qle,clear:e||Xle}}var Z5=ee(()=>{u()});var Zle,e6,ece,t6,r6,tce,n6,rce,Sg,yk,i6,o6,nce,ice,s6,a6=ee(()=>{u();sr();pr();vg();nF();pF();X5();HC();fF();Z5();Zle=.25,e6=500,ece=20,t6=6,r6=2,tce=4,n6=2,rce=1,Sg="eventsDiscarded",yk="overrideInstrumentationKey",i6="maxEventRetryAttempts",o6="maxUnloadEventRetryAttempts",nce="addUnloadCb",ice=function(r){In(e,r);function e(){var t=r.call(this)||this;t.identifier="PostChannel",t.priority=1011,t.version="3.2.9";var n,i=!1,o=[],s=null,a=!1,l=0,c=500,d=0,p=1e4,f={},m=yg,g=null,h=null,v=0,S=0,_,D,P={},M,x,A=-1,j,re=!0,R=!1,Z=t6,ge=r6,Le,Ee;return Be(e,t,function(ae,kt){Ce(),ae._getDbgPlgTargets=function(){return[D]},ae.initialize=function(V,G,Y){Sn(G,function(){return"PostChannel:initialize"},function(){var oe=G;kt.initialize(V,G,Y);try{var be=!!G[nce];Le=$u(nl(ae.identifier),G.evtNamespace&&G.evtNamespace());var q=ae._getTelCtx();V.extensionConfig[ae.identifier]=V.extensionConfig[ae.identifier]||{},n=q.getExtCfg(ae.identifier),Ee=JC(n.setTimeoutOverride,n.clearTimeoutOverride),re=!n.disableOptimizeObj&&ik(),yr(oe),n.eventsLimitInMem>0&&(p=n.eventsLimitInMem),n.immediateEventLimit>0&&(c=n.immediateEventLimit),n.autoFlushEventsLimit>0&&(M=n.autoFlushEventsLimit),Yo(n[i6])&&(Z=n[i6]),Yo(n[o6])&&(ge=n[o6]),he(),n.httpXHROverride&&n.httpXHROverride.sendPOST&&(_=n.httpXHROverride),Bn(V.anonCookieName)&&D.addQueryStringParameter("anoncknm",V.anonCookieName),D.sendHook=n.payloadPreprocessor,D.sendListener=n.payloadListener;var se=n.overrideEndpointUrl?n.overrideEndpointUrl:V.endpointUrl;ae._notificationManager=G.getNotifyMgr(),D.initialize(se,ae.core,ae,_,n);var K=V.disablePageUnloadEvents||[];cg(We,K,Le),Wy(We,K,Le),Vy($r,V.disablePageShowEvents,Le)}catch(U){throw ae.setInitialized(!1),U}},function(){return{coreConfig:V,core:G,extensions:Y}})},ae.processTelemetry=function(V,G){mg(V,ae.identifier),G=ae._getTelCtx(G);var Y=G.getExtCfg(ae.identifier),oe=!!n.disableTelemetry;Y&&(oe=oe||!!Y.disableTelemetry);var be=V;!oe&&!i&&(n[yk]&&(be.iKey=n[yk]),Y&&Y[yk]&&(be.iKey=Y[yk]),H(be,!0),R?me(2,2):ye()),ae.processNext(be,G)},ae._doTeardown=function(V,G){me(2,2),i=!0,D.teardown(),EC(null,Le),CC(null,Le),wC(null,Le),Ce()};function yr(V){var G=V.getWParam;V.getWParam=function(){var Y=0;return n.ignoreMc1Ms0CookieProcessing&&(Y=Y|2),Y|G()}}function We(V){var G=V||Ec().event;G.type!=="beforeunload"&&(R=!0,D.setUnloading(R)),me(2,2)}function $r(V){R=!1,D.setUnloading(R)}function H(V,G){if(V.sendAttempt||(V.sendAttempt=0),V.latency||(V.latency=1),V.ext&&V.ext[dF]&&delete V.ext[dF],V.ext&&V.ext[gk]&&V.ext[gk].id&&delete V.ext[gk].id,re&&(mg,V.ext=Hu(V.ext),V.baseData&&(V.baseData=Hu(V.baseData)),V.data&&(V.data=Hu(V.data))),V.sync){if(v||a)V.latency=3,V.sync=!1;else if(D){re&&(V=Hu(V)),D.sendSynchronousBatch(Qy.create(V.iKey,[V]),V.sync===!0?1:V.sync,3);return}}var Y=V.latency,oe=d,be=p;Y===4&&(oe=l,be=c);var q=!1;if(oe<be)q=!N(V,G);else{var se=1,K=ece;Y===4&&(se=4,K=1),q=!0,W(V.iKey,V.latency,se,K)&&(q=!N(V,G))}q&&Dr(Sg,[V],Xa.QueueFull)}ae.setEventQueueLimits=function(V,G){p=V>0?V:1e4,M=G>0?G:0,he();var Y=d>V;if(!Y&&x>0)for(var oe=1;!Y&&oe<=3;oe++){var be=P[oe];be&&be.batches&&Ke(be.batches,function(q){q&&q.count()>=x&&(Y=!0)})}Ze(!0,Y)},ae.pause=function(){le(),a=!0,D.pause()},ae.resume=function(){a=!1,D.resume(),ye()},ae.addResponseHandler=function(V){D._responseHandlers.push(V)},ae._loadTransmitProfiles=function(V){$e(),Wr(V,function(G,Y){var oe=Y.length;if(oe>=2){var be=oe>2?Y[2]:0;if(Y.splice(0,oe-2),Y[1]<0&&(Y[0]=-1),Y[1]>0&&Y[0]>0){var q=Y[0]/Y[1];Y[0]=Math.ceil(q)*Y[1]}be>=0&&Y[1]>=0&&be>Y[1]&&(be=Y[1]),Y.push(be),f[G]=Y}})},ae.flush=function(V,G,Y){if(V===void 0&&(V=!0),!a)if(Y=Y||1,V)s==null?(le(),Se(1,0,Y),s=L(function(){s=null,Re(G,Y)},0)):o.push(G);else{var oe=le();de(1,1,Y),G!=null&&G(),oe&&ye()}},ae.setMsaAuthTicket=function(V){D.addHeader(BC,V)},ae.hasEvents=Pe,ae._setTransmitProfile=function(V){m!==V&&f[V]!==void 0&&(le(),m=V,ye())};function de(V,G,Y){var oe=Se(V,G,Y);return D.sendQueuedRequests(G,Y),oe}function Pe(){return d>0}function ye(){if(A>=0&&Se(A,0,j)&&D.sendQueuedRequests(0,j),l>0&&!h&&!a){var V=f[m][2];V>=0&&(h=L(function(){h=null,de(4,0,1),ye()},V))}var G=f[m][1];!g&&!s&&G>=0&&!a&&(Pe()?g=L(function(){g=null,de(S===0?3:1,0,1),S++,S%=2,ye()},G):S=0)}ae._backOffTransmission=function(){v<tce&&(v++,le(),ye())},ae._clearBackOff=function(){v&&(v=0,le(),ye())};function Ce(){n=null,i=!1,o=[],s=null,a=!1,l=0,c=500,d=0,p=1e4,f={},m=yg,g=null,h=null,v=0,S=0,_=null,P={},M=void 0,x=0,A=-1,j=null,re=!0,R=!1,Z=t6,ge=r6,Le=null,Ee=JC(),D=new Q5(e6,n6,rce,{requeue:Qt,send:ue,sent:k,drop:O,rspFail:X,oth:ce},Ee),yt(),we(),he()}function L(V,G){G===0&&v&&(G=1);var Y=1e3;return v&&(Y=hk(v-1)),Ee.set(V,G*Y)}function le(){return g!==null?(Ee.clear(g),g=null,S=0,!0):!1}function me(V,G){le(),s&&(Ee.clear(s),s=null),a||de(1,V,G)}function we(){P[4]={batches:[],iKeyMap:{}},P[3]={batches:[],iKeyMap:{}},P[2]={batches:[],iKeyMap:{}},P[1]={batches:[],iKeyMap:{}}}function Oe(V,G,Y){var oe=P[G];oe||(G=1,oe=P[G]);var be=oe.iKeyMap[V];return!be&&Y&&(be=Qy.create(V),oe.batches.push(be),oe.iKeyMap[V]=be),be}function Ze(V,G){D.canSendRequest()&&!v&&(M>0&&d>M&&(G=!0),G&&s==null&&ae.flush(V,null,20))}function N(V,G){re&&(V=Hu(V));var Y=V.latency,oe=Oe(V.iKey,Y,!0);return oe.addEvent(V)?(Y!==4?(d++,G&&V.sendAttempt===0&&Ze(!V.sync,x>0&&oe.count()>=x)):l++,!0):!1}function W(V,G,Y,oe){for(;Y<=G;){var be=Oe(V,G,!0);if(be&&be.count()>0){var q=be.split(0,oe),se=q.count();if(se>0)return Y===4?l-=se:d-=se,F(Sg,[q],Xa.QueueFull),!0}Y++}return pe(),!1}function pe(){for(var V=0,G=0,Y=function(be){var q=P[be];q&&q.batches&&Ke(q.batches,function(se){be===4?V+=se.count():G+=se.count()})},oe=1;oe<=4;oe++)Y(oe);d=G,l=V}function Se(V,G,Y){var oe=!1,be=G===0;return!be||D.canSendRequest()?Sn(ae.core,function(){return"PostChannel._queueBatches"},function(){for(var q=[],se=4;se>=V;){var K=P[se];K&&K.batches&&K.batches.length>0&&(Ke(K.batches,function(U){D.addBatch(U)?oe=oe||U&&U.count()>0:q=q.concat(U.events()),se===4?l-=U.count():d-=U.count()}),K.batches=[],K.iKeyMap={}),se--}q.length>0&&Dr(Sg,q,Xa.KillSwitch),oe&&A>=V&&(A=-1,j=0)},function(){return{latency:V,sendType:G,sendReason:Y}},!be):(A=A>=0?Math.min(A,V):V,j=Math.max(j,Y)),oe}function Re(V,G){de(1,0,G),pe(),Gt(function(){V&&V(),o.length>0?s=L(function(){s=null,Re(o.shift(),G)},0):(s=null,ye())})}function Gt(V){D.isCompletelyIdle()?V():s=L(function(){s=null,Gt(V)},Zle)}function $e(){le(),yt(),m=yg,ye()}function yt(){f={},f[yg]=[2,1,0],f[sk]=[6,3,0],f[ak]=[18,9,0]}function Qt(V,G){var Y=[],oe=Z;R&&(oe=ge),Ke(V,function(be){be&&be.count()>0&&Ke(be.events(),function(q){q&&(q.sync&&(q.latency=4,q.sync=!1),q.sendAttempt<oe?(mg(q,ae.identifier),H(q,!1)):Y.push(q))})}),Y.length>0&&Dr(Sg,Y,Xa.NonRetryableStatus),R&&me(2,2)}function Ot(V,G){var Y=ae._notificationManager||{},oe=Y[V];if(oe)try{oe.apply(Y,G)}catch(be){Qr(ae.diagLog(),1,74,V+" notification failed: "+be)}}function Dr(V,G){for(var Y=[],oe=2;oe<arguments.length;oe++)Y[oe-2]=arguments[oe];G&&G.length>0&&Ot(V,[G].concat(Y))}function F(V,G){for(var Y=[],oe=2;oe<arguments.length;oe++)Y[oe-2]=arguments[oe];G&&G.length>0&&Ke(G,function(be){be&&be.count()>0&&Ot(V,[be.events()].concat(Y))})}function ue(V,G,Y){V&&V.length>0&&Ot("eventsSendRequest",[G>=1e3&&G<=1999?G-1e3:0,Y!==!0])}function k(V,G){F("eventsSent",V,G),ye()}function O(V,G){F(Sg,V,G>=8e3&&G<=8999?G-8e3:Xa.Unknown)}function X(V){F(Sg,V,Xa.NonRetryableStatus),ye()}function ce(V,G){F(Sg,V,Xa.Unknown),ye()}function he(){!n||!n.disableAutoBatchFlushLimit?x=Math.max(e6*(n6+1),p/6):x=0}Ds(ae,"_setTimeoutOverride",function(){return Ee.set},function(V){Ee=JC(V,Ee.clear)}),Ds(ae,"_clearTimeoutOverride",function(){return Ee.clear},function(V){Ee=JC(Ee.set,V)})}),t}return e.__ieDyn=1,e}(dg),s6=ice});var l6={};Nm(l6,{BE_PROFILE:()=>ak,NRT_PROFILE:()=>sk,PostChannel:()=>s6,RT_PROFILE:()=>yg});var c6=ee(()=>{u();a6();nF()});var oce,u6,d6=ee(()=>{u();oce=async(r,e,t)=>{let n=await Promise.resolve().then(()=>(vg(),C5)),i=await Promise.resolve().then(()=>(c6(),l6)),o=new n.AppInsightsCore,s=new i.PostChannel,a={instrumentationKey:r,endpointUrl:"https://mobile.events.data.microsoft.com/OneCollector/1.0",loggingLevelTelemetry:0,loggingLevelConsole:0,disableCookiesUsage:!0,disableDbgExt:!0,disableInstrumentationKeyValidation:!0,channels:[[s]]};if(t){a.extensionConfig={};let d={alwaysUseXhrOverride:!0,httpXHROverride:t};a.extensionConfig[s.identifier]=d}let c=e.workspace.getConfiguration("telemetry").get("internalTesting");return o.initialize(a,[]),o.addTelemetryInitializer(d=>{var p,f;c&&(d.ext=(p=d.ext)!=null?p:{},d.ext.utc=(f=d.ext.utc)!=null?f:{},d.ext.utc.flags=8462029)}),o},u6=async(r,e,t)=>{let n=await oce(r,e,t);return{logEvent:(o,s)=>{try{n==null||n.track({name:o,baseData:{name:o,properties:s==null?void 0:s.properties,measurements:s==null?void 0:s.measurements}})}catch(a){throw new Error(`Failed to log event to app insights!
`+a.message)}},flush:async()=>{try{n==null||n.unload()}catch(o){throw new Error(`Failed to flush app insights!
`+o.message)}}}}});var nd,bk,p6=ee(()=>{u();(function(r){r[r.NOT_INSTANTIATED=0]="NOT_INSTANTIATED",r[r.INSTANTIATING=1]="INSTANTIATING",r[r.INSTANTIATED=2]="INSTANTIATED"})(nd||(nd={}));bk=class{constructor(e,t){this._instantiationStatus=nd.NOT_INSTANTIATED,this._eventQueue=[],this._exceptionQueue=[],this._clientFactory=t,this._key=e}sendEventData(e,t){if(!this._telemetryClient){this._instantiationStatus!==nd.INSTANTIATED&&this._eventQueue.push({eventName:e,data:t});return}this._telemetryClient.logEvent(e,t)}sendErrorData(e,t){if(!this._telemetryClient){this._instantiationStatus!==nd.INSTANTIATED&&this._exceptionQueue.push({exception:e,data:t});return}}async flush(){this._telemetryClient&&(await this._telemetryClient.flush(),this._telemetryClient=void 0)}_flushQueues(){this._eventQueue.forEach(({eventName:e,data:t})=>this.sendEventData(e,t)),this._eventQueue=[],this._exceptionQueue.forEach(({exception:e,data:t})=>this.sendErrorData(e,t)),this._exceptionQueue=[]}instantiateSender(){this._instantiationStatus===nd.NOT_INSTANTIATED&&(this._instantiationStatus=nd.INSTANTIATING,this._clientFactory(this._key).then(e=>{this._telemetryClient=e,this._instantiationStatus=nd.INSTANTIATED,this._flushQueues()}).catch(e=>{console.error(e),this._instantiationStatus=nd.INSTANTIATED}))}}});var Ik,f6=ee(()=>{u();Ik=class{constructor(e,t,n){this.telemetrySender=e,this.vscodeAPI=t,this.userOptIn=!1,this.errorOptIn=!1,this.disposables=[],this._onDidChangeTelemetryLevel=new this.vscodeAPI.EventEmitter,this.onDidChangeTelemetryLevel=this._onDidChangeTelemetryLevel.event,this.telemetryLogger=this.vscodeAPI.env.createTelemetryLogger(this.telemetrySender,n),this.updateUserOptIn(),this.telemetryLogger.onDidChangeEnableStates(()=>{this.updateUserOptIn()})}updateUserOptIn(){this.errorOptIn=this.telemetryLogger.isErrorsEnabled,this.userOptIn=this.telemetryLogger.isUsageEnabled,(this.telemetryLogger.isErrorsEnabled||this.telemetryLogger.isUsageEnabled)&&this.telemetrySender.instantiateSender(),this._onDidChangeTelemetryLevel.fire(this.telemetryLevel)}get telemetryLevel(){return this.errorOptIn&&this.userOptIn?"all":this.errorOptIn?"error":"off"}internalSendTelemetryEvent(e,t,n,i){i?this.telemetrySender.sendEventData(e,{properties:t,measurements:n}):this.telemetryLogger.logUsage(e,{properties:t,measurements:n})}sendTelemetryEvent(e,t,n){this.internalSendTelemetryEvent(e,t,n,!1)}sendDangerousTelemetryEvent(e,t,n){this.telemetrySender.instantiateSender(),this.internalSendTelemetryEvent(e,t,n,!0)}internalSendTelemetryErrorEvent(e,t,n,i){i?this.telemetrySender.sendEventData(e,{properties:t,measurements:n}):this.telemetryLogger.logError(e,{properties:t,measurements:n})}sendTelemetryErrorEvent(e,t,n){this.internalSendTelemetryErrorEvent(e,t,n,!1)}sendDangerousTelemetryErrorEvent(e,t,n){this.telemetrySender.instantiateSender(),this.internalSendTelemetryErrorEvent(e,t,n,!0)}internalSendTelemetryException(e,t,n,i){i?this.telemetrySender.sendErrorData(e,{properties:t,measurements:n}):this.telemetryLogger.logError(e,{properties:t,measurements:n})}sendTelemetryException(e,t,n){this.internalSendTelemetryException(e,t,n,!1)}sendDangerousTelemetryException(e,t,n){this.telemetrySender.instantiateSender(),this.internalSendTelemetryException(e,t,n,!0)}dispose(){return this.telemetryLogger.dispose(),Promise.all(this.disposables.map(e=>e.dispose()))}}});var Zy,m6=ee(()=>{u();Zy=class r{static applyReplacements(e,t){for(let n of Object.keys(e))for(let i of t)i.lookup.test(n)&&(i.replacementString!==void 0?e[n]=i.replacementString:delete e[n])}static shouldUseOneDataSystemSDK(e){return e.length===74&&e[32]==="-"&&e[41]==="-"&&e[46]==="-"&&e[51]==="-"&&e[56]==="-"&&e[69]==="-"}static getAdditionalCommonProperties(e){return{"common.os":e.platform,"common.nodeArch":e.architecture,"common.platformversion":(e.release||"").replace(/^(\d+)(\.\d+)?(\.\d+)?(.*)/,"$1$2$3"),"common.telemetryclientversion":"0.7.7"}}static getInstance(){return r._instance||(r._instance=new r),r._instance}}});var Sk,eb,id,_k,tb,vF,qC,yF,g6,da,Ek=ee(()=>{u();Sk="name",eb="push",id="length",_k="messageId",tb="message",vF="diagLog",qC="replace",yF="enableDebugExceptions",g6="logInternalMessage",da="call"});var ul,Ck,wk,xk=ee(()=>{u();ul="",Ck="errorToConsole",wk="warnToConsole"});function Dk(r){return r===void 0||typeof r===Xt}function _g(r){return r===null||Dk(r)}function Eg(r){return!!(r&&typeof r===dt)}function GC(r){return!!(r&&typeof r===rn)}function wc(r,e){if(r)for(var t in r)or[da](r,t)&&e[da](r,t,r[t])}function mce(r){return!!(r&&E6[da](r)==="[object Array]")}function YC(r){return!!(r&&E6[da](r)==="[object Error]")}function Zo(r){return typeof r=="string"}function Pk(r){if(r)return dce?r[S6]():gce(r)}function gce(r){if(r&&r.getUTCFullYear){var e=function(t){var n=String(t);return n[id]===1&&(n="0"+n),n};return r.getUTCFullYear()+"-"+e(r.getUTCMonth()+1)+"-"+e(r.getUTCDate())+"T"+e(r.getUTCHours())+":"+e(r.getUTCMinutes())+":"+e(r.getUTCSeconds())+"."+String((r.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"}}function $C(r,e,t){var n=r[id];try{for(var i=0;i<n&&!(i in r&&e[da](t||r,r[i],i,r)===-1);i++);}catch(o){}}function EF(r,e,t){if(r){if(r[h6])return r[h6](e,t);var n=r[id],i=t||0;try{for(var o=Math.max(i>=0?i:n-Math.abs(i),0);o<n;o++)if(o in r&&r[o]===e)return o}catch(s){}}return-1}function wg(r,e,t){var n;if(r){if(r[v6])return r[v6](e,t);var i=r[id],o=t||r;n=new Array(i);try{for(var s=0;s<i;s++)s in r&&(n[s]=e[da](o,r[s],r))}catch(a){}}return n}function CF(r,e,t){var n;if(r){if(r[y6])return r[y6](e,t);var i=r[id],o=0;if(arguments[id]>=3)n=arguments[2];else{for(;o<i&&!(o in r);)o++;n=r[o++]}for(;o<i;)o in r&&(n=e(n,r[o],o,r)),o++}return n}function dl(r){return r&&(r=cce&&r[IF]?r[IF]():r[qC]?r[qC](/^\s+|(?=\s)\s+$/g,ul):r),r}function wF(r){var e=typeof r;if(e!==rn&&(e!==dt||r===null)&&oa("objKeys called on non-object"),!I6&&b6)return b6(r);var t=[];for(var n in r)r&&or[da](r,n)&&t[eb](n);if(I6)for(var i=bF[id],o=0;o<i;o++)r&&or[da](r,bF[o])&&t[eb](bF[o]);return t}function hce(r){return r}function Tk(r){return SF&&wc(r,function(e,t){(Cg(t)||Eg(t))&&SF(t)}),C6(r)}function zC(r){return YC(r)?r[Sk]:ul}function QC(r,e){return _g(r)?e:r}function xF(r){return function(){function e(){var t=this;r&&wc(r,function(n,i){t[n]=i})}return e}()}var S6,ace,lce,h6,v6,y6,IF,_6,SF,FLe,b6,_F,cce,ULe,WLe,uce,dce,pce,E6,fce,VLe,Cg,I6,bF,C6,kk=ee(()=>{u();sr();Ek();xk();S6="toISOString",ace="endsWith",lce="startsWith",h6="indexOf",v6="map",y6="reduce",IF="trim",_6="toString",SF=Er.freeze,FLe=Er.seal,b6=Er.keys,_F=String[Kt],cce=_F[IF],ULe=_F[ace],WLe=_F[lce],uce=Date[Kt],dce=uce[S6],pce=Array.isArray,E6=ia[_6],fce=or[_6],VLe=fce[da](Er);Cg=pce||mce;I6=!{toString:null}.propertyIsEnumerable("toString"),bF=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"];C6=SF||hce});function rb(r){var e={};return wc(r,function(t,n){e[t]=n,e[n]=t}),Tk(e)}function DF(r){var e={};return wc(r,function(t,n){e[t]=n[1],e[n[0]]=n[1]}),Tk(e)}var w6=ee(()=>{u();kk()});function od(r){var e=Vn();return e&&e[r]?e[r]:r===vce&&D6()?window:null}function D6(){return!!(typeof window===dt&&window)}function P6(){return!!(typeof document===dt&&document)}function PF(){return P6()?document:od(yce)}function TF(){return typeof console!==Xt?console:od(bce)}function xg(){return!!(typeof JSON===dt&&JSON||od(x6)!==null)}function nb(){return xg()?JSON||od(x6):null}function Dg(r){var e=Object[Kt].toString[da](r),t=ul;return e==="[object Error]"?t="{ stack: '"+r.stack+"', message: '"+r.message+"', name: '"+r[Sk]+"'":xg()&&(t=nb().stringify(r)),e+t}var vce,yce,bce,x6,Nk=ee(()=>{"use strict";u();sr();Ek();xk();vce="window",yce="document",bce="console",x6="JSON"});function Ice(){var r=od("Microsoft");return r&&(Rk=r.ApplicationInsights),Rk}function T6(r){var e=Rk;return!e&&r.disableDbgExt!==!0&&(e=Rk||Ice()),e?e.ChromeDbgExt:null}var Rk,k6=ee(()=>{u();Nk();Rk=null});function N6(r){return r?'"'+r[qC](/\"/g,ul)+'"':ul}function R6(r,e){var t=TF();if(t){var n="log";t[r]&&(n=r),GC(t[n])&&t[n](e)}}function Cce(r){return r||new A6}function pl(r,e,t,n,i,o){o===void 0&&(o=!1),Cce(r).throwInternal(e,t,n,i,o)}var Sce,_ce,Ece,kF,A6,M6=ee(()=>{"use strict";u();pr();Ek();k6();Nk();kk();xk();Sce="AI (Internal): ",_ce="AI: ",Ece="AITR_";kF=function(){function r(e,t,n,i){n===void 0&&(n=!1);var o=this;o[_k]=e,o[tb]=(n?_ce:Sce)+e;var s=ul;xg()&&(s=nb().stringify(i));var a=(t?" message:"+N6(t):ul)+(i?" props:"+N6(s):ul);o[tb]+=a}return r.dataType="MessageData",r}(),A6=function(){function r(e){this.identifier="DiagnosticLogger",this.queue=[];var t=0,n={},i,o,s,a;Be(r,this,function(l){d(e||{}),l.consoleLoggingLevel=function(){return i},l.telemetryLoggingLevel=function(){return o},l.maxInternalMessageLimit=function(){return s},l[yF]=function(){return a},l.throwInternal=function(m,g,h,v,S){S===void 0&&(S=!1);var _=new kF(g,h,S,v);if(a)throw Dg(_);var D=m===1?Ck:wk;if(Dk(_[tb]))f("throw"+(m===1?"Critical":"Warning"),_);else{if(S){var P=+_[_k];!n[P]&&i>=m&&(l[D](_[tb]),n[P]=!0)}else i>=m&&l[D](_[tb]);c(m,_)}},l[wk]=function(m){R6("warn",m),f("warning",m)},l[Ck]=function(m){R6("error",m),f("error",m)},l.resetInternalMessageCount=function(){t=0,n={}},l[g6]=c;function c(m,g){if(!p()){var h=!0,v=Ece+g[_k];if(n[v]?h=!1:n[v]=!0,h&&(m<=o&&(l.queue[eb](g),t++,f(m===1?"error":"warn",g)),t===s)){var S="Internal events throttle limit per PageView reached for this app.",_=new kF(23,S,!1);l.queue[eb](_),m===1?l[Ck](S):l[wk](S)}}}function d(m){i=QC(m.loggingLevelConsole,0),o=QC(m.loggingLevelTelemetry,1),s=QC(m.maxMessageLimit,25),a=QC(m[yF],!1)}function p(){return t>=s}function f(m,g){var h=T6(e||{});h&&h[vF]&&h[vF](m,g)}})}return r.__ieDyn=1,r}()});var pa=ee(()=>{u();kk();w6();Nk();sr();M6()});var XC,ZC,ew,Ak,Pg,sd,Ni,fl=ee(()=>{u();XC="Microsoft_ApplicationInsights_BypassAjaxInstrumentation",ZC="sampleRate",ew="ProcessLegacy",Ak="http.method",Pg="https://dc.services.visualstudio.com",sd="/v2/track",Ni="not_specified"});var Tg,Rt,kg,tw,ml,O6,Qi,ad,L6,rw,nw,Mk,Ng,fa,Xi,Zi,Rg,xc,Ag,Ok,Lk,NF,Mg,iw,ow,Og,ib,ob,Lg,RF,Kg,K6,F6,U6,W6,Do=ee(()=>{u();Tg="split",Rt="length",kg="toLowerCase",tw="ingestionendpoint",ml="toString",O6="removeItem",Qi="name",ad="message",L6="count",rw="stringify",nw="pathname",Mk="indexOf",Ng="exceptions",fa="parsedStack",Xi="properties",Zi="measurements",Rg="sizeInBytes",xc="typeName",Ag="severityLevel",Ok="problemGroup",Lk="isManual",NF="CreateFromInterface",Mg="assembly",iw="hasFullStack",ow="level",Og="method",ib="fileName",ob="line",Lg="duration",RF="receivedResponse",Kg="substring",K6="sanitizeKeyAndAddUniqueness",F6="sanitizeException",U6="sanitizeProperties",W6="sanitizeMeasurements"});function Kk(r){(isNaN(r)||r<0)&&(r=0),r=Math.round(r);var e=sw+r%1e3,t=sw+Math.floor(r/1e3)%60,n=sw+Math.floor(r/(1e3*60))%60,i=sw+Math.floor(r/(1e3*60*60))%24,o=Math.floor(r/(1e3*60*60*24));return e=e[Rt]===1?"00"+e:e[Rt]===2?"0"+e:e,t=t[Rt]<2?"0"+t:t,n=n[Rt]<2?"0"+n:n,i=i[Rt]<2?"0"+i:i,(o>0?o+".":sw)+i+":"+n+":"+t+"."+e}var sw,AF=ee(()=>{u();Do();sw=""});var sb,V6=ee(()=>{u();pa();sb=DF({requestContextHeader:[0,"Request-Context"],requestContextTargetKey:[1,"appId"],requestContextAppIdFormat:[2,"appId=cid-v1:"],requestIdHeader:[3,"Request-Id"],traceParentHeader:[4,"traceparent"],traceStateHeader:[5,"tracestate"],sdkContextHeader:[6,"Sdk-Context"],sdkContextHeaderAppIdRequest:[7,"appId"],requestContextHeaderLowerCase:[8,"request-context"]})});var Fk,_Fe,j6=ee(()=>{u();pa();Fk=rb({LocalStorage:0,SessionStorage:1}),_Fe=rb({AI:0,AI_AND_W3C:1,W3C:2})});function B6(r){try{if(_g(Vn()))return null;var e=new Date()[ml](),t=od(r===Fk.LocalStorage?"localStorage":"sessionStorage");t.setItem(e,e);var n=t.getItem(e)!==e;if(t[O6](e),!n)return t}catch(i){}return null}function H6(){return Uk()?B6(Fk.SessionStorage):null}function Uk(r){return(r||aw===void 0)&&(aw=!!B6(Fk.SessionStorage)),aw}function MF(r,e){var t=H6();if(t!==null)try{return t.getItem(e)}catch(n){aw=!1,pl(r,2,2,"Browser failed read of session storage. "+zC(n),{exception:Dg(n)})}return null}function Wk(r,e,t){var n=H6();if(n!==null)try{return n.setItem(e,t),!0}catch(i){aw=!1,pl(r,2,4,"Browser failed write to session storage. "+zC(i),{exception:Dg(i)})}return!1}var aw,J6=ee(()=>{u();pa();j6();Do();aw=void 0});function Vk(r,e,t){var n=e[Rt],i=OF(r,e);if(i[Rt]!==n){for(var o=0,s=i;t[s]!==void 0;)o++,s=i[Kg](0,150-3)+LF(o);i=s}return i}function OF(r,e){var t;return e&&(e=dl(e[ml]()),e[Rt]>150&&(t=e[Kg](0,150),pl(r,2,57,"name is too long.  It has been truncated to 150 characters.",{name:e},!0))),t||e}function Xr(r,e,t){t===void 0&&(t=1024);var n;return e&&(t=t||1024,e=dl(e),e.toString()[Rt]>t&&(n=e[ml]()[Kg](0,t),pl(r,2,61,"string value is too long. It has been truncated to "+t+" characters.",{value:e},!0))),n||e}function Qp(r,e){return Hk(r,e,2048,66)}function ab(r,e){var t;return e&&e[Rt]>32768&&(t=e[Kg](0,32768),pl(r,2,56,"message is too long, it has been truncated to 32768 characters.",{message:e},!0)),t||e}function jk(r,e){var t;if(e){var n=""+e;n[Rt]>32768&&(t=n[Kg](0,32768),pl(r,2,52,"exception is too long, it has been truncated to 32768 characters.",{exception:e},!0))}return t||e}function eo(r,e){if(e){var t={};wc(e,function(n,i){if(Eg(i)&&xg())try{i=nb()[rw](i)}catch(o){pl(r,2,49,"custom property is not valid",{exception:o},!0)}i=Xr(r,i,8192),n=Vk(r,n,t),t[n]=i}),e=t}return e}function to(r,e){if(e){var t={};wc(e,function(n,i){n=Vk(r,n,t),t[n]=i}),e=t}return e}function Bk(r,e){return e&&Hk(r,e,128,69)[ml]()}function Hk(r,e,t,n){var i;return e&&(e=dl(e),e[Rt]>t&&(i=e[Kg](0,t),pl(r,2,n,"input is too long, it has been truncated to "+t+" characters.",{data:e},!0))),i||e}function LF(r){var e="00"+r;return e.substr(e[Rt]-3)}var es,kce,gl=ee(()=>{u();pa();Do();kce=(es={MAX_NAME_LENGTH:150,MAX_ID_LENGTH:128,MAX_PROPERTY_LENGTH:8192,MAX_STRING_LENGTH:1024,MAX_URL_LENGTH:2048,MAX_MESSAGE_LENGTH:32768,MAX_EXCEPTION_LENGTH:32768},es[K6]=Vk,es.sanitizeKey=OF,es.sanitizeString=Xr,es.sanitizeUrl=Qp,es.sanitizeMessage=ab,es[F6]=jk,es[U6]=eo,es[W6]=to,es.sanitizeId=Bk,es.sanitizeInput=Hk,es.padNumber=LF,es.trim=dl,es)});function Y6(r){var e=G6,t=Nce,n=t[e];return q6.createElement?t[e]||(n=t[e]=q6.createElement("a")):n={host:$6(r,!0)},n.href=r,e++,e>=t[Rt]&&(e=0),G6=e,n}function $6(r,e){var t=z6(r,e)||"";if(t){var n=t.match(/(www\d{0,5}\.)?([^\/:]{1,256})(:\d{1,20})?/i);if(n!=null&&n[Rt]>3&&Zo(n[2])&&n[2][Rt]>0)return n[2]+(n[3]||"")}return t}function z6(r,e){var t=null;if(r){var n=r.match(/(\w{1,150}):\/\/([^\/:]{1,256})(:\d{1,20})?/i);if(n!=null&&n[Rt]>2&&Zo(n[2])&&n[2][Rt]>0&&(t=n[2]||"",e&&n[Rt]>2)){var i=(n[1]||"")[kg](),o=n[3]||"";(i==="http"&&o===":80"||i==="https"&&o===":443")&&(o=""),t+=o}}return t}var q6,G6,Nce,Q6=ee(()=>{u();pa();Do();q6=PF()||{},G6=0,Nce=[null,null,null,null,null]});function lw(r){return EF(Rce,r[kg]())!==-1}function X6(r,e,t,n){var i,o=n,s=n;if(e&&e[Rt]>0){var a=Y6(e);if(i=a.host,!o)if(a[nw]!=null){var l=a.pathname[Rt]===0?"/":a[nw];l.charAt(0)!=="/"&&(l="/"+l),s=a[nw],o=Xr(r,t?t+" "+l:l)}else o=Xr(r,e)}else i=n,o=n;return{target:i,name:o,data:s}}var Rce,KF=ee(()=>{u();pa();fl();gl();Q6();Do();Rce=[Pg+sd,"https://breeze.aimon.applicationinsights.io"+sd,"https://dc-int.services.visualstudio.com"+sd]});function FF(r){if(!r)return{};var e=r[Tg](Ace),t=CF(e,function(i,o){var s=o[Tg](Mce);if(s[Rt]===2){var a=s[0][kg](),l=s[1];i[a]=l}return i},{});if(wF(t)[Rt]>0){if(t.endpointsuffix){var n=t.location?t.location+".":"";t[tw]=t[tw]||"https://"+n+"dc."+t.endpointsuffix}t[tw]=t[tw]||Pg}return t}var Ace,Mce,Z6=ee(()=>{u();pa();fl();Do();Ace=";",Mce="="});var UF,e3=ee(()=>{u();pa();fl();Do();gl();UF=function(){function r(e,t,n){var i=this,o=this;o.ver=1,o.sampleRate=100,o.tags={},o[Qi]=Xr(e,n)||Ni,o.data=t,o.time=Pk(new Date),o.aiDataContract={time:1,iKey:1,name:1,sampleRate:function(){return i.sampleRate===100?4:1},tags:1,data:1}}return r}()});var ld,t3=ee(()=>{u();fl();Do();gl();ld=function(){function r(e,t,n,i){this.aiDataContract={ver:1,name:1,properties:0,measurements:0};var o=this;o.ver=2,o[Qi]=Xr(e,t)||Ni,o[Xi]=eo(e,n),o[Zi]=to(e,i)}return r.envelopeType="Microsoft.ApplicationInsights.{0}.Event",r.dataType="EventData",r}()});function BF(r,e){var t=r;return t&&!Zo(t)&&(JSON&&JSON[rw]?(t=JSON[rw](r),e&&(!t||t==="{}")&&(GC(r[ml])?t=r[ml]():t=""+r)):t=""+r+" - (Missing JSON.stringify)"),t||""}function s3(r,e){var t=r;return r&&(t&&!Zo(t)&&(t=r[jF]||r[o3]||t),t&&!Zo(t)&&(t=BF(t,!0)),r.filename&&(t=t+" @"+(r.filename||"")+":"+(r.lineno||"?")+":"+(r.colno||"?"))),e&&e!=="String"&&e!=="Object"&&e!=="Error"&&(t||"")[Mk](e)===-1&&(t=e+": "+t),t||""}function Lce(r){try{if(Eg(r))return"hasFullStack"in r&&"typeName"in r}catch(e){}return!1}function Kce(r){try{if(Eg(r))return"ver"in r&&"exceptions"in r&&"properties"in r}catch(e){}return!1}function n3(r){return r&&r.src&&Zo(r.src)&&r.obj&&Cg(r.obj)}function Fg(r){var e=r||"";Zo(e)||(Zo(e[ts])?e=e[ts]:e=""+e);var t=e[Tg](`
`);return{src:e,obj:t}}function Fce(r){for(var e=[],t=r[Tg](`
`),n=0;n<t[Rt];n++){var i=t[n];t[n+1]&&(i+="@"+t[n+1],n++),e.push(i)}return{src:r,obj:e}}function a3(r){var e=null;if(r)try{if(r[ts])e=Fg(r[ts]);else if(r[lb]&&r[lb][ts])e=Fg(r[lb][ts]);else if(r.exception&&r.exception[ts])e=Fg(r.exception[ts]);else if(n3(r))e=r;else if(n3(r[VF]))e=r[VF];else if(window&&window.opera&&r[jF])e=Fce(r[ad]);else if(r.reason&&r.reason[ts])e=Fg(r.reason[ts]);else if(Zo(r))e=Fg(r);else{var t=r[jF]||r[o3]||"";Zo(r[r3])&&(t&&(t+=`
`),t+=" from "+r[r3]),t&&(e=Fg(t))}}catch(n){e=Fg(n)}return e||{src:"",obj:null}}function Uce(r){var e="";return r&&(r.obj?$C(r.obj,function(t){e+=t+`
`}):e=r.src||""),e}function Wce(r){var e,t=r.obj;if(t&&t[Rt]>0){e=[];var n=0,i=0;$C(t,function(g){var h=g[ml]();if(HF.regex.test(h)){var v=new HF(h,n++);i+=v[Rg],e.push(v)}});var o=32*1024;if(i>o)for(var s=0,a=e[Rt]-1,l=0,c=s,d=a;s<a;){var p=e[s][Rg],f=e[a][Rg];if(l+=p+f,l>o){var m=d-c+1;e.splice(c,m);break}c=s,d=a,s++,a--}}return e}function Jk(r){var e="";if(r&&(e=r.typeName||r[Qi]||"",!e))try{var t=/function (.{1,200})\(/,n=t.exec(r.constructor[ml]());e=n&&n[Rt]>1?n[1]:""}catch(i){}return e}function WF(r){if(r)try{if(!Zo(r)){var e=Jk(r),t=BF(r,!1);return(!t||t==="{}")&&(r[lb]&&(r=r[lb],e=Jk(r)),t=BF(r,!0)),t[Mk](e)!==0&&e!=="String"?e+":"+t:t}}catch(n){}return""+(r||"")}var Oce,lb,ts,VF,r3,jF,o3,Ug,i3,HF,l3=ee(()=>{u();sr();pa();fl();Do();gl();Oce="<no_method>",lb="error",ts="stack",VF="stackDetails",r3="errorSrc",jF="message",o3="description";Ug=function(){function r(e,t,n,i,o,s){this.aiDataContract={ver:1,exceptions:1,severityLevel:0,properties:0,measurements:0};var a=this;a.ver=2,Kce(t)?(a[Ng]=t[Ng]||[],a[Xi]=t[Xi],a[Zi]=t[Zi],t[Ag]&&(a[Ag]=t[Ag]),t.id&&(a.id=t.id),t[Ok]&&(a[Ok]=t[Ok]),_g(t[Lk])||(a[Lk]=t[Lk])):(n||(n={}),a[Ng]=[new i3(e,t,n)],a[Xi]=eo(e,n),a[Zi]=to(e,i),o&&(a[Ag]=o),s&&(a.id=s))}return r.CreateAutoException=function(e,t,n,i,o,s,a,l){var c,d=Jk(o||s||e);return c={},c[ad]=s3(e,d),c.url=t,c.lineNumber=n,c.columnNumber=i,c.error=WF(o||s||e),c.evt=WF(s||e),c[xc]=d,c.stackDetails=a3(a||o||s),c.errorSrc=l,c},r.CreateFromInterface=function(e,t,n,i){var o=t[Ng]&&wg(t[Ng],function(a){return i3[NF](e,a)}),s=new r(e,Eo(Eo({},t),{exceptions:o}),n,i);return s},r.prototype.toInterface=function(){var e,t=this,n=t.exceptions,i=t.properties,o=t.measurements,s=t.severityLevel,a=t.problemGroup,l=t.id,c=t.isManual,d=n instanceof Array&&wg(n,function(p){return p.toInterface()})||void 0;return e={ver:"4.0"},e[Ng]=d,e.severityLevel=s,e.properties=i,e.measurements=o,e.problemGroup=a,e.id=l,e.isManual=c,e},r.CreateSimpleException=function(e,t,n,i,o,s){var a;return{exceptions:[(a={},a[iw]=!0,a.message=e,a.stack=o,a.typeName=t,a)]}},r.envelopeType="Microsoft.ApplicationInsights.{0}.Exception",r.dataType="ExceptionData",r.formatError=WF,r}(),i3=function(){function r(e,t,n){this.aiDataContract={id:0,outerId:0,typeName:1,message:1,hasFullStack:0,stack:0,parsedStack:2};var i=this;if(Lce(t))i[xc]=t[xc],i[ad]=t[ad],i[ts]=t[ts],i[fa]=t[fa]||[],i[iw]=t[iw];else{var o=t,s=o&&o.evt;YC(o)||(o=o[lb]||s||o),i[xc]=Xr(e,Jk(o))||Ni,i[ad]=ab(e,s3(t||o,i[xc]))||Ni;var a=t[VF]||a3(t);i[fa]=Wce(a),Cg(i[fa])&&wg(i[fa],function(l){return l[Mg]=Xr(e,l[Mg])}),i[ts]=jk(e,Uce(a)),i.hasFullStack=Cg(i.parsedStack)&&i.parsedStack[Rt]>0,n&&(n[xc]=n[xc]||i[xc])}}return r.prototype.toInterface=function(){var e,t=this,n=t[fa]instanceof Array&&wg(t[fa],function(o){return o.toInterface()}),i=(e={id:t.id,outerId:t.outerId,typeName:t[xc],message:t[ad],hasFullStack:t[iw],stack:t[ts]},e[fa]=n||void 0,e);return i},r.CreateFromInterface=function(e,t){var n=t[fa]instanceof Array&&wg(t[fa],function(o){return HF[NF](o)})||t[fa],i=new r(e,Eo(Eo({},t),{parsedStack:n}));return i},r}(),HF=function(){function r(e,t){this.aiDataContract={level:1,method:1,assembly:0,fileName:0,line:0};var n=this;if(n[Rg]=0,typeof e=="string"){var i=e;n[ow]=t,n[Og]=Oce,n[Mg]=dl(i),n[ib]="",n[ob]=0;var o=i.match(r.regex);o&&o[Rt]>=5&&(n[Og]=dl(o[2])||n[Og],n[ib]=dl(o[4]),n[ob]=parseInt(o[5])||0)}else n[ow]=e[ow],n[Og]=e[Og],n[Mg]=e[Mg],n[ib]=e[ib],n[ob]=e[ob],n[Rg]=0;n.sizeInBytes+=n.method[Rt],n.sizeInBytes+=n.fileName[Rt],n.sizeInBytes+=n.assembly[Rt],n[Rg]+=r.baseSize,n.sizeInBytes+=n.level.toString()[Rt],n.sizeInBytes+=n.line.toString()[Rt]}return r.CreateFromInterface=function(e){return new r(e,null)},r.prototype.toInterface=function(){var e=this;return{level:e[ow],method:e[Og],assembly:e[Mg],fileName:e[ib],line:e[ob]}},r.regex=/^([\s]+at)?[\s]{0,50}([^\@\()]+?)[\s]{0,50}(\@|\()([^\(\n]+):([0-9]+):([0-9]+)(\)?)$/,r.baseSize=58,r}()});var c3,u3=ee(()=>{u();c3=function(){function r(){this.aiDataContract={name:1,kind:0,value:1,count:0,min:0,max:0,stdDev:0},this.kind=0}return r}()});var cd,d3=ee(()=>{u();fl();Do();u3();gl();cd=function(){function r(e,t,n,i,o,s,a,l,c){this.aiDataContract={ver:1,metrics:1,properties:0};var d=this;d.ver=2;var p=new c3;p[L6]=i>0?i:void 0,p.max=isNaN(s)||s===null?void 0:s,p.min=isNaN(o)||o===null?void 0:o,p[Qi]=Xr(e,t)||Ni,p.value=n,p.stdDev=isNaN(a)||a===null?void 0:a,d.metrics=[p],d[Xi]=eo(e,l),d[Zi]=to(e,c)}return r.envelopeType="Microsoft.ApplicationInsights.{0}.Metric",r.dataType="MetricData",r}()});var Wg,p3=ee(()=>{u();fl();AF();Do();gl();Wg=function(){function r(e,t,n,i,o,s,a){this.aiDataContract={ver:1,name:0,url:0,duration:0,properties:0,measurements:0,id:0};var l=this;l.ver=2,l.id=Bk(e,a),l.url=Qp(e,n),l[Qi]=Xr(e,t)||Ni,isNaN(i)||(l[Lg]=Kk(i)),l[Xi]=eo(e,o),l[Zi]=to(e,s)}return r.envelopeType="Microsoft.ApplicationInsights.{0}.Pageview",r.dataType="PageviewData",r}()});var Vg,f3=ee(()=>{u();AF();KF();Do();gl();Vg=function(){function r(e,t,n,i,o,s,a,l,c,d,p,f){c===void 0&&(c="Ajax"),this.aiDataContract={id:1,ver:1,name:0,resultCode:0,duration:0,success:0,data:0,target:0,type:0,properties:0,measurements:0,kind:0,value:0,count:0,min:0,max:0,stdDev:0,dependencyKind:0,dependencySource:0,commandName:0,dependencyTypeName:0};var m=this;m.ver=2,m.id=t,m[Lg]=Kk(o),m.success=s,m.resultCode=a+"",m.type=Xr(e,c);var g=X6(e,n,l,i);m.data=Qp(e,i)||g.data,m.target=Xr(e,g.target),d&&(m.target="".concat(m.target," | ").concat(d)),m[Qi]=Xr(e,g[Qi]),m[Xi]=eo(e,p),m[Zi]=to(e,f)}return r.envelopeType="Microsoft.ApplicationInsights.{0}.RemoteDependency",r.dataType="RemoteDependencyData",r}()});var jg,m3=ee(()=>{u();fl();Do();gl();jg=function(){function r(e,t,n,i,o){this.aiDataContract={ver:1,message:1,severityLevel:0,properties:0};var s=this;s.ver=2,t=t||Ni,s[ad]=ab(e,t),s[Xi]=eo(e,i),s[Zi]=to(e,o),n&&(s[Ag]=n)}return r.envelopeType="Microsoft.ApplicationInsights.{0}.Message",r.dataType="MessageData",r}()});var Bg,g3=ee(()=>{u();fl();Do();gl();Bg=function(){function r(e,t,n,i,o,s,a){this.aiDataContract={ver:1,name:0,url:0,duration:0,perfTotal:0,networkConnect:0,sentRequest:0,receivedResponse:0,domProcessing:0,properties:0,measurements:0};var l=this;l.ver=2,l.url=Qp(e,n),l[Qi]=Xr(e,t)||Ni,l[Xi]=eo(e,o),l[Zi]=to(e,s),a&&(l.domProcessing=a.domProcessing,l[Lg]=a[Lg],l.networkConnect=a.networkConnect,l.perfTotal=a.perfTotal,l[RF]=a[RF],l.sentRequest=a.sentRequest)}return r.envelopeType="Microsoft.ApplicationInsights.{0}.PageviewPerformance",r.dataType="PageviewPerformanceData",r}()});var ud,h3=ee(()=>{u();ud=function(){function r(e,t){this.aiDataContract={baseType:1,baseData:1},this.baseType=e,this.baseData=t}return r}()});var JF,v3=ee(()=>{u();pa();JF=rb({Verbose:0,Information:1,Warning:2,Error:3,Critical:4})});function Zp(r){var e="ai."+r+".";return function(t){return e+t}}var cw,ri,qk,cb,qF,Xp,Hg,uw,dw,GF=ee(()=>{u();sr();pa();cw=Zp("application"),ri=Zp("device"),qk=Zp("location"),cb=Zp("operation"),qF=Zp("session"),Xp=Zp("user"),Hg=Zp("cloud"),uw=Zp("internal"),dw=function(r){In(e,r);function e(){return r.call(this)||this}return e}(xF({applicationVersion:cw("ver"),applicationBuild:cw("build"),applicationTypeId:cw("typeId"),applicationId:cw("applicationId"),applicationLayer:cw("layer"),deviceId:ri("id"),deviceIp:ri("ip"),deviceLanguage:ri("language"),deviceLocale:ri("locale"),deviceModel:ri("model"),deviceFriendlyName:ri("friendlyName"),deviceNetwork:ri("network"),deviceNetworkName:ri("networkName"),deviceOEMName:ri("oemName"),deviceOS:ri("os"),deviceOSVersion:ri("osVersion"),deviceRoleInstance:ri("roleInstance"),deviceRoleName:ri("roleName"),deviceScreenResolution:ri("screenResolution"),deviceType:ri("type"),deviceMachineName:ri("machineName"),deviceVMName:ri("vmName"),deviceBrowser:ri("browser"),deviceBrowserVersion:ri("browserVersion"),locationIp:qk("ip"),locationCountry:qk("country"),locationProvince:qk("province"),locationCity:qk("city"),operationId:cb("id"),operationName:cb("name"),operationParentId:cb("parentId"),operationRootId:cb("rootId"),operationSyntheticSource:cb("syntheticSource"),operationCorrelationVector:cb("correlationVector"),sessionId:qF("id"),sessionIsFirst:qF("isFirst"),sessionIsNew:qF("isNew"),userAccountAcquisitionDate:Xp("accountAcquisitionDate"),userAccountId:Xp("accountId"),userAgent:Xp("userAgent"),userId:Xp("id"),userStoreRegion:Xp("storeRegion"),userAuthUserId:Xp("authUserId"),userAnonymousUserAcquisitionDate:Xp("anonUserAcquisitionDate"),userAuthenticatedUserAcquisitionDate:Xp("authUserAcquisitionDate"),cloudName:Hg("name"),cloudRole:Hg("role"),cloudRoleVer:Hg("roleVer"),cloudRoleInstance:Hg("roleInstance"),cloudEnvironment:Hg("environment"),cloudLocation:Hg("location"),cloudDeploymentUnit:Hg("deploymentUnit"),internalNodeName:uw("nodeName"),internalSdkVersion:uw("sdkVersion"),internalAgentVersion:uw("agentVersion"),internalSnippet:uw("snippet"),internalSdkSrc:uw("sdkSrc")}))});var ni,y3=ee(()=>{u();GF();ni=new dw});var b3,ef=ee(()=>{u();KF();Z6();V6();fl();e3();t3();l3();d3();p3();f3();m3();g3();h3();v3();GF();gl();y3();J6();b3="AppInsightsChannelPlugin"});var I3,Jg,YF,ro,Gk,Yk,$k,Ri,zk,hl,S3,$F,_3,dd,Qk,ub,db,zF,qg,pd,Dc,pw,Gg,QF,Xk,pb,Zk,E3,fd,XF,C3,eN,no,Pc,tN,ZF,Yg,vl,rN,yl=ee(()=>{u();I3="initialize",Jg="name",YF="identifier",ro="push",Gk="isInitialized",Yk="config",$k="logger",Ri="length",zk="time",hl="processNext",S3="getProcessTelContext",$F="getPlugin",_3="splice",dd="teardown",Qk="messageId",ub="message",db="isAsync",zF="_doTeardown",qg="update",pd="getNext",Dc="diagLog",pw="setNextPlugin",Gg="createNew",QF="indexOf",Xk="userAgent",pb="split",Zk="nodeType",E3="apply",fd="replace",XF="enableDebugExceptions",C3="logInternalMessage",eN="toLowerCase",no="call",Pc="type",tN="handler",ZF="isChildEvt",Yg="getCtx",vl="setCtx",rN="complete"});var Cr,Po,w3,nN,tf,x3,eU,iN,fw,tU,Tc=ee(()=>{u();Cr="",Po="core",w3="disabled",nN="extensionConfig",tf="processTelemetry",x3="priority",eU="perfEvent",iN="errorToConsole",fw="warnToConsole",tU="getPerfMgr"});function Zce(r){if(r){if(sN)return sN(r);var e=r[Hce]||r[Kt]||r[oN];if(e)return e}return null}function bl(r){return r===void 0||typeof r===Xt}function Ht(r){return r===null||bl(r)}function rf(r){return!!(r&&typeof r===dt)}function on(r){return!!(r&&typeof r===rn)}function mw(r){var e=r;return e&&nf(e)&&(e=e[fd](zce,function(t,n){return n.toUpperCase()}),e=e[fd](Qce,"_"),e=e[fd](Xce,function(t,n){return"_"+n})),e}function io(r,e){if(r)for(var t in r)or[no](r,t)&&e[no](r,t,r[t])}function fb(r,e){return r&&e?r[QF](e)!==-1:!1}function eue(r){return!!(r&&M3[no](r)==="[object Array]")}function L3(r){return!!(r&&M3[no](r)==="[object Error]")}function nf(r){return typeof r=="string"}function iU(r){return typeof r=="number"}function K3(r){return typeof r=="boolean"}function k3(r){var e=!1;if(r&&typeof r=="object"){var t=sN?sN(r):Zce(r);t?(t[oN]&&or[no](t,oN)&&(t=t[oN]),e=typeof t===rn&&O3[no](t)===$ce):e=!0}return e}function oU(r){if(r)return Gce?r[R3]():tue(r)}function tue(r){if(r&&r.getUTCFullYear){var e=function(t){var n=String(t);return n[Ri]===1&&(n="0"+n),n};return r.getUTCFullYear()+"-"+e(r.getUTCMonth()+1)+"-"+e(r.getUTCDate())+"T"+e(r.getUTCHours())+":"+e(r.getUTCMinutes())+":"+e(r.getUTCSeconds())+"."+String((r.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"}}function yi(r,e,t){var n=r[Ri];try{for(var i=0;i<n&&!(i in r&&e[no](t||r,r[i],i,r)===-1);i++);}catch(o){}}function aN(r,e,t){if(r){if(r[D3])return r[D3](e,t);var n=r[Ri],i=t||0;try{for(var o=Math.max(i>=0?i:n-Math.abs(i),0);o<n;o++)if(o in r&&r[o]===e)return o}catch(s){}}return-1}function of(r){var e=typeof r;if(e!==rn&&(e!==dt||r===null)&&oa("objKeys called on non-object"),!N3&&T3)return T3(r);var t=[];for(var n in r)r&&or[no](r,n)&&t[ro](n);if(N3)for(var i=rU[Ri],o=0;o<i;o++)r&&or[no](r,rU[o])&&t[ro](rU[o]);return t}function sU(r,e,t,n){if(P3)try{var i={enumerable:!0,configurable:!0};return t&&(i.get=t),n&&(i.set=n),P3(r,e,i),!0}catch(o){}return!1}function rue(r){return r}function md(){var r=Date;return r.now?r.now():new r().getTime()}function ma(r){return L3(r)?r[Jg]:Cr}function gw(r,e,t,n,i){var o=t;return r&&(o=r[e],o!==t&&(!i||i(o))&&(!n||n(t))&&(o=t,r[e]=o)),o}function hw(r,e){return Ht(r)?e:r}function lU(r){return!!r}function nue(r,e){var t=null,n=null;return on(r)?t=r:n=r,function(){var i=arguments;if(t&&(n=t()),n)return n[e][E3](n,i)}}function lN(r,e,t,n,i){r&&e&&t&&(i!==!1||bl(r[e]))&&(r[e]=nue(t,n))}function cU(r,e,t,n){return r&&e&&rf(r)&&Zr(t)&&yi(t,function(i){nf(i)&&lN(r,i,e,i,n)}),r}function cN(r){return r&&Ja&&(r=Er(Ja({},r))),r}function uN(r,e,t,n,i,o){var s=arguments,a=s[0]||{},l=s[Ri],c=!1,d=1;for(l>0&&K3(a)&&(c=a,a=s[d]||{},d++),rf(a)||(a={});d<l;d++){var p=s[d],f=Zr(p),m=rf(p);for(var g in p){var h=f&&g in p||m&&or[no](p,g);if(h){var v=p[g],S=void 0;if(c&&v&&((S=Zr(v))||k3(v))){var _=a[g];S?Zr(_)||(_=[]):k3(_)||(_={}),v=uN(c,_,v)}v!==void 0&&(a[g]=v)}}}return a}var R3,Vce,jce,D3,Bce,A3,Hce,oN,P3,Jce,lWe,T3,nU,cWe,uWe,dWe,qce,Gce,Yce,M3,O3,$ce,zce,Qce,Xce,sN,Zr,N3,rU,aU,Il=ee(()=>{u();sr();yl();Tc();R3="toISOString",Vce="endsWith",jce="startsWith",D3="indexOf",Bce="trim",A3="toString",Hce="__proto__",oN="constructor",P3=So,Jce=Er.freeze,lWe=Er.seal,T3=Er.keys,nU=String[Kt],cWe=nU[Bce],uWe=nU[Vce],dWe=nU[jce],qce=Date[Kt],Gce=qce[R3],Yce=Array.isArray,M3=ia[A3],O3=or[A3],$ce=O3[no](Er),zce=/-([a-z])/g,Qce=/([^\w\d_$])/g,Xce=/^(\d+[\w\d_$])/,sN=Object.getPrototypeOf;Zr=Yce||eue;N3=!{toString:null}.propertyIsEnumerable("toString"),rU=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"];aU=Jce||rue});function V3(r,e){var t=!1;if(r){try{if(t=e in r,!t){var n=r[Kt];n&&(t=e in n)}}catch(o){}if(!t)try{var i=new r;t=!bl(i[e])}catch(o){}}return t}function To(r){var e=Vn();return e&&e[r]?e[r]:r===F3&&gU()?window:null}function gU(){return!!(typeof window===dt&&window)}function gb(){return gU()?window:To(F3)}function j3(){return!!(typeof document===dt&&document)}function dN(){return j3()?document:To(iue)}function hU(){return!!(typeof navigator===dt&&navigator)}function sf(){return hU()?navigator:To(sue)}function vU(){return typeof console!==Xt?console:To(aue)}function $g(){return!!(typeof JSON===dt&&JSON||To(U3)!==null)}function rs(){return $g()?JSON||To(U3):null}function yU(){return To(lue)}function bU(){return To(cue)}function IU(){var r=sf();if(r&&(r[Xk]!==dU||uU===null)){dU=r[Xk];var e=(dU||Cr)[eN]();uU=fb(e,fU)||fb(e,mU)}return uU}function SU(r){if(r===void 0&&(r=null),!r){var e=sf()||{};r=e?(e[Xk]||Cr)[eN]():Cr}var t=(r||Cr)[eN]();if(fb(t,fU)){var n=dN()||{};return Math.max(parseInt(t[pb](fU)[1]),n[oue]||0)}else if(fb(t,mU)){var i=parseInt(t[pb](mU)[1]);if(i)return i+4}return null}function Hn(r){var e=Object[Kt].toString[no](r),t=Cr;return e==="[object Error]"?t="{ stack: '"+r.stack+"', message: '"+r.message+"', name: '"+r[Jg]+"'":$g()&&(t=rs().stringify(r)),e+t}function hb(){return pU===null&&(pU=hU()&&!!sf().sendBeacon),pU}function pN(r){var e=!1;try{e=!!To("fetch");var t=To("Request");e&&r&&t&&(e=V3(t,"keepalive"))}catch(n){}return e}function fN(){return mb===null&&(mb=typeof XDomainRequest!==Xt,mb&&vw()&&(mb=mb&&!V3(To(W3),"withCredentials"))),mb}function vw(){var r=!1;try{var e=To(W3);r=!!e}catch(t){}return r}var F3,iue,oue,sue,aue,U3,lue,cue,fU,mU,W3,uU,dU,mb,pU,zg=ee(()=>{"use strict";u();sr();yl();Il();Tc();F3="window",iue="document",oue="documentMode",sue="navigator",aue="console",U3="JSON",lue="crypto",cue="msCrypto",fU="msie",mU="trident/",W3="XMLHttpRequest",uU=null,dU=null,mb=null,pU=null});function uue(){var r=To("Microsoft");return r&&(mN=r.ApplicationInsights),mN}function B3(r){var e=mN;return!e&&r.disableDbgExt!==!0&&(e=mN||uue()),e?e.ChromeDbgExt:null}var mN,H3=ee(()=>{u();zg();mN=null});function J3(r){return r?'"'+r[fd](/\"/g,Cr)+'"':Cr}function q3(r,e){var t=vU();if(t){var n="log";t[r]&&(n=r),on(t[n])&&t[n](e)}}function yw(r,e){return(r||{})[$k]||new EU(e)}function G3(r){return r||new EU}function ft(r,e,t,n,i,o){o===void 0&&(o=!1),G3(r).throwInternal(e,t,n,i,o)}function bw(r,e){G3(r)[fw](e)}var due,pue,fue,_U,EU,gN=ee(()=>{"use strict";u();pr();yl();H3();zg();Il();Tc();due="AI (Internal): ",pue="AI: ",fue="AITR_";_U=function(){function r(e,t,n,i){n===void 0&&(n=!1);var o=this;o[Qk]=e,o[ub]=(n?pue:due)+e;var s=Cr;$g()&&(s=rs().stringify(i));var a=(t?" message:"+J3(t):Cr)+(i?" props:"+J3(s):Cr);o[ub]+=a}return r.dataType="MessageData",r}();EU=function(){function r(e){this.identifier="DiagnosticLogger",this.queue=[];var t=0,n={},i,o,s,a;Be(r,this,function(l){d(e||{}),l.consoleLoggingLevel=function(){return i},l.telemetryLoggingLevel=function(){return o},l.maxInternalMessageLimit=function(){return s},l[XF]=function(){return a},l.throwInternal=function(m,g,h,v,S){S===void 0&&(S=!1);var _=new _U(g,h,S,v);if(a)throw Hn(_);var D=m===1?iN:fw;if(bl(_[ub]))f("throw"+(m===1?"Critical":"Warning"),_);else{if(S){var P=+_[Qk];!n[P]&&i>=m&&(l[D](_[ub]),n[P]=!0)}else i>=m&&l[D](_[ub]);c(m,_)}},l[fw]=function(m){q3("warn",m),f("warning",m)},l[iN]=function(m){q3("error",m),f("error",m)},l.resetInternalMessageCount=function(){t=0,n={}},l[C3]=c;function c(m,g){if(!p()){var h=!0,v=fue+g[Qk];if(n[v]?h=!1:n[v]=!0,h&&(m<=o&&(l.queue[ro](g),t++,f(m===1?"error":"warn",g)),t===s)){var S="Internal events throttle limit per PageView reached for this app.",_=new _U(23,S,!1);l.queue[ro](_),m===1?l[iN](S):l[fw](S)}}}function d(m){i=hw(m.loggingLevelConsole,0),o=hw(m.loggingLevelTelemetry,1),s=hw(m.maxMessageLimit,25),a=hw(m[XF],!1)}function p(){return t>=s}function f(m,g){var h=B3(e||{});h&&h[Dc]&&h[Dc](m,g)}})}return r.__ieDyn=1,r}()});function Y3(r,e,t,n,i){if(r){var o=r;if(o[tU]&&(o=o[tU]()),o){var s=void 0,a=o[Yg](CU);try{if(s=o.create(e(),n,i),s){if(a&&s[vl]&&(s[vl](hN[wU],a),a[Yg]&&a[vl])){var l=a[Yg](hN[Iw]);l||(l=[],a[vl](hN[Iw],l)),l[ro](s)}return o[vl](CU,s),t(s)}}catch(c){s&&s[vl]&&s[vl]("exception",c)}finally{s&&o.fire(s),o[vl](CU,a)}}}return t()}var vb,wU,Iw,hN,OWe,CU,$3=ee(()=>{u();pr();yl();Il();Tc();vb="ctx",wU="ParentContextKey",Iw="ChildrenContextKey",hN=function(){function r(e,t,n){var i=this,o=!1;if(i.start=md(),i[Jg]=e,i[db]=n,i[ZF]=function(){return!1},on(t)){var s;o=sU(i,"payload",function(){return!s&&on(t)&&(s=t(),t=null),s})}i[Yg]=function(a){return a?a===r[wU]||a===r[Iw]?i[a]:(i[vb]||{})[a]:null},i[vl]=function(a,l){if(a)if(a===r[wU])i[a]||(i[ZF]=function(){return!0}),i[a]=l;else if(a===r[Iw])i[a]=l;else{var c=i[vb]=i[vb]||{};c[a]=l}},i[rN]=function(){var a=0,l=i[Yg](r[Iw]);if(Zr(l))for(var c=0;c<l[Ri];c++){var d=l[c];d&&(a+=d[zk])}i[zk]=md()-i.start,i.exTime=i[zk]-a,i[rN]=function(){},!o&&on(t)&&(i.payload=t())}}return r.ParentContextKey="parent",r.ChildrenContextKey="childEvts",r}(),OWe=function(){function r(e){this.ctx={},Be(r,this,function(t){t.create=function(n,i,o){return new hN(n,i,o)},t.fire=function(n){n&&(n[rN](),e&&on(e[eU])&&e[eU](n))},t[vl]=function(n,i){if(n){var o=t[vb]=t[vb]||{};o[n]=i}},t[Yg]=function(n){return(t[vb]||{})[n]}})}return r.__ieDyn=1,r}(),CU="CoreUtils.doPerf"});function mue(r){r<0&&(r>>>=0),Sw=123456789+r&Qg,_w=987654321-r&Qg,X3=!0}function gue(){try{var r=md()&2147483647;mue((Math.random()*Q3^r)+r)}catch(e){}}function z3(r){var e=0,t=yU()||bU();return t&&t.getRandomValues&&(e=t.getRandomValues(new Uint32Array(1))[0]&Qg),e===0&&IU()&&(X3||gue(),e=hue()&Qg),e===0&&(e=Math.floor(Q3*Math.random()|0)),r||(e>>>=0),e}function hue(r){_w=36969*(_w&65535)+(_w>>16)&Qg,Sw=18e3*(Sw&65535)+(Sw>>16)&Qg;var e=(_w<<16)+(Sw&65535)>>>0&Qg|0;return r||(e>>>=0),e}function Z3(r){r===void 0&&(r=22);for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=z3()>>>0,n=0,i=Cr;i[Ri]<r;)n++,i+=e.charAt(t&63),t>>>=6,n===5&&(t=(z3()<<2&4294967295|t&3)>>>0,n=0);return i}var Q3,Qg,X3,Sw,_w,eJ=ee(()=>{u();yl();zg();Il();Tc();Q3=4294967296,Qg=4294967295,X3=!1,Sw=123456789,_w=987654321});function bue(r,e,t){if(tJ)try{return tJ(r,e,{value:t,enumerable:!1,configurable:!0}),!0}catch(n){}return!1}function nJ(r){return r[Zk]===1||r[Zk]===9||!+r[Zk]}function Iue(r,e){var t=e[r.id];if(!t){t={};try{nJ(e)&&(bue(e,r.id,t)||(e[r.id]=t))}catch(n){}}return t}function gd(r,e){return e===void 0&&(e=!1),mw(r+yue+++(e?"."+rJ:Cr)+vue)}function vN(r){var e={id:gd("_aiData-"+(r||Cr)+"."+rJ),accept:function(t){return nJ(t)},get:function(t,n,i,o){var s=t[e.id];return s?s[mw(n)]:(o&&(s=Iue(e,t),s[mw(n)]=i),i)},kill:function(t,n){if(t&&t[n])try{delete t[n]}catch(i){}}};return e}var tJ,rJ,vue,yue,yN=ee(()=>{u();sr();yl();Il();Tc();eJ();tJ=So,rJ="2.8.11",vue="."+Z3(6),yue=0});function lJ(r){return r&&r[fd]?r[fd](/^[\s\.]+|(?=[\s\.])[\.\s]+$/g,Cr):r}function DU(r,e){var t;if(e){var n=Cr;Zr(e)?(n=Cr,yi(e,function(o){o=lJ(o),o&&(o[0]!=="."&&(o="."+o),n+=o)})):n=lJ(e),n&&(n[0]!=="."&&(n="."+n),r=(r||Cr)+n)}var i=Cue.exec(r||Cr)||[];return t={},t[Pc]=i[1],t.ns=(i[2]||Cr).replace(Sue,".").replace(_ue,Cr)[pb](".").sort().join("."),t}function dJ(r,e,t){t===void 0&&(t=!0);var n=bN.get(r,xU,{},t),i=n[e];return i||(i=n[e]=[]),i}function pJ(r,e,t,n){r&&e&&e[Pc]&&(r[aJ]?r[aJ](e[Pc],t,n):r[sJ]&&r[sJ](uJ+e[Pc],t))}function wue(r,e,t,n){var i=!1;return r&&e&&e[Pc]&&t&&(r[oJ]?(r[oJ](e[Pc],t,n),i=!0):r[iJ]&&(r[iJ](uJ+e[Pc],t),i=!0)),i}function cJ(r,e,t,n){for(var i=e[Ri];i--;){var o=e[i];o&&(!t.ns||t.ns===o.evtName.ns)&&(!n||n(o))&&(pJ(r,o.evtName,o[tN],o.capture),e[_3](i,1))}}function xue(r,e,t){if(e[Pc])cJ(r,dJ(r,e[Pc]),e,t);else{var n=bN.get(r,xU,{});io(n,function(i,o){cJ(r,o,e,t)}),of(n)[Ri]===0&&bN.kill(r,xU)}}function Ew(r,e){var t;return e?(Zr(e)?t=[r].concat(e):t=[r,e],t=DU("xx",t).ns[pb](".")):t=r,t}function IN(r,e,t,n,i){var o;i===void 0&&(i=!1);var s=!1;if(r)try{var a=DU(e,n);if(s=wue(r,a,t,i),s&&bN.accept(r)){var l=(o={guid:Eue++,evtName:a},o[tN]=t,o.capture=i,o);dJ(r,a.type)[ro](l)}}catch(c){}return s}function PU(r,e,t,n,i){if(i===void 0&&(i=!1),r)try{var o=DU(e,n),s=!1;xue(r,o,function(a){return o.ns&&!t||a[tN]===t?(s=!0,!0):!1}),s||pJ(r,o,t,i)}catch(a){}}var uJ,iJ,oJ,sJ,aJ,xU,tVe,rVe,Sue,_ue,Eue,bN,Cue,fJ=ee(()=>{u();yl();yN();Il();Tc();uJ="on",iJ="attachEvent",oJ="addEventListener",sJ="detachEvent",aJ="removeEventListener",xU="events",tVe=gd("aiEvtPageHide"),rVe=gd("aiEvtPageShow"),Sue=/\.[\.]+/g,_ue=/[\.]+$/,Eue=1,bN=vN("events"),Cue=/^([^.]*)(?:\.(.+)|)/});function SN(r){return Due.get(r,"state",{},!0)}var Due,mJ=ee(()=>{"use strict";u();yN();Due=vN("plugin")});function Tue(r,e,t){for(;r;){if(r[$F]()===t)return r;r=r[pd]()}return Cw([t],e[Yk]||{},e)}function TU(r,e,t,n){var i=null,o=[];n!==null&&(i=n?Tue(r,t,n):r);var s={_next:l,ctx:{core:function(){return t},diagLog:function(){return yw(t,e)},getCfg:function(){return e},getExtCfg:c,getConfig:d,hasNext:function(){return!!i},getNext:function(){return i},setNext:function(f){i=f},iterate:p,onComplete:a}};function a(f,m){for(var g=[],h=2;h<arguments.length;h++)g[h-2]=arguments[h];f&&o[ro]({func:f,self:bl(m)?s.ctx:m,args:g})}function l(){var f=i;if(i=f?f[pd]():null,!f){var m=o;m&&m[Ri]>0&&(yi(m,function(g){try{g.func[no](g.self,g.args)}catch(h){ft(t[$k],2,73,"Unexpected Exception during onComplete - "+Hn(h))}}),o=[])}return f}function c(f,m,g){m===void 0&&(m={}),g===void 0&&(g=0);var h;if(e){var v=e[nN];v&&f&&(h=v[f])}if(!h)h=m;else if(rf(m)&&g!==0){var S=uN(!0,m,h);e&&g===2&&io(m,function(_){if(Ht(S[_])){var D=e[_];Ht(D)||(S[_]=D)}}),h=S}return h}function d(f,m,g){g===void 0&&(g=!1);var h,v=c(f,null);return v&&!Ht(v[m])?h=v[m]:e&&!Ht(e[m])&&(h=e[m]),Ht(h)?g:h}function p(f){for(var m;m=s._next();){var g=m[$F]();g&&f(g)}}return s}function yb(r,e,t,n){var i=TU(r,e,t,n),o=i.ctx;function s(l){var c=i._next();return c&&c[tf](l,o),!c}function a(l,c){return l===void 0&&(l=null),Zr(l)&&(l=Cw(l,e,t,c)),yb(l||o[pd](),e,t,c)}return o[hl]=s,o[Gg]=a,o}function kU(r,e,t){var n=e[Yk]||{},i=TU(r,n,e,t),o=i.ctx;function s(l){var c=i._next();return c&&c.unload(o,l),!c}function a(l,c){return l===void 0&&(l=null),Zr(l)&&(l=Cw(l,n,e,c)),kU(l||o[pd](),e,c)}return o[hl]=s,o[Gg]=a,o}function NU(r,e,t){var n=e[Yk]||{},i=TU(r,n,e,t),o=i.ctx;function s(l){return o.iterate(function(c){on(c[qg])&&c[qg](o,l)})}function a(l,c){return l===void 0&&(l=null),Zr(l)&&(l=Cw(l,n,e,c)),NU(l||o[pd](),e,c)}return o[hl]=s,o[Gg]=a,o}function Cw(r,e,t,n){var i=null,o=!n;if(Zr(r)&&r[Ri]>0){var s=null;yi(r,function(a){if(!o&&n===a&&(o=!0),o&&a&&on(a[tf])){var l=kue(a,e,t);i||(i=l),s&&s._setNext(l),s=l}})}return n&&!i?Cw([n],e,t):i}function kue(r,e,t){var n=null,i=on(r[tf]),o=on(r[pw]),s;r?s=r[YF]+"-"+r[x3]+"-"+vJ++:s="Unknown-0-"+vJ++;var a={getPlugin:function(){return r},getNext:function(){return n},processTelemetry:d,unload:p,update:f,_id:s,_setNext:function(m){n=m}};function l(){var m;return r&&on(r[hJ])&&(m=r[hJ]()),m||(m=yb(a,e,t)),m}function c(m,g,h,v,S){var _=!1,D=r?r[YF]:Pue,P=m[gJ];return P||(P=m[gJ]={}),m.setNext(n),r&&Y3(m[Po](),function(){return D+":"+h},function(){P[s]=!0;try{var M=n?n._id:Cr;M&&(P[M]=!1),_=g(m)}catch(A){var x=n?P[n._id]:!0;x&&(_=!0),(!n||!x)&&ft(m[Dc](),1,73,"Plugin ["+D+"] failed during "+h+" - "+Hn(A)+", run flags: "+Hn(P))}},v,S),_}function d(m,g){g=g||l();function h(v){if(!r||!i)return!1;var S=SN(r);return S[dd]||S[w3]?!1:(o&&r[pw](n),r[tf](m,v),!0)}c(g,h,"processTelemetry",function(){return{item:m}},!m.sync)||g[hl](m)}function p(m,g){function h(){var v=!1;if(r){var S=SN(r),_=r[Po]||S[Po];r&&(!_||_===m.core())&&!S[dd]&&(S[Po]=null,S[dd]=!0,S[Gk]=!1,r[dd]&&r[dd](m,g)===!0&&(v=!0))}return v}c(m,h,"unload",function(){},g[db])||m[hl](g)}function f(m,g){function h(){var v=!1;if(r){var S=SN(r),_=r[Po]||S[Po];r&&(!_||_===m.core())&&!S[dd]&&r[qg]&&r[qg](m,g)===!0&&(v=!0)}return v}c(m,h,"update",function(){},!1)||m[hl](g)}return aU(a)}var Pue,gJ,hJ,vJ,gVe,yJ=ee(()=>{"use strict";u();yl();gN();zg();Il();Tc();$3();mJ();Pue="TelemetryPluginChain",gJ="_hasRun",hJ="_getTelCtx",vJ=0;gVe=function(){function r(e,t,n,i){var o=this,s=yb(e,t,n,i);cU(o,s,of(s))}return r}()});function bJ(){var r=[];function e(n){n&&r[ro](n)}function t(n,i){yi(r,function(o){try{o(n,i)}catch(s){ft(n[Dc](),2,73,"Unexpected error calling unload handler - "+Hn(s))}}),r=[]}return{add:e,run:t}}var IJ=ee(()=>{u();yl();gN();zg();Il()});var af,RU,SJ=ee(()=>{"use strict";u();pr();yl();Il();Tc();yJ();IJ();af="getPlugin",RU=function(){function r(){var e=this,t,n,i,o,s;c(),Be(r,e,function(d){d[I3]=function(p,f,m,g){l(p,f,g),t=!0},d[dd]=function(p,f){var m,g=d[Po];if(!g||p&&g!==p[Po]())return;var h,v=!1,S=p||kU(null,g,i&&i[af]?i[af]():i),_=f||(m={reason:0},m[db]=!1,m);function D(){if(!v){v=!0,o.run(S,f);var P=s;s=[],yi(P,function(M){M.rm()}),h===!0&&S[hl](_),c()}}return!d[zF]||d[zF](S,_,D)!==!0?D():h=!0,h},d[qg]=function(p,f){var m=d[Po];if(!m||p&&m!==p[Po]())return;var g,h=!1,v=p||NU(null,m,i&&i[af]?i[af]():i),S=f||{reason:0};function _(){h||(h=!0,l(v.getCfg(),v.core(),v[pd]()))}return!d._doUpdate||d._doUpdate(v,S,_)!==!0?_():g=!0,g},d._addHook=function(p){p&&(Zr(p)?s=s.concat(p):s[ro](p))},lN(d,"_addUnloadCb",function(){return o},"add")}),e[Dc]=function(d){return a(d)[Dc]()},e[Gk]=function(){return t},e.setInitialized=function(d){t=d},e[pw]=function(d){i=d},e[hl]=function(d,p){p?p[hl](d):i&&on(i[tf])&&i[tf](d,null)},e._getTelCtx=a;function a(d){d===void 0&&(d=null);var p=d;if(!p){var f=n||yb(null,{},e[Po]);i&&i[af]?p=f[Gg](null,i[af]):p=f[Gg](null,i)}return p}function l(d,p,f){d&&gw(d,nN,[],null,Ht),!f&&p&&(f=p[S3]()[pd]());var m=i;i&&i[af]&&(m=i[af]()),e[Po]=p,n=yb(f,d,p,m)}function c(){t=!1,e[Po]=null,n=null,i=null,s=[],o=bJ()}}return r.__ieDyn=1,r}()});var Xg=ee(()=>{u();SJ();Il();fJ();zg();gN();yN()});var lf,_J=ee(()=>{u();lf="duration"});var Jn,_N,ns,kc,Zg,Dt,cf,uf,ga,df,hd,ww,eh,pf,vd,xw,ff,th,mf,rh,bb,gf,Ib,yd,EN,nh,oo,AU,CN,Sb,jr,ih,MU,OU,Dw,hf,LU,_b,KU,wN,xN,Eb,FU,EJ,ha,DN,Pw,Tw,CJ,Cb,PN,UU,WU,VU,TN,wJ,bd=ee(()=>{u();Jn="tags",_N="deviceType",ns="data",kc="name",Zg="traceID",Dt="length",cf="stringify",uf="measurements",ga="dataType",df="envelopeType",hd="toString",ww="onLine",eh="enqueue",pf="count",vd="push",xw="emitLineDelimitedJson",ff="clear",th="batchPayloads",mf="markAsSent",rh="clearSent",bb="BUFFER_KEY",gf="SENT_BUFFER_KEY",Ib="MAX_BUFFER_SIZE",yd="namePrefix",EN="maxBatchSizeInBytes",nh="triggerSend",oo="diagLog",AU="onunloadDisableBeacon",CN="isBeaconApiDisabled",Sb="_sender",jr="_senderConfig",ih="_buffer",MU="enableSessionStorageBuffer",OU="samplingPercentage",Dw="instrumentationKey",hf="endpointUrl",LU="customHeaders",_b="disableXhr",KU="onunloadDisableFetch",wN="disableTelemetry",xN="baseType",Eb="sampleRate",FU="convertUndefined",EJ="_xhrReadyStateChange",ha="_onError",DN="_onPartialSuccess",Pw="_onSuccess",Tw="itemsAccepted",CJ="itemsReceived",Cb="isRetryDisabled",PN="setRequestHeader",UU="maxBatchInterval",WU="eventsSendRequest",VU="disableInstrumentationKeyValidation",TN="getSamplingScore",wJ="getHashCodeScore"});function qn(r,e,t){return gw(r,e,t,lU)}function Nue(r,e,t){var n=t[Jn]=t[Jn]||{},i=e.ext=e.ext||{},o=e[Jn]=e[Jn]||[],s=i.user;s&&(qn(n,ni.userAuthUserId,s.authId),qn(n,ni.userId,s.id||s.localId));var a=i.app;a&&qn(n,ni.sessionId,a.sesId);var l=i.device;l&&(qn(n,ni.deviceId,l.id||l.localId),qn(n,ni[_N],l.deviceClass),qn(n,ni.deviceIp,l.ip),qn(n,ni.deviceModel,l.model),qn(n,ni[_N],l[_N]));var c=e.ext.web;if(c){qn(n,ni.deviceLanguage,c.browserLang),qn(n,ni.deviceBrowserVersion,c.browserVer),qn(n,ni.deviceBrowser,c.browser);var d=t[ns]=t[ns]||{},p=d[sn]=d[sn]||{},f=p[bi]=p[bi]||{};qn(f,"domain",c.domain),qn(f,"isManual",c.isManual?xJ:null),qn(f,"screenRes",c.screenRes),qn(f,"userConsent",c.userConsent?xJ:null)}var m=i.os;m&&qn(n,ni.deviceOS,m[kc]);var g=i.trace;g&&(qn(n,ni.operationParentId,g.parentID),qn(n,ni.operationName,Xr(r,g[kc])),qn(n,ni.operationId,g[Zg]));for(var h={},v=o[Dt]-1;v>=0;v--){var S=o[v];io(S,function(D,P){h[D]=P}),o.splice(v,1)}io(o,function(D,P){h[D]=P});var _=Eo(Eo({},n),h);_[ni.internalSdkVersion]||(_[ni.internalSdkVersion]="javascript:".concat(Rue.Version)),t[Jn]=cN(_)}function vf(r,e,t){Ht(r)||io(r,function(n,i){iU(i)?t[n]=i:nf(i)?e[n]=i:$g()&&(e[n]=rs()[cf](i))})}function oh(r,e){Ht(r)||io(r,function(t,n){r[t]=n||e})}function sh(r,e,t,n){var i=new UF(r,n,e);qn(i,"sampleRate",t[ZC]),(t[sn]||{}).startTime&&(i.time=oU(t[sn].startTime)),i.iKey=t.iKey;var o=t.iKey.replace(/-/g,"");return i[kc]=i[kc].replace("{0}",o),Nue(r,t,i),t[Jn]=t[Jn]||[],cN(i)}function ah(r,e){Ht(e[sn])&&ft(r,1,46,"telemetryItem.baseData cannot be null.")}function DJ(r,e,t){ah(r,e);var n=e[sn][uf]||{},i=e[sn][bi]||{};vf(e[ns],i,n),Ht(t)||oh(i,t);var o=e[sn];if(Ht(o))return bw(r,"Invalid input for dependency data"),null;var s=o[bi]&&o[bi][Ak]?o[bi][Ak]:"GET",a=new Vg(r,o.id,o.target,o[kc],o[lf],o.success,o.responseCode,s,o.type,o.correlationContext,i,n),l=new ud(Vg[ga],a);return sh(r,Vg[df],e,l)}function BU(r,e,t){ah(r,e);var n={},i={};e[jU]!==ld[ga]&&(n.baseTypeSource=e[jU]),e[jU]===ld[ga]?(n=e[sn][bi]||{},i=e[sn][uf]||{}):e[sn]&&vf(e[sn],n,i),vf(e[ns],n,i),Ht(t)||oh(n,t);var o=e[sn][kc],s=new ld(r,o,n,i),a=new ud(ld[ga],s);return sh(r,ld[df],e,a)}function PJ(r,e,t){ah(r,e);var n=e[sn][uf]||{},i=e[sn][bi]||{};vf(e[ns],i,n),Ht(t)||oh(i,t);var o=e[sn],s=Ug.CreateFromInterface(r,o,i,n),a=new ud(Ug[ga],s);return sh(r,Ug[df],e,a)}function TJ(r,e,t){ah(r,e);var n=e[sn],i=n[bi]||{},o=n[uf]||{};vf(e[ns],i,o),Ht(t)||oh(i,t);var s=new cd(r,n[kc],n.average,n.sampleCount,n.min,n.max,n.stdDev,i,o),a=new ud(cd[ga],s);return sh(r,cd[df],e,a)}function kJ(r,e,t){ah(r,e);var n,i=e[sn];!Ht(i)&&!Ht(i[bi])&&!Ht(i[bi][lf])?(n=i[bi][lf],delete i[bi][lf]):!Ht(e[ns])&&!Ht(e[ns][lf])&&(n=e[ns][lf],delete e[ns][lf]);var o=e[sn],s;((e.ext||{}).trace||{})[Zg]&&(s=e.ext.trace[Zg]);var a=o.id||s,l=o[kc],c=o.uri,d=o[bi]||{},p=o[uf]||{};if(Ht(o.refUri)||(d.refUri=o.refUri),Ht(o.pageType)||(d.pageType=o.pageType),Ht(o.isLoggedIn)||(d.isLoggedIn=o.isLoggedIn[hd]()),!Ht(o[bi])){var f=o[bi];io(f,function(h,v){d[h]=v})}vf(e[ns],d,p),Ht(t)||oh(d,t);var m=new Wg(r,l,c,n,d,p,a),g=new ud(Wg[ga],m);return sh(r,Wg[df],e,g)}function NJ(r,e,t){ah(r,e);var n=e[sn],i=n[kc],o=n.uri||n.url,s=n[bi]||{},a=n[uf]||{};vf(e[ns],s,a),Ht(t)||oh(s,t);var l=new Bg(r,i,o,void 0,s,a,n),c=new ud(Bg[ga],l);return sh(r,Bg[df],e,c)}function RJ(r,e,t){ah(r,e);var n=e[sn].message,i=e[sn].severityLevel,o=e[sn][bi]||{},s=e[sn][uf]||{};vf(e[ns],o,s),Ht(t)||oh(o,t);var a=new jg(r,n,i,o,s),l=new ud(jg[ga],a);return sh(r,jg[df],e,l)}var jU,sn,bi,xJ,Rue,AJ=ee(()=>{u();sr();ef();Xg();_J();bd();jU="baseType",sn="baseData",bi="properties",xJ="true";Rue={Version:"2.8.11"}});function MJ(r,e){PU(r,null,null,e)}function OJ(r){var e=dN(),t=sf(),n=!1,i=!0,o=Ew(gd("OfflineListener"),r);try{if(a(gb())&&(n=!0),e){var s=e.body||e;s.ononline&&a(s)&&(n=!0)}n&&t&&!Ht(t[ww])&&(i=t[ww])}catch(f){n=!1}function a(f){var m=!1;return f&&(m=IN(f,"online",l,o),m&&IN(f,"offline",c,o)),m}function l(){i=!0}function c(){i=!1}function d(){var f=!0;return n?f=i:t&&!Ht(t[ww])&&(f=t[ww]),f}function p(){var f=gb();if(f&&n){if(MJ(f,o),e){var m=e.body||e;bl(m.ononline)||MJ(m,o)}n=!1}}return{isOnline:d,isListening:function(){return n},unload:p}}var LJ=ee(()=>{u();Xg();bd()});var KJ,FJ,UJ,WJ=ee(()=>{u();sr();pr();ef();Xg();bd();KJ=function(){function r(e,t){var n=[],i=!1;this._get=function(){return n},this._set=function(o){return n=o,n},Be(r,this,function(o){o[eh]=function(s){if(o[pf]()>=t.eventsLimitInMem()){i||(ft(e,2,105,"Maximum in-memory buffer size reached: "+o[pf](),!0),i=!0);return}n[vd](s)},o[pf]=function(){return n[Dt]},o.size=function(){for(var s=n[Dt],a=0;a<n[Dt];a++)s+=n[a][Dt];return t[xw]()||(s+=2),s},o[ff]=function(){n=[],i=!1},o.getItems=function(){return n.slice(0)},o[th]=function(s){if(s&&s[Dt]>0){var a=t[xw]()?s.join(`
`):"["+s.join(",")+"]";return a}return null}})}return r.__ieDyn=1,r}(),FJ=function(r){In(e,r);function e(t,n){var i=r.call(this,t,n)||this;return Be(e,i,function(o,s){o[mf]=function(a){s[ff]()},o[rh]=function(a){}}),i}return e.__ieDyn=1,e}(KJ),UJ=function(r){In(e,r);function e(t,n){var i=r.call(this,t,n)||this,o=!1;return Be(e,i,function(s,a){var l=f(e[bb]),c=f(e[gf]),d=s._set(l.concat(c));d[Dt]>e[Ib]&&(d[Dt]=e[Ib]),m(e[gf],[]),m(e[bb],d),s[eh]=function(g){if(s[pf]()>=e[Ib]){o||(ft(t,2,67,"Maximum buffer size reached: "+s[pf](),!0),o=!0);return}a[eh](g),m(e[bb],s._get())},s[ff]=function(){a[ff](),m(e[bb],s._get()),m(e[gf],[]),o=!1},s[mf]=function(g){m(e[bb],s._set(p(g,s._get())));var h=f(e[gf]);h instanceof Array&&g instanceof Array&&(h=h.concat(g),h[Dt]>e[Ib]&&(ft(t,1,67,"Sent buffer reached its maximum size: "+h[Dt],!0),h[Dt]=e[Ib]),m(e[gf],h))},s[rh]=function(g){var h=f(e[gf]);h=p(g,h),m(e[gf],h)};function p(g,h){var v=[];return yi(h,function(S){!on(S)&&aN(g,S)===-1&&v[vd](S)}),v}function f(g){var h=g;try{h=n[yd]&&n[yd]()?n[yd]()+"_"+h:h;var v=MF(t,h);if(v){var S=rs().parse(v);if(nf(S)&&(S=rs().parse(S)),S&&Zr(S))return S}}catch(_){ft(t,1,42," storage key: "+h+", "+ma(_),{exception:Hn(_)})}return[]}function m(g,h){var v=g;try{v=n[yd]&&n[yd]()?n[yd]()+"_"+v:v;var S=JSON[cf](h);Wk(t,v,S)}catch(_){Wk(t,v,JSON[cf]([])),ft(t,2,41," storage key: "+v+", "+ma(_)+". Buffer cleared",{exception:Hn(_)})}}}),i}return e.BUFFER_KEY="AI_buffer",e.SENT_BUFFER_KEY="AI_sentBuffer",e.MAX_BUFFER_SIZE=2e3,e}(KJ)});var VJ,jJ=ee(()=>{u();pr();Xg();bd();VJ=function(){function r(e){Be(r,this,function(t){t.serialize=function(s){var a=n(s,"root");try{return rs()[cf](a)}catch(l){ft(e,1,48,l&&on(l[hd])?l[hd]():"Error serializing object",null,!0)}};function n(s,a){var l="__aiCircularRefCheck",c={};if(!s)return ft(e,1,48,"cannot serialize object because it is null or undefined",{name:a},!0),c;if(s[l])return ft(e,2,50,"Circular reference detected while serializing object",{name:a},!0),c;if(!s.aiDataContract){if(a==="measurements")c=o(s,"number",a);else if(a==="properties")c=o(s,"string",a);else if(a==="tags")c=o(s,"string",a);else if(Zr(s))c=i(s,a);else{ft(e,2,49,"Attempting to serialize an object which does not implement ISerializable",{name:a},!0);try{rs()[cf](s),c=s}catch(d){ft(e,1,48,d&&on(d[hd])?d[hd]():"Error serializing object",null,!0)}}return c}return s[l]=!0,io(s.aiDataContract,function(d,p){var f=on(p)?p()&1:p&1,m=on(p)?p()&4:p&4,g=p&2,h=s[d]!==void 0,v=rf(s[d])&&s[d]!==null;if(f&&!h&&!g)ft(e,1,24,"Missing required field specification. The field is required but not present on source",{field:d,name:a});else if(!m){var S=void 0;v?g?S=i(s[d],d):S=n(s[d],d):S=s[d],S!==void 0&&(c[d]=S)}}),delete s[l],c}function i(s,a){var l;if(s)if(!Zr(s))ft(e,1,54,`This field was specified as an array in the contract but the item is not an array.\r
`,{name:a},!0);else{l=[];for(var c=0;c<s[Dt];c++){var d=s[c],p=n(d,a+"["+c+"]");l[vd](p)}}return l}function o(s,a,l){var c;return s&&(c={},io(s,function(d,p){if(a==="string")p===void 0?c[d]="undefined":p===null?c[d]="null":p[hd]?c[d]=p[hd]():c[d]="invalid field: toString() is not defined.";else if(a==="number")if(p===void 0)c[d]="undefined";else if(p===null)c[d]="null";else{var f=parseFloat(p);isNaN(f)?c[d]="NaN":c[d]=f}else c[d]="invalid field: "+l+" is of unknown type.",ft(e,1,c[d],null,!0)})),c}})}return r.__ieDyn=1,r}()});var Aue,BJ,HJ=ee(()=>{u();bd();Aue=8,BJ=function(){function r(){}return r.prototype.getHashCodeScore=function(e){var t=this.getHashCode(e)/r.INT_MAX_VALUE;return t*100},r.prototype.getHashCode=function(e){if(e==="")return 0;for(;e[Dt]<Aue;)e=e.concat(e);for(var t=5381,n=0;n<e[Dt];++n)t=(t<<5)+t+e.charCodeAt(n),t=t&t;return Math.abs(t)},r.INT_MAX_VALUE=2147483647,r}()});var JJ,qJ=ee(()=>{u();ef();bd();HJ();JJ=function(){function r(){var e=this,t=new BJ,n=new dw;e[TN]=function(i){var o=0;return i[Jn]&&i[Jn][n.userId]?o=t.getHashCodeScore(i[Jn][n.userId]):i.ext&&i.ext.user&&i.ext.user.id?o=t[wJ](i.ext.user.id):i[Jn]&&i[Jn][n.operationId]?o=t.getHashCodeScore(i[Jn][n.operationId]):i.ext&&i.ext.telemetryTrace&&i.ext.telemetryTrace[Zg]?o=t.getHashCodeScore(i.ext.telemetryTrace[Zg]):o=Math.random()*100,o}}return r}()});var GJ,YJ=ee(()=>{u();ef();Xg();bd();qJ();GJ=function(){function r(e,t){this.INT_MAX_VALUE=2147483647;var n=t||yw(null);(e>100||e<0)&&(n.throwInternal(2,58,"Sampling rate is out of range (0..100). Sampling will be disabled, you may be sending too much data which may affect your AI service level.",{samplingRate:e},!0),e=100),this[Eb]=e,this.samplingScoreGenerator=new JJ}return r.prototype.isSampledIn=function(e){var t=this[Eb],n=!1;return t==null||t>=100||e.baseType===cd[ga]?!0:(n=this.samplingScoreGenerator[TN](e)<t,n)},r}()});function kN(r){try{return r.responseText}catch(e){}return null}function $J(){var r,e,t;return r={endpointUrl:function(){return Pg+sd}},r[xw]=function(){return!1},r[UU]=function(){return 15e3},r[EN]=function(){return 102400},r[wN]=function(){return!1},r[MU]=function(){return!0},r[Cb]=function(){return!1},r[CN]=function(){return!0},r[_b]=function(){return!1},r[KU]=function(){return!1},r[AU]=function(){return!1},r[Dw]=function(){return e},r[yd]=function(){return e},r[OU]=function(){return 100},r[LU]=function(){return t},r[FU]=function(){return e},r.eventsLimitInMem=function(){return 1e4},r}var Id,Mue,Oue,kw,zJ=ee(()=>{u();sr();pr();ef();Xg();AJ();LJ();WJ();jJ();YJ();bd();Mue=65e3;Oue=(Id={},Id[ld.dataType]=BU,Id[jg.dataType]=RJ,Id[Wg.dataType]=kJ,Id[Bg.dataType]=NJ,Id[Ug.dataType]=PJ,Id[cd.dataType]=TJ,Id[Vg.dataType]=DJ,Id),kw=function(r){In(e,r);function e(){var t=r.call(this)||this;t.priority=1001,t.identifier=b3,t._senderConfig=$J();var n,i,o,s,a,l,c,d,p=0,f,m,g,h;return Be(e,t,function(v,S){Ce(),v.pause=function(){kt(),s=!0},v.resume=function(){s&&(s=!1,i=null,v._buffer.size()>v._senderConfig[EN]()&&v[nh](!0,null,10),ae())},v.flush=function(L,le,me){if(L===void 0&&(L=!0),!s){kt();try{v[nh](L,null,me||1)}catch(we){ft(v[oo](),1,22,"flush failed, telemetry will not be collected: "+ma(we),{exception:Hn(we)})}}},v.onunloadFlush=function(){if(!s)if((v._senderConfig[AU]()===!1||v[jr][CN]()===!1)&&hb())try{v[nh](!0,M,2)}catch(L){ft(v[oo](),1,20,"failed to flush with beacon sender on page unload, telemetry will not be collected: "+ma(L),{exception:Hn(L)})}else v.flush()},v.addHeader=function(L,le){d[L]=le},v.initialize=function(L,le,me,we){v.isInitialized()&&ft(v[oo](),1,28,"Sender is already initialized"),S.initialize(L,le,me,we);var Oe=v._getTelCtx(),Ze=v.identifier;l=new VJ(le.logger),n=0,i=null,o=0,v[Sb]=null,c=0;var N=v[oo]();h=Ew(gd("Sender"),le.evtNamespace&&le.evtNamespace()),g=OJ(h);var W=$J();io(W,function(Re,Gt){v[jr][Re]=function(){var $e=Oe.getConfig(Ze,Re,Gt());return!$e&&Re==="endpointUrl"&&($e=Gt()),$e}}),v._buffer=v[jr][MU]()&&Uk()?new UJ(N,v[jr]):new FJ(N,v[jr]),v._sample=new GJ(v[jr][OU](),N),ye(L)||ft(N,1,100,"Invalid Instrumentation key "+L[Dw]),!lw(v._senderConfig.endpointUrl())&&v._senderConfig.customHeaders()&&v._senderConfig.customHeaders()[Dt]>0&&yi(v[jr][LU](),function(Re){t.addHeader(Re.header,Re.value)});var pe=v[jr],Se=null;!pe[_b]()&&fN()?Se=$r:!pe[_b]()&&vw()&&(Se=j),!Se&&pN()&&(Se=R),f=Se||j,!pe[CN]()&&hb()&&(Se=A),v[Sb]=Se||j,!pe[KU]()&&pN(!0)?m=re:hb()?m=A:!pe[_b]()&&fN()?m=$r:!pe[_b]()&&vw()?m=j:m=f},v.processTelemetry=function(L,le){le=v._getTelCtx(le);var me=le[oo]();try{if(v[jr][wN]())return;if(!L){ft(me,1,7,"Cannot send empty telemetry");return}if(L.baseData&&!L[xN]){ft(me,1,70,"Cannot send telemetry without baseData and baseType");return}if(L[xN]||(L[xN]="EventData"),!v[Sb]){ft(me,1,28,"Sender was not initialized");return}if(_(L))L[ZC]=v._sample[Eb];else{ft(me,2,33,"Telemetry item was sampled out and not sent",{SampleRate:v._sample[Eb]});return}var we=v[jr][FU]()||void 0,Oe=L.iKey||v[jr][Dw](),Ze=e.constructEnvelope(L,Oe,me,we);if(!Ze){ft(me,1,47,"Unable to create an AppInsights envelope");return}var N=!1;if(L[Jn]&&L[Jn][ew]&&(yi(L[Jn][ew],function(Re){try{Re&&Re(Ze)===!1&&(N=!0,bw(me,"Telemetry processor check returns false"))}catch(Gt){ft(me,1,64,"One of telemetry initializers failed, telemetry item will not be sent: "+ma(Gt),{exception:Hn(Gt)},!0)}}),delete L[Jn][ew]),N)return;var W=l.serialize(Ze),pe=v[ih],Se=pe.size();Se+W[Dt]>v[jr][EN]()&&v[nh](!0,null,10),pe[eh](W),ae()}catch(Re){ft(me,2,12,"Failed adding telemetry to the sender's buffer, some telemetry will be lost: "+ma(Re),{exception:Hn(Re)})}v.processNext(L,le)},v[EJ]=function(L,le,me){L.readyState===4&&D(L.status,le,L.responseURL,me,We(L),kN(L)||L.response)},v[nh]=function(L,le,me){if(L===void 0&&(L=!0),!s)try{var we=v[ih];if(v[jr][wN]())we[ff]();else{if(we[pf]()>0){var Oe=we.getItems();Pe(me||0,L),le?le.call(t,Oe,L):v[Sb](Oe,L)}o=+new Date}kt()}catch(N){var Ze=SU();(!Ze||Ze>9)&&ft(v[oo](),1,40,"Telemetry transmission failed, some telemetry will be lost: "+ma(N),{exception:Hn(N)})}},v._doTeardown=function(L,le){v.onunloadFlush(),g.unload(),Ce()},v[ha]=function(L,le,me){ft(v[oo](),2,26,"Failed to send telemetry.",{message:le}),v._buffer[rh](L)},v[DN]=function(L,le){for(var me=[],we=[],Oe=le.errors.reverse(),Ze=0,N=Oe;Ze<N.length;Ze++){var W=N[Ze],pe=L.splice(W.index,1)[0];yr(W.statusCode)?we[vd](pe):me[vd](pe)}L[Dt]>0&&v[Pw](L,le[Tw]),me[Dt]>0&&v[ha](me,We(null,["partial success",le[Tw],"of",le.itemsReceived].join(" "))),we[Dt]>0&&(Le(we),ft(v[oo](),2,40,"Partial success. Delivered: "+L[Dt]+", Failed: "+me[Dt]+". Will retry to send "+we[Dt]+" our of "+le[CJ]+" items"))},v[Pw]=function(L,le){v._buffer[rh](L)},v._xdrOnLoad=function(L,le){var me=kN(L);if(L&&(me+""=="200"||me===""))n=0,v[Pw](le,0);else{var we=ge(me);we&&we.itemsReceived&&we.itemsReceived>we[Tw]&&!v[jr][Cb]()?v[DN](le,we):v[ha](le,H(L))}};function _(L){return v._sample.isSampledIn(L)}function D(L,le,me,we,Oe,Ze){var N=null;if(v._appId||(N=ge(Ze),N&&N.appId&&(v._appId=N.appId)),(L<200||L>=300)&&L!==0){if((L===301||L===307||L===308)&&!P(me)){v[ha](le,Oe);return}!v[jr][Cb]()&&yr(L)?(Le(le),ft(v[oo](),2,40,". Response code "+L+". Will retry to send "+le[Dt]+" items.")):v[ha](le,Oe)}else if(g&&!g.isOnline()){if(!v[jr][Cb]()){var W=10;Le(le,W),ft(v[oo](),2,40,". Offline - Response Code: ".concat(L,". Offline status: ").concat(!g.isOnline(),". Will retry to send ").concat(le.length," items."))}}else P(me),L===206?(N||(N=ge(Ze)),N&&!v[jr][Cb]()?v[DN](le,N):v[ha](le,Oe)):(n=0,v[Pw](le,we))}function P(L){return c>=10?!1:!Ht(L)&&L!==""&&L!==v[jr][hf]()?(v[jr][hf]=function(){return L},++c,!0):!1}function M(L,le){m?m(L,!1):A(L,le)}function x(L){var le=sf(),me=v[ih],we=v[jr][hf](),Oe=v._buffer[th](L),Ze=new Blob([Oe],{type:"text/plain;charset=UTF-8"}),N=le.sendBeacon(we,Ze);return N&&(me[mf](L),v._onSuccess(L,L[Dt])),N}function A(L,le){if(Zr(L)&&L[Dt]>0&&!x(L)){for(var me=[],we=0;we<L[Dt];we++){var Oe=L[we];x([Oe])||me[vd](Oe)}me[Dt]>0&&(f&&f(me,!0),ft(v[oo](),2,40,". Failed to send telemetry with Beacon API, retried with normal sender."))}}function j(L,le){var me=new XMLHttpRequest,we=v[jr][hf]();try{me[XC]=!0}catch(Ze){}me.open("POST",we,le),me[PN]("Content-type","application/json"),lw(we)&&me[PN](sb[6],sb[7]),yi(of(d),function(Ze){me[PN](Ze,d[Ze])}),me.onreadystatechange=function(){return v._xhrReadyStateChange(me,L,L[Dt])},me.onerror=function(Ze){return v[ha](L,We(me),Ze)};var Oe=v._buffer[th](L);me.send(Oe),v._buffer[mf](L)}function re(L,le){if(Zr(L)){for(var me=L[Dt],we=0;we<L[Dt];we++)me+=L[we][Dt];p+me<=Mue?Z(L,!1):hb()?A(L,le):(f&&f(L,!0),ft(v[oo](),2,40,". Failed to send telemetry with Beacon API, retried with xhrSender."))}}function R(L,le){Z(L,!0)}function Z(L,le){var me,we=v[jr][hf](),Oe=v._buffer[th](L),Ze=new Blob([Oe],{type:"application/json"}),N=new Headers,W=Oe[Dt],pe=!1,Se=!1;lw(we)&&N.append(sb[6],sb[7]),yi(of(d),function($e){N.append($e,d[$e])});var Re=(me={method:"POST",headers:N,body:Ze},me[XC]=!0,me);le||(Re.keepalive=!0,pe=!0,p+=W);var Gt=new Request(we,Re);try{Gt[XC]=!0}catch($e){}v._buffer[mf](L);try{fetch(Gt).then(function($e){le||(p-=W,W=0),Se||(Se=!0,$e.ok?$e.text().then(function(yt){D($e.status,L,$e.url,L[Dt],$e.statusText,yt)}):v[ha](L,$e.statusText))}).catch(function($e){le||(p-=W,W=0),Se||(Se=!0,v[ha](L,$e.message))})}catch($e){Se||v[ha](L,Hn($e))}pe&&!Se&&(Se=!0,v._onSuccess(L,L[Dt]))}function ge(L){try{if(L&&L!==""){var le=rs().parse(L);if(le&&le.itemsReceived&&le.itemsReceived>=le[Tw]&&le.itemsReceived-le.itemsAccepted===le.errors[Dt])return le}}catch(me){ft(v[oo](),1,43,"Cannot parse the response. "+ma(me),{response:L})}return null}function Le(L,le){if(le===void 0&&(le=1),!(!L||L[Dt]===0)){var me=v[ih];me[rh](L),n++;for(var we=0,Oe=L;we<Oe.length;we++){var Ze=Oe[we];me[eh](Ze)}Ee(le),ae()}}function Ee(L){var le=10,me;if(n<=1)me=le;else{var we=(Math.pow(2,n)-1)/2,Oe=Math.floor(Math.random()*we*le)+1;Oe=L*Oe,me=Math.max(Math.min(Oe,3600),le)}var Ze=md()+me*1e3;i=Ze}function ae(){if(!a&&!s){var L=i?Math.max(0,i-md()):0,le=Math.max(v[jr][UU](),L);a=setTimeout(function(){a=null,v[nh](!0,null,1)},le)}}function kt(){clearTimeout(a),a=null,i=null}function yr(L){return L===401||L===403||L===408||L===429||L===500||L===502||L===503||L===504}function We(L,le){return L?"XMLHttpRequest,Status:"+L.status+",Response:"+kN(L)||L.response||"":le}function $r(L,le){var me=v[ih],we=gb(),Oe=new XDomainRequest;Oe.onload=function(){return v._xdrOnLoad(Oe,L)},Oe.onerror=function(pe){return v[ha](L,H(Oe),pe)};var Ze=we&&we.location&&we.location.protocol||"";if(v[jr][hf]().lastIndexOf(Ze,0)!==0){ft(v[oo](),2,40,". Cannot send XDomain request. The endpoint URL protocol doesn't match the hosting page protocol."),me[ff]();return}var N=v[jr][hf]().replace(/^(https?:)/,"");Oe.open("POST",N);var W=me[th](L);Oe.send(W),me[mf](L)}function H(L,le){return L?"XDomainRequest,Response:"+kN(L)||"":le}function de(){var L="getNotifyMgr";return v.core[L]?v.core[L]():v.core._notificationManager}function Pe(L,le){var me=de();if(me&&me[WU])try{me[WU](L,le)}catch(we){ft(v[oo](),1,74,"send request notification failed: "+ma(we),{exception:Hn(we)})}}function ye(L){var le=Ht(L[VU])?!1:L[VU];if(le)return!0;var me="^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$",we=new RegExp(me);return we.test(L[Dw])}function Ce(){v[Sb]=null,v[ih]=null,v._appId=null,v._sample=null,d={},g=null,n=0,i=null,o=null,s=!1,a=null,l=null,c=0,p=0,f=null,m=null,h=null}}),t}return e.constructEnvelope=function(t,n,i,o){var s;n!==t.iKey&&!Ht(n)?s=Eo(Eo({},t),{iKey:n}):s=t;var a=Oue[s.baseType]||BU;return a(i,s,o)},e}(RU)});var HU=ee(()=>{u();zJ()});var Sl,is,Nw,_l,Ut,Ts,Nc,NN,ks,vt,lh,Br,RN,ch,uh,JU,Rw,dh,wb,Aw,yf,Ns,xb,bf,El,Db,ph,Rs,va,If,Sd,qU,Sf,Cl,Mw,Ow,_d,fh,AN,Pb,wl,GU,QJ,XJ,Gn,Lw,ZJ,mh,Kw,gh,xl,MN,ON,LN,KN,Rn=ee(()=>{u();Sl="initialize",is="name",Nw="getNotifyMgr",_l="identifier",Ut="push",Ts="isInitialized",Nc="config",NN="instrumentationKey",ks="logger",vt="length",lh="time",Br="processNext",RN="getProcessTelContext",ch="addNotificationListener",uh="removeNotificationListener",JU="stopPollingInternalLogs",Rw="onComplete",dh="getPlugin",wb="flush",Aw="_extensions",yf="splice",Ns="teardown",xb="messageId",bf="message",El="isAsync",Db="_doTeardown",ph="update",Rs="getNext",va="diagLog",If="setNextPlugin",Sd="createNew",qU="cookieCfg",Sf="indexOf",Cl="substring",Mw="userAgent",Ow="split",_d="setEnabled",fh="substr",AN="nodeType",Pb="apply",wl="replace",GU="enableDebugExceptions",QJ="logInternalMessage",XJ="toLowerCase",Gn="call",Lw="type",ZJ="handler",mh="listeners",Kw="isChildEvt",gh="getCtx",xl="setCtx",MN="complete",ON="traceId",LN="spanId",KN="traceFlags"});var Pt,YU,fn,$U,Fw,Tb,eq,os,ya,kb,_f,Nb,Ef,FN,Uw,hh,Ii=ee(()=>{u();Pt="",YU="channels",fn="core",$U="createPerfMgr",Fw="disabled",Tb="extensionConfig",eq="extensions",os="processTelemetry",ya="priority",kb="eventsSent",_f="eventsDiscarded",Nb="eventsSendRequest",Ef="perfEvent",FN="errorToConsole",Uw="warnToConsole",hh="getPerfMgr"});function Gue(r){if(r){if(WN)return WN(r);var e=r[Kue]||r[Kt]||r[UN];if(e)return e}return null}function t2(r,e){return typeof r===e}function An(r){return r===void 0||typeof r===Xt}function ar(r){return r===null||An(r)}function r2(r){return!ar(r)}function n2(r,e){return!!(r&&or[Gn](r,e))}function Ed(r){return!!(r&&typeof r===dt)}function wr(r){return!!(r&&typeof r===rn)}function Ww(r){var e=r;return e&&Cf(e)&&(e=e[wl](Hue,function(t,n){return n.toUpperCase()}),e=e[wl](Jue,"_"),e=e[wl](que,function(t,n){return"_"+n})),e}function Cd(r,e){if(r)for(var t in r)or[Gn](r,t)&&e[Gn](r,t,r[t])}function i2(r,e){var t=!1;return r&&e&&!(t=r===e)&&(t=Uue?r[cq](e):Yue(r,e)),t}function Yue(r,e){var t=!1,n=e?e[vt]:0,i=r?r[vt]:0;if(n&&i&&i>=n&&!(t=r===e)){for(var o=i-1,s=n-1;s>=0;s--){if(r[o]!=e[s])return!1;o--}t=!0}return t}function Ai(r,e){return r&&e?r[Sf](e)!==-1:!1}function o2(r){return!!(r&&e2[Gn](r)==="[object Date]")}function $ue(r){return!!(r&&e2[Gn](r)==="[object Array]")}function VN(r){return!!(r&&e2[Gn](r)==="[object Error]")}function Cf(r){return typeof r=="string"}function s2(r){return typeof r=="number"}function Rb(r){return typeof r=="boolean"}function sq(r){var e=!1;if(r&&typeof r=="object"){var t=WN?WN(r):Gue(r);t?(t[UN]&&or[Gn](t,UN)&&(t=t[UN]),e=typeof t===rn&&dq[Gn](t)===Bue):e=!0}return e}function Ab(r){if(r)return Vue?r[lq]():zue(r)}function zue(r){if(r&&r.getUTCFullYear){var e=function(t){var n=String(t);return n[vt]===1&&(n="0"+n),n};return r.getUTCFullYear()+"-"+e(r.getUTCMonth()+1)+"-"+e(r.getUTCDate())+"T"+e(r.getUTCHours())+":"+e(r.getUTCMinutes())+":"+e(r.getUTCSeconds())+"."+String((r.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"}}function Et(r,e,t){var n=r[vt];try{for(var i=0;i<n&&!(i in r&&e[Gn](t||r,r[i],i,r)===-1);i++);}catch(o){}}function ba(r,e,t){if(r){if(r[tq])return r[tq](e,t);var n=r[vt],i=t||0;try{for(var o=Math.max(i>=0?i:n-Math.abs(i),0);o<n;o++)if(o in r&&r[o]===e)return o}catch(s){}}return-1}function a2(r,e,t){var n;if(r){if(r[rq])return r[rq](e,t);var i=r[vt],o=t||r;n=new Array(i);try{for(var s=0;s<i;s++)s in r&&(n[s]=e[Gn](o,r[s],r))}catch(a){}}return n}function l2(r,e,t){var n;if(r){if(r[nq])return r[nq](e,t);var i=r[vt],o=0;if(arguments[vt]>=3)n=arguments[2];else{for(;o<i&&!(o in r);)o++;n=r[o++]}for(;o<i;)o in r&&(n=e(n,r[o],o,r)),o++}return n}function Dl(r){return r&&(r=Fue&&r[QU]?r[QU]():r[wl]?r[wl](/^\s+|(?=\s)\s+$/g,Pt):r),r}function Mb(r){var e=typeof r;if(e!==rn&&(e!==dt||r===null)&&oa("objKeys called on non-object"),!aq&&oq)return oq(r);var t=[];for(var n in r)r&&or[Gn](r,n)&&t[Ut](n);if(aq)for(var i=zU[vt],o=0;o<i;o++)r&&or[Gn](r,zU[o])&&t[Ut](zU[o]);return t}function Ob(r,e,t,n){if(iq)try{var i={enumerable:!0,configurable:!0};return t&&(i.get=t),n&&(i.set=n),iq(r,e,i),!0}catch(o){}return!1}function Que(r){return r}function c2(r){return XU&&Cd(r,function(e,t){(an(t)||Ed(t))&&XU(t)}),Rc(r)}function Pl(){var r=Date;return r.now?r.now():new r().getTime()}function Vw(r){return VN(r)?r[is]:Pt}function Ia(r,e,t,n,i){var o=t;return r&&(o=r[e],o!==t&&(!i||i(o))&&(!n||n(t))&&(o=t,r[e]=o)),o}function Lb(r,e,t){var n;return r?(n=r[e],!n&&ar(n)&&(n=An(t)?{}:t,r[e]=n)):n=An(t)?{}:t,n}function Sa(r,e){return ar(r)?e:r}function jN(r){return!!r}function ii(r){throw new Error(r)}function Xue(r,e){var t=null,n=null;return wr(r)?t=r:n=r,function(){var i=arguments;if(t&&(n=t()),n)return n[e][Pb](n,i)}}function Kb(r,e,t,n,i){r&&e&&t&&(i!==!1||An(r[e]))&&(r[e]=Xue(t,n))}function wd(r,e,t,n){return r&&e&&Ed(r)&&an(t)&&Et(t,function(i){Cf(i)&&Kb(r,i,e,i,n)}),r}function Fb(r,e,t,n,i,o){var s=arguments,a=s[0]||{},l=s[vt],c=!1,d=1;for(l>0&&Rb(a)&&(c=a,a=s[d]||{},d++),Ed(a)||(a={});d<l;d++){var p=s[d],f=an(p),m=Ed(p);for(var g in p){var h=f&&g in p||m&&or[Gn](p,g);if(h){var v=p[g],S=void 0;if(c&&v&&((S=an(v))||sq(v))){var _=a[g];S?an(_)||(_=[]):sq(_)||(_={}),v=Fb(c,_,v)}v!==void 0&&(a[g]=v)}}}return a}var lq,cq,Lue,tq,rq,nq,QU,uq,Kue,UN,iq,XU,K9e,oq,ZU,Fue,Uue,F9e,Wue,Vue,jue,e2,dq,Bue,Hue,Jue,que,WN,an,aq,zU,Rc,Yn=ee(()=>{u();sr();Rn();Ii();lq="toISOString",cq="endsWith",Lue="startsWith",tq="indexOf",rq="map",nq="reduce",QU="trim",uq="toString",Kue="__proto__",UN="constructor",iq=So,XU=Er.freeze,K9e=Er.seal,oq=Er.keys,ZU=String[Kt],Fue=ZU[QU],Uue=ZU[cq],F9e=ZU[Lue],Wue=Date[Kt],Vue=Wue[lq],jue=Array.isArray,e2=ia[uq],dq=or[uq],Bue=dq[Gn](Er),Hue=/-([a-z])/g,Jue=/([^\w\d_$])/g,que=/^(\d+[\w\d_$])/,WN=Object.getPrototypeOf;an=jue||$ue;aq=!{toString:null}.propertyIsEnumerable("toString"),zU=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"];Rc=XU||Que});function u2(r){var e={};return Cd(r,function(t,n){e[t]=n,e[n]=t}),c2(e)}var pq=ee(()=>{u();Yn()});function As(r){var e=Vn();return e&&e[r]?e[r]:r===fq&&gq()?window:null}function gq(){return!!(typeof window===dt&&window)}function hq(){return gq()?window:As(fq)}function cde(){return!!(typeof document===dt&&document)}function BN(){return cde()?document:As(Zue)}function ude(){return!!(typeof navigator===dt&&navigator)}function f2(){return ude()?navigator:As(ede)}function vq(r){if(r&&lde){var e=As("__mockLocation");if(e)return e}return typeof location===dt&&location?location:As(tde)}function yq(){return typeof console!==Xt?console:As(rde)}function bq(){return As(nde)}function HN(){return!!(typeof JSON===dt&&JSON||As(mq)!==null)}function m2(){return HN()?JSON||As(mq):null}function Iq(){return As(ide)}function Sq(){return As(ode)}function vh(){var r=f2();if(r&&(r[Mw]!==p2||d2===null)){p2=r[Mw];var e=(p2||Pt)[XJ]();d2=Ai(e,sde)||Ai(e,ade)}return d2}function _a(r){var e=Object[Kt].toString[Gn](r),t=Pt;return e==="[object Error]"?t="{ stack: '"+r.stack+"', message: '"+r.message+"', name: '"+r[is]+"'":HN()&&(t=m2().stringify(r)),e+t}var fq,Zue,ede,tde,rde,nde,mq,ide,ode,sde,ade,d2,p2,lde,Ac=ee(()=>{"use strict";u();sr();Rn();Yn();Ii();fq="window",Zue="document",ede="navigator",tde="location",rde="console",nde="performance",mq="JSON",ide="crypto",ode="msCrypto",sde="msie",ade="trident/",d2=null,p2=null,lde=!1});function dde(r,e){return function(){var t=arguments,n=h2(e);if(n){var i=n.listener;i&&i[r]&&i[r][Pb](i,t)}}}function pde(){var r=As("Microsoft");return r&&(qN=r.ApplicationInsights),qN}function h2(r){var e=qN;return!e&&r.disableDbgExt!==!0&&(e=qN||pde()),e?e.ChromeDbgExt:null}function _q(r){if(!JN){JN={};for(var e=0;e<g2[vt];e++)JN[g2[e]]=dde(g2[e],r)}return JN}var g2,qN,JN,v2=ee(()=>{u();Rn();Ac();g2=["eventsSent","eventsDiscarded","eventsSendRequest","perfEvent"],qN=null});function Eq(r){return r?'"'+r[wl](/\"/g,Pt)+'"':Pt}function Cq(r,e){var t=yq();if(t){var n="log";t[r]&&(n=r),wr(t[n])&&t[n](e)}}function wq(r,e){return(r||{})[ks]||new Ub(e)}function xq(r){return r||new Ub}function Tl(r,e,t,n,i,o){o===void 0&&(o=!1),xq(r).throwInternal(e,t,n,i,o)}function Dq(r,e){xq(r)[Uw](e)}var fde,mde,gde,GN,Ub,yh=ee(()=>{"use strict";u();pr();Rn();v2();Ac();Yn();Ii();fde="AI (Internal): ",mde="AI: ",gde="AITR_";GN=function(){function r(e,t,n,i){n===void 0&&(n=!1);var o=this;o[xb]=e,o[bf]=(n?mde:fde)+e;var s=Pt;HN()&&(s=m2().stringify(i));var a=(t?" message:"+Eq(t):Pt)+(i?" props:"+Eq(s):Pt);o[bf]+=a}return r.dataType="MessageData",r}();Ub=function(){function r(e){this.identifier="DiagnosticLogger",this.queue=[];var t=0,n={},i,o,s,a;Be(r,this,function(l){d(e||{}),l.consoleLoggingLevel=function(){return i},l.telemetryLoggingLevel=function(){return o},l.maxInternalMessageLimit=function(){return s},l[GU]=function(){return a},l.throwInternal=function(m,g,h,v,S){S===void 0&&(S=!1);var _=new GN(g,h,S,v);if(a)throw _a(_);var D=m===1?FN:Uw;if(An(_[bf]))f("throw"+(m===1?"Critical":"Warning"),_);else{if(S){var P=+_[xb];!n[P]&&i>=m&&(l[D](_[bf]),n[P]=!0)}else i>=m&&l[D](_[bf]);c(m,_)}},l[Uw]=function(m){Cq("warn",m),f("warning",m)},l[FN]=function(m){Cq("error",m),f("error",m)},l.resetInternalMessageCount=function(){t=0,n={}},l[QJ]=c;function c(m,g){if(!p()){var h=!0,v=gde+g[xb];if(n[v]?h=!1:n[v]=!0,h&&(m<=o&&(l.queue[Ut](g),t++,f(m===1?"error":"warn",g)),t===s)){var S="Internal events throttle limit per PageView reached for this app.",_=new GN(23,S,!1);l.queue[Ut](_),m===1?l[FN](S):l[Uw](S)}}}function d(m){i=Sa(m.loggingLevelConsole,0),o=Sa(m.loggingLevelTelemetry,1),s=Sa(m.maxMessageLimit,25),a=Sa(m[GU],!1)}function p(){return t>=s}function f(m,g){var h=h2(e||{});h&&h[va]&&h[va](m,g)}})}return r.__ieDyn=1,r}()});function $N(r,e,t,n,i){if(r){var o=r;if(o[hh]&&(o=o[hh]()),o){var s=void 0,a=o[gh](y2);try{if(s=o.create(e(),n,i),s){if(a&&s[xl]&&(s[xl](YN[b2],a),a[gh]&&a[xl])){var l=a[gh](YN[jw]);l||(l=[],a[xl](YN[jw],l)),l[Ut](s)}return o[xl](y2,s),t(s)}}catch(c){s&&s[xl]&&s[xl]("exception",c)}finally{s&&o.fire(s),o[xl](y2,a)}}}return t()}function Tq(){return hde}var Wb,b2,jw,hde,YN,Pq,y2,zN=ee(()=>{u();pr();Rn();Yn();Ii();Wb="ctx",b2="ParentContextKey",jw="ChildrenContextKey",hde=null,YN=function(){function r(e,t,n){var i=this,o=!1;if(i.start=Pl(),i[is]=e,i[El]=n,i[Kw]=function(){return!1},wr(t)){var s;o=Ob(i,"payload",function(){return!s&&wr(t)&&(s=t(),t=null),s})}i[gh]=function(a){return a?a===r[b2]||a===r[jw]?i[a]:(i[Wb]||{})[a]:null},i[xl]=function(a,l){if(a)if(a===r[b2])i[a]||(i[Kw]=function(){return!0}),i[a]=l;else if(a===r[jw])i[a]=l;else{var c=i[Wb]=i[Wb]||{};c[a]=l}},i[MN]=function(){var a=0,l=i[gh](r[jw]);if(an(l))for(var c=0;c<l[vt];c++){var d=l[c];d&&(a+=d[lh])}i[lh]=Pl()-i.start,i.exTime=i[lh]-a,i[MN]=function(){},!o&&wr(t)&&(i.payload=t())}}return r.ParentContextKey="parent",r.ChildrenContextKey="childEvts",r}(),Pq=function(){function r(e){this.ctx={},Be(r,this,function(t){t.create=function(n,i,o){return new YN(n,i,o)},t.fire=function(n){n&&(n[MN](),e&&wr(e[Ef])&&e[Ef](n))},t[xl]=function(n,i){if(n){var o=t[Wb]=t[Wb]||{};o[n]=i}},t[gh]=function(n){return(t[Wb]||{})[n]}})}return r.__ieDyn=1,r}(),y2="CoreUtils.doPerf"});function Rq(r){r<0&&(r>>>=0),Bw=123456789+r&wf,Hw=987654321-r&wf,Nq=!0}function Aq(){try{var r=Pl()&2147483647;Rq((Math.random()*kq^r)+r)}catch(e){}}function Mq(r){return r>0?Math.floor(bh()/wf*(r+1))>>>0:0}function bh(r){var e=0,t=Iq()||Sq();return t&&t.getRandomValues&&(e=t.getRandomValues(new Uint32Array(1))[0]&wf),e===0&&vh()&&(Nq||Aq(),e=I2()&wf),e===0&&(e=Math.floor(kq*Math.random()|0)),r||(e>>>=0),e}function Oq(r){r?Rq(r):Aq()}function I2(r){Hw=36969*(Hw&65535)+(Hw>>16)&wf,Bw=18e3*(Bw&65535)+(Bw>>16)&wf;var e=(Hw<<16)+(Bw&65535)>>>0&wf|0;return r||(e>>>=0),e}function QN(r){r===void 0&&(r=22);for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=bh()>>>0,n=0,i=Pt;i[vt]<r;)n++,i+=e.charAt(t&63),t>>>=6,n===5&&(t=(bh()<<2&4294967295|t&3)>>>0,n=0);return i}var kq,wf,Nq,Bw,Hw,S2=ee(()=>{u();Rn();Ac();Yn();Ii();kq=4294967296,wf=4294967295,Nq=!1,Bw=123456789,Hw=987654321});function bde(r,e,t){if(Lq)try{return Lq(r,e,{value:t,enumerable:!1,configurable:!0}),!0}catch(n){}return!1}function Fq(r){return r[AN]===1||r[AN]===9||!+r[AN]}function Ide(r,e){var t=e[r.id];if(!t){t={};try{Fq(e)&&(bde(e,r.id,t)||(e[r.id]=t))}catch(n){}}return t}function Vb(r,e){return e===void 0&&(e=!1),Ww(r+yde+++(e?"."+Kq:Pt)+vde)}function XN(r){var e={id:Vb("_aiData-"+(r||Pt)+"."+Kq),accept:function(t){return Fq(t)},get:function(t,n,i,o){var s=t[e.id];return s?s[Ww(n)]:(o&&(s=Ide(e,t),s[Ww(n)]=i),i)},kill:function(t,n){if(t&&t[n])try{delete t[n]}catch(i){}}};return e}var Lq,Kq,vde,yde,ZN=ee(()=>{u();sr();Rn();Yn();Ii();S2();Lq=So,Kq="2.8.11",vde="."+QN(6),yde=0});function $q(r,e){var t=Jw[jb]||r0[jb];return t||(t=Jw[jb]=Jw(r,e),r0[jb]=t),t}function t0(r){return r?r.isEnabled():!0}function Sde(r){var e=r[qU]=r[qU]||{};if(Ia(e,"domain",r.cookieDomain,r2,ar),Ia(e,"path",r.cookiePath||"/",null,ar),ar(e[C2])){var t=void 0;An(r[Vq])||(t=!r[Vq]),An(r[jq])||(t=!r[jq]),e[C2]=t}return e}function zq(r,e){return e&&r&&an(r.ignoreCookies)?r.ignoreCookies[Sf](e)!==-1:!1}function _de(r,e){return e&&r&&an(r.blockedCookies)&&r.blockedCookies[Sf](e)!==-1?!0:zq(r,e)}function Jw(r,e){var t,n=Sde(r||r0),i=n.path||"/",o=n.domain,s=n[C2]!==!1,a=(t={isEnabled:function(){var l=s&&Jq(e),c=r0[jb];return l&&c&&a!==c&&(l=t0(c)),l}},t[_d]=function(l){s=l!==!1},t.set=function(l,c,d,p,f){var m=!1;if(t0(a)&&!_de(n,l)){var g={},h=Dl(c||Pt),v=h[Sf](";");if(v!==-1&&(h=Dl(c[Cl](0,v)),g=Qq(c[Cl](v+1))),Ia(g,"domain",p||o,jN,An),!ar(d)){var S=vh();if(An(g[_2])){var _=Pl(),D=_+d*1e3;if(D>0){var P=new Date;P.setTime(D),Ia(g,_2,qq(P,S?Uq:Wq)||qq(P,S?Uq:Wq)||Pt,jN)}}S||Ia(g,"max-age",Pt+d,null,An)}var M=vq();M&&M.protocol==="https:"&&(Ia(g,"secure",null,null,An),E2===null&&(E2=!Cde((f2()||{})[Mw])),E2&&Ia(g,"SameSite","None",null,An)),Ia(g,"path",f||i,null,An);var x=n.setCookie||Yq;x(l,Gq(h,g)),m=!0}return m},t.get=function(l){var c=Pt;return t0(a)&&!zq(n,l)&&(c=(n.getCookie||Ede)(l)),c},t.del=function(l,c){var d=!1;return t0(a)&&(d=a.purge(l,c)),d},t.purge=function(l,c){var d,p=!1;if(Jq(e)){var f=(d={},d.path=c||"/",d[_2]="Thu, 01 Jan 1970 00:00:01 GMT",d);vh()||(f["max-age"]="0");var m=n.delCookie||Yq;m(l,Gq(Pt,f)),p=!0}return p},t);return a[jb]=a,a}function Jq(r){if(e0===null){e0=!1;try{var e=qw||{};e0=e[w2]!==void 0}catch(t){Tl(r,2,68,"Cannot access document.cookie - "+Vw(t),{exception:_a(t)})}}return e0}function Qq(r){var e={};if(r&&r[vt]){var t=Dl(r)[Ow](";");Et(t,function(n){if(n=Dl(n||Pt),n){var i=n[Sf]("=");i===-1?e[n]=null:e[Dl(n[Cl](0,i))]=Dl(n[Cl](i+1))}})}return e}function qq(r,e){return wr(r[e])?r[e]():null}function Gq(r,e){var t=r||Pt;return Cd(e,function(n,i){t+="; "+n+(ar(i)?Pt:"="+i)}),t}function Ede(r){var e=Pt;if(qw){var t=qw[w2]||Pt;Bq!==t&&(Hq=Qq(t),Bq=t),e=Dl(Hq[r]||Pt)}return e}function Yq(r,e){qw&&(qw[w2]=r+"="+e)}function Cde(r){return Cf(r)?!!(Ai(r,"CPU iPhone OS 12")||Ai(r,"iPad; CPU OS 12")||Ai(r,"Macintosh; Intel Mac OS X 10_14")&&Ai(r,"Version/")&&Ai(r,"Safari")||Ai(r,"Macintosh; Intel Mac OS X 10_14")&&i2(r,"AppleWebKit/605.1.15 (KHTML, like Gecko)")||Ai(r,"Chrome/5")||Ai(r,"Chrome/6")||Ai(r,"UnrealEngine")&&!Ai(r,"Chrome")||Ai(r,"UCBrowser/12")||Ai(r,"UCBrowser/11")):!1}var Uq,Wq,w2,_2,C2,Vq,jq,jb,e0,E2,Bq,qw,Hq,r0,x2=ee(()=>{u();Rn();yh();Ac();Yn();Ii();Uq="toGMTString",Wq="toUTCString",w2="cookie",_2="expires",C2="enabled",Vq="isCookieUseDisabled",jq="disableCookiesUsage",jb="_ckMgr",e0=null,E2=null,Bq=null,qw=BN(),Hq={},r0={}});function e4(r){return r&&r[wl]?r[wl](/^[\s\.]+|(?=[\s\.])[\.\s]+$/g,Pt):r}function Nde(r,e){var t;if(e){var n=Pt;an(e)?(n=Pt,Et(e,function(o){o=e4(o),o&&(o[0]!=="."&&(o="."+o),n+=o)})):n=e4(e),n&&(n[0]!=="."&&(n="."+n),r=(r||Pt)+n)}var i=kde.exec(r||Pt)||[];return t={},t[Lw]=i[1],t.ns=(i[2]||Pt).replace(Dde,".").replace(Pde,Pt)[Ow](".").sort().join("."),t}function Rde(r,e,t){t===void 0&&(t=!0);var n=t4.get(r,xde,{},t),i=n[e];return i||(i=n[e]=[]),i}function Ade(r,e,t,n){var i=!1;return r&&e&&e[Lw]&&t&&(r[Zq]?(r[Zq](e[Lw],t,n),i=!0):r[Xq]&&(r[Xq](wde+e[Lw],t),i=!0)),i}function D2(r,e,t,n,i){var o;i===void 0&&(i=!1);var s=!1;if(r)try{var a=Nde(e,n);if(s=Ade(r,a,t,i),s&&t4.accept(r)){var l=(o={guid:Tde++,evtName:a},o[ZJ]=t,o.capture=i,o);Rde(r,a.type)[Ut](l)}}catch(c){}return s}function r4(r,e,t){var n=!1,i=hq();i&&(n=D2(i,r,e,t),n=D2(i.body,r,e,t)||n);var o=BN();return o&&(n=D2(o,r,e,t)||n),n}var wde,Xq,Zq,xde,UBe,WBe,Dde,Pde,Tde,t4,kde,n4=ee(()=>{u();Rn();ZN();Ac();Yn();Ii();wde="on",Xq="attachEvent",Zq="addEventListener",xde="events",UBe=Vb("aiEvtPageHide"),WBe=Vb("aiEvtPageShow"),Dde=/\.[\.]+/g,Pde=/[\.]+$/,Tde=1,t4=XN("events"),kde=/^([^.]*)(?:\.(.+)|)/});function i4(){var r=P2();return r[Cl](0,8)+"-"+r[Cl](8,12)+"-"+r[Cl](12,16)+"-"+r[Cl](16,20)+"-"+r[Cl](20)}function o4(){var r=bq();return r&&r.now?r.now():Pl()}function P2(){for(var r=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],e=Pt,t,n=0;n<4;n++)t=bh(),e+=r[t&15]+r[t>>4&15]+r[t>>8&15]+r[t>>12&15]+r[t>>16&15]+r[t>>20&15]+r[t>>24&15]+r[t>>28&15];var i=r[8+(bh()&3)|0];return e[fh](0,8)+e[fh](9,4)+"4"+e[fh](13,3)+i+e[fh](16,3)+e[fh](19,12)}function s4(r,e){var t=$q(r,e),n=$w._canUseCookies;return Gw===null&&(Gw=[],Yw=n,Ob($w,"_canUseCookies",function(){return Yw},function(i){Yw=i,Et(Gw,function(o){o[_d](i)})})),ba(Gw,t)===-1&&Gw[Ut](t),Rb(n)&&t[_d](n),Rb(Yw)&&t[_d](Yw),t}function a4(){s4()[_d](!1)}var Gw,Yw,$w,l4=ee(()=>{"use strict";u();sr();Rn();x2();Ac();n4();Yn();Ii();S2();Gw=null;$w={_canUseCookies:void 0,isTypeof:t2,isUndefined:An,isNullOrUndefined:ar,hasOwnProperty:n2,isFunction:wr,isObject:Ed,isDate:o2,isArray:an,isError:VN,isString:Cf,isNumber:s2,isBoolean:Rb,toISOString:Ab,arrForEach:Et,arrIndexOf:ba,arrMap:a2,arrReduce:l2,strTrim:Dl,objCreate:_o,objKeys:Mb,objDefineAccessors:Ob,addEventHandler:r4,dateNow:Pl,isIE:vh,disableCookies:a4,newGuid:i4,perfNow:o4,newId:QN,randomValue:Mq,random32:bh,mwcRandomSeed:Oq,mwcRandom32:I2,generateW3CId:P2}});function c4(r,e,t){return r&&r[vt]===e&&r!==t?!!r.match(/^[\da-f]*$/):!1}function u4(r){return c4(r,32,Mde)}function d4(r){return c4(r,16,Ode)}var Mde,Ode,p4=ee(()=>{u();Rn();Mde="00000000000000000000000000000000",Ode="0000000000000000"});function xd(r){return Lde.get(r,"state",{},!0)}function n0(r,e){for(var t=[],n=null,i=r[Rs](),o;i;){var s=i[dh]();if(s){n&&wr(n[If])&&wr(s[os])&&n[If](s);var a=!1;wr(s[Ts])?a=s[Ts]():(o=xd(s),a=o[Ts]),a||t[Ut](s),n=s,i=i[Rs]()}}Et(t,function(l){var c=r[fn]();l[Sl](r.getCfg(),c,e,r[Rs]()),o=xd(l),!l[fn]&&!o[fn]&&(o[fn]=c),o[Ts]=!0,delete o[Ns]})}function i0(r){return r.sort(function(e,t){var n=0;if(t){var i=wr(t[os]);wr(e[os])?n=i?e[ya]-t[ya]:1:i&&(n=-1)}else n=e?1:-1;return n})}function f4(r){var e={};return{getName:function(){return e[is]},setName:function(t){r&&r.setName(t),e[is]=t},getTraceId:function(){return e[ON]},setTraceId:function(t){r&&r.setTraceId(t),u4(t)&&(e[ON]=t)},getSpanId:function(){return e[LN]},setSpanId:function(t){r&&r.setSpanId(t),d4(t)&&(e[LN]=t)},getTraceFlags:function(){return e[KN]},setTraceFlags:function(t){r&&r.setTraceFlags(t),e[KN]=t}}}var Lde,o0=ee(()=>{"use strict";u();Rn();ZN();Yn();Ii();p4();Lde=XN("plugin")});function Fde(r,e,t){for(;r;){if(r[dh]()===t)return r;r=r[Rs]()}return Mc([t],e[Nc]||{},e)}function T2(r,e,t,n){var i=null,o=[];n!==null&&(i=n?Fde(r,t,n):r);var s={_next:l,ctx:{core:function(){return t},diagLog:function(){return wq(t,e)},getCfg:function(){return e},getExtCfg:c,getConfig:d,hasNext:function(){return!!i},getNext:function(){return i},setNext:function(f){i=f},iterate:p,onComplete:a}};function a(f,m){for(var g=[],h=2;h<arguments.length;h++)g[h-2]=arguments[h];f&&o[Ut]({func:f,self:An(m)?s.ctx:m,args:g})}function l(){var f=i;if(i=f?f[Rs]():null,!f){var m=o;m&&m[vt]>0&&(Et(m,function(g){try{g.func[Gn](g.self,g.args)}catch(h){Tl(t[ks],2,73,"Unexpected Exception during onComplete - "+_a(h))}}),o=[])}return f}function c(f,m,g){m===void 0&&(m={}),g===void 0&&(g=0);var h;if(e){var v=e[Tb];v&&f&&(h=v[f])}if(!h)h=m;else if(Ed(m)&&g!==0){var S=Fb(!0,m,h);e&&g===2&&Cd(m,function(_){if(ar(S[_])){var D=e[_];ar(D)||(S[_]=D)}}),h=S}return h}function d(f,m,g){g===void 0&&(g=!1);var h,v=c(f,null);return v&&!ar(v[m])?h=v[m]:e&&!ar(e[m])&&(h=e[m]),ar(h)?g:h}function p(f){for(var m;m=s._next();){var g=m[dh]();g&&f(g)}}return s}function kl(r,e,t,n){var i=T2(r,e,t,n),o=i.ctx;function s(l){var c=i._next();return c&&c[os](l,o),!c}function a(l,c){return l===void 0&&(l=null),an(l)&&(l=Mc(l,e,t,c)),kl(l||o[Rs](),e,t,c)}return o[Br]=s,o[Sd]=a,o}function Bb(r,e,t){var n=e[Nc]||{},i=T2(r,n,e,t),o=i.ctx;function s(l){var c=i._next();return c&&c.unload(o,l),!c}function a(l,c){return l===void 0&&(l=null),an(l)&&(l=Mc(l,n,e,c)),Bb(l||o[Rs](),e,c)}return o[Br]=s,o[Sd]=a,o}function zw(r,e,t){var n=e[Nc]||{},i=T2(r,n,e,t),o=i.ctx;function s(l){return o.iterate(function(c){wr(c[ph])&&c[ph](o,l)})}function a(l,c){return l===void 0&&(l=null),an(l)&&(l=Mc(l,n,e,c)),zw(l||o[Rs](),e,c)}return o[Br]=s,o[Sd]=a,o}function Mc(r,e,t,n){var i=null,o=!n;if(an(r)&&r[vt]>0){var s=null;Et(r,function(a){if(!o&&n===a&&(o=!0),o&&a&&wr(a[os])){var l=Ude(a,e,t);i||(i=l),s&&s._setNext(l),s=l}})}return n&&!i?Mc([n],e,t):i}function Ude(r,e,t){var n=null,i=wr(r[os]),o=wr(r[If]),s;r?s=r[_l]+"-"+r[ya]+"-"+h4++:s="Unknown-0-"+h4++;var a={getPlugin:function(){return r},getNext:function(){return n},processTelemetry:d,unload:p,update:f,_id:s,_setNext:function(m){n=m}};function l(){var m;return r&&wr(r[g4])&&(m=r[g4]()),m||(m=kl(a,e,t)),m}function c(m,g,h,v,S){var _=!1,D=r?r[_l]:Kde,P=m[m4];return P||(P=m[m4]={}),m.setNext(n),r&&$N(m[fn](),function(){return D+":"+h},function(){P[s]=!0;try{var M=n?n._id:Pt;M&&(P[M]=!1),_=g(m)}catch(A){var x=n?P[n._id]:!0;x&&(_=!0),(!n||!x)&&Tl(m[va](),1,73,"Plugin ["+D+"] failed during "+h+" - "+_a(A)+", run flags: "+_a(P))}},v,S),_}function d(m,g){g=g||l();function h(v){if(!r||!i)return!1;var S=xd(r);return S[Ns]||S[Fw]?!1:(o&&r[If](n),r[os](m,v),!0)}c(g,h,"processTelemetry",function(){return{item:m}},!m.sync)||g[Br](m)}function p(m,g){function h(){var v=!1;if(r){var S=xd(r),_=r[fn]||S[fn];r&&(!_||_===m.core())&&!S[Ns]&&(S[fn]=null,S[Ns]=!0,S[Ts]=!1,r[Ns]&&r[Ns](m,g)===!0&&(v=!0))}return v}c(m,h,"unload",function(){},g[El])||m[Br](g)}function f(m,g){function h(){var v=!1;if(r){var S=xd(r),_=r[fn]||S[fn];r&&(!_||_===m.core())&&!S[Ns]&&r[ph]&&r[ph](m,g)===!0&&(v=!0)}return v}c(m,h,"update",function(){},!1)||m[Br](g)}return Rc(a)}var Kde,m4,g4,h4,bHe,s0=ee(()=>{"use strict";u();Rn();yh();Ac();Yn();Ii();zN();o0();Kde="TelemetryPluginChain",m4="_hasRun",g4="_getTelCtx",h4=0;bHe=function(){function r(e,t,n,i){var o=this,s=kl(e,t,n,i);wd(o,s,Mb(s))}return r}()});function v4(r,e,t){e&&an(e)&&e[vt]>0&&(e=e.sort(function(n,i){return n[ya]-i[ya]}),Et(e,function(n){n[ya]<Qw&&ii(Wde+n[_l])}),r[Ut]({queue:Rc(e),chain:Mc(e,t[Nc],t)}))}function y4(r,e){function t(){return kl(null,e[Nc],e,null)}function n(c,d,p,f){var m=c?c[vt]+1:1;function g(){m--,m===0&&(f&&f(),f=null)}m>0&&Et(c,function(h){if(h&&h.queue[vt]>0){var v=h.chain,S=d[Sd](v);S[Rw](g),p(S)}else m--}),g()}function i(c,d){var p=d||{reason:0};return n(r,c,function(f){f[Br](p)},function(){c[Br](p)}),!0}function o(c,d){var p=d||{reason:0,isAsync:!1};return n(r,c,function(f){f[Br](p)},function(){c[Br](p),a=!1}),!0}function s(c){var d=null;return r&&r[vt]>0&&Et(r,function(p){if(p&&p.queue[vt]>0&&(Et(p.queue,function(f){if(f[_l]===c)return d=f,-1}),d))return-1}),d}var a=!1,l={identifier:"ChannelControllerPlugin",priority:Qw,initialize:function(c,d,p,f){a=!0,Et(r,function(m){m&&m.queue[vt]>0&&n0(kl(m.chain,c,d),p)})},isInitialized:function(){return a},processTelemetry:function(c,d){n(r,d||t(),function(p){p[Br](c)},function(){d[Br](c)})},update:i,pause:function(){n(r,t(),function(c){c.iterate(function(d){d.pause&&d.pause()})},null)},resume:function(){n(r,t(),function(c){c.iterate(function(d){d.resume&&d.resume()})},null)},teardown:o,getChannel:s,flush:function(c,d,p,f){var m=1,g=!1,h=null;f=f||5e3;function v(){m--,g&&m===0&&(h&&(clearTimeout(h),h=null),d&&d(g),d=null)}return n(r,t(),function(S){S.iterate(function(_){if(_[wb]){m++;var D=!1;_[wb](c,function(){D=!0,v()},p)||D||(c&&h==null?h=setTimeout(function(){h=null,v()},f):v())}})},function(){g=!0,v()}),!0},_setQueue:function(c){r=c}};return l}function b4(r,e,t){var n=[];if(r&&Et(r,function(o){return v4(n,o,t)}),e){var i=[];Et(e,function(o){o[ya]>Qw&&i[Ut](o)}),v4(n,i,t)}return n}var Qw,Wde,I4=ee(()=>{u();Rn();Yn();Ii();s0();o0();Qw=500,Wde="Channel has invalid priority - "});function a0(){var r=[];function e(n){n&&r[Ut](n)}function t(n,i){Et(r,function(o){try{o(n,i)}catch(s){Tl(n[va](),2,73,"Unexpected error calling unload handler - "+_a(s))}}),r=[]}return{add:e,run:t}}var k2=ee(()=>{u();Rn();yh();Ac();Yn()});var xf,S4,_4=ee(()=>{"use strict";u();pr();Rn();Yn();Ii();s0();k2();xf="getPlugin",S4=function(){function r(){var e=this,t,n,i,o,s;c(),Be(r,e,function(d){d[Sl]=function(p,f,m,g){l(p,f,g),t=!0},d[Ns]=function(p,f){var m,g=d[fn];if(!g||p&&g!==p[fn]())return;var h,v=!1,S=p||Bb(null,g,i&&i[xf]?i[xf]():i),_=f||(m={reason:0},m[El]=!1,m);function D(){if(!v){v=!0,o.run(S,f);var P=s;s=[],Et(P,function(M){M.rm()}),h===!0&&S[Br](_),c()}}return!d[Db]||d[Db](S,_,D)!==!0?D():h=!0,h},d[ph]=function(p,f){var m=d[fn];if(!m||p&&m!==p[fn]())return;var g,h=!1,v=p||zw(null,m,i&&i[xf]?i[xf]():i),S=f||{reason:0};function _(){h||(h=!0,l(v.getCfg(),v.core(),v[Rs]()))}return!d._doUpdate||d._doUpdate(v,S,_)!==!0?_():g=!0,g},d._addHook=function(p){p&&(an(p)?s=s.concat(p):s[Ut](p))},Kb(d,"_addUnloadCb",function(){return o},"add")}),e[va]=function(d){return a(d)[va]()},e[Ts]=function(){return t},e.setInitialized=function(d){t=d},e[If]=function(d){i=d},e[Br]=function(d,p){p?p[Br](d):i&&wr(i[os])&&i[os](d,null)},e._getTelCtx=a;function a(d){d===void 0&&(d=null);var p=d;if(!p){var f=n||kl(null,{},e[fn]);i&&i[xf]?p=f[Sd](null,i[xf]):p=f[Sd](null,i)}return p}function l(d,p,f){d&&Ia(d,Tb,[],null,ar),!f&&p&&(f=p[RN]()[Rs]());var m=i;i&&i[xf]&&(m=i[xf]()),e[fn]=p,n=kl(f,d,p,m)}function c(){t=!1,e[fn]=null,n=null,i=null,s=[],o=a0()}}return r.__ieDyn=1,r}()});var E4,C4=ee(()=>{u();sr();pr();Rn();_4();yh();Ac();Yn();Ii();E4=function(r){In(e,r);function e(){var t=r.call(this)||this;t.identifier="TelemetryInitializerPlugin",t.priority=199;var n,i;o(),Be(e,t,function(s,a){s.addTelemetryInitializer=function(l){var c={id:n++,fn:l};i[Ut](c);var d={remove:function(){Et(i,function(p,f){if(p.id===c.id)return i[yf](f,1),-1})}};return d},s[os]=function(l,c){for(var d=!1,p=i[vt],f=0;f<p;++f){var m=i[f];if(m)try{if(m.fn[Pb](null,[l])===!1){d=!0;break}}catch(g){Tl(c[va](),1,64,"One of telemetry initializers failed, telemetry item will not be sent: "+Vw(g),{exception:_a(g)},!0)}}d||s[Br](l,c)},s[Db]=function(){o()}});function o(){n=0,i=[]}return t}return e.__ieDyn=1,e}(S4)});function Bde(r,e){return new Pq(e)}function Hde(r,e,t){var n,i=[],o={};return Et(t,function(s){(ar(s)||ar(s[Sl]))&&ii(P4);var a=s[ya],l=s[_l];s&&a&&(ar(o[a])?o[a]=l:Dq(r,"Two extensions have same priority #"+a+" - "+o[a]+", "+l)),(!a||a<e)&&i[Ut](s)}),n={all:t},n[fn]=i,n}function D4(r,e){var t=!1;return Et(e,function(n){if(n===r)return t=!0,-1}),t}function Jde(){var r;return _o((r={},r[ch]=function(e){},r[uh]=function(e){},r[kb]=function(e){},r[_f]=function(e,t){},r[Nb]=function(e,t){},r))}var P4,w4,x4,Vde,jde,T4,k4=ee(()=>{"use strict";u();sr();pr();sr();Rn();I4();x2();ZN();v2();yh();Yn();Ii();zN();s0();o0();C4();k2();P4="Plugins must provide initialize method",w4="_notificationManager",x4="SDK is still unloading...",Vde="SDK is not initialized",jde={loggingLevelConsole:1};T4=function(){function r(){var e,t,n,i,o,s,a,l,c,d,p,f,m,g,h,v,S,_,D,P,M=0;Be(r,this,function(x){A(),x[Ts]=function(){return t},x[Sl]=function(H,de,Pe,ye){g&&ii(x4),x[Ts]()&&ii("Core should not be initialized more than once"),e=H||{},x[Nc]=e,ar(H[NN])&&ii("Please provide instrumentation key"),i=ye,x[w4]=ye,ae(),kt(),yr(),Pe&&(x[ks]=Pe);var Ce=Lb(e,eq,[]);c=[],c[Ut].apply(c,Fm(Fm([],de,!1),Ce,!1)),f=Lb(e,YU,[]),re(null),(!m||m[vt]===0)&&ii("No "+YU+" available"),t=!0,x.releaseQueue()},x.getTransmissionControls=function(){var H=[];return m&&Et(m,function(de){H[Ut](de.queue)}),Rc(H)},x.track=function(H){H.iKey=H.iKey||e[NN],H[lh]=H[lh]||Ab(new Date),H.ver=H.ver||"4.0",!g&&x[Ts]()?j()[Br](H):n[Ut](H)},x[RN]=j,x[Nw]=function(){return i||(i=Jde(),x[w4]=i),i},x[ch]=function(H){i&&i[ch](H)},x[uh]=function(H){i&&i[uh](H)},x.getCookieMgr=function(){return a||(a=Jw(e,x[ks])),a},x.setCookieMgr=function(H){a=H},x[hh]=function(){if(!o&&!s&&Sa(e.enablePerfMgr)){var H=Sa(e[$U]);wr(H)&&(s=H(x,x[Nw]()))}return o||s||Tq()},x.setPerfMgr=function(H){o=H},x.eventCnt=function(){return n[vt]},x.releaseQueue=function(){if(t&&n[vt]>0){var H=n;n=[],Et(H,function(de){j()[Br](de)})}},x.pollInternalLogs=function(H){v=H||null;var de=Sa(e.diagnosticLogInterval);return(!de||!(de>0))&&(de=1e4),M&&clearInterval(M),M=setInterval(function(){Le()},de),M},x[JU]=function(){M&&(clearInterval(M),M=0,Le())},wd(x,function(){return h},["addTelemetryInitializer"]),x.unload=function(H,de,Pe){var ye;H===void 0&&(H=!0),t||ii(Vde),g&&ii(x4);var Ce=(ye={reason:50},ye[El]=H,ye.flushComplete=!1,ye),L=Bb(Z(),x);L[Rw](function(){A(),de&&de(Ce)},x);function le(me){Ce.flushComplete=me,g=!0,_.run(L,Ce),x[JU](),L[Br](Ce)}Ee(H,le,6,Pe)||le(!1)},x[dh]=R,x.addPlugin=function(H,de,Pe,ye){if(!H){ye&&ye(!1),$r(P4);return}var Ce=R(H[_l]);if(Ce&&!de){ye&&ye(!1),$r("Plugin ["+H[_l]+"] is already loaded!");return}var L={reason:16};function le(Oe){c[Ut](H),L.added=[H],re(L),ye&&ye(!0)}if(Ce){var me=[Ce.plugin],we={reason:2,isAsync:!!Pe};ge(me,we,function(Oe){Oe?(L.removed=me,L.reason|=32,le(!0)):ye&&ye(!1)})}else le(!1)},x.evtNamespace=function(){return S},x[wb]=Ee,x.getTraceCtx=function(H){return P||(P=f4()),P},x.setTraceCtx=function(H){P=H||null},Kb(x,"addUnloadCb",function(){return _},"add");function A(){t=!1,e=Fb(!0,{},jde),x[Nc]=e,x[ks]=new Ub(e),x[Aw]=[],h=new E4,n=[],i=null,o=null,s=null,a=null,l=null,d=null,c=[],p=null,f=null,m=null,g=!1,v=null,S=Vb("AIBaseCore",!0),_=a0(),P=null}function j(){return kl(Z(),e,x)}function re(H){var de=Hde(x[ks],Qw,c);d=de[fn],l=null;var Pe=de.all;if(m=Rc(b4(f,Pe,x)),p){var ye=ba(Pe,p);ye!==-1&&Pe[yf](ye,1),ye=ba(d,p),ye!==-1&&d[yf](ye,1),p._setQueue(m)}else p=y4(m,x);Pe[Ut](p),d[Ut](p),x[Aw]=i0(Pe),p[Sl](e,x,Pe),n0(j(),Pe),x[Aw]=Rc(i0(d||[])).slice(),H&&We(H)}function R(H){var de,Pe=null,ye=null;return Et(x[Aw],function(Ce){if(Ce[_l]===H&&Ce!==p&&Ce!==h)return ye=Ce,-1}),!ye&&p&&(ye=p.getChannel(H)),ye&&(Pe=(de={plugin:ye},de[_d]=function(Ce){xd(ye)[Fw]=!Ce},de.isEnabled=function(){var Ce=xd(ye);return!Ce[Ns]&&!Ce[Fw]},de.remove=function(Ce,L){var le;Ce===void 0&&(Ce=!0);var me=[ye],we=(le={reason:1},le[El]=Ce,le);ge(me,we,function(Oe){Oe&&re({reason:32,removed:me}),L&&L(Oe)})},de)),Pe}function Z(){if(!l){var H=(d||[]).slice();ba(H,h)===-1&&H[Ut](h),l=Mc(i0(H),e,x)}return l}function ge(H,de,Pe){if(H&&H[vt]>0){var ye=Mc(H,e,x),Ce=Bb(ye,x);Ce[Rw](function(){var L=!1,le=[];Et(c,function(we,Oe){D4(we,H)?L=!0:le[Ut](we)}),c=le;var me=[];f&&(Et(f,function(we,Oe){var Ze=[];Et(we,function(N){D4(N,H)?L=!0:Ze[Ut](N)}),me[Ut](Ze)}),f=me),Pe&&Pe(L)}),Ce[Br](de)}else Pe(!1)}function Le(){var H=x[ks]?x[ks].queue:[];H&&(Et(H,function(de){var Pe,ye=(Pe={},Pe[is]=v||"InternalMessageId: "+de[xb],Pe.iKey=Sa(e[NN]),Pe.time=Ab(new Date),Pe.baseType=GN.dataType,Pe.baseData={message:de[bf]},Pe);x.track(ye)}),H[vt]=0)}function Ee(H,de,Pe,ye){return p?p[wb](H,de,Pe||6,ye):(de&&de(!1),!0)}function ae(){var H=Sa(e.disableDbgExt);H===!0&&D&&(i[uh](D),D=null),i&&!D&&H!==!0&&(D=_q(e),i[ch](D))}function kt(){var H=Sa(e.enablePerfMgr);!H&&s&&(s=null),H&&Lb(e,$U,Bde)}function yr(){var H=Lb(e,Tb,{});H.NotificationManager=i}function We(H){var de=zw(Z(),x);(!x._updateHook||x._updateHook(de,H)!==!0)&&de[Br](H)}function $r(H){var de=x[ks];de?Tl(de,2,73,H):ii(H)}})}return r.__ieDyn=1,r}()});function l0(r,e,t,n){Et(r,function(i){if(i&&i[e])if(t)setTimeout(function(){return n(i)},0);else try{n(i)}catch(o){}})}var N4,R4=ee(()=>{u();pr();Rn();Yn();Ii();N4=function(){function r(e){this.listeners=[];var t=!!(e||{}).perfEvtsSendAll;Be(r,this,function(n){n[ch]=function(i){n.listeners[Ut](i)},n[uh]=function(i){for(var o=ba(n[mh],i);o>-1;)n.listeners[yf](o,1),o=ba(n[mh],i)},n[kb]=function(i){l0(n[mh],kb,!0,function(o){o[kb](i)})},n[_f]=function(i,o){l0(n[mh],_f,!0,function(s){s[_f](i,o)})},n[Nb]=function(i,o){l0(n[mh],Nb,o,function(s){s[Nb](i,o)})},n[Ef]=function(i){i&&(t||!i[Kw]())&&l0(n[mh],Ef,!1,function(o){i[El]?setTimeout(function(){return o[Ef](i)},0):o[Ef](i)})}})}return r.__ieDyn=1,r}()});var Xw,A4=ee(()=>{u();sr();pr();Rn();k4();yh();Yn();Ii();R4();zN();Xw=function(r){In(e,r);function e(){var t=r.call(this)||this;return Be(e,t,function(n,i){n[Sl]=function(a,l,c,d){i[Sl](a,l,c||new Ub(a),d||new N4(a))},n.track=function(a){$N(n[hh](),function(){return"AppInsightsCore:track"},function(){a===null&&(s(a),ii("Invalid telemetry item")),o(a),i.track(a)},function(){return{item:a}},!a.sync)};function o(a){ar(a[is])&&(s(a),ii("telemetry name required"))}function s(a){var l=n[Nw]();l&&l[_f]([a],2)}}),t}return e.__ieDyn=1,e}(T4)});var De,kr,Ih,Nl,M4,O4,c0,N2,Zw,u0,Hb,Rl,Df,Dd,ex,L4,qde,R2,K4=ee(()=>{u();pq();kr="Failed",Ih=kr+"MonitorAjax",Nl="Track",M4="Start",O4="Stop",c0="Event",N2="AuthContext",Zw="Exception",u0="Local",Hb="Session",Rl="Storage",Df="Browser",Dd="Cannot",ex="Buffer",L4="InstrumentationKey",qde=u2({CRITICAL:1,WARNING:2}),R2=u2((De={},De[Df+"DoesNotSupport"+u0+Rl]=0,De[Df+Dd+"Read"+u0+Rl]=1,De[Df+Dd+"Read"+Hb+Rl]=2,De[Df+Dd+"Write"+u0+Rl]=3,De[Df+Dd+"Write"+Hb+Rl]=4,De[Df+kr+"RemovalFrom"+u0+Rl]=5,De[Df+kr+"RemovalFrom"+Hb+Rl]=6,De[Dd+"SendEmptyTelemetry"]=7,De.ClientPerformanceMathError=8,De["ErrorParsingAI"+Hb+"Cookie"]=9,De.ErrorPVCalc=10,De[Zw+"WhileLoggingError"]=11,De[kr+"AddingTelemetryTo"+ex]=12,De[Ih+"Abort"]=13,De[Ih+"Dur"]=14,De[Ih+"Open"]=15,De[Ih+"RSC"]=16,De[Ih+"Send"]=17,De[Ih+"GetCorrelationHeader"]=18,De[kr+"ToAddHandlerForOnBeforeUnload"]=19,De[kr+"ToSendQueuedTelemetry"]=20,De[kr+"ToReportDataLoss"]=21,De["Flush"+kr]=22,De.MessageLimitPerPVExceeded=23,De.MissingRequiredFieldSpecification=24,De.NavigationTimingNotSupported=25,De.OnError=26,De[Hb+"RenewalDateIsZero"]=27,De.SenderNotInitialized=28,De[M4+Nl+c0+kr]=29,De[O4+Nl+c0+kr]=30,De[M4+Nl+kr]=31,De[O4+Nl+kr]=32,De.TelemetrySampledAndNotSent=33,De[Nl+c0+kr]=34,De[Nl+Zw+kr]=35,De[Nl+"Metric"+kr]=36,De[Nl+"PV"+kr]=37,De[Nl+"PV"+kr+"Calc"]=38,De[Nl+"Trace"+kr]=39,De["Transmission"+kr]=40,De[kr+"ToSet"+Rl+ex]=41,De[kr+"ToRestore"+Rl+ex]=42,De.InvalidBackendResponse=43,De[kr+"ToFixDepricatedValues"]=44,De.InvalidDurationValue=45,De.TelemetryEnvelopeInvalid=46,De.CreateEnvelopeError=47,De[Dd+"SerializeObject"]=48,De[Dd+"SerializeObjectNonSerializable"]=49,De.CircularReferenceDetected=50,De["Clear"+N2+kr]=51,De[Zw+"Truncated"]=52,De.IllegalCharsInName=53,De.ItemNotInArray=54,De.MaxAjaxPerPVExceeded=55,De.MessageTruncated=56,De.NameTooLong=57,De.SampleRateOutOfRange=58,De["Set"+N2+kr]=59,De["Set"+N2+kr+"AccountName"]=60,De.StringValueTooLong=61,De.StartCalledMoreThanOnce=62,De.StopCalledWithoutStart=63,De["TelemetryInitializer"+kr]=64,De.TrackArgumentsNotSpecified=65,De.UrlTooLong=66,De[Hb+Rl+ex+"Full"]=67,De[Dd+"AccessCookie"]=68,De.IdTooLong=69,De.InvalidEvent=70,De[Ih+"SetRequestHeader"]=71,De["Send"+Df+"InfoOnUserInit"]=72,De["Plugin"+Zw]=73,De["Notification"+Zw]=74,De.SnippetScriptLoadFailure=99,De["Invalid"+L4]=100,De[Dd+"ParseAiBlobValue"]=101,De.InvalidContentBlob=102,De[Nl+"PageAction"+c0+kr]=103,De[kr+"AddingCustomDefinedRequestContext"]=104,De["InMemory"+Rl+ex+"Full"]=105,De[L4+"Deprecation"]=106,De))});var A2=ee(()=>{u();A4();l4();Yn();K4()});var d0,p0,tx,F4=ee(()=>{u();d0="instrumentationKey",p0="connectionString",tx="diagnosticLogInterval"});var U4={};Nm(U4,{AppInsightsCore:()=>Xw,ApplicationInsights:()=>Gde,CoreUtils:()=>$w,Sender:()=>kw,SeverityLevel:()=>JF,_InternalMessageId:()=>R2,arrForEach:()=>Et,isNullOrUndefined:()=>ar,proxyFunctions:()=>wd,throwError:()=>ii});var Gde,W4=ee(()=>{u();pr();HU();ef();A2();F4();A2();ef();HU();Gde=function(){function r(e){var t=new Xw;(ar(e)||ar(e[d0])&&ar(e[p0]))&&ii("Invalid input configuration"),Be(r,this,function(n){if(e[p0]){var i=FF(e[p0]),o=i.ingestionendpoint;e.endpointUrl=o?o+sd:e.endpointUrl,e[d0]=i.instrumentationkey||e[d0]}n.config=e,s(),n.initialize=s,n.getSKUDefaults=function(){n.config[tx]=n.config[tx]&&n.config[tx]>0?n.config[tx]:1e4},n.getSKUDefaults(),wd(n,t,["track","flush","pollInternalLogs","stopPollingInternalLogs","unload","getPlugin","addPlugin","evtNamespace","addUnloadCb"]);function s(){t.initialize(n.config,[new kw]),t.pollInternalLogs()}})}return r.__ieDyn=1,r}()});var j4={};Nm(j4,{default:()=>f0});function $de(r){if(r.userAgentData){let e=r.userAgentData.brands[r.userAgentData.brands.length-1];return`${r.userAgentData.platform} - ${e==null?void 0:e.brand} v${e==null?void 0:e.version}}`}else return r.appVersion}var V4,Yde,f0,B4=ee(()=>{u();V4=$(require("vscode"));d6();p6();f6();m6();Yde=async(r,e)=>{let t;try{let i=await Promise.resolve().then(()=>(W4(),U4));t=new i.ApplicationInsights({instrumentationKey:r,disableAjaxTracking:!0,disableExceptionTracking:!0,disableFetchTracking:!0,disableCorrelationHeaders:!0,disableCookiesUsage:!0,autoTrackPageVisitTime:!1,emitLineDelimitedJson:!1,disableInstrumentationKeyValidation:!0})}catch(i){return Promise.reject(i)}return{logEvent:(i,o)=>{let s={...o==null?void 0:o.properties,...o==null?void 0:o.measurements};e!=null&&e.length&&Zy.applyReplacements(s,e),t==null||t.track({name:i,data:s})},flush:async()=>{t==null||t.flush()}}};f0=class extends Ik{constructor(e,t){let n=s=>Yde(s,t);Zy.shouldUseOneDataSystemSDK(e)&&(n=s=>u6(s,V4));let i={release:$de(navigator),platform:"web",architecture:"web"},o=new bk(e,n);if(e&&e.indexOf("AIF")===0)throw new Error("AIF keys are no longer supported. Please switch to 1DS keys for 1st party extensions");super(o,V4,{additionalCommonProperties:Zy.getAdditionalCommonProperties(i)})}}});var tW=z((mt,dG)=>{u();mt=dG.exports=Zt;var xr;typeof process=="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?xr=function(){var r=Array.prototype.slice.call(arguments,0);r.unshift("SEMVER"),console.log.apply(console,r)}:xr=function(){};mt.SEMVER_SPEC_VERSION="2.0.0";var rx=256,I0=Number.MAX_SAFE_INTEGER||9007199254740991,K2=16,Zme=rx-6,nx=mt.re=[],Hr=mt.safeRe=[],Ie=mt.src=[],$t=0,j2="[a-zA-Z0-9-]",F2=[["\\s",1],["\\d",rx],[j2,Zme]];function x0(r){for(var e=0;e<F2.length;e++){var t=F2[e][0],n=F2[e][1];r=r.split(t+"*").join(t+"{0,"+n+"}").split(t+"+").join(t+"{1,"+n+"}")}return r}var Yb=$t++;Ie[Yb]="0|[1-9]\\d*";var $b=$t++;Ie[$b]="\\d+";var B2=$t++;Ie[B2]="\\d*[a-zA-Z-]"+j2+"*";var Q4=$t++;Ie[Q4]="("+Ie[Yb]+")\\.("+Ie[Yb]+")\\.("+Ie[Yb]+")";var X4=$t++;Ie[X4]="("+Ie[$b]+")\\.("+Ie[$b]+")\\.("+Ie[$b]+")";var U2=$t++;Ie[U2]="(?:"+Ie[Yb]+"|"+Ie[B2]+")";var W2=$t++;Ie[W2]="(?:"+Ie[$b]+"|"+Ie[B2]+")";var H2=$t++;Ie[H2]="(?:-("+Ie[U2]+"(?:\\."+Ie[U2]+")*))";var J2=$t++;Ie[J2]="(?:-?("+Ie[W2]+"(?:\\."+Ie[W2]+")*))";var V2=$t++;Ie[V2]=j2+"+";var ox=$t++;Ie[ox]="(?:\\+("+Ie[V2]+"(?:\\."+Ie[V2]+")*))";var q2=$t++,Z4="v?"+Ie[Q4]+Ie[H2]+"?"+Ie[ox]+"?";Ie[q2]="^"+Z4+"$";var G2="[v=\\s]*"+Ie[X4]+Ie[J2]+"?"+Ie[ox]+"?",Y2=$t++;Ie[Y2]="^"+G2+"$";var eI=$t++;Ie[eI]="((?:<|>)?=?)";var S0=$t++;Ie[S0]=Ie[$b]+"|x|X|\\*";var _0=$t++;Ie[_0]=Ie[Yb]+"|x|X|\\*";var _h=$t++;Ie[_h]="[v=\\s]*("+Ie[_0]+")(?:\\.("+Ie[_0]+")(?:\\.("+Ie[_0]+")(?:"+Ie[H2]+")?"+Ie[ox]+"?)?)?";var Qb=$t++;Ie[Qb]="[v=\\s]*("+Ie[S0]+")(?:\\.("+Ie[S0]+")(?:\\.("+Ie[S0]+")(?:"+Ie[J2]+")?"+Ie[ox]+"?)?)?";var eG=$t++;Ie[eG]="^"+Ie[eI]+"\\s*"+Ie[_h]+"$";var tG=$t++;Ie[tG]="^"+Ie[eI]+"\\s*"+Ie[Qb]+"$";var rG=$t++;Ie[rG]="(?:^|[^\\d])(\\d{1,"+K2+"})(?:\\.(\\d{1,"+K2+"}))?(?:\\.(\\d{1,"+K2+"}))?(?:$|[^\\d])";var D0=$t++;Ie[D0]="(?:~>?)";var Xb=$t++;Ie[Xb]="(\\s*)"+Ie[D0]+"\\s+";nx[Xb]=new RegExp(Ie[Xb],"g");Hr[Xb]=new RegExp(x0(Ie[Xb]),"g");var ege="$1~",nG=$t++;Ie[nG]="^"+Ie[D0]+Ie[_h]+"$";var iG=$t++;Ie[iG]="^"+Ie[D0]+Ie[Qb]+"$";var P0=$t++;Ie[P0]="(?:\\^)";var Zb=$t++;Ie[Zb]="(\\s*)"+Ie[P0]+"\\s+";nx[Zb]=new RegExp(Ie[Zb],"g");Hr[Zb]=new RegExp(x0(Ie[Zb]),"g");var tge="$1^",oG=$t++;Ie[oG]="^"+Ie[P0]+Ie[_h]+"$";var sG=$t++;Ie[sG]="^"+Ie[P0]+Ie[Qb]+"$";var $2=$t++;Ie[$2]="^"+Ie[eI]+"\\s*("+G2+")$|^$";var z2=$t++;Ie[z2]="^"+Ie[eI]+"\\s*("+Z4+")$|^$";var Eh=$t++;Ie[Eh]="(\\s*)"+Ie[eI]+"\\s*("+G2+"|"+Ie[_h]+")";nx[Eh]=new RegExp(Ie[Eh],"g");Hr[Eh]=new RegExp(x0(Ie[Eh]),"g");var rge="$1$2$3",aG=$t++;Ie[aG]="^\\s*("+Ie[_h]+")\\s+-\\s+("+Ie[_h]+")\\s*$";var lG=$t++;Ie[lG]="^\\s*("+Ie[Qb]+")\\s+-\\s+("+Ie[Qb]+")\\s*$";var cG=$t++;Ie[cG]="(<|>)?=?\\s*\\*";for(Lc=0;Lc<$t;Lc++)xr(Lc,Ie[Lc]),nx[Lc]||(nx[Lc]=new RegExp(Ie[Lc]),Hr[Lc]=new RegExp(x0(Ie[Lc])));var Lc;mt.parse=Ch;function Ch(r,e){if((!e||typeof e!="object")&&(e={loose:!!e,includePrerelease:!1}),r instanceof Zt)return r;if(typeof r!="string"||r.length>rx)return null;var t=e.loose?Hr[Y2]:Hr[q2];if(!t.test(r))return null;try{return new Zt(r,e)}catch(n){return null}}mt.valid=nge;function nge(r,e){var t=Ch(r,e);return t?t.version:null}mt.clean=ige;function ige(r,e){var t=Ch(r.trim().replace(/^[=v]+/,""),e);return t?t.version:null}mt.SemVer=Zt;function Zt(r,e){if((!e||typeof e!="object")&&(e={loose:!!e,includePrerelease:!1}),r instanceof Zt){if(r.loose===e.loose)return r;r=r.version}else if(typeof r!="string")throw new TypeError("Invalid Version: "+r);if(r.length>rx)throw new TypeError("version is longer than "+rx+" characters");if(!(this instanceof Zt))return new Zt(r,e);xr("SemVer",r,e),this.options=e,this.loose=!!e.loose;var t=r.trim().match(e.loose?Hr[Y2]:Hr[q2]);if(!t)throw new TypeError("Invalid Version: "+r);if(this.raw=r,this.major=+t[1],this.minor=+t[2],this.patch=+t[3],this.major>I0||this.major<0)throw new TypeError("Invalid major version");if(this.minor>I0||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>I0||this.patch<0)throw new TypeError("Invalid patch version");t[4]?this.prerelease=t[4].split(".").map(function(n){if(/^[0-9]+$/.test(n)){var i=+n;if(i>=0&&i<I0)return i}return n}):this.prerelease=[],this.build=t[5]?t[5].split("."):[],this.format()}Zt.prototype.format=function(){return this.version=this.major+"."+this.minor+"."+this.patch,this.prerelease.length&&(this.version+="-"+this.prerelease.join(".")),this.version};Zt.prototype.toString=function(){return this.version};Zt.prototype.compare=function(r){return xr("SemVer.compare",this.version,this.options,r),r instanceof Zt||(r=new Zt(r,this.options)),this.compareMain(r)||this.comparePre(r)};Zt.prototype.compareMain=function(r){return r instanceof Zt||(r=new Zt(r,this.options)),zb(this.major,r.major)||zb(this.minor,r.minor)||zb(this.patch,r.patch)};Zt.prototype.comparePre=function(r){if(r instanceof Zt||(r=new Zt(r,this.options)),this.prerelease.length&&!r.prerelease.length)return-1;if(!this.prerelease.length&&r.prerelease.length)return 1;if(!this.prerelease.length&&!r.prerelease.length)return 0;var e=0;do{var t=this.prerelease[e],n=r.prerelease[e];if(xr("prerelease compare",e,t,n),t===void 0&&n===void 0)return 0;if(n===void 0)return 1;if(t===void 0)return-1;if(t===n)continue;return zb(t,n)}while(++e)};Zt.prototype.inc=function(r,e){switch(r){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",e);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",e);break;case"prepatch":this.prerelease.length=0,this.inc("patch",e),this.inc("pre",e);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",e),this.inc("pre",e);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":if(this.prerelease.length===0)this.prerelease=[0];else{for(var t=this.prerelease.length;--t>=0;)typeof this.prerelease[t]=="number"&&(this.prerelease[t]++,t=-2);t===-1&&this.prerelease.push(0)}e&&(this.prerelease[0]===e?isNaN(this.prerelease[1])&&(this.prerelease=[e,0]):this.prerelease=[e,0]);break;default:throw new Error("invalid increment argument: "+r)}return this.format(),this.raw=this.version,this};mt.inc=oge;function oge(r,e,t,n){typeof t=="string"&&(n=t,t=void 0);try{return new Zt(r,t).inc(e,n).version}catch(i){return null}}mt.diff=sge;function sge(r,e){if(Q2(r,e))return null;var t=Ch(r),n=Ch(e),i="";if(t.prerelease.length||n.prerelease.length){i="pre";var o="prerelease"}for(var s in t)if((s==="major"||s==="minor"||s==="patch")&&t[s]!==n[s])return i+s;return o}mt.compareIdentifiers=zb;var z4=/^[0-9]+$/;function zb(r,e){var t=z4.test(r),n=z4.test(e);return t&&n&&(r=+r,e=+e),r===e?0:t&&!n?-1:n&&!t?1:r<e?-1:1}mt.rcompareIdentifiers=age;function age(r,e){return zb(e,r)}mt.major=lge;function lge(r,e){return new Zt(r,e).major}mt.minor=cge;function cge(r,e){return new Zt(r,e).minor}mt.patch=uge;function uge(r,e){return new Zt(r,e).patch}mt.compare=Td;function Td(r,e,t){return new Zt(r,t).compare(new Zt(e,t))}mt.compareLoose=dge;function dge(r,e){return Td(r,e,!0)}mt.rcompare=pge;function pge(r,e,t){return Td(e,r,t)}mt.sort=fge;function fge(r,e){return r.sort(function(t,n){return mt.compare(t,n,e)})}mt.rsort=mge;function mge(r,e){return r.sort(function(t,n){return mt.rcompare(t,n,e)})}mt.gt=ix;function ix(r,e,t){return Td(r,e,t)>0}mt.lt=E0;function E0(r,e,t){return Td(r,e,t)<0}mt.eq=Q2;function Q2(r,e,t){return Td(r,e,t)===0}mt.neq=uG;function uG(r,e,t){return Td(r,e,t)!==0}mt.gte=X2;function X2(r,e,t){return Td(r,e,t)>=0}mt.lte=Z2;function Z2(r,e,t){return Td(r,e,t)<=0}mt.cmp=C0;function C0(r,e,t,n){switch(e){case"===":return typeof r=="object"&&(r=r.version),typeof t=="object"&&(t=t.version),r===t;case"!==":return typeof r=="object"&&(r=r.version),typeof t=="object"&&(t=t.version),r!==t;case"":case"=":case"==":return Q2(r,t,n);case"!=":return uG(r,t,n);case">":return ix(r,t,n);case">=":return X2(r,t,n);case"<":return E0(r,t,n);case"<=":return Z2(r,t,n);default:throw new TypeError("Invalid operator: "+e)}}mt.Comparator=Ea;function Ea(r,e){if((!e||typeof e!="object")&&(e={loose:!!e,includePrerelease:!1}),r instanceof Ea){if(r.loose===!!e.loose)return r;r=r.value}if(!(this instanceof Ea))return new Ea(r,e);r=r.trim().split(/\s+/).join(" "),xr("comparator",r,e),this.options=e,this.loose=!!e.loose,this.parse(r),this.semver===sx?this.value="":this.value=this.operator+this.semver.version,xr("comp",this)}var sx={};Ea.prototype.parse=function(r){var e=this.options.loose?Hr[$2]:Hr[z2],t=r.match(e);if(!t)throw new TypeError("Invalid comparator: "+r);this.operator=t[1],this.operator==="="&&(this.operator=""),t[2]?this.semver=new Zt(t[2],this.options.loose):this.semver=sx};Ea.prototype.toString=function(){return this.value};Ea.prototype.test=function(r){return xr("Comparator.test",r,this.options.loose),this.semver===sx?!0:(typeof r=="string"&&(r=new Zt(r,this.options)),C0(r,this.operator,this.semver,this.options))};Ea.prototype.intersects=function(r,e){if(!(r instanceof Ea))throw new TypeError("a Comparator is required");(!e||typeof e!="object")&&(e={loose:!!e,includePrerelease:!1});var t;if(this.operator==="")return t=new mn(r.value,e),w0(this.value,t,e);if(r.operator==="")return t=new mn(this.value,e),w0(r.semver,t,e);var n=(this.operator===">="||this.operator===">")&&(r.operator===">="||r.operator===">"),i=(this.operator==="<="||this.operator==="<")&&(r.operator==="<="||r.operator==="<"),o=this.semver.version===r.semver.version,s=(this.operator===">="||this.operator==="<=")&&(r.operator===">="||r.operator==="<="),a=C0(this.semver,"<",r.semver,e)&&(this.operator===">="||this.operator===">")&&(r.operator==="<="||r.operator==="<"),l=C0(this.semver,">",r.semver,e)&&(this.operator==="<="||this.operator==="<")&&(r.operator===">="||r.operator===">");return n||i||o&&s||a||l};mt.Range=mn;function mn(r,e){if((!e||typeof e!="object")&&(e={loose:!!e,includePrerelease:!1}),r instanceof mn)return r.loose===!!e.loose&&r.includePrerelease===!!e.includePrerelease?r:new mn(r.raw,e);if(r instanceof Ea)return new mn(r.value,e);if(!(this instanceof mn))return new mn(r,e);if(this.options=e,this.loose=!!e.loose,this.includePrerelease=!!e.includePrerelease,this.raw=r.trim().split(/\s+/).join(" "),this.set=this.raw.split("||").map(function(t){return this.parseRange(t.trim())},this).filter(function(t){return t.length}),!this.set.length)throw new TypeError("Invalid SemVer Range: "+this.raw);this.format()}mn.prototype.format=function(){return this.range=this.set.map(function(r){return r.join(" ").trim()}).join("||").trim(),this.range};mn.prototype.toString=function(){return this.range};mn.prototype.parseRange=function(r){var e=this.options.loose,t=e?Hr[lG]:Hr[aG];r=r.replace(t,Cge),xr("hyphen replace",r),r=r.replace(Hr[Eh],rge),xr("comparator trim",r,Hr[Eh]),r=r.replace(Hr[Xb],ege),r=r.replace(Hr[Zb],tge);var n=e?Hr[$2]:Hr[z2],i=r.split(" ").map(function(o){return hge(o,this.options)},this).join(" ").split(/\s+/);return this.options.loose&&(i=i.filter(function(o){return!!o.match(n)})),i=i.map(function(o){return new Ea(o,this.options)},this),i};mn.prototype.intersects=function(r,e){if(!(r instanceof mn))throw new TypeError("a Range is required");return this.set.some(function(t){return t.every(function(n){return r.set.some(function(i){return i.every(function(o){return n.intersects(o,e)})})})})};mt.toComparators=gge;function gge(r,e){return new mn(r,e).set.map(function(t){return t.map(function(n){return n.value}).join(" ").trim().split(" ")})}function hge(r,e){return xr("comp",r,e),r=bge(r,e),xr("caret",r),r=vge(r,e),xr("tildes",r),r=Sge(r,e),xr("xrange",r),r=Ege(r,e),xr("stars",r),r}function ko(r){return!r||r.toLowerCase()==="x"||r==="*"}function vge(r,e){return r.trim().split(/\s+/).map(function(t){return yge(t,e)}).join(" ")}function yge(r,e){var t=e.loose?Hr[iG]:Hr[nG];return r.replace(t,function(n,i,o,s,a){xr("tilde",r,n,i,o,s,a);var l;return ko(i)?l="":ko(o)?l=">="+i+".0.0 <"+(+i+1)+".0.0":ko(s)?l=">="+i+"."+o+".0 <"+i+"."+(+o+1)+".0":a?(xr("replaceTilde pr",a),l=">="+i+"."+o+"."+s+"-"+a+" <"+i+"."+(+o+1)+".0"):l=">="+i+"."+o+"."+s+" <"+i+"."+(+o+1)+".0",xr("tilde return",l),l})}function bge(r,e){return r.trim().split(/\s+/).map(function(t){return Ige(t,e)}).join(" ")}function Ige(r,e){xr("caret",r,e);var t=e.loose?Hr[sG]:Hr[oG];return r.replace(t,function(n,i,o,s,a){xr("caret",r,n,i,o,s,a);var l;return ko(i)?l="":ko(o)?l=">="+i+".0.0 <"+(+i+1)+".0.0":ko(s)?i==="0"?l=">="+i+"."+o+".0 <"+i+"."+(+o+1)+".0":l=">="+i+"."+o+".0 <"+(+i+1)+".0.0":a?(xr("replaceCaret pr",a),i==="0"?o==="0"?l=">="+i+"."+o+"."+s+"-"+a+" <"+i+"."+o+"."+(+s+1):l=">="+i+"."+o+"."+s+"-"+a+" <"+i+"."+(+o+1)+".0":l=">="+i+"."+o+"."+s+"-"+a+" <"+(+i+1)+".0.0"):(xr("no pr"),i==="0"?o==="0"?l=">="+i+"."+o+"."+s+" <"+i+"."+o+"."+(+s+1):l=">="+i+"."+o+"."+s+" <"+i+"."+(+o+1)+".0":l=">="+i+"."+o+"."+s+" <"+(+i+1)+".0.0"),xr("caret return",l),l})}function Sge(r,e){return xr("replaceXRanges",r,e),r.split(/\s+/).map(function(t){return _ge(t,e)}).join(" ")}function _ge(r,e){r=r.trim();var t=e.loose?Hr[tG]:Hr[eG];return r.replace(t,function(n,i,o,s,a,l){xr("xRange",r,n,i,o,s,a,l);var c=ko(o),d=c||ko(s),p=d||ko(a),f=p;return i==="="&&f&&(i=""),c?i===">"||i==="<"?n="<0.0.0":n="*":i&&f?(d&&(s=0),a=0,i===">"?(i=">=",d?(o=+o+1,s=0,a=0):(s=+s+1,a=0)):i==="<="&&(i="<",d?o=+o+1:s=+s+1),n=i+o+"."+s+"."+a):d?n=">="+o+".0.0 <"+(+o+1)+".0.0":p&&(n=">="+o+"."+s+".0 <"+o+"."+(+s+1)+".0"),xr("xRange return",n),n})}function Ege(r,e){return xr("replaceStars",r,e),r.trim().replace(Hr[cG],"")}function Cge(r,e,t,n,i,o,s,a,l,c,d,p,f){return ko(t)?e="":ko(n)?e=">="+t+".0.0":ko(i)?e=">="+t+"."+n+".0":e=">="+e,ko(l)?a="":ko(c)?a="<"+(+l+1)+".0.0":ko(d)?a="<"+l+"."+(+c+1)+".0":p?a="<="+l+"."+c+"."+d+"-"+p:a="<="+a,(e+" "+a).trim()}mn.prototype.test=function(r){if(!r)return!1;typeof r=="string"&&(r=new Zt(r,this.options));for(var e=0;e<this.set.length;e++)if(wge(this.set[e],r,this.options))return!0;return!1};function wge(r,e,t){for(var n=0;n<r.length;n++)if(!r[n].test(e))return!1;if(e.prerelease.length&&!t.includePrerelease){for(n=0;n<r.length;n++)if(xr(r[n].semver),r[n].semver!==sx&&r[n].semver.prerelease.length>0){var i=r[n].semver;if(i.major===e.major&&i.minor===e.minor&&i.patch===e.patch)return!0}return!1}return!0}mt.satisfies=w0;function w0(r,e,t){try{e=new mn(e,t)}catch(n){return!1}return e.test(r)}mt.maxSatisfying=xge;function xge(r,e,t){var n=null,i=null;try{var o=new mn(e,t)}catch(s){return null}return r.forEach(function(s){o.test(s)&&(!n||i.compare(s)===-1)&&(n=s,i=new Zt(n,t))}),n}mt.minSatisfying=Dge;function Dge(r,e,t){var n=null,i=null;try{var o=new mn(e,t)}catch(s){return null}return r.forEach(function(s){o.test(s)&&(!n||i.compare(s)===1)&&(n=s,i=new Zt(n,t))}),n}mt.minVersion=Pge;function Pge(r,e){r=new mn(r,e);var t=new Zt("0.0.0");if(r.test(t)||(t=new Zt("0.0.0-0"),r.test(t)))return t;t=null;for(var n=0;n<r.set.length;++n){var i=r.set[n];i.forEach(function(o){var s=new Zt(o.semver.version);switch(o.operator){case">":s.prerelease.length===0?s.patch++:s.prerelease.push(0),s.raw=s.format();case"":case">=":(!t||ix(t,s))&&(t=s);break;case"<":case"<=":break;default:throw new Error("Unexpected operation: "+o.operator)}})}return t&&r.test(t)?t:null}mt.validRange=Tge;function Tge(r,e){try{return new mn(r,e).range||"*"}catch(t){return null}}mt.ltr=kge;function kge(r,e,t){return eW(r,e,"<",t)}mt.gtr=Nge;function Nge(r,e,t){return eW(r,e,">",t)}mt.outside=eW;function eW(r,e,t,n){r=new Zt(r,n),e=new mn(e,n);var i,o,s,a,l;switch(t){case">":i=ix,o=Z2,s=E0,a=">",l=">=";break;case"<":i=E0,o=X2,s=ix,a="<",l="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(w0(r,e,n))return!1;for(var c=0;c<e.set.length;++c){var d=e.set[c],p=null,f=null;if(d.forEach(function(m){m.semver===sx&&(m=new Ea(">=0.0.0")),p=p||m,f=f||m,i(m.semver,p.semver,n)?p=m:s(m.semver,f.semver,n)&&(f=m)}),p.operator===a||p.operator===l||(!f.operator||f.operator===a)&&o(r,f.semver))return!1;if(f.operator===l&&s(r,f.semver))return!1}return!0}mt.prerelease=Rge;function Rge(r,e){var t=Ch(r,e);return t&&t.prerelease.length?t.prerelease:null}mt.intersects=Age;function Age(r,e,t){return r=new mn(r,t),e=new mn(e,t),r.intersects(e)}mt.coerce=Mge;function Mge(r){if(r instanceof Zt)return r;if(typeof r!="string")return null;var e=r.match(Hr[rG]);return e==null?null:Ch(e[1]+"."+(e[2]||"0")+"."+(e[3]||"0"))}});var Nh=z((K0,kG)=>{u();(function(r,e){typeof K0=="object"&&typeof kG!="undefined"?e(K0):typeof define=="function"&&define.amd?define(["exports"],e):(r=typeof globalThis!="undefined"?globalThis:r||self,e(r.lumino_algorithm={}))})(K0,function(r){"use strict";r.ArrayExt=void 0,function(N){function W(q,se,K,U){K===void 0&&(K=0),U===void 0&&(U=-1);var ne=q.length;if(ne===0)return-1;K<0?K=Math.max(0,K+ne):K=Math.min(K,ne-1),U<0?U=Math.max(0,U+ne):U=Math.min(U,ne-1);var ke;U<K?ke=U+1+(ne-K):ke=U-K+1;for(var Me=0;Me<ke;++Me){var Lt=(K+Me)%ne;if(q[Lt]===se)return Lt}return-1}N.firstIndexOf=W;function pe(q,se,K,U){K===void 0&&(K=-1),U===void 0&&(U=0);var ne=q.length;if(ne===0)return-1;K<0?K=Math.max(0,K+ne):K=Math.min(K,ne-1),U<0?U=Math.max(0,U+ne):U=Math.min(U,ne-1);var ke;K<U?ke=K+1+(ne-U):ke=K-U+1;for(var Me=0;Me<ke;++Me){var Lt=(K-Me+ne)%ne;if(q[Lt]===se)return Lt}return-1}N.lastIndexOf=pe;function Se(q,se,K,U){K===void 0&&(K=0),U===void 0&&(U=-1);var ne=q.length;if(ne===0)return-1;K<0?K=Math.max(0,K+ne):K=Math.min(K,ne-1),U<0?U=Math.max(0,U+ne):U=Math.min(U,ne-1);var ke;U<K?ke=U+1+(ne-K):ke=U-K+1;for(var Me=0;Me<ke;++Me){var Lt=(K+Me)%ne;if(se(q[Lt],Lt))return Lt}return-1}N.findFirstIndex=Se;function Re(q,se,K,U){K===void 0&&(K=-1),U===void 0&&(U=0);var ne=q.length;if(ne===0)return-1;K<0?K=Math.max(0,K+ne):K=Math.min(K,ne-1),U<0?U=Math.max(0,U+ne):U=Math.min(U,ne-1);var ke;K<U?ke=K+1+(ne-U):ke=K-U+1;for(var Me=0;Me<ke;++Me){var Lt=(K-Me+ne)%ne;if(se(q[Lt],Lt))return Lt}return-1}N.findLastIndex=Re;function Gt(q,se,K,U){K===void 0&&(K=0),U===void 0&&(U=-1);var ne=Se(q,se,K,U);return ne!==-1?q[ne]:void 0}N.findFirstValue=Gt;function $e(q,se,K,U){K===void 0&&(K=-1),U===void 0&&(U=0);var ne=Re(q,se,K,U);return ne!==-1?q[ne]:void 0}N.findLastValue=$e;function yt(q,se,K,U,ne){U===void 0&&(U=0),ne===void 0&&(ne=-1);var ke=q.length;if(ke===0)return 0;U<0?U=Math.max(0,U+ke):U=Math.min(U,ke-1),ne<0?ne=Math.max(0,ne+ke):ne=Math.min(ne,ke-1);for(var Me=U,Lt=ne-U+1;Lt>0;){var di=Lt>>1,ku=Me+di;K(q[ku],se)<0?(Me=ku+1,Lt-=di+1):Lt=di}return Me}N.lowerBound=yt;function Qt(q,se,K,U,ne){U===void 0&&(U=0),ne===void 0&&(ne=-1);var ke=q.length;if(ke===0)return 0;U<0?U=Math.max(0,U+ke):U=Math.min(U,ke-1),ne<0?ne=Math.max(0,ne+ke):ne=Math.min(ne,ke-1);for(var Me=U,Lt=ne-U+1;Lt>0;){var di=Lt>>1,ku=Me+di;K(q[ku],se)>0?Lt=di:(Me=ku+1,Lt-=di+1)}return Me}N.upperBound=Qt;function Ot(q,se,K){if(q===se)return!0;if(q.length!==se.length)return!1;for(var U=0,ne=q.length;U<ne;++U)if(K?!K(q[U],se[U]):q[U]!==se[U])return!1;return!0}N.shallowEqual=Ot;function Dr(q,se){se===void 0&&(se={});var K=se.start,U=se.stop,ne=se.step;if(ne===void 0&&(ne=1),ne===0)throw new Error("Slice `step` cannot be zero.");var ke=q.length;K===void 0?K=ne<0?ke-1:0:K<0?K=Math.max(K+ke,ne<0?-1:0):K>=ke&&(K=ne<0?ke-1:ke),U===void 0?U=ne<0?-1:ke:U<0?U=Math.max(U+ke,ne<0?-1:0):U>=ke&&(U=ne<0?ke-1:ke);var Me;ne<0&&U>=K||ne>0&&K>=U?Me=0:ne<0?Me=Math.floor((U-K+1)/ne+1):Me=Math.floor((U-K-1)/ne+1);for(var Lt=[],di=0;di<Me;++di)Lt[di]=q[K+di*ne];return Lt}N.slice=Dr;function F(q,se,K){var U=q.length;if(!(U<=1)&&(se<0?se=Math.max(0,se+U):se=Math.min(se,U-1),K<0?K=Math.max(0,K+U):K=Math.min(K,U-1),se!==K)){for(var ne=q[se],ke=se<K?1:-1,Me=se;Me!==K;Me+=ke)q[Me]=q[Me+ke];q[K]=ne}}N.move=F;function ue(q,se,K){se===void 0&&(se=0),K===void 0&&(K=-1);var U=q.length;if(!(U<=1))for(se<0?se=Math.max(0,se+U):se=Math.min(se,U-1),K<0?K=Math.max(0,K+U):K=Math.min(K,U-1);se<K;){var ne=q[se],ke=q[K];q[se++]=ke,q[K--]=ne}}N.reverse=ue;function k(q,se,K,U){K===void 0&&(K=0),U===void 0&&(U=-1);var ne=q.length;if(!(ne<=1)&&(K<0?K=Math.max(0,K+ne):K=Math.min(K,ne-1),U<0?U=Math.max(0,U+ne):U=Math.min(U,ne-1),!(K>=U))){var ke=U-K+1;if(se>0?se=se%ke:se<0&&(se=(se%ke+ke)%ke),se!==0){var Me=K+se;ue(q,K,Me-1),ue(q,Me,U),ue(q,K,U)}}}N.rotate=k;function O(q,se,K,U){K===void 0&&(K=0),U===void 0&&(U=-1);var ne=q.length;if(ne!==0){K<0?K=Math.max(0,K+ne):K=Math.min(K,ne-1),U<0?U=Math.max(0,U+ne):U=Math.min(U,ne-1);var ke;U<K?ke=U+1+(ne-K):ke=U-K+1;for(var Me=0;Me<ke;++Me)q[(K+Me)%ne]=se}}N.fill=O;function X(q,se,K){var U=q.length;se<0?se=Math.max(0,se+U):se=Math.min(se,U);for(var ne=U;ne>se;--ne)q[ne]=q[ne-1];q[se]=K}N.insert=X;function ce(q,se){var K=q.length;if(se<0&&(se+=K),!(se<0||se>=K)){for(var U=q[se],ne=se+1;ne<K;++ne)q[ne-1]=q[ne];return q.length=K-1,U}}N.removeAt=ce;function he(q,se,K,U){K===void 0&&(K=0),U===void 0&&(U=-1);var ne=W(q,se,K,U);return ne!==-1&&ce(q,ne),ne}N.removeFirstOf=he;function V(q,se,K,U){K===void 0&&(K=-1),U===void 0&&(U=0);var ne=pe(q,se,K,U);return ne!==-1&&ce(q,ne),ne}N.removeLastOf=V;function G(q,se,K,U){K===void 0&&(K=0),U===void 0&&(U=-1);var ne=q.length;if(ne===0)return 0;K<0?K=Math.max(0,K+ne):K=Math.min(K,ne-1),U<0?U=Math.max(0,U+ne):U=Math.min(U,ne-1);for(var ke=0,Me=0;Me<ne;++Me)K<=U&&Me>=K&&Me<=U&&q[Me]===se||U<K&&(Me<=U||Me>=K)&&q[Me]===se?ke++:ke>0&&(q[Me-ke]=q[Me]);return ke>0&&(q.length=ne-ke),ke}N.removeAllOf=G;function Y(q,se,K,U){K===void 0&&(K=0),U===void 0&&(U=-1);var ne,ke=Se(q,se,K,U);return ke!==-1&&(ne=ce(q,ke)),{index:ke,value:ne}}N.removeFirstWhere=Y;function oe(q,se,K,U){K===void 0&&(K=-1),U===void 0&&(U=0);var ne,ke=Re(q,se,K,U);return ke!==-1&&(ne=ce(q,ke)),{index:ke,value:ne}}N.removeLastWhere=oe;function be(q,se,K,U){K===void 0&&(K=0),U===void 0&&(U=-1);var ne=q.length;if(ne===0)return 0;K<0?K=Math.max(0,K+ne):K=Math.min(K,ne-1),U<0?U=Math.max(0,U+ne):U=Math.min(U,ne-1);for(var ke=0,Me=0;Me<ne;++Me)K<=U&&Me>=K&&Me<=U&&se(q[Me],Me)||U<K&&(Me<=U||Me>=K)&&se(q[Me],Me)?ke++:ke>0&&(q[Me-ke]=q[Me]);return ke>0&&(q.length=ne-ke),ke}N.removeAllWhere=be}(r.ArrayExt||(r.ArrayExt={}));function e(N){var W;return typeof N.iter=="function"?W=N.iter():W=new p(N),W}function t(N){return new f(N)}function n(N){return new m(N)}function i(N){return new g(N)}function o(N){return new h(N)}function s(N,W){for(var pe=0,Se=e(N),Re;(Re=Se.next())!==void 0;)if(W(Re,pe++)===!1)return}function a(N,W){for(var pe=0,Se=e(N),Re;(Re=Se.next())!==void 0;)if(!W(Re,pe++))return!1;return!0}function l(N,W){for(var pe=0,Se=e(N),Re;(Re=Se.next())!==void 0;)if(W(Re,pe++))return!0;return!1}function c(N){for(var W=0,pe=[],Se=e(N),Re;(Re=Se.next())!==void 0;)pe[W++]=Re;return pe}function d(N){for(var W=e(N),pe,Se={};(pe=W.next())!==void 0;)Se[pe[0]]=pe[1];return Se}var p=function(){function N(W){this._index=0,this._source=W}return N.prototype.iter=function(){return this},N.prototype.clone=function(){var W=new N(this._source);return W._index=this._index,W},N.prototype.next=function(){if(!(this._index>=this._source.length))return this._source[this._index++]},N}(),f=function(){function N(W,pe){pe===void 0&&(pe=Object.keys(W)),this._index=0,this._source=W,this._keys=pe}return N.prototype.iter=function(){return this},N.prototype.clone=function(){var W=new N(this._source,this._keys);return W._index=this._index,W},N.prototype.next=function(){if(!(this._index>=this._keys.length)){var W=this._keys[this._index++];return W in this._source?W:this.next()}},N}(),m=function(){function N(W,pe){pe===void 0&&(pe=Object.keys(W)),this._index=0,this._source=W,this._keys=pe}return N.prototype.iter=function(){return this},N.prototype.clone=function(){var W=new N(this._source,this._keys);return W._index=this._index,W},N.prototype.next=function(){if(!(this._index>=this._keys.length)){var W=this._keys[this._index++];return W in this._source?this._source[W]:this.next()}},N}(),g=function(){function N(W,pe){pe===void 0&&(pe=Object.keys(W)),this._index=0,this._source=W,this._keys=pe}return N.prototype.iter=function(){return this},N.prototype.clone=function(){var W=new N(this._source,this._keys);return W._index=this._index,W},N.prototype.next=function(){if(!(this._index>=this._keys.length)){var W=this._keys[this._index++];return W in this._source?[W,this._source[W]]:this.next()}},N}(),h=function(){function N(W){this._fn=W}return N.prototype.iter=function(){return this},N.prototype.clone=function(){throw new Error("An `FnIterator` cannot be cloned.")},N.prototype.next=function(){return this._fn.call(void 0)},N}();function v(){for(var N=[],W=0;W<arguments.length;W++)N[W]=arguments[W];return new S(e(N.map(e)))}var S=function(){function N(W){this._cloned=!1,this._source=W,this._active=void 0}return N.prototype.iter=function(){return this},N.prototype.clone=function(){var W=new N(this._source.clone());return W._active=this._active&&this._active.clone(),W._cloned=!0,this._cloned=!0,W},N.prototype.next=function(){if(this._active===void 0){var W=this._source.next();if(W===void 0)return;this._active=this._cloned?W.clone():W}var pe=this._active.next();return pe!==void 0?pe:(this._active=void 0,this.next())},N}();function _(){return new D}var D=function(){function N(){}return N.prototype.iter=function(){return this},N.prototype.clone=function(){return new N},N.prototype.next=function(){},N}();function P(N,W){return W===void 0&&(W=0),new M(e(N),W)}var M=function(){function N(W,pe){this._source=W,this._index=pe}return N.prototype.iter=function(){return this},N.prototype.clone=function(){return new N(this._source.clone(),this._index)},N.prototype.next=function(){var W=this._source.next();if(W!==void 0)return[this._index++,W]},N}();function x(N,W){return new A(e(N),W)}var A=function(){function N(W,pe){this._index=0,this._source=W,this._fn=pe}return N.prototype.iter=function(){return this},N.prototype.clone=function(){var W=new N(this._source.clone(),this._fn);return W._index=this._index,W},N.prototype.next=function(){for(var W=this._fn,pe=this._source,Se;(Se=pe.next())!==void 0;)if(W(Se,this._index++))return Se},N}();function j(N,W){for(var pe=0,Se=e(N),Re;(Re=Se.next())!==void 0;)if(W(Re,pe++))return Re}function re(N,W){for(var pe=0,Se=e(N),Re;(Re=Se.next())!==void 0;)if(W(Re,pe++))return pe-1;return-1}function R(N,W){var pe=e(N),Se=pe.next();if(Se!==void 0){for(var Re=Se;(Se=pe.next())!==void 0;)W(Se,Re)<0&&(Re=Se);return Re}}function Z(N,W){var pe=e(N),Se=pe.next();if(Se!==void 0){for(var Re=Se;(Se=pe.next())!==void 0;)W(Se,Re)>0&&(Re=Se);return Re}}function ge(N,W){var pe=e(N),Se=pe.next();if(Se!==void 0){for(var Re=Se,Gt=Se;(Se=pe.next())!==void 0;)W(Se,Re)<0?Re=Se:W(Se,Gt)>0&&(Gt=Se);return[Re,Gt]}}function Le(N,W){return new Ee(e(N),W)}var Ee=function(){function N(W,pe){this._index=0,this._source=W,this._fn=pe}return N.prototype.iter=function(){return this},N.prototype.clone=function(){var W=new N(this._source.clone(),this._fn);return W._index=this._index,W},N.prototype.next=function(){var W=this._source.next();if(W!==void 0)return this._fn.call(void 0,W,this._index++)},N}();function ae(N,W,pe){return W===void 0?new kt(0,N,1):pe===void 0?new kt(N,W,1):new kt(N,W,pe)}var kt=function(){function N(W,pe,Se){this._index=0,this._start=W,this._stop=pe,this._step=Se,this._length=yr.rangeLength(W,pe,Se)}return N.prototype.iter=function(){return this},N.prototype.clone=function(){var W=new N(this._start,this._stop,this._step);return W._index=this._index,W},N.prototype.next=function(){if(!(this._index>=this._length))return this._start+this._step*this._index++},N}(),yr;(function(N){function W(pe,Se,Re){return Re===0?1/0:pe>Se&&Re>0||pe<Se&&Re<0?0:Math.ceil((Se-pe)/Re)}N.rangeLength=W})(yr||(yr={}));function We(N,W,pe){var Se=0,Re=e(N),Gt=Re.next();if(Gt===void 0&&pe===void 0)throw new TypeError("Reduce of empty iterable with no initial value.");if(Gt===void 0)return pe;var $e=Re.next();if($e===void 0&&pe===void 0)return Gt;if($e===void 0)return W(pe,Gt,Se++);var yt;pe===void 0?yt=W(Gt,$e,Se++):yt=W(W(pe,Gt,Se++),$e,Se++);for(var Qt;(Qt=Re.next())!==void 0;)yt=W(yt,Qt,Se++);return yt}function $r(N,W){return new de(N,W)}function H(N){return new de(N,1)}var de=function(){function N(W,pe){this._value=W,this._count=pe}return N.prototype.iter=function(){return this},N.prototype.clone=function(){return new N(this._value,this._count)},N.prototype.next=function(){if(!(this._count<=0))return this._count--,this._value},N}();function Pe(N){var W;return typeof N.retro=="function"?W=N.retro():W=new ye(N),W}var ye=function(){function N(W){this._source=W,this._index=W.length-1}return N.prototype.iter=function(){return this},N.prototype.clone=function(){var W=new N(this._source);return W._index=this._index,W},N.prototype.next=function(){if(!(this._index<0||this._index>=this._source.length))return this._source[this._index--]},N}();function Ce(N){var W=[],pe=new Set,Se=new Map;return s(N,Re),Se.forEach(function($e,yt){Gt(yt)}),W;function Re($e){var yt=$e[0],Qt=$e[1],Ot=Se.get(Qt);Ot?Ot.push(yt):Se.set(Qt,[yt])}function Gt($e){if(!pe.has($e)){pe.add($e);var yt=Se.get($e);yt&&yt.forEach(Gt),W.push($e)}}}function L(N,W){return new le(e(N),W)}var le=function(){function N(W,pe){this._source=W,this._step=pe}return N.prototype.iter=function(){return this},N.prototype.clone=function(){return new N(this._source.clone(),this._step)},N.prototype.next=function(){for(var W=this._source.next(),pe=this._step-1;pe>0;--pe)this._source.next();return W},N}();r.StringExt=void 0,function(N){function W($e,yt,Qt){Qt===void 0&&(Qt=0);for(var Ot=new Array(yt.length),Dr=0,F=Qt,ue=yt.length;Dr<ue;++Dr,++F){if(F=$e.indexOf(yt[Dr],F),F===-1)return null;Ot[Dr]=F}return Ot}N.findIndices=W;function pe($e,yt,Qt){Qt===void 0&&(Qt=0);var Ot=W($e,yt,Qt);if(!Ot)return null;for(var Dr=0,F=0,ue=Ot.length;F<ue;++F){var k=Ot[F]-Qt;Dr+=k*k}return{score:Dr,indices:Ot}}N.matchSumOfSquares=pe;function Se($e,yt,Qt){Qt===void 0&&(Qt=0);var Ot=W($e,yt,Qt);if(!Ot)return null;for(var Dr=0,F=Qt-1,ue=0,k=Ot.length;ue<k;++ue){var O=Ot[ue];Dr+=O-F-1,F=O}return{score:Dr,indices:Ot}}N.matchSumOfDeltas=Se;function Re($e,yt,Qt){for(var Ot=[],Dr=0,F=0,ue=yt.length;Dr<ue;){for(var k=yt[Dr],O=yt[Dr];++Dr<ue&&yt[Dr]===O+1;)O++;F<k&&Ot.push($e.slice(F,k)),k<O+1&&Ot.push(Qt($e.slice(k,O+1))),F=O+1}return F<$e.length&&Ot.push($e.slice(F)),Ot}N.highlight=Re;function Gt($e,yt){return $e<yt?-1:$e>yt?1:0}N.cmp=Gt}(r.StringExt||(r.StringExt={}));function me(N,W){return new we(e(N),W)}var we=function(){function N(W,pe){this._source=W,this._count=pe}return N.prototype.iter=function(){return this},N.prototype.clone=function(){return new N(this._source.clone(),this._count)},N.prototype.next=function(){if(!(this._count<=0)){var W=this._source.next();if(W!==void 0)return this._count--,W}},N}();function Oe(){for(var N=[],W=0;W<arguments.length;W++)N[W]=arguments[W];return new Ze(N.map(e))}var Ze=function(){function N(W){this._source=W}return N.prototype.iter=function(){return this},N.prototype.clone=function(){return new N(this._source.map(function(W){return W.clone()}))},N.prototype.next=function(){for(var W=new Array(this._source.length),pe=0,Se=this._source.length;pe<Se;++pe){var Re=this._source[pe].next();if(Re===void 0)return;W[pe]=Re}return W},N}();r.ArrayIterator=p,r.ChainIterator=S,r.EmptyIterator=D,r.EnumerateIterator=M,r.FilterIterator=A,r.FnIterator=h,r.ItemIterator=g,r.KeyIterator=f,r.MapIterator=Ee,r.RangeIterator=kt,r.RepeatIterator=de,r.RetroArrayIterator=ye,r.StrideIterator=le,r.TakeIterator=we,r.ValueIterator=m,r.ZipIterator=Ze,r.chain=v,r.each=s,r.empty=_,r.enumerate=P,r.every=a,r.filter=x,r.find=j,r.findIndex=re,r.iter=e,r.iterFn=o,r.iterItems=i,r.iterKeys=t,r.iterValues=n,r.map=Le,r.max=Z,r.min=R,r.minmax=ge,r.once=H,r.range=ae,r.reduce=We,r.repeat=$r,r.retro=Pe,r.some=l,r.stride=L,r.take=me,r.toArray=c,r.toObject=d,r.topologicSort=Ce,r.zip=Oe,Object.defineProperty(r,"__esModule",{value:!0})})});var aW=z((F0,NG)=>{u();(function(r,e){typeof F0=="object"&&typeof NG!="undefined"?e(F0):typeof define=="function"&&define.amd?define(["exports"],e):(r=typeof globalThis!="undefined"?globalThis:r||self,e(r.lumino_properties={}))})(F0,function(r){"use strict";r.AttachedProperty=function(){function t(n){this._pid=e.nextPID(),this.name=n.name,this._create=n.create,this._coerce=n.coerce||null,this._compare=n.compare||null,this._changed=n.changed||null}return t.prototype.get=function(n){var i,o=e.ensureMap(n);return this._pid in o?i=o[this._pid]:i=o[this._pid]=this._createValue(n),i},t.prototype.set=function(n,i){var o,s=e.ensureMap(n);this._pid in s?o=s[this._pid]:o=s[this._pid]=this._createValue(n);var a=this._coerceValue(n,i);this._maybeNotify(n,o,s[this._pid]=a)},t.prototype.coerce=function(n){var i,o=e.ensureMap(n);this._pid in o?i=o[this._pid]:i=o[this._pid]=this._createValue(n);var s=this._coerceValue(n,i);this._maybeNotify(n,i,o[this._pid]=s)},t.prototype._createValue=function(n){var i=this._create;return i(n)},t.prototype._coerceValue=function(n,i){var o=this._coerce;return o?o(n,i):i},t.prototype._compareValue=function(n,i){var o=this._compare;return o?o(n,i):n===i},t.prototype._maybeNotify=function(n,i,o){var s=this._changed;s&&!this._compareValue(i,o)&&s(n,i,o)},t}(),function(t){function n(i){e.ownerData.delete(i)}t.clearData=n}(r.AttachedProperty||(r.AttachedProperty={}));var e;(function(t){t.ownerData=new WeakMap,t.nextPID=function(){var i=0;return function(){var o=Math.random(),s=(""+o).slice(2);return"pid-"+s+"-"+i++}}();function n(i){var o=t.ownerData.get(i);return o||(o=Object.create(null),t.ownerData.set(i,o),o)}t.ensureMap=n})(e||(e={})),Object.defineProperty(r,"__esModule",{value:!0})})});var Mi=z((U0,RG)=>{u();(function(r,e){typeof U0=="object"&&typeof RG!="undefined"?e(U0,Nh(),aW()):typeof define=="function"&&define.amd?define(["exports","@lumino/algorithm","@lumino/properties"],e):(r=typeof globalThis!="undefined"?globalThis:r||self,e(r.lumino_signaling={},r.lumino_algorithm,r.lumino_properties))})(U0,function(r,e,t){"use strict";r.Signal=function(){function i(o){this._blockedCount=0,this.sender=o}return i.prototype.block=function(o){this._blockedCount++;try{o()}finally{this._blockedCount--}},i.prototype.connect=function(o,s){return n.connect(this,o,s)},i.prototype.disconnect=function(o,s){return n.disconnect(this,o,s)},i.prototype.emit=function(o){this._blockedCount||n.emit(this,o)},i}(),function(i){function o(m,g){var h=n.blockedProperty;h.set(m,h.get(m)+1);try{g()}finally{h.set(m,h.get(m)-1)}}i.blockAll=o;function s(m,g){n.disconnectBetween(m,g)}i.disconnectBetween=s;function a(m){n.disconnectSender(m)}i.disconnectSender=a;function l(m){n.disconnectReceiver(m)}i.disconnectReceiver=l;function c(m){n.disconnectAll(m)}i.disconnectAll=c;function d(m){n.disconnectAll(m)}i.clearData=d;function p(){return n.exceptionHandler}i.getExceptionHandler=p;function f(m){var g=n.exceptionHandler;return n.exceptionHandler=m,g}i.setExceptionHandler=f}(r.Signal||(r.Signal={}));var n;(function(i){i.exceptionHandler=function(x){console.error(x)};function o(x,A,j){j=j||void 0;var re=f.get(x.sender);if(re||(re=[],f.set(x.sender,re)),v(re,x,A,j))return!1;var R=j||A,Z=m.get(R);Z||(Z=[],m.set(R,Z));var ge={signal:x,slot:A,thisArg:j};return re.push(ge),Z.push(ge),!0}i.connect=o;function s(x,A,j){j=j||void 0;var re=f.get(x.sender);if(!re||re.length===0)return!1;var R=v(re,x,A,j);if(!R)return!1;var Z=j||A,ge=m.get(Z);return R.signal=null,_(re),_(ge),!0}i.disconnect=s;function a(x,A){var j=f.get(x);if(!(!j||j.length===0)){var re=m.get(A);!re||re.length===0||(e.each(re,function(R){R.signal&&R.signal.sender===x&&(R.signal=null)}),_(j),_(re))}}i.disconnectBetween=a;function l(x){var A=f.get(x);!A||A.length===0||(e.each(A,function(j){if(j.signal){var re=j.thisArg||j.slot;j.signal=null,_(m.get(re))}}),_(A))}i.disconnectSender=l;function c(x){var A=m.get(x);!A||A.length===0||(e.each(A,function(j){if(j.signal){var re=j.signal.sender;j.signal=null,_(f.get(re))}}),_(A))}i.disconnectReceiver=c;function d(x){l(x),c(x)}i.disconnectAll=d;function p(x,A){if(!(i.blockedProperty.get(x.sender)>0)){var j=f.get(x.sender);if(!(!j||j.length===0))for(var re=0,R=j.length;re<R;++re){var Z=j[re];Z.signal===x&&S(Z,A)}}}i.emit=p;var f=new WeakMap,m=new WeakMap,g=new Set,h=function(){var x=typeof requestAnimationFrame=="function";return x?requestAnimationFrame:setImmediate}();function v(x,A,j,re){return e.find(x,function(R){return R.signal===A&&R.slot===j&&R.thisArg===re})}function S(x,A){var j=x.signal,re=x.slot,R=x.thisArg;try{re.call(R,j.sender,A)}catch(Z){i.exceptionHandler(Z)}}function _(x){g.size===0&&h(D),g.add(x)}function D(){g.forEach(P),g.clear()}function P(x){e.ArrayExt.removeAllWhere(x,M)}function M(x){return x.signal===null}i.blockedProperty=new t.AttachedProperty({name:"blocked",create:function(){return 0}})})(n||(n={})),Object.defineProperty(r,"__esModule",{value:!0})})});var MG=z(W0=>{"use strict";u();Object.defineProperty(W0,"__esModule",{value:!0});W0.ActivityMonitor=void 0;var AG=Mi(),lW=class{constructor(e){this._timer=-1,this._timeout=-1,this._isDisposed=!1,this._activityStopped=new AG.Signal(this),e.signal.connect(this._onSignalFired,this),this._timeout=e.timeout||1e3}get activityStopped(){return this._activityStopped}get timeout(){return this._timeout}set timeout(e){this._timeout=e}get isDisposed(){return this._isDisposed}dispose(){this._isDisposed||(this._isDisposed=!0,AG.Signal.clearData(this))}_onSignalFired(e,t){clearTimeout(this._timer),this._sender=e,this._args=t,this._timer=setTimeout(()=>{this._activityStopped.emit({sender:this._sender,args:this._args})},this._timeout)}};W0.ActivityMonitor=lW});var LG=z(OG=>{"use strict";u();Object.defineProperty(OG,"__esModule",{value:!0})});var KG=z(dx=>{"use strict";u();Object.defineProperty(dx,"__esModule",{value:!0});dx.MarkdownCodeBlocks=void 0;var Yge;(function(r){r.CODE_BLOCK_MARKER="```";let e=[".markdown",".mdown",".mkdn",".md",".mkd",".mdwn",".mdtxt",".mdtext",".text",".txt",".Rmd"];class t{constructor(s){this.startLine=s,this.code="",this.endLine=-1}}r.MarkdownCodeBlock=t;function n(o){return e.indexOf(o)>-1}r.isMarkdown=n;function i(o){if(!o||o==="")return[];let s=o.split(`
`),a=[],l=null;for(let c=0;c<s.length;c++){let d=s[c],p=d.indexOf(r.CODE_BLOCK_MARKER)===0,f=l!=null;if(!(!p&&!f))if(f)l&&(p?(l.endLine=c-1,a.push(l),l=null):l.code+=d+`
`);else{l=new t(c);let m=d.indexOf(r.CODE_BLOCK_MARKER),g=d.lastIndexOf(r.CODE_BLOCK_MARKER);m!==g&&(l.code=d.substring(m+r.CODE_BLOCK_MARKER.length,g),l.endLine=c,a.push(l),l=null)}}return a}r.findMarkdownCodeBlocks=i})(Yge=dx.MarkdownCodeBlocks||(dx.MarkdownCodeBlocks={}))});var Ml=z((V0,FG)=>{u();(function(r,e){typeof V0=="object"&&typeof FG!="undefined"?e(V0):typeof define=="function"&&define.amd?define(["exports"],e):(r=typeof globalThis!="undefined"?globalThis:r||self,e(r.lumino_coreutils={}))})(V0,function(r){"use strict";r.JSONExt=void 0,function(s){s.emptyObject=Object.freeze({}),s.emptyArray=Object.freeze([]);function a(v){return v===null||typeof v=="boolean"||typeof v=="number"||typeof v=="string"}s.isPrimitive=a;function l(v){return Array.isArray(v)}s.isArray=l;function c(v){return!a(v)&&!l(v)}s.isObject=c;function d(v,S){if(v===S)return!0;if(a(v)||a(S))return!1;var _=l(v),D=l(S);return _!==D?!1:_&&D?f(v,S):m(v,S)}s.deepEqual=d;function p(v){return a(v)?v:l(v)?g(v):h(v)}s.deepCopy=p;function f(v,S){if(v===S)return!0;if(v.length!==S.length)return!1;for(var _=0,D=v.length;_<D;++_)if(!d(v[_],S[_]))return!1;return!0}function m(v,S){if(v===S)return!0;for(var _ in v)if(v[_]!==void 0&&!(_ in S))return!1;for(var _ in S)if(S[_]!==void 0&&!(_ in v))return!1;for(var _ in v){var D=v[_],P=S[_];if(!(D===void 0&&P===void 0)&&(D===void 0||P===void 0||!d(D,P)))return!1}return!0}function g(v){for(var S=new Array(v.length),_=0,D=v.length;_<D;++_)S[_]=p(v[_]);return S}function h(v){var S={};for(var _ in v){var D=v[_];D!==void 0&&(S[_]=p(D))}return S}}(r.JSONExt||(r.JSONExt={}));var e=function(){function s(){this._types=[],this._values=[]}return s.prototype.types=function(){return this._types.slice()},s.prototype.hasData=function(a){return this._types.indexOf(a)!==-1},s.prototype.getData=function(a){var l=this._types.indexOf(a);return l!==-1?this._values[l]:void 0},s.prototype.setData=function(a,l){this.clearData(a),this._types.push(a),this._values.push(l)},s.prototype.clearData=function(a){var l=this._types.indexOf(a);l!==-1&&(this._types.splice(l,1),this._values.splice(l,1))},s.prototype.clear=function(){this._types.length=0,this._values.length=0},s}(),t=function(){function s(){var a=this;this.promise=new Promise(function(l,c){a._resolve=l,a._reject=c})}return s.prototype.resolve=function(a){var l=this._resolve;l(a)},s.prototype.reject=function(a){var l=this._reject;l(a)},s}(),n=function(){function s(a){this.name=a,this._tokenStructuralPropertyT=null}return s}();function i(s){for(var a=0,l=0,c=s.length;l<c;++l)l%4===0&&(a=Math.random()*4294967295>>>0),s[l]=a&255,a>>>=8}r.Random=void 0,function(s){s.getRandomValues=function(){var a=typeof window!="undefined"&&(window.crypto||window.msCrypto)||null;return a&&typeof a.getRandomValues=="function"?function(c){return a.getRandomValues(c)}:i}()}(r.Random||(r.Random={}));function o(s){for(var a=new Uint8Array(16),l=new Array(256),c=0;c<16;++c)l[c]="0"+c.toString(16);for(var c=16;c<256;++c)l[c]=c.toString(16);return function(){return s(a),a[6]=64|a[6]&15,a[8]=128|a[8]&63,l[a[0]]+l[a[1]]+l[a[2]]+l[a[3]]+"-"+l[a[4]]+l[a[5]]+"-"+l[a[6]]+l[a[7]]+"-"+l[a[8]]+l[a[9]]+"-"+l[a[10]]+l[a[11]]+l[a[12]]+l[a[13]]+l[a[14]]+l[a[15]]}}r.UUID=void 0,function(s){s.uuid4=o(r.Random.getRandomValues)}(r.UUID||(r.UUID={})),r.MimeData=e,r.PromiseDelegate=t,r.Token=n,Object.defineProperty(r,"__esModule",{value:!0})})});var jG=z((N6e,VG)=>{"use strict";u();function $ge(r,e){var t=r;e.slice(0,-1).forEach(function(i){t=t[i]||{}});var n=e[e.length-1];return n in t}function UG(r){return typeof r=="number"||/^0x[0-9a-f]+$/i.test(r)?!0:/^[-+]?(?:\d+(?:\.\d*)?|\.\d+)(e[-+]?\d+)?$/.test(r)}function WG(r,e){return e==="constructor"&&typeof r[e]=="function"||e==="__proto__"}VG.exports=function(r,e){e||(e={});var t={bools:{},strings:{},unknownFn:null};typeof e.unknown=="function"&&(t.unknownFn=e.unknown),typeof e.boolean=="boolean"&&e.boolean?t.allBools=!0:[].concat(e.boolean).filter(Boolean).forEach(function(P){t.bools[P]=!0});var n={};function i(P){return n[P].some(function(M){return t.bools[M]})}Object.keys(e.alias||{}).forEach(function(P){n[P]=[].concat(e.alias[P]),n[P].forEach(function(M){n[M]=[P].concat(n[P].filter(function(x){return M!==x}))})}),[].concat(e.string).filter(Boolean).forEach(function(P){t.strings[P]=!0,n[P]&&[].concat(n[P]).forEach(function(M){t.strings[M]=!0})});var o=e.default||{},s={_:[]};function a(P,M){return t.allBools&&/^--[^=]+$/.test(M)||t.strings[P]||t.bools[P]||n[P]}function l(P,M,x){for(var A=P,j=0;j<M.length-1;j++){var re=M[j];if(WG(A,re))return;A[re]===void 0&&(A[re]={}),(A[re]===Object.prototype||A[re]===Number.prototype||A[re]===String.prototype)&&(A[re]={}),A[re]===Array.prototype&&(A[re]=[]),A=A[re]}var R=M[M.length-1];WG(A,R)||((A===Object.prototype||A===Number.prototype||A===String.prototype)&&(A={}),A===Array.prototype&&(A=[]),A[R]===void 0||t.bools[R]||typeof A[R]=="boolean"?A[R]=x:Array.isArray(A[R])?A[R].push(x):A[R]=[A[R],x])}function c(P,M,x){if(!(x&&t.unknownFn&&!a(P,x)&&t.unknownFn(x)===!1)){var A=!t.strings[P]&&UG(M)?Number(M):M;l(s,P.split("."),A),(n[P]||[]).forEach(function(j){l(s,j.split("."),A)})}}Object.keys(t.bools).forEach(function(P){c(P,o[P]===void 0?!1:o[P])});var d=[];r.indexOf("--")!==-1&&(d=r.slice(r.indexOf("--")+1),r=r.slice(0,r.indexOf("--")));for(var p=0;p<r.length;p++){var f=r[p],m,g;if(/^--.+=/.test(f)){var h=f.match(/^--([^=]+)=([\s\S]*)$/);m=h[1];var v=h[2];t.bools[m]&&(v=v!=="false"),c(m,v,f)}else if(/^--no-.+/.test(f))m=f.match(/^--no-(.+)/)[1],c(m,!1,f);else if(/^--.+/.test(f))m=f.match(/^--(.+)/)[1],g=r[p+1],g!==void 0&&!/^(-|--)[^-]/.test(g)&&!t.bools[m]&&!t.allBools&&(!n[m]||!i(m))?(c(m,g,f),p+=1):/^(true|false)$/.test(g)?(c(m,g==="true",f),p+=1):c(m,t.strings[m]?"":!0,f);else if(/^-[^-]+/.test(f)){for(var S=f.slice(1,-1).split(""),_=!1,D=0;D<S.length;D++){if(g=f.slice(D+2),g==="-"){c(S[D],g,f);continue}if(/[A-Za-z]/.test(S[D])&&g[0]==="="){c(S[D],g.slice(1),f),_=!0;break}if(/[A-Za-z]/.test(S[D])&&/-?\d+(\.\d*)?(e-?\d+)?$/.test(g)){c(S[D],g,f),_=!0;break}if(S[D+1]&&S[D+1].match(/\W/)){c(S[D],f.slice(D+2),f),_=!0;break}else c(S[D],t.strings[S[D]]?"":!0,f)}m=f.slice(-1)[0],!_&&m!=="-"&&(r[p+1]&&!/^(-|--)[^-]/.test(r[p+1])&&!t.bools[m]&&(!n[m]||!i(m))?(c(m,r[p+1],f),p+=1):r[p+1]&&/^(true|false)$/.test(r[p+1])?(c(m,r[p+1]==="true",f),p+=1):c(m,t.strings[m]?"":!0,f))}else if((!t.unknownFn||t.unknownFn(f)!==!1)&&s._.push(t.strings._||!UG(f)?f:Number(f)),e.stopEarly){s._.push.apply(s._,r.slice(p+1));break}}return Object.keys(o).forEach(function(P){$ge(s,P.split("."))||(l(s,P.split("."),o[P]),(n[P]||[]).forEach(function(M){l(s,M.split("."),o[P])}))}),e["--"]?s["--"]=d.slice():d.forEach(function(P){s._.push(P)}),s}});var j0=z((A6e,HG)=>{"use strict";u();function Wc(r){if(typeof r!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(r))}function BG(r,e){for(var t="",n=0,i=-1,o=0,s,a=0;a<=r.length;++a){if(a<r.length)s=r.charCodeAt(a);else{if(s===47)break;s=47}if(s===47){if(!(i===a-1||o===1))if(i!==a-1&&o===2){if(t.length<2||n!==2||t.charCodeAt(t.length-1)!==46||t.charCodeAt(t.length-2)!==46){if(t.length>2){var l=t.lastIndexOf("/");if(l!==t.length-1){l===-1?(t="",n=0):(t=t.slice(0,l),n=t.length-1-t.lastIndexOf("/")),i=a,o=0;continue}}else if(t.length===2||t.length===1){t="",n=0,i=a,o=0;continue}}e&&(t.length>0?t+="/..":t="..",n=2)}else t.length>0?t+="/"+r.slice(i+1,a):t=r.slice(i+1,a),n=a-i-1;i=a,o=0}else s===46&&o!==-1?++o:o=-1}return t}function zge(r,e){var t=e.dir||e.root,n=e.base||(e.name||"")+(e.ext||"");return t?t===e.root?t+n:t+r+n:n}var aI={resolve:function(){for(var e="",t=!1,n,i=arguments.length-1;i>=-1&&!t;i--){var o;i>=0?o=arguments[i]:(n===void 0&&(n=process.cwd()),o=n),Wc(o),o.length!==0&&(e=o+"/"+e,t=o.charCodeAt(0)===47)}return e=BG(e,!t),t?e.length>0?"/"+e:"/":e.length>0?e:"."},normalize:function(e){if(Wc(e),e.length===0)return".";var t=e.charCodeAt(0)===47,n=e.charCodeAt(e.length-1)===47;return e=BG(e,!t),e.length===0&&!t&&(e="."),e.length>0&&n&&(e+="/"),t?"/"+e:e},isAbsolute:function(e){return Wc(e),e.length>0&&e.charCodeAt(0)===47},join:function(){if(arguments.length===0)return".";for(var e,t=0;t<arguments.length;++t){var n=arguments[t];Wc(n),n.length>0&&(e===void 0?e=n:e+="/"+n)}return e===void 0?".":aI.normalize(e)},relative:function(e,t){if(Wc(e),Wc(t),e===t||(e=aI.resolve(e),t=aI.resolve(t),e===t))return"";for(var n=1;n<e.length&&e.charCodeAt(n)===47;++n);for(var i=e.length,o=i-n,s=1;s<t.length&&t.charCodeAt(s)===47;++s);for(var a=t.length,l=a-s,c=o<l?o:l,d=-1,p=0;p<=c;++p){if(p===c){if(l>c){if(t.charCodeAt(s+p)===47)return t.slice(s+p+1);if(p===0)return t.slice(s+p)}else o>c&&(e.charCodeAt(n+p)===47?d=p:p===0&&(d=0));break}var f=e.charCodeAt(n+p),m=t.charCodeAt(s+p);if(f!==m)break;f===47&&(d=p)}var g="";for(p=n+d+1;p<=i;++p)(p===i||e.charCodeAt(p)===47)&&(g.length===0?g+="..":g+="/..");return g.length>0?g+t.slice(s+d):(s+=d,t.charCodeAt(s)===47&&++s,t.slice(s))},_makeLong:function(e){return e},dirname:function(e){if(Wc(e),e.length===0)return".";for(var t=e.charCodeAt(0),n=t===47,i=-1,o=!0,s=e.length-1;s>=1;--s)if(t=e.charCodeAt(s),t===47){if(!o){i=s;break}}else o=!1;return i===-1?n?"/":".":n&&i===1?"//":e.slice(0,i)},basename:function(e,t){if(t!==void 0&&typeof t!="string")throw new TypeError('"ext" argument must be a string');Wc(e);var n=0,i=-1,o=!0,s;if(t!==void 0&&t.length>0&&t.length<=e.length){if(t.length===e.length&&t===e)return"";var a=t.length-1,l=-1;for(s=e.length-1;s>=0;--s){var c=e.charCodeAt(s);if(c===47){if(!o){n=s+1;break}}else l===-1&&(o=!1,l=s+1),a>=0&&(c===t.charCodeAt(a)?--a===-1&&(i=s):(a=-1,i=l))}return n===i?i=l:i===-1&&(i=e.length),e.slice(n,i)}else{for(s=e.length-1;s>=0;--s)if(e.charCodeAt(s)===47){if(!o){n=s+1;break}}else i===-1&&(o=!1,i=s+1);return i===-1?"":e.slice(n,i)}},extname:function(e){Wc(e);for(var t=-1,n=0,i=-1,o=!0,s=0,a=e.length-1;a>=0;--a){var l=e.charCodeAt(a);if(l===47){if(!o){n=a+1;break}continue}i===-1&&(o=!1,i=a+1),l===46?t===-1?t=a:s!==1&&(s=1):t!==-1&&(s=-1)}return t===-1||i===-1||s===0||s===1&&t===i-1&&t===n+1?"":e.slice(t,i)},format:function(e){if(e===null||typeof e!="object")throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof e);return zge("/",e)},parse:function(e){Wc(e);var t={root:"",dir:"",base:"",ext:"",name:""};if(e.length===0)return t;var n=e.charCodeAt(0),i=n===47,o;i?(t.root="/",o=1):o=0;for(var s=-1,a=0,l=-1,c=!0,d=e.length-1,p=0;d>=o;--d){if(n=e.charCodeAt(d),n===47){if(!c){a=d+1;break}continue}l===-1&&(c=!1,l=d+1),n===46?s===-1?s=d:p!==1&&(p=1):s!==-1&&(p=-1)}return s===-1||l===-1||p===0||p===1&&s===l-1&&s===a+1?l!==-1&&(a===0&&i?t.base=t.name=e.slice(1,l):t.base=t.name=e.slice(a,l)):(a===0&&i?(t.name=e.slice(1,s),t.base=e.slice(1,l)):(t.name=e.slice(a,s),t.base=e.slice(a,l)),t.ext=e.slice(s,l)),a>0?t.dir=e.slice(0,a-1):i&&(t.dir="/"),t},sep:"/",delimiter:":",win32:null,posix:null};aI.posix=aI;HG.exports=aI});var qG=z((O6e,JG)=>{"use strict";u();JG.exports=function(e,t){if(t=t.split(":")[0],e=+e,!e)return!1;switch(t){case"http":case"ws":return e!==80;case"https":case"wss":return e!==443;case"ftp":return e!==21;case"gopher":return e!==70;case"file":return!1}return e!==0}});var $G=z(cW=>{"use strict";u();var Qge=Object.prototype.hasOwnProperty,Xge;function GG(r){try{return decodeURIComponent(r.replace(/\+/g," "))}catch(e){return null}}function YG(r){try{return encodeURIComponent(r)}catch(e){return null}}function Zge(r){for(var e=/([^=?#&]+)=?([^&]*)/g,t={},n;n=e.exec(r);){var i=GG(n[1]),o=GG(n[2]);i===null||o===null||i in t||(t[i]=o)}return t}function ehe(r,e){e=e||"";var t=[],n,i;typeof e!="string"&&(e="?");for(i in r)if(Qge.call(r,i)){if(n=r[i],!n&&(n===null||n===Xge||isNaN(n))&&(n=""),i=YG(i),n=YG(n),i===null||n===null)continue;t.push(i+"="+n)}return t.length?e+t.join("&"):""}cW.stringify=ehe;cW.parse=Zge});var pW=z((U6e,rY)=>{"use strict";u();var QG=qG(),B0=$G(),the=/^[\x00-\x20\u00a0\u1680\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]+/,XG=/[\n\r\t]/g,rhe=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//,ZG=/:\d+$/,nhe=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\\/]+)?([\S\s]*)/i,ihe=/^[a-zA-Z]:/;function dW(r){return(r||"").toString().replace(the,"")}var uW=[["#","hash"],["?","query"],function(e,t){return Vc(t.protocol)?e.replace(/\\/g,"/"):e},["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d*)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],zG={hash:1,query:1};function eY(r){var e;typeof window!="undefined"?e=window:typeof this!="undefined"?e=this:typeof self!="undefined"?e=self:e={};var t=e.location||{};r=r||t;var n={},i=typeof r,o;if(r.protocol==="blob:")n=new jc(unescape(r.pathname),{});else if(i==="string"){n=new jc(r,{});for(o in zG)delete n[o]}else if(i==="object"){for(o in r)o in zG||(n[o]=r[o]);n.slashes===void 0&&(n.slashes=rhe.test(r.href))}return n}function Vc(r){return r==="file:"||r==="ftp:"||r==="http:"||r==="https:"||r==="ws:"||r==="wss:"}function tY(r,e){r=dW(r),r=r.replace(XG,""),e=e||{};var t=nhe.exec(r),n=t[1]?t[1].toLowerCase():"",i=!!t[2],o=!!t[3],s=0,a;return i?o?(a=t[2]+t[3]+t[4],s=t[2].length+t[3].length):(a=t[2]+t[4],s=t[2].length):o?(a=t[3]+t[4],s=t[3].length):a=t[4],n==="file:"?s>=2&&(a=a.slice(2)):Vc(n)?a=t[4]:n?i&&(a=a.slice(2)):s>=2&&Vc(e.protocol)&&(a=t[4]),{protocol:n,slashes:i||Vc(n),slashesCount:s,rest:a}}function ohe(r,e){if(r==="")return e;for(var t=(e||"/").split("/").slice(0,-1).concat(r.split("/")),n=t.length,i=t[n-1],o=!1,s=0;n--;)t[n]==="."?t.splice(n,1):t[n]===".."?(t.splice(n,1),s++):s&&(n===0&&(o=!0),t.splice(n,1),s--);return o&&t.unshift(""),(i==="."||i==="..")&&t.push(""),t.join("/")}function jc(r,e,t){if(r=dW(r),r=r.replace(XG,""),!(this instanceof jc))return new jc(r,e,t);var n,i,o,s,a,l,c=uW.slice(),d=typeof e,p=this,f=0;for(d!=="object"&&d!=="string"&&(t=e,e=null),t&&typeof t!="function"&&(t=B0.parse),e=eY(e),i=tY(r||"",e),n=!i.protocol&&!i.slashes,p.slashes=i.slashes||n&&e.slashes,p.protocol=i.protocol||e.protocol||"",r=i.rest,(i.protocol==="file:"&&(i.slashesCount!==2||ihe.test(r))||!i.slashes&&(i.protocol||i.slashesCount<2||!Vc(p.protocol)))&&(c[3]=[/(.*)/,"pathname"]);f<c.length;f++){if(s=c[f],typeof s=="function"){r=s(r,p);continue}o=s[0],l=s[1],o!==o?p[l]=r:typeof o=="string"?(a=o==="@"?r.lastIndexOf(o):r.indexOf(o),~a&&(typeof s[2]=="number"?(p[l]=r.slice(0,a),r=r.slice(a+s[2])):(p[l]=r.slice(a),r=r.slice(0,a)))):(a=o.exec(r))&&(p[l]=a[1],r=r.slice(0,a.index)),p[l]=p[l]||n&&s[3]&&e[l]||"",s[4]&&(p[l]=p[l].toLowerCase())}t&&(p.query=t(p.query)),n&&e.slashes&&p.pathname.charAt(0)!=="/"&&(p.pathname!==""||e.pathname!=="")&&(p.pathname=ohe(p.pathname,e.pathname)),p.pathname.charAt(0)!=="/"&&Vc(p.protocol)&&(p.pathname="/"+p.pathname),QG(p.port,p.protocol)||(p.host=p.hostname,p.port=""),p.username=p.password="",p.auth&&(a=p.auth.indexOf(":"),~a?(p.username=p.auth.slice(0,a),p.username=encodeURIComponent(decodeURIComponent(p.username)),p.password=p.auth.slice(a+1),p.password=encodeURIComponent(decodeURIComponent(p.password))):p.username=encodeURIComponent(decodeURIComponent(p.auth)),p.auth=p.password?p.username+":"+p.password:p.username),p.origin=p.protocol!=="file:"&&Vc(p.protocol)&&p.host?p.protocol+"//"+p.host:"null",p.href=p.toString()}function she(r,e,t){var n=this;switch(r){case"query":typeof e=="string"&&e.length&&(e=(t||B0.parse)(e)),n[r]=e;break;case"port":n[r]=e,QG(e,n.protocol)?e&&(n.host=n.hostname+":"+e):(n.host=n.hostname,n[r]="");break;case"hostname":n[r]=e,n.port&&(e+=":"+n.port),n.host=e;break;case"host":n[r]=e,ZG.test(e)?(e=e.split(":"),n.port=e.pop(),n.hostname=e.join(":")):(n.hostname=e,n.port="");break;case"protocol":n.protocol=e.toLowerCase(),n.slashes=!t;break;case"pathname":case"hash":if(e){var i=r==="pathname"?"/":"#";n[r]=e.charAt(0)!==i?i+e:e}else n[r]=e;break;case"username":case"password":n[r]=encodeURIComponent(e);break;case"auth":var o=e.indexOf(":");~o?(n.username=e.slice(0,o),n.username=encodeURIComponent(decodeURIComponent(n.username)),n.password=e.slice(o+1),n.password=encodeURIComponent(decodeURIComponent(n.password))):n.username=encodeURIComponent(decodeURIComponent(e))}for(var s=0;s<uW.length;s++){var a=uW[s];a[4]&&(n[a[1]]=n[a[1]].toLowerCase())}return n.auth=n.password?n.username+":"+n.password:n.username,n.origin=n.protocol!=="file:"&&Vc(n.protocol)&&n.host?n.protocol+"//"+n.host:"null",n.href=n.toString(),n}function ahe(r){(!r||typeof r!="function")&&(r=B0.stringify);var e,t=this,n=t.host,i=t.protocol;i&&i.charAt(i.length-1)!==":"&&(i+=":");var o=i+(t.protocol&&t.slashes||Vc(t.protocol)?"//":"");return t.username?(o+=t.username,t.password&&(o+=":"+t.password),o+="@"):t.password?(o+=":"+t.password,o+="@"):t.protocol!=="file:"&&Vc(t.protocol)&&!n&&t.pathname!=="/"&&(o+="@"),(n[n.length-1]===":"||ZG.test(t.hostname)&&!t.port)&&(n+=":"),o+=n+t.pathname,e=typeof t.query=="object"?r(t.query):t.query,e&&(o+=e.charAt(0)!=="?"?"?"+e:e),t.hash&&(o+=t.hash),o}jc.prototype={set:she,toString:ahe};jc.extractProtocol=tY;jc.location=eY;jc.trimLeft=dW;jc.qs=B0;rY.exports=jc});var mW=z(Rh=>{"use strict";u();var lhe=Rh&&Rh.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Rh,"__esModule",{value:!0});Rh.URLExt=void 0;var che=j0(),fW=lhe(pW()),uhe;(function(r){function e(c){if(typeof document!="undefined"&&document){let d=document.createElement("a");return d.href=c,d}return fW.default(c)}r.parse=e;function t(c){return fW.default(c).hostname}r.getHostName=t;function n(c){return c&&e(c).toString()}r.normalize=n;function i(...c){let d=fW.default(c[0],{}),p=`${d.protocol}${d.slashes?"//":""}${d.auth}${d.auth?"@":""}${d.host}`,f=che.posix.join(`${p&&d.pathname[0]!=="/"?"/":""}${d.pathname}`,...c.slice(1));return`${p}${f==="."?"":f}`}r.join=i;function o(c){return i(...c.split("/").map(encodeURIComponent))}r.encodeParts=o;function s(c){let d=Object.keys(c).filter(p=>p.length>0);return d.length?"?"+d.map(p=>{let f=encodeURIComponent(String(c[p]));return p+(f?"="+f:"")}).join("&"):""}r.objectToQueryString=s;function a(c){return c.replace(/^\?/,"").split("&").reduce((d,p)=>{let[f,m]=p.split("=");return f.length>0&&(d[f]=decodeURIComponent(m||"")),d},{})}r.queryStringToObject=a;function l(c){let{protocol:d}=e(c);return(!d||c.toLowerCase().indexOf(d)!==0)&&c.indexOf("/")!==0}r.isLocal=l})(uhe=Rh.URLExt||(Rh.URLExt={}))});var nY=z((exports,module)=>{"use strict";u();var __importDefault=exports&&exports.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(exports,"__esModule",{value:!0});exports.PageConfig=void 0;var coreutils_1=Ml(),minimist_1=__importDefault(jG()),url_1=mW(),PageConfig;(function(PageConfig){function getOption(name){if(configData)return configData[name]||getBodyData(name);configData=Object.create(null);let found=!1;if(typeof document!="undefined"&&document){let r=document.getElementById("jupyter-config-data");r&&(configData=JSON.parse(r.textContent||""),found=!0)}if(!found&&typeof process!="undefined"&&process.argv)try{let cli=minimist_1.default(process.argv.slice(2)),path=j0(),fullPath="";"jupyter-config-data"in cli?fullPath=path.resolve(cli["jupyter-config-data"]):"JUPYTER_CONFIG_DATA"in process.env&&(fullPath=path.resolve(process.env.JUPYTER_CONFIG_DATA)),fullPath&&(configData=eval("require")(fullPath))}catch(r){console.error(r)}if(!coreutils_1.JSONExt.isObject(configData))configData=Object.create(null);else for(let r in configData)typeof configData[r]!="string"&&(configData[r]=JSON.stringify(configData[r]));return configData[name]||getBodyData(name)}PageConfig.getOption=getOption;function setOption(r,e){let t=getOption(r);return configData[r]=e,t}PageConfig.setOption=setOption;function getBaseUrl(){return url_1.URLExt.normalize(getOption("baseUrl")||"/")}PageConfig.getBaseUrl=getBaseUrl;function getTreeUrl(){return url_1.URLExt.join(getBaseUrl(),getOption("treeUrl"))}PageConfig.getTreeUrl=getTreeUrl;function getShareUrl(){return url_1.URLExt.normalize(getOption("shareUrl")||getBaseUrl())}PageConfig.getShareUrl=getShareUrl;function getTreeShareUrl(){return url_1.URLExt.normalize(url_1.URLExt.join(getShareUrl(),getOption("treeUrl")))}PageConfig.getTreeShareUrl=getTreeShareUrl;function getUrl(r){var e,t,n;let i=getOption("baseUrl")||"/",o=(e=r.mode)!==null&&e!==void 0?e:getOption("mode"),s=(t=r.workspace)!==null&&t!==void 0?t:getOption("workspace"),a=o==="multiple-document"?"lab":"doc";i=url_1.URLExt.join(i,a),s!==PageConfig.defaultWorkspace&&(i=url_1.URLExt.join(i,"workspaces",encodeURIComponent(getOption("workspace"))));let l=(n=r.treePath)!==null&&n!==void 0?n:getOption("treePath");return l&&(i=url_1.URLExt.join(i,"tree",url_1.URLExt.encodeParts(l))),i}PageConfig.getUrl=getUrl,PageConfig.defaultWorkspace="default";function getWsUrl(r){let e=getOption("wsUrl");if(!e){if(r=r?url_1.URLExt.normalize(r):getBaseUrl(),r.indexOf("http")!==0)return"";e="ws"+r.slice(4)}return url_1.URLExt.normalize(e)}PageConfig.getWsUrl=getWsUrl;function getNBConvertURL({path:r,format:e,download:t}){let n=url_1.URLExt.encodeParts(r),i=url_1.URLExt.join(getBaseUrl(),"nbconvert",e,n);return t?i+"?download=true":i}PageConfig.getNBConvertURL=getNBConvertURL;function getToken(){return getOption("token")||getBodyData("jupyterApiToken")}PageConfig.getToken=getToken;function getNotebookVersion(){let r=getOption("notebookVersion");return r===""?[0,0,0]:JSON.parse(r)}PageConfig.getNotebookVersion=getNotebookVersion;let configData=null;function getBodyData(r){if(typeof document=="undefined"||!document.body)return"";let e=document.body.dataset[r];return typeof e=="undefined"?"":decodeURIComponent(e)}let Extension;(function(r){function e(i){try{let o=getOption(i);if(o)return JSON.parse(o)}catch(o){console.warn(`Unable to parse ${i}.`,o)}return[]}r.deferred=e("deferredExtensions"),r.disabled=e("disabledExtensions");function t(i){let o=i.indexOf(":"),s="";return o!==-1&&(s=i.slice(0,o)),r.deferred.some(a=>a===i||s&&a===s)}r.isDeferred=t;function n(i){let o=i.indexOf(":"),s="";return o!==-1&&(s=i.slice(0,o)),r.disabled.some(a=>a===i||s&&a===s)}r.isDisabled=n})(Extension=PageConfig.Extension||(PageConfig.Extension={}))})(PageConfig=exports.PageConfig||(exports.PageConfig={}))});var iY=z(px=>{"use strict";u();Object.defineProperty(px,"__esModule",{value:!0});px.PathExt=void 0;var Ah=j0(),dhe;(function(r){function e(...d){let p=Ah.posix.join(...d);return p==="."?"":c(p)}r.join=e;function t(d,p){return Ah.posix.basename(d,p)}r.basename=t;function n(d){let p=c(Ah.posix.dirname(d));return p==="."?"":p}r.dirname=n;function i(d){return Ah.posix.extname(d)}r.extname=i;function o(d){return d===""?"":c(Ah.posix.normalize(d))}r.normalize=o;function s(...d){return c(Ah.posix.resolve(...d))}r.resolve=s;function a(d,p){return c(Ah.posix.relative(d,p))}r.relative=a;function l(d){return d.length>0&&d.indexOf(".")!==0&&(d=`.${d}`),d}r.normalizeExtension=l;function c(d){return d.indexOf("/")===0&&(d=d.slice(1)),d}r.removeSlash=c})(dhe=px.PathExt||(px.PathExt={}))});var oY=z(fx=>{"use strict";u();Object.defineProperty(fx,"__esModule",{value:!0});fx.Text=void 0;var phe;(function(r){let e=2>1;function t(s,a){if(e)return s;let l=s;for(let c=0;c+1<a.length&&c<s;c++){let d=a.charCodeAt(c);if(d>=55296&&d<=56319){let p=a.charCodeAt(c+1);p>=56320&&p<=57343&&(l--,c++)}}return l}r.jsIndexToCharIndex=t;function n(s,a){if(e)return s;let l=s;for(let c=0;c+1<a.length&&c<l;c++){let d=a.charCodeAt(c);if(d>=55296&&d<=56319){let p=a.charCodeAt(c+1);p>=56320&&p<=57343&&(l++,c++)}}return l}r.charIndexToJsIndex=n;function i(s,a=!1){return s.replace(/^(\w)|[\s-_:]+(\w)/g,function(l,c,d){return d?d.toUpperCase():a?c.toUpperCase():c.toLowerCase()})}r.camelCase=i;function o(s){return(s||"").toLowerCase().split(" ").map(a=>a.charAt(0).toUpperCase()+a.slice(1)).join(" ")}r.titleCase=o})(phe=fx.Text||(fx.Text={}))});var sY={};Nm(sY,{default:()=>fhe});function fhe(r){return{formatNow:()=>{try{return r.toLocaleString()}catch(e){return`${r}`}},format:()=>{try{return r.toLocaleTimeString()}catch(e){return`${r}`}}}}var aY=ee(()=>{"use strict";u()});var lY=z(Mh=>{"use strict";u();var mhe=Mh&&Mh.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Mh,"__esModule",{value:!0});Mh.Time=void 0;var gW=mhe((aY(),qD(sY))),ghe;(function(r){function e(n){gW.default.locale(document.documentElement.lang);let i=gW.default(n).fromNow();return i=i==="a few seconds ago"?"seconds ago":i,i}r.formatHuman=e;function t(n,i="YYYY-MM-DD HH:mm"){return gW.default(n).format(i)}r.format=t})(ghe=Mh.Time||(Mh.Time={}))});var ls=z(as=>{"use strict";u();var hhe=as&&as.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Nf=as&&as.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&hhe(e,r,t)};Object.defineProperty(as,"__esModule",{value:!0});Nf(MG(),as);Nf(LG(),as);Nf(KG(),as);Nf(nY(),as);Nf(iY(),as);Nf(oY(),as);Nf(lY(),as);Nf(mW(),as)});var cY=z(Oh=>{"use strict";u();Object.defineProperty(Oh,"__esModule",{value:!0});Oh.ConfigWithDefaults=Oh.ConfigSection=void 0;var vhe=ls(),mx=oi(),yhe="api/config",bhe;(function(r){function e(t){let n=new hW(t);return n.load().then(()=>n)}r.create=e})(bhe=Oh.ConfigSection||(Oh.ConfigSection={}));var hW=class{constructor(e){var t;this._url="unknown";let n=this.serverSettings=(t=e.serverSettings)!==null&&t!==void 0?t:mx.ServerConnection.makeSettings();this._url=vhe.URLExt.join(n.baseUrl,yhe,encodeURIComponent(e.name))}get data(){return this._data}async load(){let e=await mx.ServerConnection.makeRequest(this._url,{},this.serverSettings);if(e.status!==200)throw await mx.ServerConnection.ResponseError.create(e);this._data=await e.json()}async update(e){this._data=Object.assign(Object.assign({},this._data),e);let t={method:"PATCH",body:JSON.stringify(e)},n=await mx.ServerConnection.makeRequest(this._url,t,this.serverSettings);if(n.status!==200)throw await mx.ServerConnection.ResponseError.create(n);return this._data=await n.json(),this._data}},vW=class{constructor(e){var t,n;this._className="",this._section=e.section,this._defaults=(t=e.defaults)!==null&&t!==void 0?t:{},this._className=(n=e.className)!==null&&n!==void 0?n:""}get(e){let t=this._classData();return e in t?t[e]:this._defaults[e]}set(e,t){let n={};if(n[e]=t,this._className){let i={};return i[this._className]=n,this._section.update(i)}else return this._section.update(n)}_classData(){let e=this._section.data;return this._className&&this._className in e?e[this._className]:e}};Oh.ConfigWithDefaults=vW});var gx=z(H0=>{"use strict";u();Object.defineProperty(H0,"__esModule",{value:!0});H0.validateProperty=void 0;function Ihe(r,e,t,n=[]){if(!r.hasOwnProperty(e))throw Error(`Missing property '${e}'`);let i=r[e];if(t!==void 0){let o=!0;switch(t){case"array":o=Array.isArray(i);break;case"object":o=typeof i!="undefined";break;default:o=typeof i===t}if(!o)throw new Error(`Property '${e}' is not of type '${t}'`);if(n.length>0){let s=!0;switch(t){case"string":case"number":case"boolean":s=n.includes(i);break;default:s=n.findIndex(a=>a===i)>=0;break}if(!s)throw new Error(`Property '${e}' is not one of the valid values ${JSON.stringify(n)}`)}}}H0.validateProperty=Ihe});var uY=z(lI=>{"use strict";u();Object.defineProperty(lI,"__esModule",{value:!0});lI.validateCheckpointModel=lI.validateContentsModel=void 0;var Bc=gx();function She(r){Bc.validateProperty(r,"name","string"),Bc.validateProperty(r,"path","string"),Bc.validateProperty(r,"type","string"),Bc.validateProperty(r,"created","string"),Bc.validateProperty(r,"last_modified","string"),Bc.validateProperty(r,"mimetype","object"),Bc.validateProperty(r,"content","object"),Bc.validateProperty(r,"format","object")}lI.validateContentsModel=She;function _he(r){Bc.validateProperty(r,"id","string"),Bc.validateProperty(r,"last_modified","string")}lI.validateCheckpointModel=_he});var IW=z(No=>{"use strict";u();var Ehe=No&&No.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Che=No&&No.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),whe=No&&No.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Ehe(e,r,t);return Che(e,r),e};Object.defineProperty(No,"__esModule",{value:!0});No.Drive=No.ContentsManager=No.Contents=void 0;var Ms=ls(),xhe=Nh(),J0=Mi(),_n=oi(),kd=whe(uY()),Dhe="api/contents",Phe="files",The;(function(r){function e(n){kd.validateContentsModel(n)}r.validateContentsModel=e;function t(n){kd.validateCheckpointModel(n)}r.validateCheckpointModel=t})(The=No.Contents||(No.Contents={}));var yW=class{constructor(e={}){var t,n;this._isDisposed=!1,this._additionalDrives=new Map,this._fileChanged=new J0.Signal(this);let i=this.serverSettings=(t=e.serverSettings)!==null&&t!==void 0?t:_n.ServerConnection.makeSettings();this._defaultDrive=(n=e.defaultDrive)!==null&&n!==void 0?n:new q0({serverSettings:i}),this._defaultDrive.fileChanged.connect(this._onFileChanged,this)}get fileChanged(){return this._fileChanged}get isDisposed(){return this._isDisposed}dispose(){this.isDisposed||(this._isDisposed=!0,J0.Signal.clearData(this))}addDrive(e){this._additionalDrives.set(e.name,e),e.fileChanged.connect(this._onFileChanged,this)}getModelDBFactory(e){var t;let[n]=this._driveForPath(e);return(t=n==null?void 0:n.modelDBFactory)!==null&&t!==void 0?t:null}localPath(e){let t=e.split("/"),n=t[0].split(":");return n.length===1||!this._additionalDrives.has(n[0])?Ms.PathExt.removeSlash(e):Ms.PathExt.join(n.slice(1).join(":"),...t.slice(1))}normalize(e){let t=e.split(":");return t.length===1?Ms.PathExt.normalize(e):`${t[0]}:${Ms.PathExt.normalize(t.slice(1).join(":"))}`}resolvePath(e,t){let n=this.driveName(e),i=this.localPath(e),o=Ms.PathExt.resolve("/",i,t);return n?`${n}:${o}`:o}driveName(e){let n=e.split("/")[0].split(":");return n.length===1?"":this._additionalDrives.has(n[0])?n[0]:""}get(e,t){let[n,i]=this._driveForPath(e);return n.get(i,t).then(o=>{let s=[];return o.type==="directory"&&o.content?(xhe.each(o.content,a=>{s.push(Object.assign(Object.assign({},a),{path:this._toGlobalPath(n,a.path)}))}),Object.assign(Object.assign({},o),{path:this._toGlobalPath(n,i),content:s})):Object.assign(Object.assign({},o),{path:this._toGlobalPath(n,i)})})}getDownloadUrl(e){let[t,n]=this._driveForPath(e);return t.getDownloadUrl(n)}newUntitled(e={}){if(e.path){let t=this.normalize(e.path),[n,i]=this._driveForPath(t);return n.newUntitled(Object.assign(Object.assign({},e),{path:i})).then(o=>Object.assign(Object.assign({},o),{path:Ms.PathExt.join(t,o.name)}))}else return this._defaultDrive.newUntitled(e)}delete(e){let[t,n]=this._driveForPath(e);return t.delete(n)}rename(e,t){let[n,i]=this._driveForPath(e),[o,s]=this._driveForPath(t);if(n!==o)throw Error("ContentsManager: renaming files must occur within a Drive");return n.rename(i,s).then(a=>Object.assign(Object.assign({},a),{path:this._toGlobalPath(n,s)}))}save(e,t={}){let n=this.normalize(e),[i,o]=this._driveForPath(e);return i.save(o,Object.assign(Object.assign({},t),{path:o})).then(s=>Object.assign(Object.assign({},s),{path:n}))}copy(e,t){let[n,i]=this._driveForPath(e),[o,s]=this._driveForPath(t);if(n===o)return n.copy(i,s).then(a=>Object.assign(Object.assign({},a),{path:this._toGlobalPath(n,a.path)}));throw Error("Copying files between drives is not currently implemented")}createCheckpoint(e){let[t,n]=this._driveForPath(e);return t.createCheckpoint(n)}listCheckpoints(e){let[t,n]=this._driveForPath(e);return t.listCheckpoints(n)}restoreCheckpoint(e,t){let[n,i]=this._driveForPath(e);return n.restoreCheckpoint(i,t)}deleteCheckpoint(e,t){let[n,i]=this._driveForPath(e);return n.deleteCheckpoint(i,t)}_toGlobalPath(e,t){return e===this._defaultDrive?Ms.PathExt.removeSlash(t):`${e.name}:${Ms.PathExt.removeSlash(t)}`}_driveForPath(e){let t=this.driveName(e),n=this.localPath(e);return t?[this._additionalDrives.get(t),n]:[this._defaultDrive,n]}_onFileChanged(e,t){var n,i;if(e===this._defaultDrive)this._fileChanged.emit(t);else{let o=null,s=null;!((n=t.newValue)===null||n===void 0)&&n.path&&(o=Object.assign(Object.assign({},t.newValue),{path:this._toGlobalPath(e,t.newValue.path)})),!((i=t.oldValue)===null||i===void 0)&&i.path&&(s=Object.assign(Object.assign({},t.oldValue),{path:this._toGlobalPath(e,t.oldValue.path)})),this._fileChanged.emit({type:t.type,newValue:o,oldValue:s})}}};No.ContentsManager=yW;var q0=class{constructor(e={}){var t,n,i;this._isDisposed=!1,this._fileChanged=new J0.Signal(this),this.name=(t=e.name)!==null&&t!==void 0?t:"Default",this._apiEndpoint=(n=e.apiEndpoint)!==null&&n!==void 0?n:Dhe,this.serverSettings=(i=e.serverSettings)!==null&&i!==void 0?i:_n.ServerConnection.makeSettings()}get fileChanged(){return this._fileChanged}get isDisposed(){return this._isDisposed}dispose(){this.isDisposed||(this._isDisposed=!0,J0.Signal.clearData(this))}async get(e,t){let n=this._getUrl(e);if(t){t.type==="notebook"&&delete t.format;let a=t.content?"1":"0",l=Object.assign(Object.assign({},t),{content:a});n+=Ms.URLExt.objectToQueryString(l)}let i=this.serverSettings,o=await _n.ServerConnection.makeRequest(n,{},i);if(o.status!==200)throw await _n.ServerConnection.ResponseError.create(o);let s=await o.json();return kd.validateContentsModel(s),s}getDownloadUrl(e){let t=this.serverSettings.baseUrl,n=Ms.URLExt.join(t,Phe,Ms.URLExt.encodeParts(e)),i=document.cookie.match("\\b_xsrf=([^;]*)\\b");if(i){let o=new URL(n);o.searchParams.append("_xsrf",i[1]),n=o.toString()}return Promise.resolve(n)}async newUntitled(e={}){var t;let n="{}";e&&(e.ext&&(e.ext=bW.normalizeExtension(e.ext)),n=JSON.stringify(e));let i=this.serverSettings,o=this._getUrl((t=e.path)!==null&&t!==void 0?t:""),s={method:"POST",body:n},a=await _n.ServerConnection.makeRequest(o,s,i);if(a.status!==201)throw await _n.ServerConnection.ResponseError.create(a);let l=await a.json();return kd.validateContentsModel(l),this._fileChanged.emit({type:"new",oldValue:null,newValue:l}),l}async delete(e){let t=this._getUrl(e),n=this.serverSettings,i={method:"DELETE"},o=await _n.ServerConnection.makeRequest(t,i,n);if(o.status!==204)throw await _n.ServerConnection.ResponseError.create(o);this._fileChanged.emit({type:"delete",oldValue:{path:e},newValue:null})}async rename(e,t){let n=this.serverSettings,i=this._getUrl(e),o={method:"PATCH",body:JSON.stringify({path:t})},s=await _n.ServerConnection.makeRequest(i,o,n);if(s.status!==200)throw await _n.ServerConnection.ResponseError.create(s);let a=await s.json();return kd.validateContentsModel(a),this._fileChanged.emit({type:"rename",oldValue:{path:e},newValue:a}),a}async save(e,t={}){let n=this.serverSettings,i=this._getUrl(e),o={method:"PUT",body:JSON.stringify(t)},s=await _n.ServerConnection.makeRequest(i,o,n);if(s.status!==200&&s.status!==201)throw await _n.ServerConnection.ResponseError.create(s);let a=await s.json();return kd.validateContentsModel(a),this._fileChanged.emit({type:"save",oldValue:null,newValue:a}),a}async copy(e,t){let n=this.serverSettings,i=this._getUrl(t),o={method:"POST",body:JSON.stringify({copy_from:e})},s=await _n.ServerConnection.makeRequest(i,o,n);if(s.status!==201)throw await _n.ServerConnection.ResponseError.create(s);let a=await s.json();return kd.validateContentsModel(a),this._fileChanged.emit({type:"new",oldValue:null,newValue:a}),a}async createCheckpoint(e){let t=this._getUrl(e,"checkpoints"),n={method:"POST"},i=await _n.ServerConnection.makeRequest(t,n,this.serverSettings);if(i.status!==201)throw await _n.ServerConnection.ResponseError.create(i);let o=await i.json();return kd.validateCheckpointModel(o),o}async listCheckpoints(e){let t=this._getUrl(e,"checkpoints"),n=await _n.ServerConnection.makeRequest(t,{},this.serverSettings);if(n.status!==200)throw await _n.ServerConnection.ResponseError.create(n);let i=await n.json();if(!Array.isArray(i))throw new Error("Invalid Checkpoint list");for(let o=0;o<i.length;o++)kd.validateCheckpointModel(i[o]);return i}async restoreCheckpoint(e,t){let n=this._getUrl(e,"checkpoints",t),i={method:"POST"},o=await _n.ServerConnection.makeRequest(n,i,this.serverSettings);if(o.status!==204)throw await _n.ServerConnection.ResponseError.create(o)}async deleteCheckpoint(e,t){let n=this._getUrl(e,"checkpoints",t),i={method:"DELETE"},o=await _n.ServerConnection.makeRequest(n,i,this.serverSettings);if(o.status!==204)throw await _n.ServerConnection.ResponseError.create(o)}_getUrl(...e){let t=e.map(i=>Ms.URLExt.encodeParts(i)),n=this.serverSettings.baseUrl;return Ms.URLExt.join(n,this._apiEndpoint,...t)}};No.Drive=q0;var bW;(function(r){function e(t){return t.length>0&&t.indexOf(".")!==0&&(t=`.${t}`),t}r.normalizeExtension=e})(bW||(bW={}))});var pY=z(dY=>{"use strict";u();Object.defineProperty(dY,"__esModule",{value:!0})});var hx=z(At=>{"use strict";u();Object.defineProperty(At,"__esModule",{value:!0});At.isInputReplyMsg=At.isInputRequestMsg=At.isDebugReplyMsg=At.isDebugRequestMsg=At.isExecuteReplyMsg=At.isInfoRequestMsg=At.isCommMsgMsg=At.isCommCloseMsg=At.isCommOpenMsg=At.isDebugEventMsg=At.isClearOutputMsg=At.isStatusMsg=At.isErrorMsg=At.isExecuteResultMsg=At.isExecuteInputMsg=At.isUpdateDisplayDataMsg=At.isDisplayDataMsg=At.isStreamMsg=At.createMessage=void 0;var khe=Ml();function Nhe(r){var e,t,n,i,o;return{buffers:(e=r.buffers)!==null&&e!==void 0?e:[],channel:r.channel,content:r.content,header:{date:new Date().toISOString(),msg_id:(t=r.msgId)!==null&&t!==void 0?t:khe.UUID.uuid4(),msg_type:r.msgType,session:r.session,username:(n=r.username)!==null&&n!==void 0?n:"",version:"5.2"},metadata:(i=r.metadata)!==null&&i!==void 0?i:{},parent_header:(o=r.parentHeader)!==null&&o!==void 0?o:{}}}At.createMessage=Nhe;function Rhe(r){return r.header.msg_type==="stream"}At.isStreamMsg=Rhe;function Ahe(r){return r.header.msg_type==="display_data"}At.isDisplayDataMsg=Ahe;function Mhe(r){return r.header.msg_type==="update_display_data"}At.isUpdateDisplayDataMsg=Mhe;function Ohe(r){return r.header.msg_type==="execute_input"}At.isExecuteInputMsg=Ohe;function Lhe(r){return r.header.msg_type==="execute_result"}At.isExecuteResultMsg=Lhe;function Khe(r){return r.header.msg_type==="error"}At.isErrorMsg=Khe;function Fhe(r){return r.header.msg_type==="status"}At.isStatusMsg=Fhe;function Uhe(r){return r.header.msg_type==="clear_output"}At.isClearOutputMsg=Uhe;function Whe(r){return r.header.msg_type==="debug_event"}At.isDebugEventMsg=Whe;function Vhe(r){return r.header.msg_type==="comm_open"}At.isCommOpenMsg=Vhe;function jhe(r){return r.header.msg_type==="comm_close"}At.isCommCloseMsg=jhe;function Bhe(r){return r.header.msg_type==="comm_msg"}At.isCommMsgMsg=Bhe;function Hhe(r){return r.header.msg_type==="kernel_info_request"}At.isInfoRequestMsg=Hhe;function Jhe(r){return r.header.msg_type==="execute_reply"}At.isExecuteReplyMsg=Jhe;function qhe(r){return r.header.msg_type==="debug_request"}At.isDebugRequestMsg=qhe;function Ghe(r){return r.header.msg_type==="debug_reply"}At.isDebugReplyMsg=Ghe;function Yhe(r){return r.header.msg_type==="input_request"}At.isInputRequestMsg=Yhe;function $he(r){return r.header.msg_type==="input_reply"}At.isInputReplyMsg=$he});var fY=z(()=>{u()});var mY=z(SW=>{"use strict";u();Object.defineProperty(SW,"__esModule",{value:!0});SW.default=WebSocket});var Os=z(Rf=>{"use strict";u();var _W,EW,CW;Object.defineProperty(Rf,"__esModule",{value:!0});Rf.ServerConnection=void 0;var Lh=ls(),wW,xW,DW,PW;if(typeof window=="undefined"){let r=fY();wW=(_W=Rf.fetch)!==null&&_W!==void 0?_W:r,DW=(EW=Rf.Request)!==null&&EW!==void 0?EW:r.Request,xW=(CW=Rf.Headers)!==null&&CW!==void 0?CW:r.Headers,PW=mY()}else wW=fetch,DW=Request,xW=Headers,PW=WebSocket;var gY;(function(r){function e(o){return G0.makeSettings(o)}r.makeSettings=e;function t(o,s,a){return G0.handleRequest(o,s,a)}r.makeRequest=t;class n extends Error{constructor(s,a=`Invalid response: ${s.status} ${s.statusText}`,l=""){super(a),this.response=s,this.traceback=l}static async create(s){try{let a=await s.json();return a.traceback&&console.error(a.traceback),a.message?new n(s,a.message):new n(s)}catch(a){return console.debug(a),new n(s)}}}r.ResponseError=n;class i extends TypeError{constructor(s){super(s.message),this.stack=s.stack}}r.NetworkError=i})(gY=Rf.ServerConnection||(Rf.ServerConnection={}));var G0;(function(r){function e(i={}){let o=Lh.PageConfig.getBaseUrl(),s=Lh.PageConfig.getWsUrl(),a=Lh.URLExt.normalize(i.baseUrl)||o,l=i.wsUrl;return!l&&a===o&&(l=s),!l&&a.indexOf("http")===0&&(l="ws"+a.slice(4)),l=l!=null?l:s,Object.assign(Object.assign({init:{cache:"no-store",credentials:"same-origin"},fetch:wW,Headers:xW,Request:DW,WebSocket:PW,token:Lh.PageConfig.getToken(),appUrl:Lh.PageConfig.getOption("appUrl"),appendToken:typeof window=="undefined"||process.env.JEST_WORKER_ID!==void 0||Lh.URLExt.getHostName(o)!==Lh.URLExt.getHostName(l)},i),{baseUrl:a,wsUrl:l})}r.makeSettings=e;function t(i,o,s){var a;if(i.indexOf(s.baseUrl)!==0)throw new Error("Can only be used for notebook server requests");((a=o.cache)!==null&&a!==void 0?a:s.init.cache)==="no-store"&&(i+=(/\?/.test(i)?"&":"?")+new Date().getTime());let c=new s.Request(i,Object.assign(Object.assign({},s.init),o)),d=!1;if(s.token&&(d=!0,c.headers.append("Authorization",`token ${s.token}`)),typeof document!="undefined"&&(document!=null&&document.cookie)){let p=n("_xsrf");p!==void 0&&(d=!0,c.headers.append("X-XSRFToken",p))}return!c.headers.has("Content-Type")&&d&&c.headers.set("Content-Type","application/json"),s.fetch.call(null,c).catch(p=>{throw new gY.NetworkError(p)})}r.handleRequest=t;function n(i){let o=document.cookie.match("\\b"+i+"=([^;]*)\\b");return o==null?void 0:o[1]}})(G0||(G0={}))});var Y0=z(Af=>{"use strict";u();Object.defineProperty(Af,"__esModule",{value:!0});Af.validateModels=Af.validateModel=Af.validateMessage=void 0;var Kh=gx(),hY=["username","version","session","msg_id","msg_type"],zhe={stream:{name:"string",text:"string"},display_data:{data:"object",metadata:"object"},execute_input:{code:"string",execution_count:"number"},execute_result:{execution_count:"number",data:"object",metadata:"object"},error:{ename:"string",evalue:"string",traceback:"object"},status:{execution_state:["string",["starting","idle","busy","restarting","dead"]]},clear_output:{wait:"boolean"},comm_open:{comm_id:"string",target_name:"string",data:"object"},comm_msg:{comm_id:"string",data:"object"},comm_close:{comm_id:"string"},shutdown_reply:{restart:"boolean"}};function Qhe(r){for(let e=0;e<hY.length;e++)Kh.validateProperty(r,hY[e],"string")}function Xhe(r){Kh.validateProperty(r,"metadata","object"),Kh.validateProperty(r,"content","object"),Kh.validateProperty(r,"channel","string"),Qhe(r.header),r.channel==="iopub"&&Zhe(r)}Af.validateMessage=Xhe;function Zhe(r){if(r.channel==="iopub"){let e=zhe[r.header.msg_type];if(e===void 0)return;let t=Object.keys(e),n=r.content;for(let i=0;i<t.length;i++){let o=e[t[i]];Array.isArray(o)||(o=[o]),Kh.validateProperty(n,t[i],...o)}}}function vY(r){Kh.validateProperty(r,"name","string"),Kh.validateProperty(r,"id","string")}Af.validateModel=vY;function eve(r){if(!Array.isArray(r))throw new Error("Invalid kernel list");r.forEach(e=>vY(e))}Af.validateModels=eve});var z0=z(En=>{"use strict";u();Object.defineProperty(En,"__esModule",{value:!0});En.getKernelModel=En.shutdownKernel=En.interruptKernel=En.restartKernel=En.startNew=En.listRunning=En.KERNEL_SERVICE_URL=void 0;var Si=Os(),cI=ls(),$0=Y0();En.KERNEL_SERVICE_URL="api/kernels";async function tve(r=Si.ServerConnection.makeSettings()){let e=cI.URLExt.join(r.baseUrl,En.KERNEL_SERVICE_URL),t=await Si.ServerConnection.makeRequest(e,{},r);if(t.status!==200)throw await Si.ServerConnection.ResponseError.create(t);let n=await t.json();return $0.validateModels(n),n}En.listRunning=tve;async function rve(r={},e=Si.ServerConnection.makeSettings()){let t=cI.URLExt.join(e.baseUrl,En.KERNEL_SERVICE_URL),n={method:"POST",body:JSON.stringify(r)},i=await Si.ServerConnection.makeRequest(t,n,e);if(i.status!==201)throw await Si.ServerConnection.ResponseError.create(i);let o=await i.json();return $0.validateModel(o),o}En.startNew=rve;async function nve(r,e=Si.ServerConnection.makeSettings()){let t=cI.URLExt.join(e.baseUrl,En.KERNEL_SERVICE_URL,encodeURIComponent(r),"restart"),n={method:"POST"},i=await Si.ServerConnection.makeRequest(t,n,e);if(i.status!==200)throw await Si.ServerConnection.ResponseError.create(i);let o=await i.json();$0.validateModel(o)}En.restartKernel=nve;async function ive(r,e=Si.ServerConnection.makeSettings()){let t=cI.URLExt.join(e.baseUrl,En.KERNEL_SERVICE_URL,encodeURIComponent(r),"interrupt"),n={method:"POST"},i=await Si.ServerConnection.makeRequest(t,n,e);if(i.status!==204)throw await Si.ServerConnection.ResponseError.create(i)}En.interruptKernel=ive;async function ove(r,e=Si.ServerConnection.makeSettings()){let t=cI.URLExt.join(e.baseUrl,En.KERNEL_SERVICE_URL,encodeURIComponent(r)),n={method:"DELETE"},i=await Si.ServerConnection.makeRequest(t,n,e);if(i.status===404){let o=`The kernel "${r}" does not exist on the server`;console.warn(o)}else if(i.status!==204)throw await Si.ServerConnection.ResponseError.create(i)}En.shutdownKernel=ove;async function sve(r,e=Si.ServerConnection.makeSettings()){let t=cI.URLExt.join(e.baseUrl,En.KERNEL_SERVICE_URL,encodeURIComponent(r)),n=await Si.ServerConnection.makeRequest(t,{},e);if(n.status===404)return;if(n.status!==200)throw await Si.ServerConnection.ResponseError.create(n);let i=await n.json();return $0.validateModel(i),i}En.getKernelModel=sve});var vx=z((Q0,yY)=>{u();(function(r,e){typeof Q0=="object"&&typeof yY!="undefined"?e(Q0,Ml(),Mi()):typeof define=="function"&&define.amd?define(["exports","@lumino/coreutils","@lumino/signaling"],e):(r=typeof globalThis!="undefined"?globalThis:r||self,e(r.lumino_polling={},r.lumino_coreutils,r.lumino_signaling))})(Q0,function(r,e,t){"use strict";var n=function(g,h){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(v,S){v.__proto__=S}||function(v,S){for(var _ in S)Object.prototype.hasOwnProperty.call(S,_)&&(v[_]=S[_])},n(g,h)};function i(g,h){if(typeof h!="function"&&h!==null)throw new TypeError("Class extends value "+String(h)+" is not a constructor or null");n(g,h);function v(){this.constructor=g}g.prototype=h===null?Object.create(h):(v.prototype=h.prototype,new v)}var o=function(){return o=Object.assign||function(h){for(var v,S=1,_=arguments.length;S<_;S++){v=arguments[S];for(var D in v)Object.prototype.hasOwnProperty.call(v,D)&&(h[D]=v[D])}return h},o.apply(this,arguments)};function s(g,h,v,S){function _(D){return D instanceof v?D:new v(function(P){P(D)})}return new(v||(v=Promise))(function(D,P){function M(j){try{A(S.next(j))}catch(re){P(re)}}function x(j){try{A(S.throw(j))}catch(re){P(re)}}function A(j){j.done?D(j.value):_(j.value).then(M,x)}A((S=S.apply(g,h||[])).next())})}function a(g,h){var v={label:0,sent:function(){if(D[0]&1)throw D[1];return D[1]},trys:[],ops:[]},S,_,D,P;return P={next:M(0),throw:M(1),return:M(2)},typeof Symbol=="function"&&(P[Symbol.iterator]=function(){return this}),P;function M(A){return function(j){return x([A,j])}}function x(A){if(S)throw new TypeError("Generator is already executing.");for(;v;)try{if(S=1,_&&(D=A[0]&2?_.return:A[0]?_.throw||((D=_.return)&&D.call(_),0):_.next)&&!(D=D.call(_,A[1])).done)return D;switch(_=0,D&&(A=[A[0]&2,D.value]),A[0]){case 0:case 1:D=A;break;case 4:return v.label++,{value:A[1],done:!1};case 5:v.label++,_=A[1],A=[0];continue;case 7:A=v.ops.pop(),v.trys.pop();continue;default:if(D=v.trys,!(D=D.length>0&&D[D.length-1])&&(A[0]===6||A[0]===2)){v=0;continue}if(A[0]===3&&(!D||A[1]>D[0]&&A[1]<D[3])){v.label=A[1];break}if(A[0]===6&&v.label<D[1]){v.label=D[1],D=A;break}if(D&&v.label<D[2]){v.label=D[2],v.ops.push(A);break}D[2]&&v.ops.pop(),v.trys.pop();continue}A=h.call(g,v)}catch(j){A=[6,j],_=0}finally{S=D=0}if(A[0]&5)throw A[1];return{value:A[0]?A[1]:void 0,done:!0}}}var l=typeof requestAnimationFrame=="function"?requestAnimationFrame:setImmediate,c=typeof cancelAnimationFrame=="function"?cancelAnimationFrame:clearImmediate;r.Poll=function(){function g(h){var v=this;this._disposed=new t.Signal(this),this._tick=new e.PromiseDelegate,this._ticked=new t.Signal(this),this._timeout=-1,this._factory=h.factory,this._standby=h.standby||d.DEFAULT_STANDBY,this._state=o(o({},d.DEFAULT_STATE),{timestamp:new Date().getTime()});var S=h.frequency||{},_=Math.max(S.interval||0,S.max||0,d.DEFAULT_FREQUENCY.max);this.frequency=o(o(o({},d.DEFAULT_FREQUENCY),S),{max:_}),this.name=h.name||d.DEFAULT_NAME,(!("auto"in h)||h.auto)&&l(function(){return void v.start()})}return Object.defineProperty(g.prototype,"disposed",{get:function(){return this._disposed},enumerable:!0,configurable:!0}),Object.defineProperty(g.prototype,"frequency",{get:function(){return this._frequency},set:function(h){if(!(this.isDisposed||e.JSONExt.deepEqual(h,this.frequency||{}))){var v=h.backoff,S=h.interval,_=h.max;if(S=Math.round(S),_=Math.round(_),typeof v=="number"&&v<1)throw new Error("Poll backoff growth factor must be at least 1");if((S<0||S>_)&&S!==g.NEVER)throw new Error("Poll interval must be between 0 and max");if(_>g.MAX_INTERVAL&&_!==g.NEVER)throw new Error("Max interval must be less than "+g.MAX_INTERVAL);this._frequency={backoff:v,interval:S,max:_}}},enumerable:!0,configurable:!0}),Object.defineProperty(g.prototype,"isDisposed",{get:function(){return this.state.phase==="disposed"},enumerable:!0,configurable:!0}),Object.defineProperty(g.prototype,"standby",{get:function(){return this._standby},set:function(h){this.isDisposed||this.standby===h||(this._standby=h)},enumerable:!0,configurable:!0}),Object.defineProperty(g.prototype,"state",{get:function(){return this._state},enumerable:!0,configurable:!0}),Object.defineProperty(g.prototype,"tick",{get:function(){return this._tick.promise},enumerable:!0,configurable:!0}),Object.defineProperty(g.prototype,"ticked",{get:function(){return this._ticked},enumerable:!0,configurable:!0}),g.prototype.dispose=function(){this.isDisposed||(this._state=o(o({},d.DISPOSED_STATE),{timestamp:new Date().getTime()}),this._tick.promise.catch(function(h){}),this._tick.reject(new Error("Poll ("+this.name+") is disposed.")),this._disposed.emit(void 0),t.Signal.clearData(this))},g.prototype.refresh=function(){return this.schedule({cancel:function(h){var v=h.phase;return v==="refreshed"},interval:g.IMMEDIATE,phase:"refreshed"})},g.prototype.schedule=function(h){return h===void 0&&(h={}),s(this,void 0,void 0,function(){var v,S,_,D,P,M=this;return a(this,function(x){switch(x.label){case 0:return this.isDisposed?[2]:h.cancel&&h.cancel(this.state)?[2]:(v=this.state,S=this._tick,_=new e.PromiseDelegate,D=o({interval:this.frequency.interval,payload:null,phase:"standby",timestamp:new Date().getTime()},h),this._state=D,this._tick=_,v.interval===g.IMMEDIATE?c(this._timeout):clearTimeout(this._timeout),this._ticked.emit(this.state),S.resolve(this),[4,S.promise]);case 1:return x.sent(),P=function(){M.isDisposed||M.tick!==_.promise||M._execute()},this._timeout=D.interval===g.IMMEDIATE?l(P):D.interval===g.NEVER?-1:setTimeout(P,D.interval),[2]}})})},g.prototype.start=function(){return this.schedule({cancel:function(h){var v=h.phase;return v!=="constructed"&&v!=="standby"&&v!=="stopped"},interval:g.IMMEDIATE,phase:"started"})},g.prototype.stop=function(){return this.schedule({cancel:function(h){var v=h.phase;return v==="stopped"},interval:g.NEVER,phase:"stopped"})},g.prototype._execute=function(){var h=this,v=typeof this.standby=="function"?this.standby():this.standby;if(v=v==="never"?!1:v==="when-hidden"?!!(typeof document!="undefined"&&document&&document.hidden):v,v){this.schedule();return}var S=this.tick;this._factory(this.state).then(function(_){h.isDisposed||h.tick!==S||h.schedule({payload:_,phase:h.state.phase==="rejected"?"reconnected":"resolved"})}).catch(function(_){h.isDisposed||h.tick!==S||h.schedule({interval:d.sleep(h.frequency,h.state),payload:_,phase:"rejected"})})},g}(),function(g){g.IMMEDIATE=0,g.MAX_INTERVAL=2147483647,g.NEVER=1/0}(r.Poll||(r.Poll={}));var d;(function(g){g.DEFAULT_BACKOFF=3,g.DEFAULT_FREQUENCY={backoff:!0,interval:1e3,max:30*1e3},g.DEFAULT_NAME="unknown",g.DEFAULT_STANDBY="when-hidden",g.DEFAULT_STATE={interval:r.Poll.NEVER,payload:null,phase:"constructed",timestamp:new Date(0).getTime()},g.DISPOSED_STATE={interval:r.Poll.NEVER,payload:null,phase:"disposed",timestamp:new Date(0).getTime()};function h(S,_){return S=Math.ceil(S),_=Math.floor(_),Math.floor(Math.random()*(_-S+1))+S}function v(S,_){var D=S.backoff,P=S.interval,M=S.max;if(P===r.Poll.NEVER)return P;var x=D===!0?g.DEFAULT_BACKOFF:D===!1?1:D,A=h(P,_.interval*x);return Math.min(M,A)}g.sleep=v})(d||(d={}));var p=function(){function g(h,v){var S=this;v===void 0&&(v=500),this.payload=null,this.limit=v,this.poll=new r.Poll({auto:!1,factory:function(){return s(S,void 0,void 0,function(){return a(this,function(_){switch(_.label){case 0:return[4,h()];case 1:return[2,_.sent()]}})})},frequency:{backoff:!1,interval:r.Poll.NEVER,max:r.Poll.NEVER},standby:"never"}),this.payload=new e.PromiseDelegate,this.poll.ticked.connect(function(_,D){var P=S.payload;if(D.phase==="resolved"){S.payload=new e.PromiseDelegate,P.resolve(D.payload);return}if(D.phase==="rejected"||D.phase==="stopped"){S.payload=new e.PromiseDelegate,P.promise.catch(function(M){}),P.reject(D.payload);return}},this)}return Object.defineProperty(g.prototype,"isDisposed",{get:function(){return this.payload===null},enumerable:!0,configurable:!0}),g.prototype.dispose=function(){this.isDisposed||(this.payload=null,this.poll.dispose())},g.prototype.stop=function(){return s(this,void 0,void 0,function(){return a(this,function(h){return[2,this.poll.stop()]})})},g}(),f=function(g){i(h,g);function h(){return g!==null&&g.apply(this,arguments)||this}return h.prototype.invoke=function(){return this.poll.schedule({interval:this.limit,phase:"invoked"}),this.payload.promise},h}(p),m=function(g){i(h,g);function h(v,S){var _=g.call(this,v,typeof S=="number"?S:S&&S.limit)||this,D="leading";return typeof S!="number"&&(S=S||{},D="edge"in S?S.edge:D),_._interval=D==="trailing"?_.limit:r.Poll.IMMEDIATE,_}return h.prototype.invoke=function(){return this.poll.state.phase!=="invoked"&&this.poll.schedule({interval:this._interval,phase:"invoked"}),this.payload.promise},h}(p);r.Debouncer=f,r.RateLimiter=p,r.Throttler=m,Object.defineProperty(r,"__esModule",{value:!0})})});var yx=z(X0=>{"use strict";u();Object.defineProperty(X0,"__esModule",{value:!0});X0.BaseManager=void 0;var bY=Mi(),ave=Os(),TW=class{constructor(e){var t;this._isDisposed=!1,this._disposed=new bY.Signal(this),this.serverSettings=(t=e.serverSettings)!==null&&t!==void 0?t:ave.ServerConnection.makeSettings()}get disposed(){return this._disposed}get isDisposed(){return this._isDisposed}dispose(){this.isDisposed||(this._disposed.emit(void 0),bY.Signal.clearData(this))}};X0.BaseManager=TW});var kW=z((Z0,IY)=>{u();(function(r,e){typeof Z0=="object"&&typeof IY!="undefined"?e(Z0,Nh(),Mi()):typeof define=="function"&&define.amd?define(["exports","@lumino/algorithm","@lumino/signaling"],e):(r=typeof globalThis!="undefined"?globalThis:r||self,e(r.lumino_disposable={},r.lumino_algorithm,r.lumino_signaling))})(Z0,function(r,e,t){"use strict";var n=function(a,l){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,d){c.__proto__=d}||function(c,d){for(var p in d)Object.prototype.hasOwnProperty.call(d,p)&&(c[p]=d[p])},n(a,l)};function i(a,l){if(typeof l!="function"&&l!==null)throw new TypeError("Class extends value "+String(l)+" is not a constructor or null");n(a,l);function c(){this.constructor=a}a.prototype=l===null?Object.create(l):(c.prototype=l.prototype,new c)}var o=function(){function a(l){this._fn=l}return Object.defineProperty(a.prototype,"isDisposed",{get:function(){return!this._fn},enumerable:!0,configurable:!0}),a.prototype.dispose=function(){if(this._fn){var l=this._fn;this._fn=null,l()}},a}(),s=function(a){i(l,a);function l(){var c=a!==null&&a.apply(this,arguments)||this;return c._disposed=new t.Signal(c),c}return Object.defineProperty(l.prototype,"disposed",{get:function(){return this._disposed},enumerable:!0,configurable:!0}),l.prototype.dispose=function(){this.isDisposed||(a.prototype.dispose.call(this),this._disposed.emit(void 0),t.Signal.clearData(this))},l}(o);r.DisposableSet=function(){function a(){this._isDisposed=!1,this._items=new Set}return Object.defineProperty(a.prototype,"isDisposed",{get:function(){return this._isDisposed},enumerable:!0,configurable:!0}),a.prototype.dispose=function(){this._isDisposed||(this._isDisposed=!0,this._items.forEach(function(l){l.dispose()}),this._items.clear())},a.prototype.contains=function(l){return this._items.has(l)},a.prototype.add=function(l){this._items.add(l)},a.prototype.remove=function(l){this._items.delete(l)},a.prototype.clear=function(){this._items.clear()},a}(),function(a){function l(c){var d=new a;return e.each(c,function(p){d.add(p)}),d}a.from=l}(r.DisposableSet||(r.DisposableSet={})),r.ObservableDisposableSet=function(a){i(l,a);function l(){var c=a!==null&&a.apply(this,arguments)||this;return c._disposed=new t.Signal(c),c}return Object.defineProperty(l.prototype,"disposed",{get:function(){return this._disposed},enumerable:!0,configurable:!0}),l.prototype.dispose=function(){this.isDisposed||(a.prototype.dispose.call(this),this._disposed.emit(void 0),t.Signal.clearData(this))},l}(r.DisposableSet),function(a){function l(c){var d=new a;return e.each(c,function(p){d.add(p)}),d}a.from=l}(r.ObservableDisposableSet||(r.ObservableDisposableSet={})),r.DisposableDelegate=o,r.ObservableDisposableDelegate=s,Object.defineProperty(r,"__esModule",{value:!0})})});var SY=z(Hc=>{"use strict";u();var lve=Hc&&Hc.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),cve=Hc&&Hc.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),uve=Hc&&Hc.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&lve(e,r,t);return cve(e,r),e};Object.defineProperty(Hc,"__esModule",{value:!0});Hc.CommHandler=void 0;var dve=kW(),eR=uve(hx()),NW=class extends dve.DisposableDelegate{constructor(e,t,n,i){super(i),this._target="",this._id="",this._id=t,this._target=e,this._kernel=n}get commId(){return this._id}get targetName(){return this._target}get onClose(){return this._onClose}set onClose(e){this._onClose=e}get onMsg(){return this._onMsg}set onMsg(e){this._onMsg=e}open(e,t,n=[]){if(this.isDisposed||this._kernel.isDisposed)throw new Error("Cannot open");let i=eR.createMessage({msgType:"comm_open",channel:"shell",username:this._kernel.username,session:this._kernel.clientId,content:{comm_id:this._id,target_name:this._target,data:e!=null?e:{}},metadata:t,buffers:n});return this._kernel.sendShellMessage(i,!1,!0)}send(e,t,n=[],i=!0){if(this.isDisposed||this._kernel.isDisposed)throw new Error("Cannot send");let o=eR.createMessage({msgType:"comm_msg",channel:"shell",username:this._kernel.username,session:this._kernel.clientId,content:{comm_id:this._id,data:e},metadata:t,buffers:n});return this._kernel.sendShellMessage(o,!1,i)}close(e,t,n=[]){if(this.isDisposed||this._kernel.isDisposed)throw new Error("Cannot close");let i=eR.createMessage({msgType:"comm_close",channel:"shell",username:this._kernel.username,session:this._kernel.clientId,content:{comm_id:this._id,data:e!=null?e:{}},metadata:t,buffers:n}),o=this._kernel.sendShellMessage(i,!1,!0),s=this._onClose;if(s){let a=eR.createMessage({msgType:"comm_close",channel:"iopub",username:this._kernel.username,session:this._kernel.clientId,content:{comm_id:this._id,data:e!=null?e:{}},metadata:t,buffers:n});s(a)}return this.dispose(),o}};Hc.CommHandler=NW});var EY=z(cs=>{"use strict";u();var pve=cs&&cs.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),fve=cs&&cs.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),mve=cs&&cs.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&pve(e,r,t);return fve(e,r),e};Object.defineProperty(cs,"__esModule",{value:!0});cs.KernelShellFutureHandler=cs.KernelControlFutureHandler=cs.KernelFutureHandler=void 0;var _Y=Ml(),gve=kW(),hve=mve(hx()),bx=class extends gve.DisposableDelegate{constructor(e,t,n,i,o){super(e),this._status=0,this._stdin=Oi.noOp,this._iopub=Oi.noOp,this._reply=Oi.noOp,this._done=new _Y.PromiseDelegate,this._hooks=new Oi.HookList,this._disposeOnDone=!0,this._msg=t,n||this._setFlag(Oi.KernelFutureFlag.GotReply),this._disposeOnDone=i,this._kernel=o}get msg(){return this._msg}get done(){return this._done.promise}get onReply(){return this._reply}set onReply(e){this._reply=e}get onIOPub(){return this._iopub}set onIOPub(e){this._iopub=e}get onStdin(){return this._stdin}set onStdin(e){this._stdin=e}registerMessageHook(e){if(this.isDisposed)throw new Error("Kernel future is disposed");this._hooks.add(e)}removeMessageHook(e){this.isDisposed||this._hooks.remove(e)}sendInputReply(e){this._kernel.sendInputReply(e)}dispose(){this._stdin=Oi.noOp,this._iopub=Oi.noOp,this._reply=Oi.noOp,this._hooks=null,this._testFlag(Oi.KernelFutureFlag.IsDone)||(this._done.promise.catch(()=>{}),this._done.reject(new Error(`Canceled future for ${this.msg.header.msg_type} message before replies were done`))),super.dispose()}async handleMsg(e){switch(e.channel){case"control":case"shell":e.channel===this.msg.channel&&e.parent_header.msg_id===this.msg.header.msg_id&&await this._handleReply(e);break;case"stdin":await this._handleStdin(e);break;case"iopub":await this._handleIOPub(e);break;default:break}}async _handleReply(e){let t=this._reply;t&&await t(e),this._replyMsg=e,this._setFlag(Oi.KernelFutureFlag.GotReply),this._testFlag(Oi.KernelFutureFlag.GotIdle)&&this._handleDone()}async _handleStdin(e){let t=this._stdin;t&&await t(e)}async _handleIOPub(e){let t=await this._hooks.process(e),n=this._iopub;t&&n&&await n(e),hve.isStatusMsg(e)&&e.content.execution_state==="idle"&&(this._setFlag(Oi.KernelFutureFlag.GotIdle),this._testFlag(Oi.KernelFutureFlag.GotReply)&&this._handleDone())}_handleDone(){this._testFlag(Oi.KernelFutureFlag.IsDone)||(this._setFlag(Oi.KernelFutureFlag.IsDone),this._done.resolve(this._replyMsg),this._disposeOnDone&&this.dispose())}_testFlag(e){return(this._status&e)!==0}_setFlag(e){this._status|=e}};cs.KernelFutureHandler=bx;var RW=class extends bx{};cs.KernelControlFutureHandler=RW;var AW=class extends bx{};cs.KernelShellFutureHandler=AW;var Oi;(function(r){r.noOp=()=>{};let e=(()=>typeof requestAnimationFrame=="function"?requestAnimationFrame:setImmediate)();class t{constructor(){this._hooks=[]}add(o){this.remove(o),this._hooks.push(o)}remove(o){let s=this._hooks.indexOf(o);s>=0&&(this._hooks[s]=null,this._scheduleCompact())}async process(o){await this._processing;let s=new _Y.PromiseDelegate;this._processing=s.promise;let a;for(let l=this._hooks.length-1;l>=0;l--){let c=this._hooks[l];if(c!==null){try{a=await c(o)}catch(d){a=!0,console.error(d)}if(a===!1)return s.resolve(void 0),!1}}return s.resolve(void 0),!0}_scheduleCompact(){this._compactScheduled||(this._compactScheduled=!0,e(()=>{this._processing=this._processing.then(()=>{this._compactScheduled=!1,this._compact()})}))}_compact(){let o=0;for(let s=0,a=this._hooks.length;s<a;s++){let l=this._hooks[s];this._hooks[s]===null?o++:this._hooks[s-o]=l}this._hooks.length-=o}}r.HookList=t;let n;(function(i){i[i.GotReply=1]="GotReply",i[i.GotIdle=2]="GotIdle",i[i.IsDone=4]="IsDone",i[i.DisposeOnDone=8]="DisposeOnDone"})(n=r.KernelFutureFlag||(r.KernelFutureFlag={}))})(Oi||(Oi={}))});var MW=z(uI=>{"use strict";u();Object.defineProperty(uI,"__esModule",{value:!0});uI.serialize=uI.deserialize=void 0;function vve(r){let e;return typeof r=="string"?e=JSON.parse(r):e=bve(r),e}uI.deserialize=vve;function yve(r){var e;let t;return!((e=r.buffers)===null||e===void 0)&&e.length?t=Ive(r):t=JSON.stringify(r),t}uI.serialize=yve;function bve(r){let e=new DataView(r),t=e.getUint32(0),n=[];if(t<2)throw new Error("Invalid incoming Kernel Message");for(let s=1;s<=t;s++)n.push(e.getUint32(s*4));let i=new Uint8Array(r.slice(n[0],n[1])),o=JSON.parse(new TextDecoder("utf8").decode(i));o.buffers=[];for(let s=1;s<t;s++){let a=n[s],l=n[s+1]||r.byteLength;o.buffers.push(new DataView(r.slice(a,l)))}return o}function Ive(r){let e=[],t=[],n=new TextEncoder,i=[];r.buffers!==void 0&&(i=r.buffers,delete r.buffers);let o=n.encode(JSON.stringify(r));t.push(o.buffer);for(let c=0;c<i.length;c++){let d=i[c];t.push(ArrayBuffer.isView(d)?d.buffer:d)}let s=t.length;e.push(4*(s+1));for(let c=0;c+1<t.length;c++)e.push(e[e.length-1]+t[c].byteLength);let a=new Uint8Array(e[e.length-1]+t[t.length-1].byteLength),l=new DataView(a.buffer);l.setUint32(0,s);for(let c=0;c<e.length;c++)l.setUint32(4*(c+1),e[c]);for(let c=0;c<t.length;c++)a.set(new Uint8Array(t[c]),e[c]);return a.buffer}});var wY=z(CY=>{"use strict";u();Object.defineProperty(CY,"__esModule",{value:!0})});var DY=z(dI=>{"use strict";u();Object.defineProperty(dI,"__esModule",{value:!0});dI.validateSpecModels=dI.validateSpecModel=void 0;var Fh=gx();function xY(r){let e=r.spec;if(!e)throw new Error("Invalid kernel spec");Fh.validateProperty(r,"name","string"),Fh.validateProperty(r,"resources","object"),Fh.validateProperty(e,"language","string"),Fh.validateProperty(e,"display_name","string"),Fh.validateProperty(e,"argv","array");let t=null;e.hasOwnProperty("metadata")&&(Fh.validateProperty(e,"metadata","object"),t=e.metadata);let n=null;return e.hasOwnProperty("env")&&(Fh.validateProperty(e,"env","object"),n=e.env),{name:r.name,resources:r.resources,language:e.language,display_name:e.display_name,argv:e.argv,metadata:t,env:n}}dI.validateSpecModel=xY;function Sve(r){if(!r.hasOwnProperty("kernelspecs"))throw new Error("No kernelspecs found");let e=Object.keys(r.kernelspecs),t=Object.create(null),n=r.default;for(let i=0;i<e.length;i++){let o=r.kernelspecs[e[i]];try{t[e[i]]=xY(o)}catch(s){console.warn(`Removing errant kernel spec: ${e[i]}`)}}if(e=Object.keys(t),!e.length)throw new Error("No valid kernelspecs found");return(!n||typeof n!="string"||!(n in t))&&(n=e[0],console.warn(`Default kernel not found, using '${e[0]}'`)),{default:n,kernelspecs:t}}dI.validateSpecModels=Sve});var LW=z(tR=>{"use strict";u();Object.defineProperty(tR,"__esModule",{value:!0});tR.getSpecs=void 0;var OW=Os(),_ve=DY(),Eve=ls(),Cve="api/kernelspecs";async function wve(r=OW.ServerConnection.makeSettings()){let e=Eve.URLExt.join(r.baseUrl,Cve),t=await OW.ServerConnection.makeRequest(e,{},r);if(t.status!==200)throw await OW.ServerConnection.ResponseError.create(t);let n=await t.json();return _ve.validateSpecModels(n)}tR.getSpecs=wve});var TY=z(Jc=>{"use strict";u();var xve=Jc&&Jc.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Dve=Jc&&Jc.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Pve=Jc&&Jc.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&xve(e,r,t);return Dve(e,r),e};Object.defineProperty(Jc,"__esModule",{value:!0});Jc.KernelSpecManager=void 0;var Tve=Ml(),kve=vx(),PY=Mi(),Nve=Pve(LW()),Rve=yx(),KW=class extends Rve.BaseManager{constructor(e={}){var t;super(e),this._isReady=!1,this._connectionFailure=new PY.Signal(this),this._specs=null,this._specsChanged=new PY.Signal(this),this._ready=Promise.all([this.requestSpecs()]).then(n=>{}).catch(n=>{}).then(()=>{this.isDisposed||(this._isReady=!0)}),this._pollSpecs=new kve.Poll({auto:!1,factory:()=>this.requestSpecs(),frequency:{interval:61*1e3,backoff:!0,max:300*1e3},name:"@jupyterlab/services:KernelSpecManager#specs",standby:(t=e.standby)!==null&&t!==void 0?t:"when-hidden"}),this.ready.then(()=>{this._pollSpecs.start()})}get isReady(){return this._isReady}get ready(){return this._ready}get specs(){return this._specs}get specsChanged(){return this._specsChanged}get connectionFailure(){return this._connectionFailure}dispose(){this._pollSpecs.dispose(),super.dispose()}async refreshSpecs(){await this._pollSpecs.refresh(),await this._pollSpecs.tick}async requestSpecs(){let e=await Nve.getSpecs(this.serverSettings);this.isDisposed||Tve.JSONExt.deepEqual(e,this._specs)||(this._specs=e,this._specsChanged.emit(e))}};Jc.KernelSpecManager=KW});var rR=z(Ro=>{"use strict";u();var kY=Ro&&Ro.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Ave=Ro&&Ro.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),NY=Ro&&Ro.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&kY(e,r,t);return Ave(e,r),e},Mve=Ro&&Ro.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&kY(e,r,t)};Object.defineProperty(Ro,"__esModule",{value:!0});Ro.KernelSpecAPI=Ro.KernelSpec=void 0;var Ove=NY(wY());Ro.KernelSpec=Ove;var Lve=NY(LW());Ro.KernelSpecAPI=Lve;Mve(TY(),Ro)});var OY=z(qc=>{"use strict";u();var Kve=qc&&qc.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Fve=qc&&qc.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),iR=qc&&qc.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Kve(e,r,t);return Fve(e,r),e};Object.defineProperty(qc,"__esModule",{value:!0});qc.KernelConnection=void 0;var RY=ls(),Mf=Ml(),Uh=Mi(),Uve=oi(),AY=SY(),Ls=iR(hx()),MY=EY(),FW=iR(MW()),Wve=iR(Y0()),Vve=rR(),nR=iR(z0()),jve=3e3,pI="_RESTARTING_",Bve="",UW=class r{constructor(e){var t,n,i,o;this._createSocket=()=>{this._errorIfDisposed(),this._clearSocket(),this._updateConnectionStatus("connecting");let s=this.serverSettings,a=RY.URLExt.join(s.wsUrl,nR.KERNEL_SERVICE_URL,encodeURIComponent(this._id)),l=a.replace(/^((?:\w+:)?\/\/)(?:[^@\/]+@)/,"$1"),c=RY.URLExt.join(a,"channels?session_id="+encodeURIComponent(this._clientId)),d=s.token;s.appendToken&&d!==""&&(c=c+`&token=${encodeURIComponent(d)}`),this._ws=new s.WebSocket(c),this._ws.binaryType="arraybuffer",this._ws.onmessage=this._onWSMessage,this._ws.onopen=this._onWSOpen,this._ws.onclose=this._onWSClose,this._ws.onerror=this._onWSClose},this._onWSOpen=s=>{this._updateConnectionStatus("connected")},this._onWSMessage=s=>{let a;try{a=FW.deserialize(s.data),Wve.validateMessage(a)}catch(l){throw l.message=`Kernel message validation error: ${l.message}`,l}this._kernelSession=a.header.session,this._msgChain=this._msgChain.then(()=>this._handleMessage(a)).catch(l=>{l.message.startsWith("Canceled future for ")&&console.error(l)}),this._anyMessage.emit({msg:a,direction:"recv"})},this._onWSClose=s=>{this.isDisposed||this._reconnect()},this._id="",this._name="",this._status="unknown",this._connectionStatus="connecting",this._kernelSession="",this._isDisposed=!1,this._ws=null,this._username="",this._reconnectLimit=7,this._reconnectAttempt=0,this._reconnectTimeout=null,this._futures=new Map,this._comms=new Map,this._targetRegistry=Object.create(null),this._info=new Mf.PromiseDelegate,this._pendingMessages=[],this._statusChanged=new Uh.Signal(this),this._connectionStatusChanged=new Uh.Signal(this),this._disposed=new Uh.Signal(this),this._iopubMessage=new Uh.Signal(this),this._anyMessage=new Uh.Signal(this),this._unhandledMessage=new Uh.Signal(this),this._displayIdToParentIds=new Map,this._msgIdToDisplayIds=new Map,this._msgChain=Promise.resolve(),this._noOp=()=>{},this._name=e.model.name,this._id=e.model.id,this.serverSettings=(t=e.serverSettings)!==null&&t!==void 0?t:Uve.ServerConnection.makeSettings(),this._clientId=(n=e.clientId)!==null&&n!==void 0?n:Mf.UUID.uuid4(),this._username=(i=e.username)!==null&&i!==void 0?i:"",this.handleComms=(o=e.handleComms)!==null&&o!==void 0?o:!0,this._createSocket()}get disposed(){return this._disposed}get statusChanged(){return this._statusChanged}get connectionStatusChanged(){return this._connectionStatusChanged}get iopubMessage(){return this._iopubMessage}get unhandledMessage(){return this._unhandledMessage}get model(){return{id:this.id,name:this.name}}get anyMessage(){return this._anyMessage}get id(){return this._id}get name(){return this._name}get username(){return this._username}get clientId(){return this._clientId}get status(){return this._status}get connectionStatus(){return this._connectionStatus}get isDisposed(){return this._isDisposed}get info(){return this._info.promise}get spec(){return this._specPromise?this._specPromise:(this._specPromise=Vve.KernelSpecAPI.getSpecs(this.serverSettings).then(e=>e.kernelspecs[this._name]),this._specPromise)}clone(e={}){return new r(Object.assign({model:this.model,username:this.username,serverSettings:this.serverSettings,handleComms:!1},e))}dispose(){this.isDisposed||(this._isDisposed=!0,this._disposed.emit(),this._updateConnectionStatus("disconnected"),this._clearKernelState(),this._pendingMessages=[],this._clearSocket(),Uh.Signal.clearData(this))}sendShellMessage(e,t=!1,n=!0){return this._sendKernelShellControl(MY.KernelShellFutureHandler,e,t,n)}sendControlMessage(e,t=!1,n=!0){return this._sendKernelShellControl(MY.KernelControlFutureHandler,e,t,n)}_sendKernelShellControl(e,t,n=!1,i=!0){this._sendMessage(t),this._anyMessage.emit({msg:t,direction:"send"});let o=new e(()=>{let s=t.header.msg_id;this._futures.delete(s);let a=this._msgIdToDisplayIds.get(s);a&&(a.forEach(l=>{let c=this._displayIdToParentIds.get(l);if(c){let d=c.indexOf(s);if(d===-1)return;c.length===1?this._displayIdToParentIds.delete(l):(c.splice(d,1),this._displayIdToParentIds.set(l,c))}}),this._msgIdToDisplayIds.delete(s))},t,n,i,this);return this._futures.set(t.header.msg_id,o),o}_sendMessage(e,t=!0){if(this.status==="dead")throw new Error("Kernel is dead");if((this._kernelSession===Bve||this._kernelSession===pI)&&Ls.isInfoRequestMsg(e))if(this.connectionStatus==="connected"){this._ws.send(FW.serialize(e));return}else throw new Error("Could not send message: status is not connected");if(t&&this._pendingMessages.length>0){this._pendingMessages.push(e);return}if(this.connectionStatus==="connected"&&this._kernelSession!==pI)this._ws.send(FW.serialize(e));else if(t)this._pendingMessages.push(e);else throw new Error("Could not send message")}async interrupt(){if(this.status==="dead")throw new Error("Kernel is dead");return nR.interruptKernel(this.id,this.serverSettings)}async restart(){if(this.status==="dead")throw new Error("Kernel is dead");this._updateStatus("restarting"),this._clearKernelState(),this._kernelSession=pI,await nR.restartKernel(this.id,this.serverSettings),await this.reconnect()}reconnect(){this._errorIfDisposed();let e=new Mf.PromiseDelegate,t=(n,i)=>{i==="connected"?(e.resolve(),this.connectionStatusChanged.disconnect(t,this)):i==="disconnected"&&(e.reject(new Error("Kernel connection disconnected")),this.connectionStatusChanged.disconnect(t,this))};return this.connectionStatusChanged.connect(t,this),this._reconnectAttempt=0,this._reconnect(),e.promise}async shutdown(){this.status!=="dead"&&await nR.shutdownKernel(this.id,this.serverSettings),this.handleShutdown()}handleShutdown(){this._updateStatus("dead"),this.dispose()}async requestKernelInfo(){let e=Ls.createMessage({msgType:"kernel_info_request",channel:"shell",username:this._username,session:this._clientId,content:{}}),t;try{t=await Ol.handleShellMessage(this,e)}catch(n){if(this.isDisposed)return;throw n}if(this._errorIfDisposed(),!!t)return t.content.status===void 0&&(t.content.status="ok"),t.content.status!=="ok"?(this._info.reject("Kernel info reply errored"),t):(this._info.resolve(t.content),this._kernelSession=t.header.session,t)}requestComplete(e){let t=Ls.createMessage({msgType:"complete_request",channel:"shell",username:this._username,session:this._clientId,content:e});return Ol.handleShellMessage(this,t)}requestInspect(e){let t=Ls.createMessage({msgType:"inspect_request",channel:"shell",username:this._username,session:this._clientId,content:e});return Ol.handleShellMessage(this,t)}requestHistory(e){let t=Ls.createMessage({msgType:"history_request",channel:"shell",username:this._username,session:this._clientId,content:e});return Ol.handleShellMessage(this,t)}requestExecute(e,t=!0,n){let i={silent:!1,store_history:!0,user_expressions:{},allow_stdin:!0,stop_on_error:!1},o=Ls.createMessage({msgType:"execute_request",channel:"shell",username:this._username,session:this._clientId,content:Object.assign(Object.assign({},i),e),metadata:n});return this.sendShellMessage(o,!0,t)}requestDebug(e,t=!0){let n=Ls.createMessage({msgType:"debug_request",channel:"control",username:this._username,session:this._clientId,content:e});return this.sendControlMessage(n,!0,t)}requestIsComplete(e){let t=Ls.createMessage({msgType:"is_complete_request",channel:"shell",username:this._username,session:this._clientId,content:e});return Ol.handleShellMessage(this,t)}requestCommInfo(e){let t=Ls.createMessage({msgType:"comm_info_request",channel:"shell",username:this._username,session:this._clientId,content:e});return Ol.handleShellMessage(this,t)}sendInputReply(e){let t=Ls.createMessage({msgType:"input_reply",channel:"stdin",username:this._username,session:this._clientId,content:e});this._sendMessage(t),this._anyMessage.emit({msg:t,direction:"send"})}createComm(e,t=Mf.UUID.uuid4()){if(!this.handleComms)throw new Error("Comms are disabled on this kernel connection");if(this._comms.has(t))throw new Error("Comm is already created");let n=new AY.CommHandler(e,t,this,()=>{this._unregisterComm(t)});return this._comms.set(t,n),n}hasComm(e){return this._comms.has(e)}registerCommTarget(e,t){this.handleComms&&(this._targetRegistry[e]=t)}removeCommTarget(e,t){this.handleComms&&!this.isDisposed&&this._targetRegistry[e]===t&&delete this._targetRegistry[e]}registerMessageHook(e,t){var n;let i=(n=this._futures)===null||n===void 0?void 0:n.get(e);i&&i.registerMessageHook(t)}removeMessageHook(e,t){var n;let i=(n=this._futures)===null||n===void 0?void 0:n.get(e);i&&i.removeMessageHook(t)}async _handleDisplayId(e,t){var n,i;let o=t.parent_header.msg_id,s=this._displayIdToParentIds.get(e);if(s){let l={header:Mf.JSONExt.deepCopy(t.header),parent_header:Mf.JSONExt.deepCopy(t.parent_header),metadata:Mf.JSONExt.deepCopy(t.metadata),content:Mf.JSONExt.deepCopy(t.content),channel:t.channel,buffers:t.buffers?t.buffers.slice():[]};l.header.msg_type="update_display_data",await Promise.all(s.map(async c=>{let d=this._futures&&this._futures.get(c);d&&await d.handleMsg(l)}))}if(t.header.msg_type==="update_display_data")return!0;s=(n=this._displayIdToParentIds.get(e))!==null&&n!==void 0?n:[],s.indexOf(o)===-1&&s.push(o),this._displayIdToParentIds.set(e,s);let a=(i=this._msgIdToDisplayIds.get(o))!==null&&i!==void 0?i:[];return a.indexOf(o)===-1&&a.push(o),this._msgIdToDisplayIds.set(o,a),!1}_clearSocket(){this._ws!==null&&(this._ws.onopen=this._noOp,this._ws.onclose=this._noOp,this._ws.onerror=this._noOp,this._ws.onmessage=this._noOp,this._ws.close(),this._ws=null)}_updateStatus(e){this._status===e||this._status==="dead"||(this._status=e,Ol.logKernelStatus(this),this._statusChanged.emit(e),e==="dead"&&this.dispose())}_sendPending(){for(;this.connectionStatus==="connected"&&this._kernelSession!==pI&&this._pendingMessages.length>0;)this._sendMessage(this._pendingMessages[0],!1),this._pendingMessages.shift()}_clearKernelState(){this._kernelSession="",this._pendingMessages=[],this._futures.forEach(e=>{e.dispose()}),this._comms.forEach(e=>{e.dispose()}),this._msgChain=Promise.resolve(),this._futures=new Map,this._comms=new Map,this._displayIdToParentIds.clear(),this._msgIdToDisplayIds.clear()}_assertCurrentMessage(e){if(this._errorIfDisposed(),e.header.session!==this._kernelSession)throw new Error(`Canceling handling of old message: ${e.header.msg_type}`)}async _handleCommOpen(e){this._assertCurrentMessage(e);let t=e.content,n=new AY.CommHandler(t.target_name,t.comm_id,this,()=>{this._unregisterComm(t.comm_id)});this._comms.set(t.comm_id,n);try{await(await Ol.loadObject(t.target_name,t.target_module,this._targetRegistry))(n,e)}catch(i){throw n.close(),console.error("Exception opening new comm"),i}}async _handleCommClose(e){this._assertCurrentMessage(e);let t=e.content,n=this._comms.get(t.comm_id);if(!n){console.error("Comm not found for comm id "+t.comm_id);return}this._unregisterComm(n.commId);let i=n.onClose;i&&await i(e),n.dispose()}async _handleCommMsg(e){this._assertCurrentMessage(e);let t=e.content,n=this._comms.get(t.comm_id);if(!n)return;let i=n.onMsg;i&&await i(e)}_unregisterComm(e){this._comms.delete(e)}_updateConnectionStatus(e){if(this._connectionStatus!==e){if(this._connectionStatus=e,e!=="connecting"&&(this._reconnectAttempt=0,clearTimeout(this._reconnectTimeout)),this.status!=="dead")if(e==="connected"){let t=this._kernelSession===pI,n=this.requestKernelInfo(),i=!1,o=()=>{i||(i=!0,t&&this._kernelSession===pI&&(this._kernelSession=""),clearTimeout(s),this._pendingMessages.length>0&&this._sendPending())};n.then(o);let s=setTimeout(o,jve)}else this._updateStatus("unknown");this._connectionStatusChanged.emit(e)}}async _handleMessage(e){var t,n;let i=!1;if(e.parent_header&&e.channel==="iopub"&&(Ls.isDisplayDataMsg(e)||Ls.isUpdateDisplayDataMsg(e)||Ls.isExecuteResultMsg(e))){let s=((t=e.content.transient)!==null&&t!==void 0?t:{}).display_id;s&&(i=await this._handleDisplayId(s,e),this._assertCurrentMessage(e))}if(!i&&e.parent_header){let o=e.parent_header,s=(n=this._futures)===null||n===void 0?void 0:n.get(o.msg_id);if(s)await s.handleMsg(e),this._assertCurrentMessage(e);else{let a=o.session===this.clientId;e.channel!=="iopub"&&a&&this._unhandledMessage.emit(e)}}if(e.channel==="iopub"){switch(e.header.msg_type){case"status":{let o=e.content.execution_state;o==="restarting"&&Promise.resolve().then(async()=>{this._updateStatus("autorestarting"),this._clearKernelState(),await this.reconnect()}),this._updateStatus(o);break}case"comm_open":this.handleComms&&await this._handleCommOpen(e);break;case"comm_msg":this.handleComms&&await this._handleCommMsg(e);break;case"comm_close":this.handleComms&&await this._handleCommClose(e);break;default:break}this.isDisposed||(this._assertCurrentMessage(e),this._iopubMessage.emit(e))}}_reconnect(){if(this._errorIfDisposed(),clearTimeout(this._reconnectTimeout),this._reconnectAttempt<this._reconnectLimit){this._updateConnectionStatus("connecting");let e=Ol.getRandomIntInclusive(0,1e3*(Math.pow(2,this._reconnectAttempt)-1));console.warn(`Connection lost, reconnecting in ${Math.floor(e/1e3)} seconds.`),this._reconnectTimeout=setTimeout(this._createSocket,e),this._reconnectAttempt+=1}else this._updateConnectionStatus("disconnected");this._clearSocket()}_errorIfDisposed(){if(this.isDisposed)throw new Error("Kernel connection is disposed")}};qc.KernelConnection=UW;var Ol;(function(r){function e(o){switch(o.status){case"idle":case"busy":case"unknown":return;default:console.debug(`Kernel: ${o.status} (${o.id})`);break}}r.logKernelStatus=e;async function t(o,s){return o.sendShellMessage(s,!0).done}r.handleShellMessage=t;function n(o,s,a){return new Promise((l,c)=>{if(s){if(typeof requirejs=="undefined")throw new Error("requirejs not found");requirejs([s],d=>{if(d[o]===void 0){let p=`Object '${o}' not found in module '${s}'`;c(new Error(p))}else l(d[o])},c)}else a!=null&&a[o]?l(a[o]):c(new Error(`Object '${o}' not found in registry`))})}r.loadObject=n;function i(o,s){return o=Math.ceil(o),s=Math.floor(s),Math.floor(Math.random()*(s-o+1))+o}r.getRandomIntInclusive=i})(Ol||(Ol={}))});var FY=z(sR=>{"use strict";u();Object.defineProperty(sR,"__esModule",{value:!0});sR.KernelManager=void 0;var LY=Nh(),Hve=vx(),KY=Mi(),Jve=oi(),qve=yx(),oR=z0(),Gve=OY(),WW=class extends qve.BaseManager{constructor(e={}){var t;super(e),this._isReady=!1,this._kernelConnections=new Set,this._models=new Map,this._runningChanged=new KY.Signal(this),this._connectionFailure=new KY.Signal(this),this._pollModels=new Hve.Poll({auto:!1,factory:()=>this.requestRunning(),frequency:{interval:10*1e3,backoff:!0,max:300*1e3},name:"@jupyterlab/services:KernelManager#models",standby:(t=e.standby)!==null&&t!==void 0?t:"when-hidden"}),this._ready=(async()=>{await this._pollModels.start(),await this._pollModels.tick,this._isReady=!0})()}get isReady(){return this._isReady}get ready(){return this._ready}get runningChanged(){return this._runningChanged}get connectionFailure(){return this._connectionFailure}dispose(){this.isDisposed||(this._models.clear(),this._kernelConnections.forEach(e=>e.dispose()),this._pollModels.dispose(),super.dispose())}connectTo(e){var t;let{id:n}=e.model,i=(t=e.handleComms)!==null&&t!==void 0?t:!0;if(e.handleComms===void 0){for(let s of this._kernelConnections)if(s.id===n&&s.handleComms){i=!1;break}}let o=new Gve.KernelConnection(Object.assign(Object.assign({handleComms:i},e),{serverSettings:this.serverSettings}));return this._onStarted(o),this._models.has(n)||this.refreshRunning().catch(()=>{}),o}running(){return LY.iter([...this._models.values()])}async refreshRunning(){await this._pollModels.refresh(),await this._pollModels.tick}async startNew(e={},t={}){let n=await oR.startNew(e,this.serverSettings);return this.connectTo(Object.assign(Object.assign({},t),{model:n}))}async shutdown(e){await oR.shutdownKernel(e,this.serverSettings),await this.refreshRunning()}async shutdownAll(){await this.refreshRunning(),await Promise.all([...this._models.keys()].map(e=>oR.shutdownKernel(e,this.serverSettings))),await this.refreshRunning()}async findById(e){return this._models.has(e)?this._models.get(e):(await this.refreshRunning(),this._models.get(e))}async requestRunning(){var e,t;let n;try{n=await oR.listRunning(this.serverSettings)}catch(i){throw(i instanceof Jve.ServerConnection.NetworkError||((e=i.response)===null||e===void 0?void 0:e.status)===503||((t=i.response)===null||t===void 0?void 0:t.status)===424)&&this._connectionFailure.emit(i),i}this.isDisposed||this._models.size===n.length&&LY.every(n,i=>{let o=this._models.get(i.id);return o?o.name===i.name:!1})||(this._models=new Map(n.map(i=>[i.id,i])),this._kernelConnections.forEach(i=>{this._models.has(i.id)||i.handleShutdown()}),this._runningChanged.emit(n))}_onStarted(e){this._kernelConnections.add(e),e.statusChanged.connect(this._onStatusChanged,this),e.disposed.connect(this._onDisposed,this)}_onDisposed(e){this._kernelConnections.delete(e),this.refreshRunning().catch(()=>{})}_onStatusChanged(e,t){t==="dead"&&this.refreshRunning().catch(()=>{})}};sR.KernelManager=WW});var jW=z(Li=>{"use strict";u();var UY=Li&&Li.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Yve=Li&&Li.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),VW=Li&&Li.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&UY(e,r,t);return Yve(e,r),e},$ve=Li&&Li.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&UY(e,r,t)};Object.defineProperty(Li,"__esModule",{value:!0});Li.KernelAPI=Li.KernelMessage=Li.Kernel=void 0;var zve=VW(pY());Li.Kernel=zve;var Qve=VW(hx());Li.KernelMessage=Qve;var Xve=VW(z0());Li.KernelAPI=Xve;$ve(FY(),Li)});var WY=z(aR=>{"use strict";u();Object.defineProperty(aR,"__esModule",{value:!0});aR.BuildManager=void 0;var BW=ls(),Of=Os(),Zve="api/build",HW=class{constructor(e={}){var t;this._url="",this.serverSettings=(t=e.serverSettings)!==null&&t!==void 0?t:Of.ServerConnection.makeSettings();let{baseUrl:n,appUrl:i}=this.serverSettings;this._url=BW.URLExt.join(n,i,Zve)}get isAvailable(){return BW.PageConfig.getOption("buildAvailable").toLowerCase()==="true"}get shouldCheck(){return BW.PageConfig.getOption("buildCheck").toLowerCase()==="true"}getStatus(){let{_url:e,serverSettings:t}=this;return Of.ServerConnection.makeRequest(e,{},t).then(i=>{if(i.status!==200)throw new Of.ServerConnection.ResponseError(i);return i.json()}).then(i=>{if(typeof i.status!="string")throw new Error("Invalid data");if(typeof i.message!="string")throw new Error("Invalid data");return i})}build(){let{_url:e,serverSettings:t}=this,n={method:"POST"};return Of.ServerConnection.makeRequest(e,n,t).then(o=>{if(o.status===400)throw new Of.ServerConnection.ResponseError(o,"Build aborted");if(o.status!==200){let s=`Build failed with ${o.status}, please run 'jupyter lab build' on the server for full output`;throw new Of.ServerConnection.ResponseError(o,s)}})}cancel(){let{_url:e,serverSettings:t}=this,n={method:"DELETE"};return Of.ServerConnection.makeRequest(e,n,t).then(o=>{if(o.status!==204)throw new Of.ServerConnection.ResponseError(o)})}};aR.BuildManager=HW});var GW=z(lR=>{"use strict";u();Object.defineProperty(lR,"__esModule",{value:!0});lR.NbConvertManager=void 0;var eye=ls(),JW=Os(),tye="api/nbconvert",qW=class{constructor(e={}){var t;this.serverSettings=(t=e.serverSettings)!==null&&t!==void 0?t:JW.ServerConnection.makeSettings()}async getExportFormats(){let e=this.serverSettings.baseUrl,t=eye.URLExt.join(e,tye),{serverSettings:n}=this,i=await JW.ServerConnection.makeRequest(t,{},n);if(i.status!==200)throw await JW.ServerConnection.ResponseError.create(i);let o=await i.json(),s={};return Object.keys(o).forEach(function(l){let c=o[l].output_mimetype;s[l]={output_mimetype:c}}),s}};lR.NbConvertManager=qW});var jY=z(VY=>{"use strict";u();Object.defineProperty(VY,"__esModule",{value:!0})});var HY=z(Lf=>{"use strict";u();Object.defineProperty(Lf,"__esModule",{value:!0});Lf.validateModels=Lf.updateLegacySessionModel=Lf.validateModel=void 0;var rye=Y0(),Ix=gx();function BY(r){Ix.validateProperty(r,"id","string"),Ix.validateProperty(r,"type","string"),Ix.validateProperty(r,"name","string"),Ix.validateProperty(r,"path","string"),Ix.validateProperty(r,"kernel","object"),rye.validateModel(r.kernel)}Lf.validateModel=BY;function nye(r){r.path===void 0&&r.notebook!==void 0&&(r.path=r.notebook.path,r.type="notebook",r.name="")}Lf.updateLegacySessionModel=nye;function iye(r){if(!Array.isArray(r))throw new Error("Invalid session list");r.forEach(e=>BY(e))}Lf.validateModels=iye});var uR=z(si=>{"use strict";u();Object.defineProperty(si,"__esModule",{value:!0});si.updateSession=si.startSession=si.getSessionModel=si.shutdownSession=si.getSessionUrl=si.listRunning=si.SESSION_SERVICE_URL=void 0;var ao=Os(),YW=ls(),Kf=HY();si.SESSION_SERVICE_URL="api/sessions";async function oye(r=ao.ServerConnection.makeSettings()){let e=YW.URLExt.join(r.baseUrl,si.SESSION_SERVICE_URL),t=await ao.ServerConnection.makeRequest(e,{},r);if(t.status!==200)throw await ao.ServerConnection.ResponseError.create(t);let n=await t.json();if(!Array.isArray(n))throw new Error("Invalid Session list");return n.forEach(i=>{Kf.updateLegacySessionModel(i),Kf.validateModel(i)}),n}si.listRunning=oye;function cR(r,e){return YW.URLExt.join(r,si.SESSION_SERVICE_URL,e)}si.getSessionUrl=cR;async function sye(r,e=ao.ServerConnection.makeSettings()){var t;let n=cR(e.baseUrl,r),i={method:"DELETE"},o=await ao.ServerConnection.makeRequest(n,i,e);if(o.status===404){let a=(t=(await o.json()).message)!==null&&t!==void 0?t:`The session "${r}"" does not exist on the server`;console.warn(a)}else{if(o.status===410)throw new ao.ServerConnection.ResponseError(o,"The kernel was deleted but the session was not");if(o.status!==204)throw await ao.ServerConnection.ResponseError.create(o)}}si.shutdownSession=sye;async function aye(r,e=ao.ServerConnection.makeSettings()){let t=cR(e.baseUrl,r),n=await ao.ServerConnection.makeRequest(t,{},e);if(n.status!==200)throw await ao.ServerConnection.ResponseError.create(n);let i=await n.json();return Kf.updateLegacySessionModel(i),Kf.validateModel(i),i}si.getSessionModel=aye;async function lye(r,e=ao.ServerConnection.makeSettings()){let t=YW.URLExt.join(e.baseUrl,si.SESSION_SERVICE_URL),n={method:"POST",body:JSON.stringify(r)},i=await ao.ServerConnection.makeRequest(t,n,e);if(i.status!==201)throw await ao.ServerConnection.ResponseError.create(i);let o=await i.json();return Kf.updateLegacySessionModel(o),Kf.validateModel(o),o}si.startSession=lye;async function cye(r,e=ao.ServerConnection.makeSettings()){let t=cR(e.baseUrl,r.id),n={method:"PATCH",body:JSON.stringify(r)},i=await ao.ServerConnection.makeRequest(t,n,e);if(i.status!==200)throw await ao.ServerConnection.ResponseError.create(i);let o=await i.json();return Kf.updateLegacySessionModel(o),Kf.validateModel(o),o}si.updateSession=cye});var qY=z(dR=>{"use strict";u();Object.defineProperty(dR,"__esModule",{value:!0});dR.SessionConnection=void 0;var Nd=Mi(),uye=oi(),JY=uR(),dye=Ml(),$W=class{constructor(e){var t,n,i,o;this._id="",this._path="",this._name="",this._type="",this._kernel=null,this._isDisposed=!1,this._disposed=new Nd.Signal(this),this._kernelChanged=new Nd.Signal(this),this._statusChanged=new Nd.Signal(this),this._connectionStatusChanged=new Nd.Signal(this),this._iopubMessage=new Nd.Signal(this),this._unhandledMessage=new Nd.Signal(this),this._anyMessage=new Nd.Signal(this),this._propertyChanged=new Nd.Signal(this),this._id=e.model.id,this._name=e.model.name,this._path=e.model.path,this._type=e.model.type,this._username=(t=e.username)!==null&&t!==void 0?t:"",this._clientId=(n=e.clientId)!==null&&n!==void 0?n:dye.UUID.uuid4(),this._connectToKernel=e.connectToKernel,this._kernelConnectionOptions=(i=e.kernelConnectionOptions)!==null&&i!==void 0?i:{},this.serverSettings=(o=e.serverSettings)!==null&&o!==void 0?o:uye.ServerConnection.makeSettings(),this.setupKernel(e.model.kernel)}get disposed(){return this._disposed}get kernelChanged(){return this._kernelChanged}get statusChanged(){return this._statusChanged}get connectionStatusChanged(){return this._connectionStatusChanged}get iopubMessage(){return this._iopubMessage}get unhandledMessage(){return this._unhandledMessage}get anyMessage(){return this._anyMessage}get propertyChanged(){return this._propertyChanged}get id(){return this._id}get kernel(){return this._kernel}get path(){return this._path}get type(){return this._type}get name(){return this._name}get model(){return{id:this.id,kernel:this.kernel&&{id:this.kernel.id,name:this.kernel.name},path:this._path,type:this._type,name:this._name}}get isDisposed(){return this._isDisposed}update(e){let t=this.model;if(this._path=e.path,this._name=e.name,this._type=e.type,this._kernel===null&&e.kernel!==null||this._kernel!==null&&e.kernel===null||this._kernel!==null&&e.kernel!==null&&this._kernel.id!==e.kernel.id){this._kernel!==null&&this._kernel.dispose();let n=this._kernel||null;this.setupKernel(e.kernel);let i=this._kernel||null;this._kernelChanged.emit({name:"kernel",oldValue:n,newValue:i})}this._handleModelChange(t)}dispose(){if(!this.isDisposed){if(this._isDisposed=!0,this._disposed.emit(),this._kernel){this._kernel.dispose();let e=this._kernel;this._kernel=null;let t=this._kernel;this._kernelChanged.emit({name:"kernel",oldValue:e,newValue:t})}Nd.Signal.clearData(this)}}async setPath(e){if(this.isDisposed)throw new Error("Session is disposed");await this._patch({path:e})}async setName(e){if(this.isDisposed)throw new Error("Session is disposed");await this._patch({name:e})}async setType(e){if(this.isDisposed)throw new Error("Session is disposed");await this._patch({type:e})}async changeKernel(e){if(this.isDisposed)throw new Error("Session is disposed");return await this._patch({kernel:e}),this.kernel}async shutdown(){if(this.isDisposed)throw new Error("Session is disposed");await JY.shutdownSession(this.id,this.serverSettings),this.dispose()}setupKernel(e){if(e===null){this._kernel=null;return}let t=this._connectToKernel(Object.assign(Object.assign({},this._kernelConnectionOptions),{model:e,username:this._username,clientId:this._clientId,serverSettings:this.serverSettings}));this._kernel=t,t.statusChanged.connect(this.onKernelStatus,this),t.connectionStatusChanged.connect(this.onKernelConnectionStatus,this),t.unhandledMessage.connect(this.onUnhandledMessage,this),t.iopubMessage.connect(this.onIOPubMessage,this),t.anyMessage.connect(this.onAnyMessage,this)}onKernelStatus(e,t){this._statusChanged.emit(t)}onKernelConnectionStatus(e,t){this._connectionStatusChanged.emit(t)}onIOPubMessage(e,t){this._iopubMessage.emit(t)}onUnhandledMessage(e,t){this._unhandledMessage.emit(t)}onAnyMessage(e,t){this._anyMessage.emit(t)}async _patch(e){let t=await JY.updateSession(Object.assign(Object.assign({},e),{id:this._id}),this.serverSettings);return this.update(t),t}_handleModelChange(e){e.name!==this._name&&this._propertyChanged.emit("name"),e.type!==this._type&&this._propertyChanged.emit("type"),e.path!==this._path&&this._propertyChanged.emit("path")}};dR.SessionConnection=$W});var $Y=z(pR=>{"use strict";u();Object.defineProperty(pR,"__esModule",{value:!0});pR.SessionManager=void 0;var GY=Nh(),pye=vx(),YY=Mi(),fye=Os(),mye=yx(),gye=qY(),Sx=uR(),zW=class extends mye.BaseManager{constructor(e){var t;super(e),this._isReady=!1,this._sessionConnections=new Set,this._models=new Map,this._runningChanged=new YY.Signal(this),this._connectionFailure=new YY.Signal(this),this._connectToKernel=n=>this._kernelManager.connectTo(n),this._kernelManager=e.kernelManager,this._pollModels=new pye.Poll({auto:!1,factory:()=>this.requestRunning(),frequency:{interval:10*1e3,backoff:!0,max:300*1e3},name:"@jupyterlab/services:SessionManager#models",standby:(t=e.standby)!==null&&t!==void 0?t:"when-hidden"}),this._ready=(async()=>{await this._pollModels.start(),await this._pollModels.tick,await this._kernelManager.ready,this._isReady=!0})()}get isReady(){return this._isReady}get ready(){return this._ready}get runningChanged(){return this._runningChanged}get connectionFailure(){return this._connectionFailure}dispose(){this.isDisposed||(this._models.clear(),this._sessionConnections.forEach(e=>e.dispose()),this._pollModels.dispose(),super.dispose())}connectTo(e){let t=new gye.SessionConnection(Object.assign(Object.assign({},e),{connectToKernel:this._connectToKernel,serverSettings:this.serverSettings}));return this._onStarted(t),this._models.has(e.model.id)||this.refreshRunning().catch(()=>{}),t}running(){return GY.iter([...this._models.values()])}async refreshRunning(){await this._pollModels.refresh(),await this._pollModels.tick}async startNew(e,t={}){let n=await Sx.startSession(e,this.serverSettings);return await this.refreshRunning(),this.connectTo(Object.assign(Object.assign({},t),{model:n}))}async shutdown(e){await Sx.shutdownSession(e,this.serverSettings),await this.refreshRunning()}async shutdownAll(){await this.refreshRunning(),await Promise.all([...this._models.keys()].map(e=>Sx.shutdownSession(e,this.serverSettings))),await this.refreshRunning()}async stopIfNeeded(e){try{let n=(await Sx.listRunning(this.serverSettings)).filter(i=>i.path===e);if(n.length===1){let i=n[0].id;await this.shutdown(i)}}catch(t){}}async findById(e){return this._models.has(e)?this._models.get(e):(await this.refreshRunning(),this._models.get(e))}async findByPath(e){for(let t of this._models.values())if(t.path===e)return t;await this.refreshRunning();for(let t of this._models.values())if(t.path===e)return t}async requestRunning(){var e,t;let n;try{n=await Sx.listRunning(this.serverSettings)}catch(i){throw(i instanceof fye.ServerConnection.NetworkError||((e=i.response)===null||e===void 0?void 0:e.status)===503||((t=i.response)===null||t===void 0?void 0:t.status)===424)&&this._connectionFailure.emit(i),i}this.isDisposed||this._models.size===n.length&&GY.every(n,i=>{var o,s,a,l;let c=this._models.get(i.id);return c?((o=c.kernel)===null||o===void 0?void 0:o.id)===((s=i.kernel)===null||s===void 0?void 0:s.id)&&((a=c.kernel)===null||a===void 0?void 0:a.name)===((l=i.kernel)===null||l===void 0?void 0:l.name)&&c.name===i.name&&c.path===i.path&&c.type===i.type:!1})||(this._models=new Map(n.map(i=>[i.id,i])),this._sessionConnections.forEach(i=>{this._models.has(i.id)?i.update(this._models.get(i.id)):i.dispose()}),this._runningChanged.emit(n))}_onStarted(e){this._sessionConnections.add(e),e.disposed.connect(this._onDisposed,this),e.propertyChanged.connect(this._onChanged,this),e.kernelChanged.connect(this._onChanged,this)}_onDisposed(e){this._sessionConnections.delete(e),this.refreshRunning().catch(()=>{})}_onChanged(){this.refreshRunning().catch(()=>{})}};pR.SessionManager=zW});var QW=z(Ao=>{"use strict";u();var zY=Ao&&Ao.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),hye=Ao&&Ao.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),QY=Ao&&Ao.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&zY(e,r,t);return hye(e,r),e},vye=Ao&&Ao.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&zY(e,r,t)};Object.defineProperty(Ao,"__esModule",{value:!0});Ao.SessionAPI=Ao.Session=void 0;var yye=QY(jY());Ao.Session=yye;var bye=QY(uR());Ao.SessionAPI=bye;vye($Y(),Ao)});var XY=z(fR=>{"use strict";u();Object.defineProperty(fR,"__esModule",{value:!0});fR.DataConnector=void 0;var XW=class{async list(e){throw new Error("DataConnector#list method has not been implemented.")}async remove(e){throw new Error("DataConnector#remove method has not been implemented.")}async save(e,t){throw new Error("DataConnector#save method has not been implemented.")}};fR.DataConnector=XW});var e$=z(ZY=>{"use strict";u();Object.defineProperty(ZY,"__esModule",{value:!0})});var r$=z(gR=>{"use strict";u();Object.defineProperty(gR,"__esModule",{value:!0});gR.RestorablePool=void 0;var Iye=Ml(),t$=aW(),mR=Mi(),ZW=class{constructor(e){this._added=new mR.Signal(this),this._current=null,this._currentChanged=new mR.Signal(this),this._hasRestored=!1,this._isDisposed=!1,this._objects=new Set,this._restore=null,this._restored=new Iye.PromiseDelegate,this._updated=new mR.Signal(this),this.namespace=e.namespace}get added(){return this._added}get current(){return this._current}set current(e){this._current!==e&&e!==null&&this._objects.has(e)&&(this._current=e,this._currentChanged.emit(this._current))}get currentChanged(){return this._currentChanged}get isDisposed(){return this._isDisposed}get restored(){return this._restored.promise}get size(){return this._objects.size}get updated(){return this._updated}async add(e){var t,n;if(e.isDisposed){let i="A disposed object cannot be added.";throw console.warn(i,e),new Error(i)}if(this._objects.has(e)){let i="This object already exists in the pool.";throw console.warn(i,e),new Error(i)}if(this._objects.add(e),e.disposed.connect(this._onInstanceDisposed,this),!Gc.injectedProperty.get(e)){if(this._restore){let{connector:i}=this._restore,o=this._restore.name(e);if(o){let s=`${this.namespace}:${o}`,a=(n=(t=this._restore).args)===null||n===void 0?void 0:n.call(t,e);Gc.nameProperty.set(e,s),await i.save(s,{data:a})}}this._added.emit(e)}}dispose(){this.isDisposed||(this._current=null,this._isDisposed=!0,this._objects.clear(),mR.Signal.clearData(this))}find(e){let t=this._objects.values();for(let n of t)if(e(n))return n}forEach(e){this._objects.forEach(e)}filter(e){let t=[];return this.forEach(n=>{e(n)&&t.push(n)}),t}inject(e){return Gc.injectedProperty.set(e,!0),this.add(e)}has(e){return this._objects.has(e)}async restore(e){if(this._hasRestored)throw new Error("This pool has already been restored.");this._hasRestored=!0;let{command:t,connector:n,registry:i,when:o}=e,s=this.namespace,a=o?[n.list(s)].concat(o):[n.list(s)];this._restore=e;let[l]=await Promise.all(a),c=await Promise.all(l.ids.map(async(d,p)=>{let f=l.values[p],m=f&&f.data;return m===void 0?n.remove(d):i.execute(t,m).catch(()=>n.remove(d))}));return this._restored.resolve(),c}async save(e){var t,n;let i=Gc.injectedProperty.get(e);if(!this._restore||!this.has(e)||i)return;let{connector:o}=this._restore,s=this._restore.name(e),a=Gc.nameProperty.get(e),l=s?`${this.namespace}:${s}`:"";if(a&&a!==l&&await o.remove(a),Gc.nameProperty.set(e,l),l){let c=(n=(t=this._restore).args)===null||n===void 0?void 0:n.call(t,e);await o.save(l,{data:c})}a!==l&&this._updated.emit(e)}_onInstanceDisposed(e){if(this._objects.delete(e),e===this._current&&(this._current=null,this._currentChanged.emit(this._current)),Gc.injectedProperty.get(e)||!this._restore)return;let{connector:t}=this._restore,n=Gc.nameProperty.get(e);n&&t.remove(n)}};gR.RestorablePool=ZW;var Gc;(function(r){r.injectedProperty=new t$.AttachedProperty({name:"injected",create:()=>!1}),r.nameProperty=new t$.AttachedProperty({name:"name",create:()=>""})})(Gc||(Gc={}))});var n$=z(fI=>{"use strict";u();Object.defineProperty(fI,"__esModule",{value:!0});fI.StateDB=void 0;var Sye=Mi(),hR=class r{constructor(e={}){this._changed=new Sye.Signal(this);let{connector:t,transform:n}=e;this._connector=t||new r.Connector,n?this._ready=n.then(i=>{let{contents:o,type:s}=i;switch(s){case"cancel":return;case"clear":return this._clear();case"merge":return this._merge(o||{});case"overwrite":return this._overwrite(o||{});default:return}}):this._ready=Promise.resolve(void 0)}get changed(){return this._changed}async clear(){await this._ready,await this._clear()}async fetch(e){return await this._ready,this._fetch(e)}async list(e){return await this._ready,this._list(e)}async remove(e){await this._ready,await this._remove(e),this._changed.emit({id:e,type:"remove"})}async save(e,t){await this._ready,await this._save(e,t),this._changed.emit({id:e,type:"save"})}async toJSON(){await this._ready;let{ids:e,values:t}=await this._list();return t.reduce((n,i,o)=>(n[e[o]]=i,n),{})}async _clear(){await Promise.all((await this._list()).ids.map(e=>this._remove(e)))}async _fetch(e){let t=await this._connector.fetch(e);if(t)return JSON.parse(t).v}async _list(e=""){let{ids:t,values:n}=await this._connector.list(e);return{ids:t,values:n.map(i=>JSON.parse(i).v)}}async _merge(e){await Promise.all(Object.keys(e).map(t=>e[t]&&this._save(t,e[t])))}async _overwrite(e){await this._clear(),await this._merge(e)}async _remove(e){return this._connector.remove(e)}async _save(e,t){return this._connector.save(e,JSON.stringify({v:t}))}};fI.StateDB=hR;(function(r){class e{constructor(){this._storage={}}async fetch(n){return this._storage[n]}async list(n=""){return Object.keys(this._storage).reduce((i,o)=>((n===""||n===o.split(":")[0])&&(i.ids.push(o),i.values.push(this._storage[o])),i),{ids:[],values:[]})}async remove(n){delete this._storage[n]}async save(n,i){this._storage[n]=i}}r.Connector=e})(hR=fI.StateDB||(fI.StateDB={}))});var i$=z(vR=>{"use strict";u();Object.defineProperty(vR,"__esModule",{value:!0});vR.IStateDB=void 0;var _ye=Ml();vR.IStateDB=new _ye.Token("@jupyterlab/coreutils:IStateDB")});var eV=z(Ll=>{"use strict";u();var Eye=Ll&&Ll.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),_x=Ll&&Ll.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&Eye(e,r,t)};Object.defineProperty(Ll,"__esModule",{value:!0});_x(XY(),Ll);_x(e$(),Ll);_x(r$(),Ll);_x(n$(),Ll);_x(i$(),Ll)});var rV=z(bR=>{"use strict";u();Object.defineProperty(bR,"__esModule",{value:!0});bR.SettingManager=void 0;var Cye=ls(),wye=eV(),yR=Os(),xye="api/settings",tV=class extends wye.DataConnector{constructor(e={}){var t;super(),this.serverSettings=(t=e.serverSettings)!==null&&t!==void 0?t:yR.ServerConnection.makeSettings()}async fetch(e){if(!e)throw new Error("Plugin `id` parameter is required for settings fetch.");let{serverSettings:t}=this,{baseUrl:n,appUrl:i}=t,{makeRequest:o,ResponseError:s}=yR.ServerConnection,a=n+i,l=Ex.url(a,e),c=await o(l,{},t);if(c.status!==200)throw await s.create(c);return c.json()}async list(){var e,t;let{serverSettings:n}=this,{baseUrl:i,appUrl:o}=n,{makeRequest:s,ResponseError:a}=yR.ServerConnection,l=i+o,c=Ex.url(l,""),d=await s(c,{},n);if(d.status!==200)throw new a(d);let p=await d.json(),f=(t=(e=p==null?void 0:p.settings)===null||e===void 0?void 0:e.map(g=>(g.data={composite:{},user:{}},g)))!==null&&t!==void 0?t:[];return{ids:f.map(g=>g.id),values:f}}async save(e,t){let{serverSettings:n}=this,{baseUrl:i,appUrl:o}=n,{makeRequest:s,ResponseError:a}=yR.ServerConnection,l=i+o,c=Ex.url(l,e),d={body:JSON.stringify({raw:t}),method:"PUT"},p=await s(c,d,n);if(p.status!==204)throw new a(p)}};bR.SettingManager=tV;var Ex;(function(r){function e(t,n){return Cye.URLExt.join(t,xye,n)}r.url=e})(Ex||(Ex={}))});var wx=z(Mo=>{"use strict";u();Object.defineProperty(Mo,"__esModule",{value:!0});Mo.shutdownTerminal=Mo.listRunning=Mo.startNew=Mo.isAvailable=Mo.TERMINAL_SERVICE_URL=void 0;var IR=ls(),Rd=Os();Mo.TERMINAL_SERVICE_URL="api/terminals";function o$(){return String(IR.PageConfig.getOption("terminalsAvailable")).toLowerCase()==="true"}Mo.isAvailable=o$;async function Dye(r=Rd.ServerConnection.makeSettings()){Cx.errorIfNotAvailable();let e=IR.URLExt.join(r.baseUrl,Mo.TERMINAL_SERVICE_URL),t={method:"POST"},n=await Rd.ServerConnection.makeRequest(e,t,r);if(n.status!==200)throw await Rd.ServerConnection.ResponseError.create(n);return await n.json()}Mo.startNew=Dye;async function Pye(r=Rd.ServerConnection.makeSettings()){Cx.errorIfNotAvailable();let e=IR.URLExt.join(r.baseUrl,Mo.TERMINAL_SERVICE_URL),t=await Rd.ServerConnection.makeRequest(e,{},r);if(t.status!==200)throw await Rd.ServerConnection.ResponseError.create(t);let n=await t.json();if(!Array.isArray(n))throw new Error("Invalid terminal list");return n}Mo.listRunning=Pye;async function Tye(r,e=Rd.ServerConnection.makeSettings()){var t;Cx.errorIfNotAvailable();let n=IR.URLExt.join(e.baseUrl,Mo.TERMINAL_SERVICE_URL,r),i={method:"DELETE"},o=await Rd.ServerConnection.makeRequest(n,i,e);if(o.status===404){let a=(t=(await o.json()).message)!==null&&t!==void 0?t:`The terminal session "${r}"" does not exist on the server`;console.warn(a)}else if(o.status!==204)throw await Rd.ServerConnection.ResponseError.create(o)}Mo.shutdownTerminal=Tye;var Cx;(function(r){function e(){if(!o$())throw new Error("Terminals Unavailable")}r.errorIfNotAvailable=e})(Cx||(Cx={}))});var s$=z(SR=>{"use strict";u();Object.defineProperty(SR,"__esModule",{value:!0});SR.isAvailable=void 0;var kye=wx();Object.defineProperty(SR,"isAvailable",{enumerable:!0,get:function(){return kye.isAvailable}})});var c$=z(ER=>{"use strict";u();Object.defineProperty(ER,"__esModule",{value:!0});ER.TerminalConnection=void 0;var a$=ls(),Nye=Ml(),_R=Mi(),Rye=oi(),l$=wx(),nV=class r{constructor(e){var t;this._createSocket=()=>{this._errorIfDisposed(),this._clearSocket(),this._updateConnectionStatus("connecting");let n=this._name,i=this.serverSettings,o=a$.URLExt.join(i.wsUrl,"terminals","websocket",encodeURIComponent(n)),s=i.token;i.appendToken&&s!==""&&(o=o+`?token=${encodeURIComponent(s)}`),this._ws=new i.WebSocket(o),this._ws.onmessage=this._onWSMessage,this._ws.onclose=this._onWSClose,this._ws.onerror=this._onWSClose},this._onWSMessage=n=>{if(this._isDisposed)return;let i=JSON.parse(n.data);if(i[0]==="disconnect"&&this.dispose(),this._connectionStatus==="connecting"){i[0]==="setup"&&this._updateConnectionStatus("connected");return}this._messageReceived.emit({type:i[0],content:i.slice(1)})},this._onWSClose=n=>{console.warn(`Terminal websocket closed: ${n.code}`),this.isDisposed||this._reconnect()},this._connectionStatus="connecting",this._connectionStatusChanged=new _R.Signal(this),this._isDisposed=!1,this._disposed=new _R.Signal(this),this._messageReceived=new _R.Signal(this),this._reconnectTimeout=null,this._ws=null,this._noOp=()=>{},this._reconnectLimit=7,this._reconnectAttempt=0,this._pendingMessages=[],this._name=e.model.name,this.serverSettings=(t=e.serverSettings)!==null&&t!==void 0?t:Rye.ServerConnection.makeSettings(),this._createSocket()}get disposed(){return this._disposed}get messageReceived(){return this._messageReceived}get name(){return this._name}get model(){return{name:this._name}}get isDisposed(){return this._isDisposed}dispose(){this._isDisposed||(this._isDisposed=!0,this._disposed.emit(),this._updateConnectionStatus("disconnected"),this._clearSocket(),_R.Signal.clearData(this))}send(e){this._sendMessage(e)}_sendMessage(e,t=!0){if(!(this._isDisposed||!e.content))if(this.connectionStatus==="connected"&&this._ws){let n=[e.type,...e.content];this._ws.send(JSON.stringify(n))}else if(t)this._pendingMessages.push(e);else throw new Error(`Could not send message: ${JSON.stringify(e)}`)}_sendPending(){for(;this.connectionStatus==="connected"&&this._pendingMessages.length>0;)this._sendMessage(this._pendingMessages[0],!1),this._pendingMessages.shift()}reconnect(){this._errorIfDisposed();let e=new Nye.PromiseDelegate,t=(n,i)=>{i==="connected"?(e.resolve(),this.connectionStatusChanged.disconnect(t,this)):i==="disconnected"&&(e.reject(new Error("Terminal connection disconnected")),this.connectionStatusChanged.disconnect(t,this))};return this.connectionStatusChanged.connect(t,this),this._reconnectAttempt=0,this._reconnect(),e.promise}_reconnect(){if(this._errorIfDisposed(),clearTimeout(this._reconnectTimeout),this._reconnectAttempt<this._reconnectLimit){this._updateConnectionStatus("connecting");let e=iV.getRandomIntInclusive(0,1e3*(Math.pow(2,this._reconnectAttempt)-1));console.error(`Connection lost, reconnecting in ${Math.floor(e/1e3)} seconds.`),this._reconnectTimeout=setTimeout(this._createSocket,e),this._reconnectAttempt+=1}else this._updateConnectionStatus("disconnected");this._clearSocket()}_clearSocket(){this._ws!==null&&(this._ws.onopen=this._noOp,this._ws.onclose=this._noOp,this._ws.onerror=this._noOp,this._ws.onmessage=this._noOp,this._ws.close(),this._ws=null)}async shutdown(){await l$.shutdownTerminal(this.name,this.serverSettings),this.dispose()}clone(){return new r(this)}_updateConnectionStatus(e){this._connectionStatus!==e&&(this._connectionStatus=e,e!=="connecting"&&(this._reconnectAttempt=0,clearTimeout(this._reconnectTimeout)),e==="connected"&&this._sendPending(),this._connectionStatusChanged.emit(e))}_errorIfDisposed(){if(this.isDisposed)throw new Error("Terminal connection is disposed")}get connectionStatusChanged(){return this._connectionStatusChanged}get connectionStatus(){return this._connectionStatus}};ER.TerminalConnection=nV;var iV;(function(r){function e(n,i){return a$.URLExt.join(n,l$.TERMINAL_SERVICE_URL,encodeURIComponent(i))}r.getTermUrl=e;function t(n,i){return n=Math.ceil(n),i=Math.floor(i),Math.floor(Math.random()*(i-n+1))+n}r.getRandomIntInclusive=t})(iV||(iV={}))});var d$=z(CR=>{"use strict";u();Object.defineProperty(CR,"__esModule",{value:!0});CR.TerminalManager=void 0;var Aye=Nh(),Mye=vx(),u$=Mi(),Oye=oi(),Lye=yx(),xx=wx(),Kye=c$(),oV=class extends Lye.BaseManager{constructor(e={}){var t;if(super(e),this._isReady=!1,this._names=[],this._terminalConnections=new Set,this._runningChanged=new u$.Signal(this),this._connectionFailure=new u$.Signal(this),!this.isAvailable()){this._ready=Promise.reject("Terminals unavailable"),this._ready.catch(n=>{});return}this._pollModels=new Mye.Poll({auto:!1,factory:()=>this.requestRunning(),frequency:{interval:10*1e3,backoff:!0,max:300*1e3},name:"@jupyterlab/services:TerminalManager#models",standby:(t=e.standby)!==null&&t!==void 0?t:"when-hidden"}),this._ready=(async()=>{await this._pollModels.start(),await this._pollModels.tick,this._isReady=!0})()}get isReady(){return this._isReady}get ready(){return this._ready}get runningChanged(){return this._runningChanged}get connectionFailure(){return this._connectionFailure}dispose(){this.isDisposed||(this._names.length=0,this._terminalConnections.forEach(e=>e.dispose()),this._pollModels.dispose(),super.dispose())}isAvailable(){return xx.isAvailable()}connectTo(e){let t=new Kye.TerminalConnection(Object.assign(Object.assign({},e),{serverSettings:this.serverSettings}));return this._onStarted(t),this._names.includes(e.model.name)||this.refreshRunning().catch(()=>{}),t}running(){return Aye.iter(this._models)}async refreshRunning(){await this._pollModels.refresh(),await this._pollModels.tick}async startNew(){let e=await xx.startNew(this.serverSettings);return await this.refreshRunning(),this.connectTo({model:e})}async shutdown(e){await xx.shutdownTerminal(e,this.serverSettings),await this.refreshRunning()}async shutdownAll(){await this.refreshRunning(),await Promise.all(this._names.map(e=>xx.shutdownTerminal(e,this.serverSettings))),await this.refreshRunning()}async requestRunning(){var e,t;let n;try{n=await xx.listRunning(this.serverSettings)}catch(o){throw(o instanceof Oye.ServerConnection.NetworkError||((e=o.response)===null||e===void 0?void 0:e.status)===503||((t=o.response)===null||t===void 0?void 0:t.status)===424)&&this._connectionFailure.emit(o),o}if(this.isDisposed)return;let i=n.map(({name:o})=>o).sort();i!==this._names&&(this._names=i,this._terminalConnections.forEach(o=>{i.includes(o.name)||o.dispose()}),this._runningChanged.emit(this._models))}_onStarted(e){this._terminalConnections.add(e),e.disposed.connect(this._onDisposed,this)}_onDisposed(e){this._terminalConnections.delete(e),this.refreshRunning().catch(()=>{})}get _models(){return this._names.map(e=>({name:e}))}};CR.TerminalManager=oV});var sV=z(Oo=>{"use strict";u();var p$=Oo&&Oo.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Fye=Oo&&Oo.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),f$=Oo&&Oo.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&p$(e,r,t);return Fye(e,r),e},Uye=Oo&&Oo.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&p$(e,r,t)};Object.defineProperty(Oo,"__esModule",{value:!0});Oo.TerminalAPI=Oo.Terminal=void 0;var Wye=f$(s$());Oo.Terminal=Wye;var Vye=f$(wx());Oo.TerminalAPI=Vye;Uye(d$(),Oo)});var lV=z(wR=>{"use strict";u();Object.defineProperty(wR,"__esModule",{value:!0});wR.WorkspaceManager=void 0;var jye=ls(),Bye=eV(),Dx=Os(),Hye="api/workspaces",aV=class extends Bye.DataConnector{constructor(e={}){var t;super(),this.serverSettings=(t=e.serverSettings)!==null&&t!==void 0?t:Dx.ServerConnection.makeSettings()}async fetch(e){let{serverSettings:t}=this,{baseUrl:n,appUrl:i}=t,{makeRequest:o,ResponseError:s}=Dx.ServerConnection,a=n+i,l=mI.url(a,e),c=await o(l,{},t);if(c.status!==200)throw await s.create(c);return c.json()}async list(){let{serverSettings:e}=this,{baseUrl:t,appUrl:n}=e,{makeRequest:i,ResponseError:o}=Dx.ServerConnection,s=t+n,a=mI.url(s,""),l=await i(a,{},e);if(l.status!==200)throw await o.create(l);return(await l.json()).workspaces}async remove(e){let{serverSettings:t}=this,{baseUrl:n,appUrl:i}=t,{makeRequest:o,ResponseError:s}=Dx.ServerConnection,a=n+i,l=mI.url(a,e),d=await o(l,{method:"DELETE"},t);if(d.status!==204)throw await s.create(d)}async save(e,t){let{serverSettings:n}=this,{baseUrl:i,appUrl:o}=n,{makeRequest:s,ResponseError:a}=Dx.ServerConnection,l=i+o,c=mI.url(l,e),d={body:JSON.stringify(t),method:"PUT"},p=await s(c,d,n);if(p.status!==204)throw await a.create(p)}};wR.WorkspaceManager=aV;var mI;(function(r){function e(t,n){return jye.URLExt.join(t,Hye,n)}r.url=e})(mI||(mI={}))});var g$=z(xR=>{"use strict";u();Object.defineProperty(xR,"__esModule",{value:!0});xR.ServiceManager=void 0;var m$=Mi(),Jye=WY(),qye=GW(),Gye=IW(),Yye=rR(),$ye=QW(),zye=rV(),Qye=sV(),Xye=Os(),Zye=lV(),ebe=jW(),cV=class{constructor(e={}){var t,n;this._isDisposed=!1,this._connectionFailure=new m$.Signal(this),this._isReady=!1;let i=e.defaultDrive,o=(t=e.serverSettings)!==null&&t!==void 0?t:Xye.ServerConnection.makeSettings(),s=(n=e.standby)!==null&&n!==void 0?n:"when-hidden",a={defaultDrive:i,serverSettings:o,standby:s},l=new ebe.KernelManager(a);this.serverSettings=o,this.contents=new Gye.ContentsManager(a),this.sessions=new $ye.SessionManager(Object.assign(Object.assign({},a),{kernelManager:l})),this.settings=new zye.SettingManager(a),this.terminals=new Qye.TerminalManager(a),this.builder=new Jye.BuildManager(a),this.workspaces=new Zye.WorkspaceManager(a),this.nbconvert=new qye.NbConvertManager(a),this.kernelspecs=new Yye.KernelSpecManager(a),this.kernelspecs.connectionFailure.connect(this._onConnectionFailure,this),this.sessions.connectionFailure.connect(this._onConnectionFailure,this),this.terminals.connectionFailure.connect(this._onConnectionFailure,this);let c=[this.sessions.ready,this.kernelspecs.ready];this.terminals.isAvailable()&&c.push(this.terminals.ready),this._readyPromise=Promise.all(c).then(()=>{this._isReady=!0})}get connectionFailure(){return this._connectionFailure}get isDisposed(){return this._isDisposed}dispose(){this.isDisposed||(this._isDisposed=!0,m$.Signal.clearData(this),this.contents.dispose(),this.sessions.dispose(),this.terminals.dispose())}get isReady(){return this._isReady}get ready(){return this._readyPromise}_onConnectionFailure(e,t){this._connectionFailure.emit(t)}};xR.ServiceManager=cV});var oi=z(Ki=>{"use strict";u();var tbe=Ki&&Ki.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Kl=Ki&&Ki.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&tbe(e,r,t)};Object.defineProperty(Ki,"__esModule",{value:!0});Kl(cY(),Ki);Kl(IW(),Ki);Kl(jW(),Ki);Kl(rR(),Ki);Kl(g$(),Ki);Kl(Os(),Ki);Kl(QW(),Ki);Kl(rV(),Ki);Kl(sV(),Ki);Kl(lV(),Ki);Kl(GW(),Ki)});var pV=z((pqe,I$)=>{"use strict";u();var y$=Array.isArray,b$=Object.keys,nbe=Object.prototype.hasOwnProperty;I$.exports=function r(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){var n=y$(e),i=y$(t),o,s,a;if(n&&i){if(s=e.length,s!=t.length)return!1;for(o=s;o--!==0;)if(!r(e[o],t[o]))return!1;return!0}if(n!=i)return!1;var l=e instanceof Date,c=t instanceof Date;if(l!=c)return!1;if(l&&c)return e.getTime()==t.getTime();var d=e instanceof RegExp,p=t instanceof RegExp;if(d!=p)return!1;if(d&&p)return e.toString()==t.toString();var f=b$(e);if(s=f.length,s!==b$(t).length)return!1;for(o=s;o--!==0;)if(!nbe.call(t,f[o]))return!1;for(o=s;o--!==0;)if(a=f[o],!r(e[a],t[a]))return!1;return!0}return e!==e&&t!==t}});var TV=z(Yf=>{"use strict";u();Object.defineProperty(Yf,"__esModule",{value:!0});Yf.TargetPopulation=Yf.Filters=Yf.VSCodeFilterProvider=void 0;var s1=require("vscode"),PV=class r{constructor(e,t,n){this.extensionName=e,this.extensionVersion=t,this.targetPopulation=n}static trimVersionSuffix(e){let t=/\-[a-zA-Z0-9]+$/;return e.split(t)[0]}getFilterValue(e){switch(e){case ru.ApplicationVersion:return r.trimVersionSuffix(s1.version);case ru.Build:return s1.env.appName;case ru.ClientId:return s1.env.machineId;case ru.ExtensionName:return this.extensionName;case ru.ExtensionVersion:return r.trimVersionSuffix(this.extensionVersion);case ru.Language:return s1.env.language;case ru.TargetPopulation:return this.targetPopulation;default:return""}}getFilters(){let e=new Map,t=Object.values(ru);for(let n of t)e.set(n,this.getFilterValue(n));return e}};Yf.VSCodeFilterProvider=PV;var ru;(function(r){r.Market="X-MSEdge-Market",r.CorpNet="X-FD-Corpnet",r.ApplicationVersion="X-VSCode-AppVersion",r.Build="X-VSCode-Build",r.ClientId="X-MSEdge-ClientId",r.ExtensionName="X-VSCode-ExtensionName",r.ExtensionVersion="X-VSCode-ExtensionVersion",r.Language="X-VSCode-Language",r.TargetPopulation="X-VSCode-TargetPopulation"})(ru||(Yf.Filters=ru={}));var Iz;(function(r){r.Team="team",r.Internal="internal",r.Insiders="insider",r.Public="public"})(Iz||(Yf.TargetPopulation=Iz={}))});var Sz=z(a1=>{"use strict";u();Object.defineProperty(a1,"__esModule",{value:!0});a1.BaseFeatureProvider=void 0;var kV=class{constructor(e){this.telemetry=e,this.isFetching=!1}async getFeatures(){if(this.isFetching&&this.fetchPromise)return this.fetchPromise;this.fetchPromise=this.fetch();let e=await this.fetchPromise;return this.isFetching=!1,this.fetchPromise=void 0,e}};a1.BaseFeatureProvider=kV});var _z=z(l1=>{"use strict";u();Object.defineProperty(l1,"__esModule",{value:!0});l1.FilteredFeatureProvider=void 0;var Dbe=Sz(),NV=class extends Dbe.BaseFeatureProvider{constructor(e,t){super(e),this.telemetry=e,this.filterProviders=t,this.cachedTelemetryEvents=[]}getFilters(){let e=new Map;for(let t of this.filterProviders){let n=t.getFilters();for(let i of n.keys()){let o=n.get(i);e.set(i,o)}}return e}PostEventToTelemetry(e){if(this.cachedTelemetryEvents.includes(e))return;let t=JSON.stringify(e);this.telemetry.postEvent("report-headers",new Map([["ABExp.headers",t]])),this.cachedTelemetryEvents.push(e)}};l1.FilteredFeatureProvider=NV});var Ez=z($f=>{"use strict";u();Object.defineProperty($f,"__esModule",{value:!0});$f.TasApiFeatureProvider=$f.TASAPI_FETCHERROR_EVENTNAME=void 0;var Pbe=_z();$f.TASAPI_FETCHERROR_EVENTNAME="call-tas-error";var RV="ErrorType",AV=class extends Pbe.FilteredFeatureProvider{constructor(e,t,n){super(t,n),this.httpClient=e,this.telemetry=t,this.filterProviders=n}async fetch(){let e=this.getFilters(),t={};for(let a of e.keys()){let l=e.get(a);t[a]=l}let n;try{n=await this.httpClient.get({headers:t})}catch(a){let l=a,c=new Map;l.responseReceived&&!l.responseOk?c.set(RV,"ServerError"):l.responseReceived===!1?c.set(RV,"NoResponse"):c.set(RV,"GenericError"),this.telemetry.postEvent($f.TASAPI_FETCHERROR_EVENTNAME,c)}if(!n)throw Error($f.TASAPI_FETCHERROR_EVENTNAME);e.keys.length>0&&this.PostEventToTelemetry(t);let i=n.data,o=i.Configs,s=[];for(let a of o)if(a.Parameters)for(let l of Object.keys(a.Parameters)){let c=l+(a.Parameters[l]?"":"cf");s.includes(c)||s.push(c)}return{features:s,assignmentContext:i.AssignmentContext,configs:o}}};$f.TasApiFeatureProvider=AV});var Cz=z(AI=>{"use strict";u();Object.defineProperty(AI,"__esModule",{value:!0});AI.HttpClient=AI.FetchError=void 0;var RI=class extends Error{constructor(e,t,n){super(e),this.responseReceived=t,this.responseOk=n}};AI.FetchError=RI;var MV=class{constructor(e){this.endpoint=e}async get(e){let t=await fetch(this.endpoint,{method:"GET",headers:e==null?void 0:e.headers});if(!t)throw new RI("No response received",!1);if(!t.ok)throw new RI("Response not ok",!0,!1);let n=await t.json();if(!n)throw new RI("No data received",!1);return{data:n}}};AI.HttpClient=MV});var wz=z(c1=>{"use strict";u();Object.defineProperty(c1,"__esModule",{value:!0});c1.MemoryKeyValueStorage=void 0;var OV=class{constructor(){this.storage=new Map}async getValue(e,t){return this.storage.has(e)?await Promise.resolve(this.storage.get(e)):await Promise.resolve(t||void 0)}setValue(e,t){this.storage.set(e,t)}};c1.MemoryKeyValueStorage=OV});var xz=z(u1=>{"use strict";u();Object.defineProperty(u1,"__esModule",{value:!0});u1.ExperimentationServiceBase=void 0;var Tbe=wz(),LV=class{get features(){return this._features}set features(e){this._features=e,this.telemetry&&this.telemetry.setSharedProperty(this.assignmentContextTelemetryPropertyName,this.features.assignmentContext)}constructor(e,t,n,i,o){this.telemetry=e,this.assignmentContextTelemetryPropertyName=t,this.telemetryEventName=n,this.storageKey=i,this.storage=o,this.featuresConsumed=!1,this.cachedTelemetryEvents=[],this._features={features:[],assignmentContext:"",configs:[]},this.storageKey||(this.storageKey="ABExp.Features"),this.storage||(o=new Tbe.MemoryKeyValueStorage),this.loadCachePromise=this.loadCachedFeatureData(),this.initializePromise=this.loadCachePromise,this.initialFetch=new Promise((s,a)=>{this.resolveInitialFetchPromise=s})}async getFeaturesAsync(e=!1){if(this.fetchPromise!=null){try{await this.fetchPromise}catch(t){}return this.features}if(!this.featureProviders||this.featureProviders.length===0)return Promise.resolve({features:[],assignmentContext:"",configs:[]});try{this.fetchPromise=Promise.all(this.featureProviders.map(async n=>await n.getFeatures()));let t=await this.fetchPromise;this.updateFeatures(t,e)}catch(t){}return this.fetchPromise=void 0,this.resolveInitialFetchPromise&&(this.resolveInitialFetchPromise(),this.resolveInitialFetchPromise=void 0),this.features}updateFeatures(e,t=!1){let n={features:[],assignmentContext:"",configs:[]};for(let i of e){for(let o of i.features)n.features.includes(o)||n.features.push(o);for(let o of i.configs){let s=n.configs.find(a=>a.Id===o.Id);s?s.Parameters=Object.assign(Object.assign({},s.Parameters),o.Parameters):n.configs.push(o)}n.assignmentContext+=i.assignmentContext}(t||!this.featuresConsumed)&&(this.features=n),this.storage&&this.storage.setValue(this.storageKey,n)}async loadCachedFeatureData(){let e;this.storage&&(e=await this.storage.getValue(this.storageKey),e!==void 0&&e.configs===void 0&&(e.configs=[])),this.features.features.length===0&&(this.features=e||{features:[],assignmentContext:"",configs:[]})}isFlightEnabled(e){return this.featuresConsumed=!0,this.PostEventToTelemetry(e),this.features.features.includes(e)}async isCachedFlightEnabled(e){return await this.loadCachePromise,this.featuresConsumed=!0,this.PostEventToTelemetry(e),this.features.features.includes(e)}async isFlightEnabledAsync(e){let t=await this.getFeaturesAsync(!0);return this.featuresConsumed=!0,this.PostEventToTelemetry(e),t.features.includes(e)}getTreatmentVariable(e,t){this.featuresConsumed=!0,this.PostEventToTelemetry(`${e}.${t}`);let n=this.features.configs.find(i=>i.Id===e);return n==null?void 0:n.Parameters[t]}async getTreatmentVariableAsync(e,t,n){if(n){let i=this.featuresConsumed,o=this.getTreatmentVariable(e,t);if(o===void 0)this.featuresConsumed=i;else return o}return await this.getFeaturesAsync(!0),this.getTreatmentVariable(e,t)}PostEventToTelemetry(e){this.cachedTelemetryEvents.includes(e)||(this.telemetry.postEvent(this.telemetryEventName,new Map([["ABExp.queriedFeature",e]])),this.cachedTelemetryEvents.push(e))}invokeInit(){this.init()}addFeatureProvider(...e){if(!(e==null||this.featureProviders==null))for(let t of e)this.featureProviders.push(t)}};u1.ExperimentationServiceBase=LV});var Dz=z(d1=>{"use strict";u();Object.defineProperty(d1,"__esModule",{value:!0});d1.PollingService=void 0;var KV=class{constructor(e){this.fetchInterval=e}StopPolling(){clearInterval(this.intervalHandle),this.intervalHandle=void 0}OnPollTick(e){this.onTick=e}StartPolling(e=!1){this.intervalHandle&&this.StopPolling(),this.onTick!=null&&(e&&this.onTick().then(()=>{}).catch(()=>{}),this.intervalHandle=setInterval(async()=>{await this.onTick()},this.fetchInterval),this.intervalHandle.unref&&this.intervalHandle.unref())}};d1.PollingService=KV});var Pz=z(p1=>{"use strict";u();Object.defineProperty(p1,"__esModule",{value:!0});p1.ExperimentationServiceAutoPolling=void 0;var kbe=xz(),Nbe=Dz(),FV=class extends kbe.ExperimentationServiceBase{constructor(e,t,n,i,o,s,a){if(super(e,i,o,s,a),this.telemetry=e,this.filterProviders=t,this.refreshRateMs=n,this.assignmentContextTelemetryPropertyName=i,this.telemetryEventName=o,this.storageKey=s,this.storage=a,n<1e3&&n!==0)throw new Error("The minimum refresh rate for polling is 1000 ms (1 second). If you wish to deactivate this auto-polling use value of 0.");n>0&&(this.pollingService=new Nbe.PollingService(n),this.pollingService.OnPollTick(async()=>{await super.getFeaturesAsync()}))}init(){this.pollingService?this.pollingService.StartPolling(!0):super.getFeaturesAsync()}async getFeaturesAsync(e=!1){if(this.pollingService){this.pollingService.StopPolling();let t=await super.getFeaturesAsync(e);return this.pollingService.StartPolling(),t}else return await super.getFeaturesAsync(e)}};p1.ExperimentationServiceAutoPolling=FV});var Tz=z(m1=>{"use strict";u();Object.defineProperty(m1,"__esModule",{value:!0});m1.ExperimentationService=void 0;var Rbe=Ez(),Abe=Cz(),Mbe=Pz(),f1=class extends Mbe.ExperimentationServiceAutoPolling{constructor(e){super(e.telemetry,e.filterProviders||[],e.refetchInterval!=null?e.refetchInterval:0,e.assignmentContextTelemetryPropertyName,e.telemetryEventName,e.storageKey,e.keyValueStorage),this.options=e,this.invokeInit()}init(){this.featureProviders=[],this.addFeatureProvider(new Rbe.TasApiFeatureProvider(new Abe.HttpClient(this.options.endpoint),this.telemetry,this.filterProviders)),super.init()}};m1.ExperimentationService=f1;f1.REFRESH_RATE_IN_MINUTES=30});var kz=z(g1=>{"use strict";u();Object.defineProperty(g1,"__esModule",{value:!0});g1.ExperimentationService=void 0;var Obe=Tz();Object.defineProperty(g1,"ExperimentationService",{enumerable:!0,get:function(){return Obe.ExperimentationService}})});var Nz=z(h1=>{"use strict";u();Object.defineProperty(h1,"__esModule",{value:!0});h1.MementoKeyValueStorage=void 0;var UV=class{constructor(e){this.mementoGlobalStorage=e}async getValue(e,t){return await this.mementoGlobalStorage.get(e)||t}setValue(e,t){this.mementoGlobalStorage.update(e,t)}};h1.MementoKeyValueStorage=UV});var Rz=z(VV=>{"use strict";u();Object.defineProperty(VV,"__esModule",{value:!0});var WV=class{constructor(){this.initializePromise=Promise.resolve(),this.initialFetch=Promise.resolve()}isFlightEnabled(e){return!1}isCachedFlightEnabled(e){return Promise.resolve(!1)}isFlightEnabledAsync(e){return Promise.resolve(!1)}getTreatmentVariable(e,t){}getTreatmentVariableAsync(e,t){return Promise.resolve(void 0)}};VV.default=WV});var Mz=z(MI=>{"use strict";u();Object.defineProperty(MI,"__esModule",{value:!0});MI.getExperimentationServiceAsync=MI.getExperimentationService=void 0;var Lbe=TV(),Kbe=kz(),jV=require("vscode"),Fbe=Nz(),Ube=Rz(),Wbe="https://default.exp-tas.com/vscode/ab",Vbe="query-expfeature",jbe="abexp.assignmentcontext",Bbe="VSCode.ABExp.FeatureData",Hbe=1e3*60*30;function Az(r,e,t,n,i,...o){if(!i)throw new Error("Memento storage was not provided.");let s=jV.workspace.getConfiguration("telemetry");if(!(jV.env.isTelemetryEnabled===void 0?s.get("enableTelemetry",!0):jV.env.isTelemetryEnabled))return new Ube.default;let c=[new Lbe.VSCodeFilterProvider(r,e,t),...o],d=new Fbe.MementoKeyValueStorage(i);return new Kbe.ExperimentationService({filterProviders:c,telemetry:n,storageKey:Bbe,keyValueStorage:d,featuresTelemetryPropertyName:"",assignmentContextTelemetryPropertyName:jbe,telemetryEventName:Vbe,endpoint:Wbe,refetchInterval:Hbe})}MI.getExperimentationService=Az;async function Jbe(r,e,t,n,i,...o){let s=Az(r,e,t,n,i,...o);return await s.initializePromise,s}MI.getExperimentationServiceAsync=Jbe});var Lz=z(zf=>{"use strict";u();Object.defineProperty(zf,"__esModule",{value:!0});zf.TargetPopulation=zf.getExperimentationServiceAsync=zf.getExperimentationService=void 0;var Oz=Mz();Object.defineProperty(zf,"getExperimentationService",{enumerable:!0,get:function(){return Oz.getExperimentationService}});Object.defineProperty(zf,"getExperimentationServiceAsync",{enumerable:!0,get:function(){return Oz.getExperimentationServiceAsync}});var qbe=TV();Object.defineProperty(zf,"TargetPopulation",{enumerable:!0,get:function(){return qbe.TargetPopulation}})});var C1=z((wXe,YV)=>{"use strict";u();function $be(r){var e=void 0;typeof r=="string"?e=[r]:e=r.raw;for(var t="",n=0;n<e.length;n++)t+=e[n].replace(/\\\n[ \t]*/g,"").replace(/\\`/g,"`"),n<(arguments.length<=1?0:arguments.length-1)&&(t+=arguments.length<=n+1?void 0:arguments[n+1]);var i=t.split(`
`),o=null;return i.forEach(function(s){var a=s.match(/^(\s+)\S+/);if(a){var l=a[1].length;o?o=Math.min(o,l):o=l}}),o!==null&&(t=i.map(function(s){return s[0]===" "?s.slice(o):s}).join(`
`)),t=t.trim(),t.replace(/\\n/g,`
`)}typeof YV!="undefined"&&(YV.exports=$be)});var aQ=z((Vd,sQ)=>{u();var oQ=typeof self!="undefined"?self:Vd,k1=function(){function r(){this.fetch=!1,this.DOMException=oQ.DOMException}return r.prototype=oQ,new r}();(function(r){var e=function(t){var n={searchParams:"URLSearchParams"in r,iterable:"Symbol"in r&&"iterator"in Symbol,blob:"FileReader"in r&&"Blob"in r&&function(){try{return new Blob,!0}catch(R){return!1}}(),formData:"FormData"in r,arrayBuffer:"ArrayBuffer"in r};function i(R){return R&&DataView.prototype.isPrototypeOf(R)}if(n.arrayBuffer)var o=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],s=ArrayBuffer.isView||function(R){return R&&o.indexOf(Object.prototype.toString.call(R))>-1};function a(R){if(typeof R!="string"&&(R=String(R)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(R))throw new TypeError("Invalid character in header field name");return R.toLowerCase()}function l(R){return typeof R!="string"&&(R=String(R)),R}function c(R){var Z={next:function(){var ge=R.shift();return{done:ge===void 0,value:ge}}};return n.iterable&&(Z[Symbol.iterator]=function(){return Z}),Z}function d(R){this.map={},R instanceof d?R.forEach(function(Z,ge){this.append(ge,Z)},this):Array.isArray(R)?R.forEach(function(Z){this.append(Z[0],Z[1])},this):R&&Object.getOwnPropertyNames(R).forEach(function(Z){this.append(Z,R[Z])},this)}d.prototype.append=function(R,Z){R=a(R),Z=l(Z);var ge=this.map[R];this.map[R]=ge?ge+", "+Z:Z},d.prototype.delete=function(R){delete this.map[a(R)]},d.prototype.get=function(R){return R=a(R),this.has(R)?this.map[R]:null},d.prototype.has=function(R){return this.map.hasOwnProperty(a(R))},d.prototype.set=function(R,Z){this.map[a(R)]=l(Z)},d.prototype.forEach=function(R,Z){for(var ge in this.map)this.map.hasOwnProperty(ge)&&R.call(Z,this.map[ge],ge,this)},d.prototype.keys=function(){var R=[];return this.forEach(function(Z,ge){R.push(ge)}),c(R)},d.prototype.values=function(){var R=[];return this.forEach(function(Z){R.push(Z)}),c(R)},d.prototype.entries=function(){var R=[];return this.forEach(function(Z,ge){R.push([ge,Z])}),c(R)},n.iterable&&(d.prototype[Symbol.iterator]=d.prototype.entries);function p(R){if(R.bodyUsed)return Promise.reject(new TypeError("Already read"));R.bodyUsed=!0}function f(R){return new Promise(function(Z,ge){R.onload=function(){Z(R.result)},R.onerror=function(){ge(R.error)}})}function m(R){var Z=new FileReader,ge=f(Z);return Z.readAsArrayBuffer(R),ge}function g(R){var Z=new FileReader,ge=f(Z);return Z.readAsText(R),ge}function h(R){for(var Z=new Uint8Array(R),ge=new Array(Z.length),Le=0;Le<Z.length;Le++)ge[Le]=String.fromCharCode(Z[Le]);return ge.join("")}function v(R){if(R.slice)return R.slice(0);var Z=new Uint8Array(R.byteLength);return Z.set(new Uint8Array(R)),Z.buffer}function S(){return this.bodyUsed=!1,this._initBody=function(R){this._bodyInit=R,R?typeof R=="string"?this._bodyText=R:n.blob&&Blob.prototype.isPrototypeOf(R)?this._bodyBlob=R:n.formData&&FormData.prototype.isPrototypeOf(R)?this._bodyFormData=R:n.searchParams&&URLSearchParams.prototype.isPrototypeOf(R)?this._bodyText=R.toString():n.arrayBuffer&&n.blob&&i(R)?(this._bodyArrayBuffer=v(R.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):n.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(R)||s(R))?this._bodyArrayBuffer=v(R):this._bodyText=R=Object.prototype.toString.call(R):this._bodyText="",this.headers.get("content-type")||(typeof R=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):n.searchParams&&URLSearchParams.prototype.isPrototypeOf(R)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},n.blob&&(this.blob=function(){var R=p(this);if(R)return R;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?p(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(m)}),this.text=function(){var R=p(this);if(R)return R;if(this._bodyBlob)return g(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(h(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},n.formData&&(this.formData=function(){return this.text().then(M)}),this.json=function(){return this.text().then(JSON.parse)},this}var _=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function D(R){var Z=R.toUpperCase();return _.indexOf(Z)>-1?Z:R}function P(R,Z){Z=Z||{};var ge=Z.body;if(R instanceof P){if(R.bodyUsed)throw new TypeError("Already read");this.url=R.url,this.credentials=R.credentials,Z.headers||(this.headers=new d(R.headers)),this.method=R.method,this.mode=R.mode,this.signal=R.signal,!ge&&R._bodyInit!=null&&(ge=R._bodyInit,R.bodyUsed=!0)}else this.url=String(R);if(this.credentials=Z.credentials||this.credentials||"same-origin",(Z.headers||!this.headers)&&(this.headers=new d(Z.headers)),this.method=D(Z.method||this.method||"GET"),this.mode=Z.mode||this.mode||null,this.signal=Z.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&ge)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(ge)}P.prototype.clone=function(){return new P(this,{body:this._bodyInit})};function M(R){var Z=new FormData;return R.trim().split("&").forEach(function(ge){if(ge){var Le=ge.split("="),Ee=Le.shift().replace(/\+/g," "),ae=Le.join("=").replace(/\+/g," ");Z.append(decodeURIComponent(Ee),decodeURIComponent(ae))}}),Z}function x(R){var Z=new d,ge=R.replace(/\r?\n[\t ]+/g," ");return ge.split(/\r?\n/).forEach(function(Le){var Ee=Le.split(":"),ae=Ee.shift().trim();if(ae){var kt=Ee.join(":").trim();Z.append(ae,kt)}}),Z}S.call(P.prototype);function A(R,Z){Z||(Z={}),this.type="default",this.status=Z.status===void 0?200:Z.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in Z?Z.statusText:"OK",this.headers=new d(Z.headers),this.url=Z.url||"",this._initBody(R)}S.call(A.prototype),A.prototype.clone=function(){return new A(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new d(this.headers),url:this.url})},A.error=function(){var R=new A(null,{status:0,statusText:""});return R.type="error",R};var j=[301,302,303,307,308];A.redirect=function(R,Z){if(j.indexOf(Z)===-1)throw new RangeError("Invalid status code");return new A(null,{status:Z,headers:{location:R}})},t.DOMException=r.DOMException;try{new t.DOMException}catch(R){t.DOMException=function(Z,ge){this.message=Z,this.name=ge;var Le=Error(Z);this.stack=Le.stack},t.DOMException.prototype=Object.create(Error.prototype),t.DOMException.prototype.constructor=t.DOMException}function re(R,Z){return new Promise(function(ge,Le){var Ee=new P(R,Z);if(Ee.signal&&Ee.signal.aborted)return Le(new t.DOMException("Aborted","AbortError"));var ae=new XMLHttpRequest;function kt(){ae.abort()}ae.onload=function(){var yr={status:ae.status,statusText:ae.statusText,headers:x(ae.getAllResponseHeaders()||"")};yr.url="responseURL"in ae?ae.responseURL:yr.headers.get("X-Request-URL");var We="response"in ae?ae.response:ae.responseText;ge(new A(We,yr))},ae.onerror=function(){Le(new TypeError("Network request failed"))},ae.ontimeout=function(){Le(new TypeError("Network request failed"))},ae.onabort=function(){Le(new t.DOMException("Aborted","AbortError"))},ae.open(Ee.method,Ee.url,!0),Ee.credentials==="include"?ae.withCredentials=!0:Ee.credentials==="omit"&&(ae.withCredentials=!1),"responseType"in ae&&n.blob&&(ae.responseType="blob"),Ee.headers.forEach(function(yr,We){ae.setRequestHeader(We,yr)}),Ee.signal&&(Ee.signal.addEventListener("abort",kt),ae.onreadystatechange=function(){ae.readyState===4&&Ee.signal.removeEventListener("abort",kt)}),ae.send(typeof Ee._bodyInit=="undefined"?null:Ee._bodyInit)})}return re.polyfill=!0,r.fetch||(r.fetch=re,r.Headers=d,r.Request=P,r.Response=A),t.Headers=d,t.Request=P,t.Response=A,t.fetch=re,Object.defineProperty(t,"__esModule",{value:!0}),t}({})})(k1);k1.fetch.ponyfill=!0;delete k1.fetch.polyfill;var ZI=k1;Vd=ZI.fetch;Vd.default=ZI.fetch;Vd.fetch=ZI.fetch;Vd.Headers=ZI.Headers;Vd.Request=ZI.Request;Vd.Response=ZI.Response;sQ.exports=Vd});var wQ=z((V1,CQ)=>{u();var hS=null;typeof WebSocket!="undefined"?hS=WebSocket:typeof MozWebSocket!="undefined"?hS=MozWebSocket:typeof V1!="undefined"?hS=V1.WebSocket||V1.MozWebSocket:typeof window!="undefined"?hS=window.WebSocket||window.MozWebSocket:typeof self!="undefined"&&(hS=self.WebSocket||self.MozWebSocket);CQ.exports=hS});var NQ=z((vst,lj)=>{u();var kQ=typeof crypto!="undefined"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto!="undefined"&&typeof window.msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto);kQ?(sj=new Uint8Array(16),lj.exports=function(){return kQ(sj),sj}):(aj=new Array(16),lj.exports=function(){for(var e=0,t;e<16;e++)e&3||(t=Math.random()*4294967296),aj[e]=t>>>((e&3)<<3)&255;return aj});var sj,aj});var MQ=z((bst,AQ)=>{u();var RQ=[];for(Xx=0;Xx<256;++Xx)RQ[Xx]=(Xx+256).toString(16).substr(1);var Xx;function oIe(r,e){var t=e||0,n=RQ;return[n[r[t++]],n[r[t++]],n[r[t++]],n[r[t++]],"-",n[r[t++]],n[r[t++]],"-",n[r[t++]],n[r[t++]],"-",n[r[t++]],n[r[t++]],"-",n[r[t++]],n[r[t++]],n[r[t++]],n[r[t++]],n[r[t++]],n[r[t++]]].join("")}AQ.exports=oIe});var zh=z((Sst,OQ)=>{u();var sIe=NQ(),aIe=MQ();function lIe(r,e,t){var n=e&&t||0;typeof r=="string"&&(e=r==="binary"?new Array(16):null,r=null),r=r||{};var i=r.random||(r.rng||sIe)();if(i[6]=i[6]&15|64,i[8]=i[8]&63|128,e)for(var o=0;o<16;++o)e[n+o]=i[o];return e||aIe(i)}OQ.exports=lIe});var rX=z((Agt,tX)=>{"use strict";u();tX.exports=({onlyFirst:r=!1}={})=>{let e=["[\\u001B\\u009B][[\\]()#;?]*(?:(?:(?:(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]+)*|[a-zA-Z\\d]+(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]*)*)?\\u0007)","(?:(?:\\d{1,4}(?:;\\d{0,4})*)?[\\dA-PR-TZcf-ntqry=><~]))"].join("|");return new RegExp(e,r?void 0:"g")}});var kX=z((HSt,TX)=>{"use strict";u();var xIe=(r,e={})=>{let t=e.safe===!0||e.keepProtected===!0,n=!1,i=(o,s)=>{let a="",l,c;for(let d of o.nodes)switch(d.type){case"block":if(e.first&&n===!0){a+=i(d,o);break}if(e.preserveNewlines===!0){l=i(d,o),c=l.split(`
`),a+=`
`.repeat(c.length-1);break}if(t===!0&&d.protected===!0){a+=i(d,o);break}n=!0;break;case"line":if(e.first&&n===!0){a+=d.value;break}t===!0&&d.protected===!0&&(a+=d.value),n=!0;break;case"open":case"close":case"text":case"newline":default:{a+=d.value||"";break}}return a};return i(r)};TX.exports=xIe});var RX=z((qSt,NX)=>{"use strict";u();var AA=class{constructor(e){this.type=e.type,e.value&&(this.value=e.value),e.match&&(this.match=e.match),this.newline=e.newline||""}get protected(){return!!this.match&&this.match[1]==="!"}},wj=class extends AA{constructor(e){super(e),this.nodes=e.nodes||[]}push(e){this.nodes.push(e)}get protected(){return this.nodes.length>0&&this.nodes[0].protected===!0}};NX.exports={Node:AA,Block:wj}});var MX=z(AX=>{"use strict";u();AX.javascript={BLOCK_OPEN_REGEX:/^\/\*\*?(!?)/,BLOCK_CLOSE_REGEX:/^\*\/(\n?)/,LINE_REGEX:/^\/\/(!?).*/}});var KX=z((zSt,LX)=>{"use strict";u();var{Node:fm,Block:OX}=RX(),DIe=MX(),xj={ESCAPED_CHAR_REGEX:/^\\./,QUOTED_STRING_REGEX:/^(['"`])((?:\\.|[^\1])+?)(\1)/,NEWLINE_REGEX:/^\r*\n/},PIe=(r,e={})=>{if(typeof r!="string")throw new TypeError("Expected input to be a string");let t=new OX({type:"root",nodes:[]}),n=[t],i=(e.language||"javascript").toLowerCase(),o=DIe[i];if(typeof o=="undefined")throw new Error(`Language "${i}" is not supported by strip-comments`);let{LINE_REGEX:s,BLOCK_OPEN_REGEX:a,BLOCK_CLOSE_REGEX:l}=o,c=t,d=r,p,f,m=[a,l].filter(Boolean),g=!1;m.every(D=>D.source==='^"""')&&(g=!0);let h=(D=d[0]||"")=>(d=d.slice(D.length),D),v=(D,P="text")=>{let M=D.exec(d);if(M)return h(M[0]),{type:P,value:M[0],match:M}},S=D=>{if(f&&f.type==="text"&&D.type==="text"){f.value+=D.value;return}c.push(D),D.nodes&&(n.push(D),c=D),f=D},_=()=>{if(c.type==="root")throw new SyntaxError("Unclosed block comment");n.pop(),c=n[n.length-1]};for(;d!=="";){if(p=v(xj.ESCAPED_CHAR_REGEX,"text")){S(new fm(p));continue}if(c.type!=="block"&&(!f||!/\w$/.test(f.value))&&!(g&&d.startsWith('"""'))&&(p=v(xj.QUOTED_STRING_REGEX,"text"))){S(new fm(p));continue}if(p=v(xj.NEWLINE_REGEX,"newline")){S(new fm(p));continue}if(a&&e.block&&!(g&&c.type==="block")&&(p=v(a,"open"))){S(new OX({type:"block"})),S(new fm(p));continue}if(l&&c.type==="block"&&e.block&&(p=v(l,"close"))){p.newline=p.match[1]||"",S(new fm(p)),_();continue}if(s&&c.type!=="block"&&e.line&&(p=v(s,"line"))){S(new fm(p));continue}if(p=v(/^[a-zABD-Z0-9\t ]+/,"text")){S(new fm(p));continue}S(new fm({type:"text",value:h(d[0])}))}return t};LX.exports=PIe});var UX=z((XSt,FX)=>{"use strict";u();var MA=kX(),dD=KX(),OA=FX.exports=(r,e)=>{let t={...e,block:!0,line:!0};return MA(dD(r,t),t)};OA.block=(r,e)=>{let t={...e,block:!0};return MA(dD(r,t),t)};OA.line=(r,e)=>{let t={...e,line:!0};return MA(dD(r,t),t)};OA.first=(r,e)=>{let t={...e,block:!0,line:!0,first:!0};return MA(dD(r,t),t)};OA.parse=dD});var wZ=z((PD,CZ)=>{u();var eSe=typeof PD=="object"&&PD&&PD.Object===Object&&PD;CZ.exports=eSe});var DZ=z((cOt,xZ)=>{u();var tSe=wZ(),rSe=typeof self=="object"&&self&&self.Object===Object&&self,nSe=tSe||rSe||Function("return this")();xZ.exports=nSe});var _M=z((dOt,PZ)=>{u();var iSe=DZ(),oSe=iSe.Symbol;PZ.exports=oSe});var kZ=z((fOt,TZ)=>{u();function sSe(r,e){for(var t=-1,n=r==null?0:r.length,i=Array(n);++t<n;)i[t]=e(r[t],t,r);return i}TZ.exports=sSe});var RZ=z((gOt,NZ)=>{u();var aSe=Array.isArray;NZ.exports=aSe});var LZ=z((vOt,OZ)=>{u();var AZ=_M(),MZ=Object.prototype,lSe=MZ.hasOwnProperty,cSe=MZ.toString,TD=AZ?AZ.toStringTag:void 0;function uSe(r){var e=lSe.call(r,TD),t=r[TD];try{r[TD]=void 0;var n=!0}catch(o){}var i=cSe.call(r);return n&&(e?r[TD]=t:delete r[TD]),i}OZ.exports=uSe});var FZ=z((bOt,KZ)=>{u();var dSe=Object.prototype,pSe=dSe.toString;function fSe(r){return pSe.call(r)}KZ.exports=fSe});var jZ=z((SOt,VZ)=>{u();var UZ=_M(),mSe=LZ(),gSe=FZ(),hSe="[object Null]",vSe="[object Undefined]",WZ=UZ?UZ.toStringTag:void 0;function ySe(r){return r==null?r===void 0?vSe:hSe:WZ&&WZ in Object(r)?mSe(r):gSe(r)}VZ.exports=ySe});var HZ=z((EOt,BZ)=>{u();function bSe(r){return r!=null&&typeof r=="object"}BZ.exports=bSe});var qZ=z((wOt,JZ)=>{u();var ISe=jZ(),SSe=HZ(),_Se="[object Symbol]";function ESe(r){return typeof r=="symbol"||SSe(r)&&ISe(r)==_Se}JZ.exports=ESe});var XZ=z((DOt,QZ)=>{u();var GZ=_M(),CSe=kZ(),wSe=RZ(),xSe=qZ(),DSe=1/0,YZ=GZ?GZ.prototype:void 0,$Z=YZ?YZ.toString:void 0;function zZ(r){if(typeof r=="string")return r;if(wSe(r))return CSe(r,zZ)+"";if(xSe(r))return $Z?$Z.call(r):"";var e=r+"";return e=="0"&&1/r==-DSe?"-0":e}QZ.exports=zZ});var eee=z((TOt,ZZ)=>{u();var PSe=XZ();function TSe(r){return r==null?"":PSe(r)}ZZ.exports=TSe});var nee=z((NOt,ree)=>{u();var kSe=eee(),tee=/[\\^$.*+?()[\]{}|]/g,NSe=RegExp(tee.source);function RSe(r){return r=kSe(r),r&&NSe.test(r)?r.replace(tee,"\\$&"):r}ree.exports=RSe});var L_e={};Nm(L_e,{activate:()=>R_e,deactivate:()=>A_e});module.exports=qD(L_e);u();u();Reflect.metadata===void 0&&u9();u();var gr=require("vscode");u();u();function Mv(){try{return(p9(),qD(d9)).isPreRelesVersionOfJupyterExtension===!0}catch(r){return!0}}var CE={isExiting:!1},GD="_builtin.JupyterServerSelectorForTesting",EO="_builtin.jupyterServerUrlProvider";var f9=!1;function m9(r){f9=r}function g9(){return f9}var h9=!1;function v9(r){h9=r}function xn(){return h9}var Je="python",DE="markdown",up="vscode-notebook-cell";var $D={language:Je};var zD="vscode-interactive-input",bt="jupyter-notebook",ht="interactive";var Zl="GitHub.codespaces",Ge="ms-toolsai.jupyter",y9="ms-toolsai.vscode-jupyter-powertoys",Ov="ms-toolsai.jupyter-hub",b9="0c6ae279ed8443289764825290e4f9e2-1a736e7c-1324-4338-be46-fc2a58ae4d14-7255",Lv="STANDARD_OUTPUT_CHANNEL",YD;(t=>(t.PythonInteractiveHelpLink="https://aka.ms/pyaiinstall",t.JupyterDataRateHelpLink="https://aka.ms/AA5ggm0"))(YD||(YD={}));var pi;(o=>(o.JupyterServerRemoteLaunchNameSeparator=`
`,o.JupyterServerRemoteLaunchService=Ge,o.JupyterServerUriListMax=10,o.IntellisenseTimeout=2e3,o.IntellisenseResolveTimeout=5e3))(pi||(pi={}));var ji=!1;var Ete=!1;function vn(){return Ete||PE()}var Cte=!1;function PE(){return Cte}var tt;(h=>(h.GeneratedThemeName="ipython-theme",h.MatplotLibDefaultParams="_VSCode_defaultMatplotlib_Params",h.MatplotLibFigureFormats="_VSCode_matplotLib_FigureFormats",h.DefaultCodeCellMarker="# %%",h.DefaultCommTarget="jupyter.widget",h.ALL_VARIABLES="ALL_VARIABLES",h.KERNEL_VARIABLES="KERNEL_VARIABLES",h.DEBUGGER_VARIABLES="DEBUGGER_VARIABLES",h.PYTHON_VARIABLES_REQUESTER="PYTHON_VARIABLES_REQUESTER",h.MULTIPLEXING_DEBUGSERVICE="MULTIPLEXING_DEBUGSERVICE",h.RUN_BY_LINE_DEBUGSERVICE="RUN_BY_LINE_DEBUGSERVICE",h.REMOTE_URI="https://remote/",h.REMOTE_URI_ID_PARAM="id",h.REMOTE_URI_HANDLE_PARAM="uriHandle",h.REMOTE_URI_EXTENSION_ID_PARAM="extensionId"))(tt||(tt={}));var wE;(n=>(n.ImportIPython=`{0}
from IPython import get_ipython

{1}`,n.MatplotLibInit=`import matplotlib
%matplotlib inline
${tt.MatplotLibDefaultParams} = dict(matplotlib.rcParams)
`,n.DisableJedi="%config Completer.use_jedi = False"))(wE||(wE={}));var I9="JUPYTER_OUTPUT_CHANNEL",CO="Default Light+",Qs="ms-python.python",Kv="ms-toolsai.jupyter-renderers",S9="ms-python.vscode-pylance",_9=["python","html","xml","javascript","markdown","latex","shellscript","bat","powershell","kusto","ruby","sql","perl","qsharp","raw"],E9=new Map([["bash","shellscript"],["c#","csharp"],["f#","fsharp"],["q#","qsharp"],["c++11","c++"],["c++12","c++"],["c++14","c++"]]),C9=["python","r","julia","c++","c#","f#","q#","powershell","java","scala","haskell","bash","cling","rust","sas","sos","ocaml"];var Q;(Ne=>(Ne.RunAllCells="jupyter.runallcells",Ne.RunAllCellsAbove="jupyter.runallcellsabove",Ne.RunCellAndAllBelow="jupyter.runcellandallbelow",Ne.RunAllCellsAbovePalette="jupyter.runallcellsabove.palette",Ne.RunCellAndAllBelowPalette="jupyter.runcurrentcellandallbelow.palette",Ne.RunToLine="jupyter.runtoline",Ne.RunFromLine="jupyter.runfromline",Ne.RunCell="jupyter.runcell",Ne.RunCurrentCell="jupyter.runcurrentcell",Ne.RunCurrentCellAdvance="jupyter.runcurrentcelladvance",Ne.CreateNewInteractive="jupyter.createnewinteractive",Ne.ImportNotebook="jupyter.importnotebook",Ne.ImportNotebookFile="jupyter.importnotebookfile",Ne.ExportFileAsNotebook="jupyter.exportfileasnotebook",Ne.ExportFileAndOutputAsNotebook="jupyter.exportfileandoutputasnotebook",Ne.InterruptKernel="jupyter.interruptkernel",Ne.RestartKernel="jupyter.restartkernel",Ne.RestartKernelAndRunAllCells="jupyter.restartkernelandrunallcells",Ne.RestartKernelAndRunUpToSelectedCell="jupyter.restartkernelandrunuptoselectedcell",Ne.NotebookEditorRemoveAllCells="jupyter.notebookeditor.removeallcells",Ne.NotebookEditorRunAllCells="jupyter.notebookeditor.runallcells",Ne.NotebookEditorRunSelectedCell="jupyter.notebookeditor.runselectedcell",Ne.NotebookEditorAddCellBelow="jupyter.notebookeditor.addcellbelow",Ne.ExpandAllCells="jupyter.expandallcells",Ne.CollapseAllCells="jupyter.collapseallcells",Ne.ExportOutputAsNotebook="jupyter.exportoutputasnotebook",Ne.ExecSelectionInInteractiveWindow="jupyter.execSelectionInteractive",Ne.RunFileInInteractiveWindows="jupyter.runFileInteractive",Ne.DebugFileInInteractiveWindows="jupyter.debugFileInteractive",Ne.AddCellBelow="jupyter.addcellbelow",Ne.DebugCurrentCellPalette="jupyter.debugcurrentcell.palette",Ne.DebugCell="jupyter.debugcell",Ne.DebugStepOver="jupyter.debugstepover",Ne.DebugContinue="jupyter.debugcontinue",Ne.DebugStop="jupyter.debugstop",Ne.RunCurrentCellAndAddBelow="jupyter.runcurrentcellandaddbelow",Ne.InsertCellBelowPosition="jupyter.insertCellBelowPosition",Ne.InsertCellBelow="jupyter.insertCellBelow",Ne.InsertCellAbove="jupyter.insertCellAbove",Ne.DeleteCells="jupyter.deleteCells",Ne.SelectCell="jupyter.selectCell",Ne.SelectCellContents="jupyter.selectCellContents",Ne.ExtendSelectionByCellAbove="jupyter.extendSelectionByCellAbove",Ne.ExtendSelectionByCellBelow="jupyter.extendSelectionByCellBelow",Ne.MoveCellsUp="jupyter.moveCellsUp",Ne.MoveCellsDown="jupyter.moveCellsDown",Ne.ChangeCellToMarkdown="jupyter.changeCellToMarkdown",Ne.ChangeCellToCode="jupyter.changeCellToCode",Ne.GotoNextCellInFile="jupyter.gotoNextCellInFile",Ne.GotoPrevCellInFile="jupyter.gotoPrevCellInFile",Ne.ScrollToCell="jupyter.scrolltocell",Ne.CreateNewNotebook="jupyter.createnewnotebook",Ne.ViewJupyterOutput="jupyter.viewOutput",Ne.ExportAsPythonScript="jupyter.exportAsPythonScript",Ne.ExportToHTML="jupyter.exportToHTML",Ne.ExportToPDF="jupyter.exportToPDF",Ne.Export="jupyter.export",Ne.NativeNotebookExport="jupyter.notebookeditor.export",Ne.LatestExtension="jupyter.latestExtension",Ne.EnableLoadingWidgetsFrom3rdPartySource="jupyter.enableLoadingWidgetScriptsFromThirdPartySource",Ne.ShowDataViewer="jupyter.showDataViewer",Ne.ShowJupyterDataViewer="jupyter.showJupyterDataViewer",Ne.RefreshDataViewer="jupyter.refreshDataViewer",Ne.ClearSavedJupyterUris="jupyter.clearSavedJupyterUris",Ne.OpenVariableView="jupyter.openVariableView",Ne.OpenOutlineView="jupyter.openOutlineView",Ne.InteractiveClearAll="jupyter.interactive.clearAllCells",Ne.InteractiveGoToCode="jupyter.interactive.goToCode",Ne.InteractiveCopyCell="jupyter.interactive.copyCell",Ne.InteractiveExportAsNotebook="jupyter.interactive.exportasnotebook",Ne.InteractiveExportAs="jupyter.interactive.exportas",Ne.RunByLine="jupyter.runByLine",Ne.RunAndDebugCell="jupyter.runAndDebugCell",Ne.RunByLineNext="jupyter.runByLineNext",Ne.RunByLineStop="jupyter.runByLineStop",Ne.ReplayPylanceLog="jupyter.replayPylanceLog",Ne.ReplayPylanceLogStep="jupyter.replayPylanceLogStep",Ne.InstallPythonExtensionViaKernelPicker="jupyter.installPythonExtensionViaKernelPicker",Ne.InstallPythonViaKernelPicker="jupyter.installPythonViaKernelPicker",Ne.ContinueEditSessionInCodespace="jupyter.continueEditSessionInCodespace"))(Q||(Q={}));var Nu;(n=>(n.DefaultDesignLenses=[Q.RunCurrentCell,Q.RunAllCellsAbove,Q.DebugCell],n.DefaultDebuggingLenses=[Q.DebugContinue,Q.DebugStop,Q.DebugStepOver],n.DebuggerCommands=[Q.DebugContinue,Q.DebugStop,Q.DebugStepOver]))(Nu||(Nu={}));var br;(j=>(j.HasCodeCells="jupyter.hascodecells",j.IsInteractiveActive="jupyter.isinteractiveactive",j.OwnsSelection="jupyter.ownsSelection",j.HaveNativeCells="jupyter.havenativecells",j.HaveNative="jupyter.havenative",j.IsNativeActive="jupyter.isnativeactive",j.IsInteractiveOrNativeActive="jupyter.isinteractiveornativeactive",j.IsPythonOrNativeActive="jupyter.ispythonornativeactive",j.IsPythonOrInteractiveActive="jupyter.ispythonorinteractiveeactive",j.IsPythonOrInteractiveOrNativeActive="jupyter.ispythonorinteractiveornativeeactive",j.CanRestartNotebookKernel="jupyter.notebookeditor.canrestartNotebookkernel",j.CanInterruptNotebookKernel="jupyter.notebookeditor.canInterruptNotebookKernel",j.CanRestartInteractiveWindowKernel="jupyter.interactive.canRestartNotebookKernel",j.CanInterruptInteractiveWindowKernel="jupyter.interactive.canInterruptNotebookKernel",j.RunByLineCells="jupyter.notebookeditor.runByLineCells",j.RunByLineDocuments="jupyter.notebookeditor.runByLineDocuments",j.DebugDocuments="jupyter.notebookeditor.debugDocuments",j.IsPythonNotebook="jupyter.ispythonnotebook",j.IsJupyterKernelSelected="jupyter.kernel.isjupyter",j.IsDataViewerActive="jupyter.dataViewerActive",j.HasNativeNotebookOrInteractiveWindowOpen="jupyter.hasNativeNotebookOrInteractiveWindowOpen",j.ZmqAvailable="jupyter.zmqavailable",j.ReplayLogLoaded="jupyter.replayLogLoaded",j.KernelSource="jupyter.kernelSource"))(br||(br={}));var xE;(l=>(l.PythonCellMarker=/^(#\s*%%|#\s*\<codecell\>|#\s*In\[\d*?\]|#\s*In\[ \])/,l.PythonMarkdownCellMarker=/^(#\s*%%\s*\[markdown\]|#\s*\<markdowncell\>)/,l.UrlPatternRegEx="(?<PREFIX>https?:\\/\\/)((\\(.+\\s+or\\s+(?<IP>.+)\\))|(?<LOCAL>[^\\s]+))(?<REST>:.+)",l.HttpPattern=/https?:\/\//,l.ShapeSplitterRegEx=/.*,\s*(\d+).*/,l.SvgHeightRegex=/(\<svg.*height=\")(.*?)\"/,l.SvgWidthRegex=/(\<svg.*width=\")(.*?)\"/,l.SvgSizeTagRegex=/\<svg.*tag=\"sizeTag=\{(.*),\s*(.*)\}\"/))(xE||(xE={}));var vxe=Symbol("DataScienceStartupTime"),wO={major:4,minor:2},go="application/vnd.jupyter.widget-view+json";var TE=7,QD="unknown";u();u();u();var wte=new Map;function w9(){return wte}u();u();u();var x9=Symbol("MicrotaskDelay");async function tc(r){return new Promise(e=>{setTimeout(()=>e(r),r)})}async function ZD(r,e,t){return new Promise(n=>{let i,o=setTimeout(()=>i(!1),e),s=setInterval(()=>{r().then(a=>{a&&i(!0)}).catch(a=>i(!1))},t);i=a=>{clearTimeout(o),clearInterval(s),n(a)}})}function ho(r,e,...t){let n=XD(e)?void 0:e;XD(e)&&t.push(e);let i,o=setTimeout(()=>i==null?void 0:i(n),r);return Promise.race([Promise.race(t).finally(()=>clearTimeout(o)),new Promise(s=>i=s)])}function Uv(r,e,...t){let n,i=setTimeout(()=>n==null?void 0:n(e),r);return Promise.race([Promise.race(t).finally(()=>clearTimeout(i)),new Promise((o,s)=>n=s)])}function Wv(r){return typeof(r==null?void 0:r.then)=="function"&&typeof(r==null?void 0:r.catch)=="function"}function XD(r){return typeof(r==null?void 0:r.then)=="function"}var xO=class{constructor(e=null){this.scope=e;this._resolved=!1;this._rejected=!1;this._promise=new Promise((t,n)=>{this._resolve=t,this._reject=n})}get value(){return this._value}resolve(e){this._value=e,this._resolve.apply(this.scope?this.scope:this,arguments),this._resolved=!0}reject(e){this._reject.apply(this.scope?this.scope:this,arguments),this._rejected=!0}get promise(){return this._promise}get resolved(){return this._resolved}get rejected(){return this._rejected}get completed(){return this._rejected||this._resolved}};function Te(r=null){return new xO(r)}function Ru(r){let e=Te();return r.then(e.resolve.bind(e)).catch(e.reject.bind(e)),e}var Fv=class{constructor(){this.currentPromise=Promise.resolve(void 0)}async chain(e){let t=Te(),n=this.currentPromise;return this.currentPromise=this.currentPromise.then(async()=>{try{let i=await e();t.resolve(i)}catch(i){throw t.reject(i),i}}),await n,t.promise}chainFinally(e){let t=Te();return this.currentPromise=this.currentPromise.finally(()=>e().then(n=>t.resolve(n)).catch(n=>t.reject(n))),t.promise}};var xte=(r,e)=>{let t=!0,n=setTimeout(()=>{t=!1,e()},r);return{isTriggered:()=>t,dispose:()=>{clearTimeout(n),t=!1}}},Dte=r=>{let e=!0;return queueMicrotask(()=>{e&&(e=!1,r())}),{isTriggered:()=>e,dispose:()=>{e=!1}}},ec=class{constructor(e){this.defaultDelay=e;this.deferred=null,this.completionPromise=null,this.doResolve=null,this.doReject=null,this.task=null}trigger(e,t=this.defaultDelay){this.task=e,this.cancelTimeout(),this.completionPromise||(this.completionPromise=new Promise((i,o)=>{this.doResolve=i,this.doReject=o}).then(()=>{if(this.completionPromise=null,this.doResolve=null,this.task){let i=this.task;return this.task=null,i()}}),this.completionPromise.catch(y));let n=()=>{var i;this.deferred=null,(i=this.doResolve)==null||i.call(this,null)};return this.deferred=t===x9?Dte(n):xte(t,n),this.completionPromise}isTriggered(){var e;return!!((e=this.deferred)!=null&&e.isTriggered())}cancel(){var e;this.cancelTimeout(),this.completionPromise&&((e=this.doReject)==null||e.call(this,new Error("Canceled")),this.completionPromise=null)}cancelTimeout(){var e;(e=this.deferred)==null||e.dispose(),this.deferred=null}dispose(){this.cancel()}};function y(){}function Xs(r){try{let e=r();Wv(e)&&e.catch(y)}catch(e){}}function Dn(r){if(!r)return!1;let e=r;return typeof e.path=="string"&&typeof e.scheme=="string"}function P9(r){let e=Dn(r)?r:r.uri;return e.scheme.includes(up)||e.path.endsWith(".interactive")}function dp(){return process.platform.toString()==="web"}function D9(r,e){return Dn(e)?e.toString():e}function T9(r,e){return r===e?!0:r&&!e||!r&&e?!1:JSON.stringify(r,D9)===JSON.stringify(e,D9)}u();var It=class{constructor(){this.started=Date.now()}get elapsedTime(){return Date.now()-this.started}reset(){this.started=Date.now()}};var Jxe=w9();function yn(r){return function(e,t,n){let i=n.value,o=`Jupyter Extension (Error in ${r||t}, method:${t}):`;n.value=function(...s){try{let a=i.apply(this,s);if(a&&typeof a.then=="function"&&typeof a.catch=="function")return a.catch(l=>{vn()||b.error(o,l)})}catch(a){if(vn())return;b.error(o,a)}}}}function Pte(r,e,t){let n=new It;try{t&&r(void 0);let i=e();return Wv(i)?i.then(o=>(r({elapsed:n.elapsedTime,returnValue:o}),o)).catch(o=>{r({elapsed:n.elapsedTime,err:o})}):r({elapsed:n.elapsedTime,returnValue:i}),i}catch(i){throw r({elapsed:n.elapsedTime,err:i}),i}}function k9(r,e){return function(t,n,i){let o=i.value;return i.value=function(...s){let a={kind:"Class",name:t&&t.constructor?t.constructor.name:"",args:s,methodName:n,target:t},l=this;return Pte(c=>r(a,c),()=>o.apply(l,s),e)},i}}function Vv(){return function(r,e,t){let n=t.value;return t.value=function(...i){if(!vn())throw new Error(`Function: ${e} can only be called from test code`);return n.apply(this,i)},t}}function DO(){return function(r,e,t){let n=t.value,i=`chainedPromiseFor_${e}`;return t.value=async function(...o){let s=this[i];s?s=s.then(()=>n.apply(this,o)):s=n.apply(this,o),this[i]=s;let a=s.then(l=>l).catch(l=>{throw this[i]=void 0,l});return a.catch(y),a},t}}u();function PO(r,e){if(Array.isArray(r))return r.map(t=>PO(t,e)).join(", ");if(r===void 0)return"undefined";if(r===null)return"null";try{return r&&r.path?`<Uri:${r.path}>`:JSON.stringify(r)}catch(t){return`<${e} cannot be serialized for logging>`}}function TO(r){if(!r)return"";try{return r.map((t,n)=>{let i=PO(t,"argument");return`Arg ${n+1}: ${i}`}).join(", ")}catch(e){return""}}function N9(r){return`Return Value: ${PO(r,"Return value")}`}function eP(){let r=new Date,e=String(r.getHours()).padStart(2,"0"),t=String(r.getMinutes()).padStart(2,"0"),n=String(r.getSeconds()).padStart(2,"0"),i=String(r.getMilliseconds()).padStart(3,"0");return`${e}:${t}:${n}.${i}`}u();function st(r,e={removeEmptyEntries:!0,trim:!0}){r=r||"";let t=r.split(/\r?\n/g);return e&&e.trim&&(t=t.map(n=>n.trim())),e&&e.removeEmptyEntries&&(t=t.filter(n=>n.length>0)),t}function Tte(r){return r&&(r.indexOf(" ")>=0&&!r.startsWith('"')&&!r.endsWith('"')?`"${r}"`:r.toString())}function kO(r){return r&&Tte(r).replace(/\\/g,"/")}function kE(r){return r&&r.replace(/(^['"])|(['"]$)/g,"")}function jv(r){return r?r.replace(/\$\([a-z0-9\-]+?\)/gi,"").trim():r||""}function Bv(r){let e=r.split(`
`),t=e.find(n=>n.trim().length>0&&!n.trim().startsWith("#"));if(t){let n=t.match(/^\s*/)[0];return e.map(i=>i.startsWith(n)?i.replace(n,""):i).join(`
`)}return r}u();var UO=require("vscode");u();u();u();var rP="en",iP=!1,oP=!1,NE=!1,kte=!1,Nte=!1,RO=!1,Rte=!1,Ate=!1,Mte=!1,tP,nP=rP,Ote,fp,Zs=typeof self=="object"?self:{},Kn;typeof Zs.vscode!="undefined"&&typeof Zs.vscode.process!="undefined"?Kn=Zs.vscode.process:typeof process!="undefined"&&(Kn=process);var A9,M9=typeof((A9=Kn==null?void 0:Kn.versions)==null?void 0:A9.electron)=="string",O9=M9&&(Kn==null?void 0:Kn.type)==="renderer",Xxe=O9&&(Kn==null?void 0:Kn.sandboxed);if(typeof navigator=="object"&&!O9)fp=navigator.userAgent,iP=fp.indexOf("Windows")>=0,oP=fp.indexOf("Macintosh")>=0,Ate=(fp.indexOf("Macintosh")>=0||fp.indexOf("iPad")>=0||fp.indexOf("iPhone")>=0)&&!!navigator.maxTouchPoints&&navigator.maxTouchPoints>0,NE=fp.indexOf("Linux")>=0,RO=!0,tP=navigator.language,nP=tP;else if(typeof Kn=="object"){iP=Kn.platform==="win32",oP=Kn.platform==="darwin",NE=Kn.platform==="linux",kte=NE&&!!Kn.env.SNAP&&!!Kn.env.SNAP_REVISION,Rte=M9,Mte=!!Kn.env.CI||!!Kn.env.BUILD_ARTIFACTSTAGINGDIRECTORY,tP=rP,nP=rP;let r=Kn.env.VSCODE_NLS_CONFIG;if(r)try{let e=JSON.parse(r),t=e.availableLanguages["*"];tP=e.locale,nP=t||rP,Ote=e._translationsConfigFile}catch(e){}Nte=!0}else console.error("Unable to resolve platform.");var NO=0;oP?NO=1:iP?NO=3:NE&&(NO=2);var RE=iP,L9=oP,K9=NE;var sP=RO,Zxe=RO&&typeof Zs.importScripts=="function";var rc=fp,pp=nP,R9;(n=>{function r(){return pp}n.value=r;function e(){return pp.length===2?pp==="en":pp.length>=3?pp[0]==="e"&&pp[1]==="n"&&pp[2]==="-":!1}n.isDefaultVariant=e;function t(){return pp==="en"}n.isDefault=t})(R9||(R9={}));var eDe=(()=>{if(typeof Zs.postMessage=="function"&&!Zs.importScripts){let r=[];Zs.addEventListener("message",t=>{if(t.data&&t.data.vscodeScheduleAsyncWork)for(let n=0,i=r.length;n<i;n++){let o=r[n];if(o.id===t.data.vscodeScheduleAsyncWork){r.splice(n,1),o.callback();return}}});let e=0;return t=>{let n=++e;r.push({id:n,callback:t}),Zs.postMessage({vscodeScheduleAsyncWork:n},"*")}}return r=>setTimeout(r)})();var Lte=!!(rc&&rc.indexOf("Chrome")>=0),tDe=!!(rc&&rc.indexOf("Firefox")>=0),rDe=!!(!Lte&&rc&&rc.indexOf("Safari")>=0),nDe=!!(rc&&rc.indexOf("Edg/")>=0),iDe=!!(rc&&rc.indexOf("Android")>=0);var Rm;if(typeof Zs.vscode!="undefined"&&typeof Zs.vscode.process!="undefined"){let r=Zs.vscode.process;Rm={get platform(){return r.platform},get arch(){return r.arch},get env(){return r.env},cwd(){return r.cwd()}}}else typeof process!="undefined"?Rm={get platform(){return process.platform},get arch(){return process.arch},get env(){return process.env},cwd(){return process.env.VSCODE_CWD||process.cwd()}}:Rm={get platform(){return RE?"win32":L9?"darwin":"linux"},get arch(){},get env(){return{}},cwd(){return"/"}};var aP=Rm.cwd,F9=Rm.env,Uo=Rm.platform,cDe=Rm.arch;var Fte=65,Ute=97,Wte=90,Vte=122,hp=46,fi=47,Wo=92,mp=58,jte=63,lP=class extends Error{constructor(t,n,i){let o;typeof n=="string"&&n.indexOf("not ")===0?(o="must not be",n=n.replace(/^not /,"")):o="must be";let s=t.indexOf(".")!==-1?"property":"argument",a=`The "${t}" ${s} ${o} of type ${n}`;a+=`. Received type ${typeof i}`;super(a);this.code="ERR_INVALID_ARG_TYPE"}};function bn(r,e){if(typeof r!="string")throw new lP(e,"string",r)}function xt(r){return r===fi||r===Wo}function AO(r){return r===fi}function gp(r){return r>=Fte&&r<=Wte||r>=Ute&&r<=Vte}function cP(r,e,t,n){let i="",o=0,s=-1,a=0,l=0;for(let c=0;c<=r.length;++c){if(c<r.length)l=r.charCodeAt(c);else{if(n(l))break;l=fi}if(n(l)){if(!(s===c-1||a===1))if(a===2){if(i.length<2||o!==2||i.charCodeAt(i.length-1)!==hp||i.charCodeAt(i.length-2)!==hp){if(i.length>2){let d=i.lastIndexOf(t);d===-1?(i="",o=0):(i=i.slice(0,d),o=i.length-1-i.lastIndexOf(t)),s=c,a=0;continue}else if(i.length!==0){i="",o=0,s=c,a=0;continue}}e&&(i+=i.length>0?`${t}..`:"..",o=2)}else i.length>0?i+=`${t}${r.slice(s+1,c)}`:i=r.slice(s+1,c),o=c-s-1;s=c,a=0}else l===hp&&a!==-1?++a:a=-1}return i}function U9(r,e){if(e===null||typeof e!="object")throw new lP("pathObject","Object",e);let t=e.dir||e.root,n=e.base||`${e.name||""}${e.ext||""}`;return t?t===e.root?`${t}${n}`:`${t}${r}${n}`:n}var Fn={resolve(...r){let e="",t="",n=!1;for(let i=r.length-1;i>=-1;i--){let o;if(i>=0){if(o=r[i],bn(o,"path"),o.length===0)continue}else e.length===0?o=aP():(o=F9[`=${e}`]||aP(),(o===void 0||o.slice(0,2).toLowerCase()!==e.toLowerCase()&&o.charCodeAt(2)===Wo)&&(o=`${e}\\`));let s=o.length,a=0,l="",c=!1,d=o.charCodeAt(0);if(s===1)xt(d)&&(a=1,c=!0);else if(xt(d))if(c=!0,xt(o.charCodeAt(1))){let p=2,f=p;for(;p<s&&!xt(o.charCodeAt(p));)p++;if(p<s&&p!==f){let m=o.slice(f,p);for(f=p;p<s&&xt(o.charCodeAt(p));)p++;if(p<s&&p!==f){for(f=p;p<s&&!xt(o.charCodeAt(p));)p++;(p===s||p!==f)&&(l=`\\\\${m}\\${o.slice(f,p)}`,a=p)}}}else a=1;else gp(d)&&o.charCodeAt(1)===mp&&(l=o.slice(0,2),a=2,s>2&&xt(o.charCodeAt(2))&&(c=!0,a=3));if(l.length>0)if(e.length>0){if(l.toLowerCase()!==e.toLowerCase())continue}else e=l;if(n){if(e.length>0)break}else if(t=`${o.slice(a)}\\${t}`,n=c,c&&e.length>0)break}return t=cP(t,!n,"\\",xt),n?`${e}\\${t}`:`${e}${t}`||"."},normalize(r){bn(r,"path");let e=r.length;if(e===0)return".";let t=0,n,i=!1,o=r.charCodeAt(0);if(e===1)return AO(o)?"\\":r;if(xt(o))if(i=!0,xt(r.charCodeAt(1))){let a=2,l=a;for(;a<e&&!xt(r.charCodeAt(a));)a++;if(a<e&&a!==l){let c=r.slice(l,a);for(l=a;a<e&&xt(r.charCodeAt(a));)a++;if(a<e&&a!==l){for(l=a;a<e&&!xt(r.charCodeAt(a));)a++;if(a===e)return`\\\\${c}\\${r.slice(l)}\\`;a!==l&&(n=`\\\\${c}\\${r.slice(l,a)}`,t=a)}}}else t=1;else gp(o)&&r.charCodeAt(1)===mp&&(n=r.slice(0,2),t=2,e>2&&xt(r.charCodeAt(2))&&(i=!0,t=3));let s=t<e?cP(r.slice(t),!i,"\\",xt):"";return s.length===0&&!i&&(s="."),s.length>0&&xt(r.charCodeAt(e-1))&&(s+="\\"),n===void 0?i?`\\${s}`:s:i?`${n}\\${s}`:`${n}${s}`},isAbsolute(r){bn(r,"path");let e=r.length;if(e===0)return!1;let t=r.charCodeAt(0);return xt(t)||e>2&&gp(t)&&r.charCodeAt(1)===mp&&xt(r.charCodeAt(2))},join(...r){if(r.length===0)return".";let e,t;for(let o=0;o<r.length;++o){let s=r[o];bn(s,"path"),s.length>0&&(e===void 0?e=t=s:e+=`\\${s}`)}if(e===void 0)return".";let n=!0,i=0;if(typeof t=="string"&&xt(t.charCodeAt(0))){++i;let o=t.length;o>1&&xt(t.charCodeAt(1))&&(++i,o>2&&(xt(t.charCodeAt(2))?++i:n=!1))}if(n){for(;i<e.length&&xt(e.charCodeAt(i));)i++;i>=2&&(e=`\\${e.slice(i)}`)}return Fn.normalize(e)},relative(r,e){if(bn(r,"from"),bn(e,"to"),r===e)return"";let t=Fn.resolve(r),n=Fn.resolve(e);if(t===n||(r=t.toLowerCase(),e=n.toLowerCase(),r===e))return"";let i=0;for(;i<r.length&&r.charCodeAt(i)===Wo;)i++;let o=r.length;for(;o-1>i&&r.charCodeAt(o-1)===Wo;)o--;let s=o-i,a=0;for(;a<e.length&&e.charCodeAt(a)===Wo;)a++;let l=e.length;for(;l-1>a&&e.charCodeAt(l-1)===Wo;)l--;let c=l-a,d=s<c?s:c,p=-1,f=0;for(;f<d;f++){let g=r.charCodeAt(i+f);if(g!==e.charCodeAt(a+f))break;g===Wo&&(p=f)}if(f!==d){if(p===-1)return n}else{if(c>d){if(e.charCodeAt(a+f)===Wo)return n.slice(a+f+1);if(f===2)return n.slice(a+f)}s>d&&(r.charCodeAt(i+f)===Wo?p=f:f===2&&(p=3)),p===-1&&(p=0)}let m="";for(f=i+p+1;f<=o;++f)(f===o||r.charCodeAt(f)===Wo)&&(m+=m.length===0?"..":"\\..");return a+=p,m.length>0?`${m}${n.slice(a,l)}`:(n.charCodeAt(a)===Wo&&++a,n.slice(a,l))},toNamespacedPath(r){if(typeof r!="string")return r;if(r.length===0)return"";let e=Fn.resolve(r);if(e.length<=2)return r;if(e.charCodeAt(0)===Wo){if(e.charCodeAt(1)===Wo){let t=e.charCodeAt(2);if(t!==jte&&t!==hp)return`\\\\?\\UNC\\${e.slice(2)}`}}else if(gp(e.charCodeAt(0))&&e.charCodeAt(1)===mp&&e.charCodeAt(2)===Wo)return`\\\\?\\${e}`;return r},dirname(r){bn(r,"path");let e=r.length;if(e===0)return".";let t=-1,n=0,i=r.charCodeAt(0);if(e===1)return xt(i)?r:".";if(xt(i)){if(t=n=1,xt(r.charCodeAt(1))){let a=2,l=a;for(;a<e&&!xt(r.charCodeAt(a));)a++;if(a<e&&a!==l){for(l=a;a<e&&xt(r.charCodeAt(a));)a++;if(a<e&&a!==l){for(l=a;a<e&&!xt(r.charCodeAt(a));)a++;if(a===e)return r;a!==l&&(t=n=a+1)}}}}else gp(i)&&r.charCodeAt(1)===mp&&(t=e>2&&xt(r.charCodeAt(2))?3:2,n=t);let o=-1,s=!0;for(let a=e-1;a>=n;--a)if(xt(r.charCodeAt(a))){if(!s){o=a;break}}else s=!1;if(o===-1){if(t===-1)return".";o=t}return r.slice(0,o)},basename(r,e){e!==void 0&&bn(e,"ext"),bn(r,"path");let t=0,n=-1,i=!0,o;if(r.length>=2&&gp(r.charCodeAt(0))&&r.charCodeAt(1)===mp&&(t=2),e!==void 0&&e.length>0&&e.length<=r.length){if(e===r)return"";let s=e.length-1,a=-1;for(o=r.length-1;o>=t;--o){let l=r.charCodeAt(o);if(xt(l)){if(!i){t=o+1;break}}else a===-1&&(i=!1,a=o+1),s>=0&&(l===e.charCodeAt(s)?--s===-1&&(n=o):(s=-1,n=a))}return t===n?n=a:n===-1&&(n=r.length),r.slice(t,n)}for(o=r.length-1;o>=t;--o)if(xt(r.charCodeAt(o))){if(!i){t=o+1;break}}else n===-1&&(i=!1,n=o+1);return n===-1?"":r.slice(t,n)},extname(r){bn(r,"path");let e=0,t=-1,n=0,i=-1,o=!0,s=0;r.length>=2&&r.charCodeAt(1)===mp&&gp(r.charCodeAt(0))&&(e=n=2);for(let a=r.length-1;a>=e;--a){let l=r.charCodeAt(a);if(xt(l)){if(!o){n=a+1;break}continue}i===-1&&(o=!1,i=a+1),l===hp?t===-1?t=a:s!==1&&(s=1):t!==-1&&(s=-1)}return t===-1||i===-1||s===0||s===1&&t===i-1&&t===n+1?"":r.slice(t,i)},format:U9.bind(null,"\\"),parse(r){bn(r,"path");let e={root:"",dir:"",base:"",ext:"",name:""};if(r.length===0)return e;let t=r.length,n=0,i=r.charCodeAt(0);if(t===1)return xt(i)?(e.root=e.dir=r,e):(e.base=e.name=r,e);if(xt(i)){if(n=1,xt(r.charCodeAt(1))){let p=2,f=p;for(;p<t&&!xt(r.charCodeAt(p));)p++;if(p<t&&p!==f){for(f=p;p<t&&xt(r.charCodeAt(p));)p++;if(p<t&&p!==f){for(f=p;p<t&&!xt(r.charCodeAt(p));)p++;p===t?n=p:p!==f&&(n=p+1)}}}}else if(gp(i)&&r.charCodeAt(1)===mp){if(t<=2)return e.root=e.dir=r,e;if(n=2,xt(r.charCodeAt(2))){if(t===3)return e.root=e.dir=r,e;n=3}}n>0&&(e.root=r.slice(0,n));let o=-1,s=n,a=-1,l=!0,c=r.length-1,d=0;for(;c>=n;--c){if(i=r.charCodeAt(c),xt(i)){if(!l){s=c+1;break}continue}a===-1&&(l=!1,a=c+1),i===hp?o===-1?o=c:d!==1&&(d=1):o!==-1&&(d=-1)}return a!==-1&&(o===-1||d===0||d===1&&o===a-1&&o===s+1?e.base=e.name=r.slice(s,a):(e.name=r.slice(s,o),e.base=r.slice(s,a),e.ext=r.slice(o,a))),s>0&&s!==n?e.dir=r.slice(0,s-1):e.dir=e.root,e},sep:"\\",delimiter:";",win32:null,posix:null},_r={resolve(...r){let e="",t=!1;for(let n=r.length-1;n>=-1&&!t;n--){let i=n>=0?r[n]:aP();bn(i,"path"),i.length!==0&&(e=`${i}/${e}`,t=i.charCodeAt(0)===fi)}return e=cP(e,!t,"/",AO),t?`/${e}`:e.length>0?e:"."},normalize(r){if(bn(r,"path"),r.length===0)return".";let e=r.charCodeAt(0)===fi,t=r.charCodeAt(r.length-1)===fi;return r=cP(r,!e,"/",AO),r.length===0?e?"/":t?"./":".":(t&&(r+="/"),e?`/${r}`:r)},isAbsolute(r){return bn(r,"path"),r.length>0&&r.charCodeAt(0)===fi},join(...r){if(r.length===0)return".";let e;for(let t=0;t<r.length;++t){let n=r[t];bn(n,"path"),n.length>0&&(e===void 0?e=n:e+=`/${n}`)}return e===void 0?".":_r.normalize(e)},relative(r,e){if(bn(r,"from"),bn(e,"to"),r===e||(r=_r.resolve(r),e=_r.resolve(e),r===e))return"";let t=1,n=r.length,i=n-t,o=1,s=e.length-o,a=i<s?i:s,l=-1,c=0;for(;c<a;c++){let p=r.charCodeAt(t+c);if(p!==e.charCodeAt(o+c))break;p===fi&&(l=c)}if(c===a)if(s>a){if(e.charCodeAt(o+c)===fi)return e.slice(o+c+1);if(c===0)return e.slice(o+c)}else i>a&&(r.charCodeAt(t+c)===fi?l=c:c===0&&(l=0));let d="";for(c=t+l+1;c<=n;++c)(c===n||r.charCodeAt(c)===fi)&&(d+=d.length===0?"..":"/..");return`${d}${e.slice(o+l)}`},toNamespacedPath(r){return r},dirname(r){if(bn(r,"path"),r.length===0)return".";let e=r.charCodeAt(0)===fi,t=-1,n=!0;for(let i=r.length-1;i>=1;--i)if(r.charCodeAt(i)===fi){if(!n){t=i;break}}else n=!1;return t===-1?e?"/":".":e&&t===1?"//":r.slice(0,t)},basename(r,e){e!==void 0&&bn(e,"ext"),bn(r,"path");let t=0,n=-1,i=!0,o;if(e!==void 0&&e.length>0&&e.length<=r.length){if(e===r)return"";let s=e.length-1,a=-1;for(o=r.length-1;o>=0;--o){let l=r.charCodeAt(o);if(l===fi){if(!i){t=o+1;break}}else a===-1&&(i=!1,a=o+1),s>=0&&(l===e.charCodeAt(s)?--s===-1&&(n=o):(s=-1,n=a))}return t===n?n=a:n===-1&&(n=r.length),r.slice(t,n)}for(o=r.length-1;o>=0;--o)if(r.charCodeAt(o)===fi){if(!i){t=o+1;break}}else n===-1&&(i=!1,n=o+1);return n===-1?"":r.slice(t,n)},extname(r){bn(r,"path");let e=-1,t=0,n=-1,i=!0,o=0;for(let s=r.length-1;s>=0;--s){let a=r.charCodeAt(s);if(a===fi){if(!i){t=s+1;break}continue}n===-1&&(i=!1,n=s+1),a===hp?e===-1?e=s:o!==1&&(o=1):e!==-1&&(o=-1)}return e===-1||n===-1||o===0||o===1&&e===n-1&&e===t+1?"":r.slice(e,n)},format:U9.bind(null,"/"),parse(r){bn(r,"path");let e={root:"",dir:"",base:"",ext:"",name:""};if(r.length===0)return e;let t=r.charCodeAt(0)===fi,n;t?(e.root="/",n=1):n=0;let i=-1,o=0,s=-1,a=!0,l=r.length-1,c=0;for(;l>=n;--l){let d=r.charCodeAt(l);if(d===fi){if(!a){o=l+1;break}continue}s===-1&&(a=!1,s=l+1),d===hp?i===-1?i=l:c!==1&&(c=1):i!==-1&&(c=-1)}if(s!==-1){let d=o===0&&t?1:o;i===-1||c===0||c===1&&i===s-1&&i===o+1?e.base=e.name=r.slice(d,s):(e.name=r.slice(d,i),e.base=r.slice(d,s),e.ext=r.slice(i,s))}return o>0?e.dir=r.slice(0,o-1):t&&(e.dir="/"),e},sep:"/",delimiter:":",win32:null,posix:null};_r.win32=Fn.win32=Fn;_r.posix=Fn.posix=_r;var Ss=Uo==="win32"?Fn.normalize:_r.normalize,dDe=Uo==="win32"?Fn.isAbsolute:_r.isAbsolute,AE=Uo==="win32"?Fn.join:_r.join,W9=Uo==="win32"?Fn.resolve:_r.resolve,V9=Uo==="win32"?Fn.relative:_r.relative,Di=Uo==="win32"?Fn.dirname:_r.dirname,tr=Uo==="win32"?Fn.basename:_r.basename,vp=Uo==="win32"?Fn.extname:_r.extname,pDe=Uo==="win32"?Fn.format:_r.format,fDe=Uo==="win32"?Fn.parse:_r.parse,mDe=Uo==="win32"?Fn.toNamespacedPath:_r.toNamespacedPath,Bi=Uo==="win32"?Fn.sep:_r.sep,gDe=Uo==="win32"?Fn.delimiter:_r.delimiter;u();var OE=require("vscode");u();u();u();u();var Bte=require("vscode");var uP=class{constructor(e){this.computeFn=e;this.lastCache=void 0;this.lastArgKey=void 0}get(e){let t=JSON.stringify(e);return this.lastArgKey!==t&&(this.lastArgKey=t,this.lastCache=this.computeFn(e)),this.lastCache}};u();var ME=class r{constructor(e){this.executor=e;this._didRun=!1}hasValue(){return this._didRun}getValue(){if(!this._didRun)try{this._value=this.executor()}catch(e){this._error=e}finally{this._didRun=!0}if(this._error)throw this._error;return this._value}get rawValue(){return this._value}map(e){return new r(()=>e(this.getValue()))}};function q9(r,e){return r<e?-1:r>e?1:0}function Hte(r,e,t=0,n=r.length,i=0,o=e.length){for(;t<n&&i<o;t++,i++){let l=r.charCodeAt(t),c=e.charCodeAt(i);if(l<c)return-1;if(l>c)return 1}let s=n-t,a=o-i;return s<a?-1:s>a?1:0}function G9(r,e,t=0,n=r.length,i=0,o=e.length){for(;t<n&&i<o;t++,i++){let l=r.charCodeAt(t),c=e.charCodeAt(i);if(l===c)continue;if(l>=128||c>=128)return Hte(r.toLowerCase(),e.toLowerCase(),t,n,i,o);j9(l)&&(l-=32),j9(c)&&(c-=32);let d=l-c;if(d!==0)return d}let s=n-t,a=o-i;return s<a?-1:s>a?1:0}function j9(r){return r>=97&&r<=122}function Y9(r,e){return r.length===e.length&&G9(r,e)===0}function $9(r,e){let t=e.length;return e.length>r.length?!1:G9(r,e,0,t)===0}var nc=class nc{constructor(e){this.confusableDictionary=e}static getInstance(e){return nc.cache.get(Array.from(e))}static getLocales(){return nc._locales.getValue()}isAmbiguous(e){return this.confusableDictionary.has(e)}getPrimaryConfusable(e){return this.confusableDictionary.get(e)}getConfusableCodePoints(){return new Set(this.confusableDictionary.keys())}};nc.ambiguousCharacterData=new ME(()=>JSON.parse('{"_common":[8232,32,8233,32,5760,32,8192,32,8193,32,8194,32,8195,32,8196,32,8197,32,8198,32,8200,32,8201,32,8202,32,8287,32,8199,32,8239,32,2042,95,65101,95,65102,95,65103,95,8208,45,8209,45,8210,45,65112,45,1748,45,8259,45,727,45,8722,45,10134,45,11450,45,1549,44,1643,44,8218,44,184,44,42233,44,894,59,2307,58,2691,58,1417,58,1795,58,1796,58,5868,58,65072,58,6147,58,6153,58,8282,58,1475,58,760,58,42889,58,8758,58,720,58,42237,58,451,33,11601,33,660,63,577,63,2429,63,5038,63,42731,63,119149,46,8228,46,1793,46,1794,46,42510,46,68176,46,1632,46,1776,46,42232,46,1373,96,65287,96,8219,96,8242,96,1370,96,1523,96,8175,96,65344,96,900,96,8189,96,8125,96,8127,96,8190,96,697,96,884,96,712,96,714,96,715,96,756,96,699,96,701,96,700,96,702,96,42892,96,1497,96,2036,96,2037,96,5194,96,5836,96,94033,96,94034,96,65339,91,10088,40,10098,40,12308,40,64830,40,65341,93,10089,41,10099,41,12309,41,64831,41,10100,123,119060,123,10101,125,65342,94,8270,42,1645,42,8727,42,66335,42,5941,47,8257,47,8725,47,8260,47,9585,47,10187,47,10744,47,119354,47,12755,47,12339,47,11462,47,20031,47,12035,47,65340,92,65128,92,8726,92,10189,92,10741,92,10745,92,119311,92,119355,92,12756,92,20022,92,12034,92,42872,38,708,94,710,94,5869,43,10133,43,66203,43,8249,60,10094,60,706,60,119350,60,5176,60,5810,60,5120,61,11840,61,12448,61,42239,61,8250,62,10095,62,707,62,119351,62,5171,62,94015,62,8275,126,732,126,8128,126,8764,126,65372,124,65293,45,120784,50,120794,50,120804,50,120814,50,120824,50,130034,50,42842,50,423,50,1000,50,42564,50,5311,50,42735,50,119302,51,120785,51,120795,51,120805,51,120815,51,120825,51,130035,51,42923,51,540,51,439,51,42858,51,11468,51,1248,51,94011,51,71882,51,120786,52,120796,52,120806,52,120816,52,120826,52,130036,52,5070,52,71855,52,120787,53,120797,53,120807,53,120817,53,120827,53,130037,53,444,53,71867,53,120788,54,120798,54,120808,54,120818,54,120828,54,130038,54,11474,54,5102,54,71893,54,119314,55,120789,55,120799,55,120809,55,120819,55,120829,55,130039,55,66770,55,71878,55,2819,56,2538,56,2666,56,125131,56,120790,56,120800,56,120810,56,120820,56,120830,56,130040,56,547,56,546,56,66330,56,2663,57,2920,57,2541,57,3437,57,120791,57,120801,57,120811,57,120821,57,120831,57,130041,57,42862,57,11466,57,71884,57,71852,57,71894,57,9082,97,65345,97,119834,97,119886,97,119938,97,119990,97,120042,97,120094,97,120146,97,120198,97,120250,97,120302,97,120354,97,120406,97,120458,97,593,97,945,97,120514,97,120572,97,120630,97,120688,97,120746,97,65313,65,119808,65,119860,65,119912,65,119964,65,120016,65,120068,65,120120,65,120172,65,120224,65,120276,65,120328,65,120380,65,120432,65,913,65,120488,65,120546,65,120604,65,120662,65,120720,65,5034,65,5573,65,42222,65,94016,65,66208,65,119835,98,119887,98,119939,98,119991,98,120043,98,120095,98,120147,98,120199,98,120251,98,120303,98,120355,98,120407,98,120459,98,388,98,5071,98,5234,98,5551,98,65314,66,8492,66,119809,66,119861,66,119913,66,120017,66,120069,66,120121,66,120173,66,120225,66,120277,66,120329,66,120381,66,120433,66,42932,66,914,66,120489,66,120547,66,120605,66,120663,66,120721,66,5108,66,5623,66,42192,66,66178,66,66209,66,66305,66,65347,99,8573,99,119836,99,119888,99,119940,99,119992,99,120044,99,120096,99,120148,99,120200,99,120252,99,120304,99,120356,99,120408,99,120460,99,7428,99,1010,99,11429,99,43951,99,66621,99,128844,67,71922,67,71913,67,65315,67,8557,67,8450,67,8493,67,119810,67,119862,67,119914,67,119966,67,120018,67,120174,67,120226,67,120278,67,120330,67,120382,67,120434,67,1017,67,11428,67,5087,67,42202,67,66210,67,66306,67,66581,67,66844,67,8574,100,8518,100,119837,100,119889,100,119941,100,119993,100,120045,100,120097,100,120149,100,120201,100,120253,100,120305,100,120357,100,120409,100,120461,100,1281,100,5095,100,5231,100,42194,100,8558,68,8517,68,119811,68,119863,68,119915,68,119967,68,120019,68,120071,68,120123,68,120175,68,120227,68,120279,68,120331,68,120383,68,120435,68,5024,68,5598,68,5610,68,42195,68,8494,101,65349,101,8495,101,8519,101,119838,101,119890,101,119942,101,120046,101,120098,101,120150,101,120202,101,120254,101,120306,101,120358,101,120410,101,120462,101,43826,101,1213,101,8959,69,65317,69,8496,69,119812,69,119864,69,119916,69,120020,69,120072,69,120124,69,120176,69,120228,69,120280,69,120332,69,120384,69,120436,69,917,69,120492,69,120550,69,120608,69,120666,69,120724,69,11577,69,5036,69,42224,69,71846,69,71854,69,66182,69,119839,102,119891,102,119943,102,119995,102,120047,102,120099,102,120151,102,120203,102,120255,102,120307,102,120359,102,120411,102,120463,102,43829,102,42905,102,383,102,7837,102,1412,102,119315,70,8497,70,119813,70,119865,70,119917,70,120021,70,120073,70,120125,70,120177,70,120229,70,120281,70,120333,70,120385,70,120437,70,42904,70,988,70,120778,70,5556,70,42205,70,71874,70,71842,70,66183,70,66213,70,66853,70,65351,103,8458,103,119840,103,119892,103,119944,103,120048,103,120100,103,120152,103,120204,103,120256,103,120308,103,120360,103,120412,103,120464,103,609,103,7555,103,397,103,1409,103,119814,71,119866,71,119918,71,119970,71,120022,71,120074,71,120126,71,120178,71,120230,71,120282,71,120334,71,120386,71,120438,71,1292,71,5056,71,5107,71,42198,71,65352,104,8462,104,119841,104,119945,104,119997,104,120049,104,120101,104,120153,104,120205,104,120257,104,120309,104,120361,104,120413,104,120465,104,1211,104,1392,104,5058,104,65320,72,8459,72,8460,72,8461,72,119815,72,119867,72,119919,72,120023,72,120179,72,120231,72,120283,72,120335,72,120387,72,120439,72,919,72,120494,72,120552,72,120610,72,120668,72,120726,72,11406,72,5051,72,5500,72,42215,72,66255,72,731,105,9075,105,65353,105,8560,105,8505,105,8520,105,119842,105,119894,105,119946,105,119998,105,120050,105,120102,105,120154,105,120206,105,120258,105,120310,105,120362,105,120414,105,120466,105,120484,105,618,105,617,105,953,105,8126,105,890,105,120522,105,120580,105,120638,105,120696,105,120754,105,1110,105,42567,105,1231,105,43893,105,5029,105,71875,105,65354,106,8521,106,119843,106,119895,106,119947,106,119999,106,120051,106,120103,106,120155,106,120207,106,120259,106,120311,106,120363,106,120415,106,120467,106,1011,106,1112,106,65322,74,119817,74,119869,74,119921,74,119973,74,120025,74,120077,74,120129,74,120181,74,120233,74,120285,74,120337,74,120389,74,120441,74,42930,74,895,74,1032,74,5035,74,5261,74,42201,74,119844,107,119896,107,119948,107,120000,107,120052,107,120104,107,120156,107,120208,107,120260,107,120312,107,120364,107,120416,107,120468,107,8490,75,65323,75,119818,75,119870,75,119922,75,119974,75,120026,75,120078,75,120130,75,120182,75,120234,75,120286,75,120338,75,120390,75,120442,75,922,75,120497,75,120555,75,120613,75,120671,75,120729,75,11412,75,5094,75,5845,75,42199,75,66840,75,1472,108,8739,73,9213,73,65512,73,1633,108,1777,73,66336,108,125127,108,120783,73,120793,73,120803,73,120813,73,120823,73,130033,73,65321,73,8544,73,8464,73,8465,73,119816,73,119868,73,119920,73,120024,73,120128,73,120180,73,120232,73,120284,73,120336,73,120388,73,120440,73,65356,108,8572,73,8467,108,119845,108,119897,108,119949,108,120001,108,120053,108,120105,73,120157,73,120209,73,120261,73,120313,73,120365,73,120417,73,120469,73,448,73,120496,73,120554,73,120612,73,120670,73,120728,73,11410,73,1030,73,1216,73,1493,108,1503,108,1575,108,126464,108,126592,108,65166,108,65165,108,1994,108,11599,73,5825,73,42226,73,93992,73,66186,124,66313,124,119338,76,8556,76,8466,76,119819,76,119871,76,119923,76,120027,76,120079,76,120131,76,120183,76,120235,76,120287,76,120339,76,120391,76,120443,76,11472,76,5086,76,5290,76,42209,76,93974,76,71843,76,71858,76,66587,76,66854,76,65325,77,8559,77,8499,77,119820,77,119872,77,119924,77,120028,77,120080,77,120132,77,120184,77,120236,77,120288,77,120340,77,120392,77,120444,77,924,77,120499,77,120557,77,120615,77,120673,77,120731,77,1018,77,11416,77,5047,77,5616,77,5846,77,42207,77,66224,77,66321,77,119847,110,119899,110,119951,110,120003,110,120055,110,120107,110,120159,110,120211,110,120263,110,120315,110,120367,110,120419,110,120471,110,1400,110,1404,110,65326,78,8469,78,119821,78,119873,78,119925,78,119977,78,120029,78,120081,78,120185,78,120237,78,120289,78,120341,78,120393,78,120445,78,925,78,120500,78,120558,78,120616,78,120674,78,120732,78,11418,78,42208,78,66835,78,3074,111,3202,111,3330,111,3458,111,2406,111,2662,111,2790,111,3046,111,3174,111,3302,111,3430,111,3664,111,3792,111,4160,111,1637,111,1781,111,65359,111,8500,111,119848,111,119900,111,119952,111,120056,111,120108,111,120160,111,120212,111,120264,111,120316,111,120368,111,120420,111,120472,111,7439,111,7441,111,43837,111,959,111,120528,111,120586,111,120644,111,120702,111,120760,111,963,111,120532,111,120590,111,120648,111,120706,111,120764,111,11423,111,4351,111,1413,111,1505,111,1607,111,126500,111,126564,111,126596,111,65259,111,65260,111,65258,111,65257,111,1726,111,64428,111,64429,111,64427,111,64426,111,1729,111,64424,111,64425,111,64423,111,64422,111,1749,111,3360,111,4125,111,66794,111,71880,111,71895,111,66604,111,1984,79,2534,79,2918,79,12295,79,70864,79,71904,79,120782,79,120792,79,120802,79,120812,79,120822,79,130032,79,65327,79,119822,79,119874,79,119926,79,119978,79,120030,79,120082,79,120134,79,120186,79,120238,79,120290,79,120342,79,120394,79,120446,79,927,79,120502,79,120560,79,120618,79,120676,79,120734,79,11422,79,1365,79,11604,79,4816,79,2848,79,66754,79,42227,79,71861,79,66194,79,66219,79,66564,79,66838,79,9076,112,65360,112,119849,112,119901,112,119953,112,120005,112,120057,112,120109,112,120161,112,120213,112,120265,112,120317,112,120369,112,120421,112,120473,112,961,112,120530,112,120544,112,120588,112,120602,112,120646,112,120660,112,120704,112,120718,112,120762,112,120776,112,11427,112,65328,80,8473,80,119823,80,119875,80,119927,80,119979,80,120031,80,120083,80,120187,80,120239,80,120291,80,120343,80,120395,80,120447,80,929,80,120504,80,120562,80,120620,80,120678,80,120736,80,11426,80,5090,80,5229,80,42193,80,66197,80,119850,113,119902,113,119954,113,120006,113,120058,113,120110,113,120162,113,120214,113,120266,113,120318,113,120370,113,120422,113,120474,113,1307,113,1379,113,1382,113,8474,81,119824,81,119876,81,119928,81,119980,81,120032,81,120084,81,120188,81,120240,81,120292,81,120344,81,120396,81,120448,81,11605,81,119851,114,119903,114,119955,114,120007,114,120059,114,120111,114,120163,114,120215,114,120267,114,120319,114,120371,114,120423,114,120475,114,43847,114,43848,114,7462,114,11397,114,43905,114,119318,82,8475,82,8476,82,8477,82,119825,82,119877,82,119929,82,120033,82,120189,82,120241,82,120293,82,120345,82,120397,82,120449,82,422,82,5025,82,5074,82,66740,82,5511,82,42211,82,94005,82,65363,115,119852,115,119904,115,119956,115,120008,115,120060,115,120112,115,120164,115,120216,115,120268,115,120320,115,120372,115,120424,115,120476,115,42801,115,445,115,1109,115,43946,115,71873,115,66632,115,65331,83,119826,83,119878,83,119930,83,119982,83,120034,83,120086,83,120138,83,120190,83,120242,83,120294,83,120346,83,120398,83,120450,83,1029,83,1359,83,5077,83,5082,83,42210,83,94010,83,66198,83,66592,83,119853,116,119905,116,119957,116,120009,116,120061,116,120113,116,120165,116,120217,116,120269,116,120321,116,120373,116,120425,116,120477,116,8868,84,10201,84,128872,84,65332,84,119827,84,119879,84,119931,84,119983,84,120035,84,120087,84,120139,84,120191,84,120243,84,120295,84,120347,84,120399,84,120451,84,932,84,120507,84,120565,84,120623,84,120681,84,120739,84,11430,84,5026,84,42196,84,93962,84,71868,84,66199,84,66225,84,66325,84,119854,117,119906,117,119958,117,120010,117,120062,117,120114,117,120166,117,120218,117,120270,117,120322,117,120374,117,120426,117,120478,117,42911,117,7452,117,43854,117,43858,117,651,117,965,117,120534,117,120592,117,120650,117,120708,117,120766,117,1405,117,66806,117,71896,117,8746,85,8899,85,119828,85,119880,85,119932,85,119984,85,120036,85,120088,85,120140,85,120192,85,120244,85,120296,85,120348,85,120400,85,120452,85,1357,85,4608,85,66766,85,5196,85,42228,85,94018,85,71864,85,8744,118,8897,118,65366,118,8564,118,119855,118,119907,118,119959,118,120011,118,120063,118,120115,118,120167,118,120219,118,120271,118,120323,118,120375,118,120427,118,120479,118,7456,118,957,118,120526,118,120584,118,120642,118,120700,118,120758,118,1141,118,1496,118,71430,118,43945,118,71872,118,119309,86,1639,86,1783,86,8548,86,119829,86,119881,86,119933,86,119985,86,120037,86,120089,86,120141,86,120193,86,120245,86,120297,86,120349,86,120401,86,120453,86,1140,86,11576,86,5081,86,5167,86,42719,86,42214,86,93960,86,71840,86,66845,86,623,119,119856,119,119908,119,119960,119,120012,119,120064,119,120116,119,120168,119,120220,119,120272,119,120324,119,120376,119,120428,119,120480,119,7457,119,1121,119,1309,119,1377,119,71434,119,71438,119,71439,119,43907,119,71919,87,71910,87,119830,87,119882,87,119934,87,119986,87,120038,87,120090,87,120142,87,120194,87,120246,87,120298,87,120350,87,120402,87,120454,87,1308,87,5043,87,5076,87,42218,87,5742,120,10539,120,10540,120,10799,120,65368,120,8569,120,119857,120,119909,120,119961,120,120013,120,120065,120,120117,120,120169,120,120221,120,120273,120,120325,120,120377,120,120429,120,120481,120,5441,120,5501,120,5741,88,9587,88,66338,88,71916,88,65336,88,8553,88,119831,88,119883,88,119935,88,119987,88,120039,88,120091,88,120143,88,120195,88,120247,88,120299,88,120351,88,120403,88,120455,88,42931,88,935,88,120510,88,120568,88,120626,88,120684,88,120742,88,11436,88,11613,88,5815,88,42219,88,66192,88,66228,88,66327,88,66855,88,611,121,7564,121,65369,121,119858,121,119910,121,119962,121,120014,121,120066,121,120118,121,120170,121,120222,121,120274,121,120326,121,120378,121,120430,121,120482,121,655,121,7935,121,43866,121,947,121,8509,121,120516,121,120574,121,120632,121,120690,121,120748,121,1199,121,4327,121,71900,121,65337,89,119832,89,119884,89,119936,89,119988,89,120040,89,120092,89,120144,89,120196,89,120248,89,120300,89,120352,89,120404,89,120456,89,933,89,978,89,120508,89,120566,89,120624,89,120682,89,120740,89,11432,89,1198,89,5033,89,5053,89,42220,89,94019,89,71844,89,66226,89,119859,122,119911,122,119963,122,120015,122,120067,122,120119,122,120171,122,120223,122,120275,122,120327,122,120379,122,120431,122,120483,122,7458,122,43923,122,71876,122,66293,90,71909,90,65338,90,8484,90,8488,90,119833,90,119885,90,119937,90,119989,90,120041,90,120197,90,120249,90,120301,90,120353,90,120405,90,120457,90,918,90,120493,90,120551,90,120609,90,120667,90,120725,90,5059,90,42204,90,71849,90,65282,34,65284,36,65285,37,65286,38,65290,42,65291,43,65294,46,65295,47,65296,48,65297,49,65298,50,65299,51,65300,52,65301,53,65302,54,65303,55,65304,56,65305,57,65308,60,65309,61,65310,62,65312,64,65316,68,65318,70,65319,71,65324,76,65329,81,65330,82,65333,85,65334,86,65335,87,65343,95,65346,98,65348,100,65350,102,65355,107,65357,109,65358,110,65361,113,65362,114,65364,116,65365,117,65367,119,65370,122,65371,123,65373,125],"_default":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"cs":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"de":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"es":[8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"fr":[65374,126,65306,58,65281,33,8216,96,8245,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"it":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"ja":[8211,45,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65292,44,65307,59],"ko":[8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"pl":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"pt-BR":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"qps-ploc":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"ru":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,305,105,921,73,1009,112,215,120,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"tr":[160,32,8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"zh-hans":[65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41],"zh-hant":[8211,45,65374,126,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65307,59]}')),nc.cache=new uP(e=>{function t(d){let p=new Map;for(let f=0;f<d.length;f+=2)p.set(d[f],d[f+1]);return p}function n(d,p){let f=new Map(d);for(let[m,g]of p)f.set(m,g);return f}function i(d,p){if(!d)return p;let f=new Map;for(let[m,g]of d)p.has(m)&&f.set(m,g);return f}let o=nc.ambiguousCharacterData.getValue(),s=e.filter(d=>!d.startsWith("_")&&d in o);s.length===0&&(s=["_default"]);let a;for(let d of s){let p=t(o[d]);a=i(a,p)}let l=t(o._common),c=n(l,a);return new nc(c)}),nc._locales=new ME(()=>Object.keys(nc.ambiguousCharacterData.getValue()).filter(e=>!e.startsWith("_")));var B9=nc,Hv=class Hv{static getRawData(){return JSON.parse("[9,10,11,12,13,32,127,160,173,847,1564,4447,4448,6068,6069,6155,6156,6157,6158,7355,7356,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8203,8204,8205,8206,8207,8234,8235,8236,8237,8238,8239,8287,8288,8289,8290,8291,8292,8293,8294,8295,8296,8297,8298,8299,8300,8301,8302,8303,10240,12288,12644,65024,65025,65026,65027,65028,65029,65030,65031,65032,65033,65034,65035,65036,65037,65038,65039,65279,65440,65520,65521,65522,65523,65524,65525,65526,65527,65528,65532,78844,119155,119156,119157,119158,119159,119160,119161,119162,917504,917505,917506,917507,917508,917509,917510,917511,917512,917513,917514,917515,917516,917517,917518,917519,917520,917521,917522,917523,917524,917525,917526,917527,917528,917529,917530,917531,917532,917533,917534,917535,917536,917537,917538,917539,917540,917541,917542,917543,917544,917545,917546,917547,917548,917549,917550,917551,917552,917553,917554,917555,917556,917557,917558,917559,917560,917561,917562,917563,917564,917565,917566,917567,917568,917569,917570,917571,917572,917573,917574,917575,917576,917577,917578,917579,917580,917581,917582,917583,917584,917585,917586,917587,917588,917589,917590,917591,917592,917593,917594,917595,917596,917597,917598,917599,917600,917601,917602,917603,917604,917605,917606,917607,917608,917609,917610,917611,917612,917613,917614,917615,917616,917617,917618,917619,917620,917621,917622,917623,917624,917625,917626,917627,917628,917629,917630,917631,917760,917761,917762,917763,917764,917765,917766,917767,917768,917769,917770,917771,917772,917773,917774,917775,917776,917777,917778,917779,917780,917781,917782,917783,917784,917785,917786,917787,917788,917789,917790,917791,917792,917793,917794,917795,917796,917797,917798,917799,917800,917801,917802,917803,917804,917805,917806,917807,917808,917809,917810,917811,917812,917813,917814,917815,917816,917817,917818,917819,917820,917821,917822,917823,917824,917825,917826,917827,917828,917829,917830,917831,917832,917833,917834,917835,917836,917837,917838,917839,917840,917841,917842,917843,917844,917845,917846,917847,917848,917849,917850,917851,917852,917853,917854,917855,917856,917857,917858,917859,917860,917861,917862,917863,917864,917865,917866,917867,917868,917869,917870,917871,917872,917873,917874,917875,917876,917877,917878,917879,917880,917881,917882,917883,917884,917885,917886,917887,917888,917889,917890,917891,917892,917893,917894,917895,917896,917897,917898,917899,917900,917901,917902,917903,917904,917905,917906,917907,917908,917909,917910,917911,917912,917913,917914,917915,917916,917917,917918,917919,917920,917921,917922,917923,917924,917925,917926,917927,917928,917929,917930,917931,917932,917933,917934,917935,917936,917937,917938,917939,917940,917941,917942,917943,917944,917945,917946,917947,917948,917949,917950,917951,917952,917953,917954,917955,917956,917957,917958,917959,917960,917961,917962,917963,917964,917965,917966,917967,917968,917969,917970,917971,917972,917973,917974,917975,917976,917977,917978,917979,917980,917981,917982,917983,917984,917985,917986,917987,917988,917989,917990,917991,917992,917993,917994,917995,917996,917997,917998,917999]")}static getData(){return this._data||(this._data=new Set(Hv.getRawData())),this._data}static isInvisibleCharacter(e){return Hv.getData().has(e)}static get codePoints(){return Hv.getData()}};Hv._data=void 0;var H9=Hv;function yp(r){return r===47||r===92}function MO(r){return r.replace(/[\\/]/g,_r.sep)}function z9(r){return r.indexOf("/")===-1&&(r=MO(r)),/^[a-zA-Z]:(\/|$)/.test(r)&&(r="/"+r),r}function OO(r,e=_r.sep){if(!r)return"";let t=r.length,n=r.charCodeAt(0);if(yp(n)){if(yp(r.charCodeAt(1))&&!yp(r.charCodeAt(2))){let o=3,s=o;for(;o<t&&!yp(r.charCodeAt(o));o++);if(s!==o&&!yp(r.charCodeAt(o+1))){for(o+=1;o<t;o++)if(yp(r.charCodeAt(o)))return r.slice(0,o+1).replace(/[\\/]/g,e)}}return e}else if(Jte(n)&&r.charCodeAt(1)===58)return yp(r.charCodeAt(2))?r.slice(0,2)+e:r.slice(0,2);let i=r.indexOf("://");if(i!==-1){for(i+=3;i<t;i++)if(yp(r.charCodeAt(i)))return r.slice(0,i+1)}return""}function LO(r,e,t,n=Bi){if(r===e)return!0;if(!r||!e||e.length>r.length)return!1;if(t){if(!$9(r,e))return!1;if(e.length===r.length)return!0;let o=e.length;return e.charAt(e.length-1)===n&&o--,r.charAt(o)===n}return e.charAt(e.length-1)!==n&&(e+=n),r.indexOf(e)===0}function Jte(r){return r>=65&&r<=90||r>=97&&r<=122}u();var La;(ae=>(ae.inMemory="inmemory",ae.vscode="vscode",ae.internal="private",ae.walkThrough="walkThrough",ae.walkThroughSnippet="walkThroughSnippet",ae.http="http",ae.https="https",ae.file="file",ae.mailto="mailto",ae.untitled="untitled",ae.data="data",ae.command="command",ae.vscodeRemote="vscode-remote",ae.vscodeRemoteResource="vscode-remote-resource",ae.vscodeUserData="vscode-userdata",ae.vscodeCustomEditor="vscode-custom-editor",ae.vscodeNotebook="vscode-notebook",ae.vscodeNotebookCell="vscode-notebook-cell",ae.vscodeNotebookCellMetadata="vscode-notebook-cell-metadata",ae.vscodeNotebookCellOutput="vscode-notebook-cell-output",ae.vscodeInteractive="vscode-interactive",ae.vscodeInteractiveInput="vscode-interactive-input",ae.vscodeSettings="vscode-settings",ae.vscodeWorkspaceTrust="vscode-workspace-trust",ae.vscodeTerminal="vscode-terminal",ae.webviewPanel="webview-panel",ae.vscodeWebview="vscode-webview",ae.extension="extension",ae.vscodeFileResource="vscode-file",ae.tmp="tmp",ae.vsls="vsls"))(La||(La={}));function Ka(r){return sP?(r==null?void 0:r.path)||"":(r==null?void 0:r.fsPath)||""}var LE=class{constructor(e){this._ignorePathCasing=e}compare(e,t,n=!1){return e===t?0:q9(this.getComparisonKey(e,n),this.getComparisonKey(t,n))}isEqual(e,t,n=!1){return e===t?!0:!e||!t?!1:this.getComparisonKey(e,n)===this.getComparisonKey(t,n)}getComparisonKey(e,t=!1){return e.with({path:this._ignorePathCasing(e)?e.path.toLowerCase():void 0,fragment:void 0}).toString()}ignorePathCasing(e){return this._ignorePathCasing(e)}isEqualOrParent(e,t,n=!1,i=RE?"\\":"/"){if(e.scheme===t.scheme){if(e.scheme===La.file)return LO(Ka(e),Ka(t),this._ignorePathCasing(e),i)&&e.query===t.query&&(n||e.fragment===t.fragment);if(Q9(e.authority,t.authority))return LO(e.path,t.path,this._ignorePathCasing(e),"/")&&e.query===t.query&&(n||e.fragment===t.fragment)}return!1}joinPath(e,...t){return OE.Uri.joinPath(e,...t)}basenameOrAuthority(e){return mi(e)||e.authority}basename(e,t){return _r.basename(e.path,t)}extname(e){return _r.extname(e.path)}dirname(e){if(e.path.length===0)return e;let t;return e.scheme===La.file?t=OE.Uri.file(Di(Ka(e))).path:(t=_r.dirname(e.path),e.authority&&t.length&&t.charCodeAt(0)!==47&&(console.error(`dirname("${e.toString})) resulted in a relative path`),t="/")),e.with({path:t})}normalizePath(e){if(!e.path.length)return e;let t;return e.scheme===La.file?t=OE.Uri.file(Ss(Ka(e))).path:t=_r.normalize(e.path),e.with({path:t})}relativePath(e,t){if(e.scheme!==t.scheme||!Q9(e.authority,t.authority))return;if(e.scheme===La.file){let o=V9(Ka(e),Ka(t));return RE?MO(o):o}let n=e.path||"/",i=t.path||"/";if(this._ignorePathCasing(e)){let o=0;for(let s=Math.min(n.length,i.length);o<s&&!(n.charCodeAt(o)!==i.charCodeAt(o)&&n.charAt(o).toLowerCase()!==i.charAt(o).toLowerCase());o++);n=i.substr(0,o)+n.substr(o)}return _r.relative(n,i)}resolvePath(e,t){if(e.scheme===La.file){let n=OE.Uri.file(W9(Ka(e),t));return e.with({authority:n.authority,path:n.path})}return t=z9(t),e.with({path:_r.resolve(e.path,t)})}isAbsolutePath(e){return!!e.path&&e.path[0]==="/"}isEqualAuthority(e,t){return e===t||e!==void 0&&t!==void 0&&Y9(e,t)}hasTrailingPathSeparator(e,t=Bi){if(e.scheme===La.file){let n=Ka(e);return n.length>OO(n).length&&n[n.length-1]===t}else{let n=e.path;return n.length>1&&n.charCodeAt(n.length-1)===47&&!/^[a-zA-Z]:(\/$|\\$)/.test(e.fsPath)}}removeTrailingPathSeparator(e,t=Bi){return X9(e,t)?e.with({path:e.path.substr(0,e.path.length-1)}):e}addTrailingPathSeparator(e,t=Bi){let n=!1;if(e.scheme===La.file){let i=Ka(e);n=i!==void 0&&i.length===OO(i).length&&i[i.length-1]===t}else{t="/";let i=e.path;n=i.length===1&&i.charCodeAt(i.length-1)===47}return!n&&!X9(e,t)?e.with({path:e.path+"/"}):e}},cr=new LE(()=>!1),WDe=new LE(r=>r.scheme===La.file?!K9:!0),VDe=new LE(r=>!0),ea=cr.isEqual.bind(cr),dP=cr.isEqualOrParent.bind(cr),Fa=cr.getComparisonKey.bind(cr),jDe=cr.basenameOrAuthority.bind(cr),mi=cr.basename.bind(cr),Jv=cr.extname.bind(cr),qv=cr.dirname.bind(cr),Hi=cr.joinPath.bind(cr),BDe=cr.normalizePath.bind(cr),KO=cr.relativePath.bind(cr),HDe=cr.resolvePath.bind(cr),JDe=cr.isAbsolutePath.bind(cr),Q9=cr.isEqualAuthority.bind(cr),X9=cr.hasTrailingPathSeparator.bind(cr),qDe=cr.removeTrailingPathSeparator.bind(cr),GDe=cr.addTrailingPathSeparator.bind(cr),Z9;(o=>{o.META_DATA_LABEL="label",o.META_DATA_DESCRIPTION="description",o.META_DATA_SIZE="size",o.META_DATA_MIME="mime";function i(s){let a=new Map;s.path.substring(s.path.indexOf(";")+1,s.path.lastIndexOf(";")).split(";").forEach(d=>{let[p,f]=d.split(":");p&&f&&a.set(p,f)});let c=s.path.substring(0,s.path.indexOf(";"));return c&&a.set(o.META_DATA_MIME,c),a}o.parseMetaData=i})(Z9||(Z9={}));u();function Pi(r=process.platform){return/^win/.test(r)?"Windows":/^darwin/.test(r)?"OSX":/^linux/.test(r)?"Linux":"Unknown"}function pP(r,e){return r.replace(/^~(?=$|\/|\\)/,e)}function Gte(){if(!dp())return UO.Uri.file(require("os").homedir())}function at(r){let e=Pi()==="Windows";if(r){let t=Ka(r);return t&&t.startsWith(Bi)&&t.length>1&&t[1]!==Bi&&e?t.slice(1):t||""}return""}function ve(r,e=[],t){t=t||Gte();let n;typeof r=="string"&&(n=UO.Uri.file(r)),typeof r!="string"&&(n=r);let i=FO(n,void 0,t),o=e.find(l=>n&&dP(n,l.uri,!0));if(e.length>1&&o)return`${o.name}${Bi}${FO(n,o.uri,t)}`;let s=o?[FO(n,o.uri,t)]:[],a=i;return[i,...s].forEach(l=>{l.length<a.length&&(a=l)}),a}function FO(r,e,t){let n=Pi()==="Windows";if(r&&e&&dP(r,e,!0)){let i=KO(e,r);if(i)return n?i.replace(/\//g,"\\"):i}if(r&&t&&dP(r,t,!0)){let i=KO(t,r);if(i)return i=n?i.replace(/\//g,"\\"):i,`~${Bi}${i}`}return at(r)}u();u();var fP=class{constructor(){this.event=(e,t,n)=>{let i=this.add(t?e.bind(t):e);return n==null||n.push(i),i}}get size(){return this.listeners?typeof this.listeners=="function"?1:this.listeners.length:0}fire(e){if(this.listeners)if(typeof this.listeners=="function")this.listeners(e);else for(let t of this.listeners)t(e)}dispose(){this.listeners=void 0}add(e){return this.listeners?typeof this.listeners=="function"?this.listeners=[this.listeners,e]:this.listeners.push(e):this.listeners=e,{dispose:()=>this.rm(e)}}rm(e){if(!this.listeners)return;if(typeof this.listeners=="function"){this.listeners===e&&(this.listeners=void 0);return}let t=this.listeners.indexOf(e);t!==-1&&(this.listeners.length===2?this.listeners=t===0?this.listeners[1]:this.listeners[0]:this.listeners=this.listeners.slice(0,t).concat(this.listeners.slice(t+1)))}};u();function ur(r){let e=this,t=!1,n;return function(){return t||(t=!0,n=r.apply(e,arguments)),n}}u();var mP;(v=>{function r(S){return S&&typeof S=="object"&&typeof S[Symbol.iterator]=="function"}v.is=r;let e=Object.freeze([]);function t(){return e}v.empty=t;function*n(S){yield S}v.single=n;function i(S){return r(S)?S:n(S)}v.wrap=i;function o(S){return S||e}v.from=o;function s(S){return!S||S[Symbol.iterator]().next().done===!0}v.isEmpty=s;function a(S){return S[Symbol.iterator]().next().value}v.first=a;function l(S,_){for(let D of S)if(_(D))return!0;return!1}v.some=l;function c(S,_){for(let D of S)if(_(D))return D}v.find=c;function*d(S,_){for(let D of S)_(D)&&(yield D)}v.filter=d;function*p(S,_){let D=0;for(let P of S)yield _(P,D++)}v.map=p;function*f(...S){for(let _ of S)for(let D of _)yield D}v.concat=f;function m(S,_,D){let P=D;for(let M of S)P=_(P,M);return P}v.reduce=m;function*g(S,_,D=S.length){for(_<0&&(_+=S.length),D<0?D+=S.length:D>S.length&&(D=S.length);_<D;_++)yield S[_]}v.slice=g;function h(S,_=Number.POSITIVE_INFINITY){let D=[];if(_===0)return[D,S];let P=S[Symbol.iterator]();for(let M=0;M<_;M++){let x=P.next();if(x.done)return[D,v.empty()];D.push(x.value)}return[D,{[Symbol.iterator](){return P}}]}v.consume=h})(mP||(mP={}));var gP;function tB(r){gP=r}function Au(r){return gP==null||gP.push(r),r}function fe(r){if(mP.is(r)){for(let e of r)if(e)try{e.dispose()}catch(t){console.warn(`dispose() failed for ${e}`,t)}return Array.isArray(r)?[]:r}else if(r)return r.dispose(),r}var vP=class vP{constructor(...e){this._toDispose=new Set;this._isDisposed=!1;e.forEach(t=>this.add(t)),Au(this)}dispose(){this._isDisposed||(this._isDisposed=!0,this.clear())}get isDisposed(){return this._isDisposed}clear(){if(this._toDispose.size!==0)try{fe(this._toDispose)}finally{this._toDispose.clear()}}add(e){if(!e)return e;if(e===this)throw new Error("Cannot register a disposable on itself!");return this._isDisposed?vP.DISABLE_DISPOSED_WARNING||console.warn(new Error("Trying to add a disposable to a DisposableStore that has already been disposed of. The added object will be leaked!").stack):this._toDispose.add(e),e}};vP.DISABLE_DISPOSED_WARNING=!1;var Pn=vP,Fr=class{constructor(...e){this._store=new Pn;this._isDisposed=!1;e.forEach(t=>this._store.add(t)),Au(this)}get isDisposed(){return this._isDisposed}dispose(){this._store.dispose(),this._isDisposed=!0}_register(e){if(e===this)throw new Error("Cannot register a disposable on itself!");return this._store.add(e)}},ic=class extends Fr{constructor(){super();this._onDidDispose=new fP,this.onDidDispose=this._onDidDispose.event}dispose(){super.dispose(),this._onDidDispose.fire(),this._onDidDispose.dispose()}};var eB=class{constructor(){this._store=new Map;this._isDisposed=!1}dispose(){this._isDisposed=!0,this.clearAndDisposeAll()}clearAndDisposeAll(){if(this._store.size)try{fe(this._store.values())}finally{this._store.clear()}}has(e){return this._store.has(e)}get(e){return this._store.get(e)}set(e,t,n=!1){var i;this._isDisposed&&console.warn(new Error("Trying to add a disposable to a DisposableMap that has already been disposed of. The added object will be leaked!").stack),n||(i=this._store.get(e))==null||i.dispose(),this._store.set(e,t)}deleteAndDispose(e){var t;(t=this._store.get(e))==null||t.dispose(),this._store.delete(e)}[Symbol.iterator](){return this._store[Symbol.iterator]()}};var hP=class{constructor(){this.references=new Map}acquire(e,...t){let n=this.references.get(e);n||(n={counter:0,object:this.createReferencedObject(e,...t)},this.references.set(e,n));let{object:i}=n,o=ur(()=>{n&&--n.counter===0&&(this.destroyReferencedObject(e,n.object),this.references.delete(e))});return n.counter++,{object:i,dispose:o}}};u();var w=require("vscode");u();var Xe=require("vscode"),WO=60,VO=WO*60,KE=VO*24,rB=KE*7,nB=KE*30,iB=KE*365;function Gv(r,e,t,n){typeof r!="number"&&(r=r.getTime());let i=Math.round((new Date().getTime()-r)/1e3);if(i<-30)return Xe.l10n.t("in {0}",Gv(new Date().getTime()+i*1e3,!1));if(!n&&i<30)return Xe.l10n.t("now");let o;return i<WO?(o=i,e?o===1?t?Xe.l10n.t("{0} second ago",o):Xe.l10n.t("{0} sec ago",o):t?Xe.l10n.t("{0} seconds ago",o):Xe.l10n.t("{0} secs ago",o):o===1?t?Xe.l10n.t("{0} second",o):Xe.l10n.t("{0} sec",o):t?Xe.l10n.t("{0} seconds",o):Xe.l10n.t("{0} secs",o)):i<VO?(o=Math.floor(i/WO),e?o===1?t?Xe.l10n.t("{0} minute ago",o):Xe.l10n.t("{0} min ago",o):t?Xe.l10n.t("{0} minutes ago",o):Xe.l10n.t("{0} mins ago",o):o===1?t?Xe.l10n.t("{0} minute",o):Xe.l10n.t("{0} min",o):t?Xe.l10n.t("{0} minutes",o):Xe.l10n.t("{0} mins",o)):i<KE?(o=Math.floor(i/VO),e?o===1?t?Xe.l10n.t("{0} hour ago",o):Xe.l10n.t("{0} hr ago",o):t?Xe.l10n.t("{0} hours ago",o):Xe.l10n.t("{0} hrs ago",o):o===1?t?Xe.l10n.t("{0} hour",o):Xe.l10n.t("{0} hr",o):t?Xe.l10n.t("{0} hours",o):Xe.l10n.t("{0} hrs",o)):i<rB?(o=Math.floor(i/KE),e?o===1?Xe.l10n.t("{0} day ago",o):Xe.l10n.t("{0} days ago",o):o===1?Xe.l10n.t("{0} day",o):Xe.l10n.t("{0} days",o)):i<nB?(o=Math.floor(i/rB),e?o===1?t?Xe.l10n.t("{0} week ago",o):Xe.l10n.t("{0} wk ago",o):t?Xe.l10n.t("{0} weeks ago",o):Xe.l10n.t("{0} wks ago",o):o===1?t?Xe.l10n.t("{0} week",o):Xe.l10n.t("{0} wk",o):t?Xe.l10n.t("{0} weeks",o):Xe.l10n.t("{0} wks",o)):i<iB?(o=Math.floor(i/nB),e?o===1?t?Xe.l10n.t("{0} month ago",o):Xe.l10n.t("{0} mo ago",o):t?Xe.l10n.t("{0} months ago",o):Xe.l10n.t("{0} mos ago",o):o===1?t?Xe.l10n.t("{0} month",o):Xe.l10n.t("{0} mo",o):t?Xe.l10n.t("{0} months",o):Xe.l10n.t("{0} mos",o)):(o=Math.floor(i/iB),e?o===1?t?Xe.l10n.t("{0} year ago",o):Xe.l10n.t("{0} yr ago",o):t?Xe.l10n.t("{0} years ago",o):Xe.l10n.t("{0} yrs ago",o):o===1?t?Xe.l10n.t("{0} year",o):Xe.l10n.t("{0} yr",o):t?Xe.l10n.t("{0} years",o):Xe.l10n.t("{0} yrs",o))}u();u();u();u();var NH=$(te());var ty=class{async createHash(e,t="SHA-256"){return ja(e,t)}};ty=E([(0,NH.injectable)()],ty);var $P={},kH=!1,zP;typeof window=="object"?zP=window.crypto:typeof WorkerGlobalScope!="undefined"&&self instanceof WorkerGlobalScope?zP=self.crypto:zP=require("node:crypto").webcrypto;async function ja(r,e){let t=r.includes("/")||r.includes("\\")||r.endsWith(".interactive");if(t&&$P[r])return $P[r];let n=await Ase(r,e);return t&&!kH&&(Object.keys($P).length>1e4&&(kH=!0),$P[r]=n),n}async function Ase(r,e){let t=new TextEncoder().encode(r),n=await zP.subtle.digest({name:e},t);return Array.from(new Uint8Array(n)).map(o=>o.toString(16).padStart(2,"0")).join("")}function ry(r){if(typeof r=="string")try{let[e,t,n]=`${r.trim()}...`.split(".").map(i=>parseInt(i,10));return isNaN(e)?"":isNaN(t)?e.toString():isNaN(n)?`${e}.${t}`:`${e}.${t}.${n}`}catch(e){return b.error(`Failed to parse version ${r}`,e),""}return r?`${r.major}.${r.minor}.${r.micro}`:""}async function Nt(r){return ja(r,"SHA-256")}var IL=$(RH());var BE=require("vscode");function Lu(r){var l,c,d;let e=zi(r);if(e){let p=[];typeof((l=e.version)==null?void 0:l.major)=="number"&&(p.push(e.version.major.toString()),typeof e.version.minor=="number"&&(p.push(e.version.minor.toString()),typeof e.version.micro=="number"&&p.push(e.version.micro.toString())));let f=p.length?p.join("."):"",m=((c=e.environment)==null?void 0:c.name)||(e.environment?mi((d=e.environment)==null?void 0:d.folderUri):""),g=f?`Python ${f}`:"Python";return Ep(r)&&m?m:m?`${m} (${g})`:g}if(Object.keys(r).length===1&&r.id)return r.id;let t=ry(Ku(r)||"").trim(),n=Ep(r),i=t?`Python ${t}`:"Python",o=_s(r);if(n&&o)return o;let s=[];o&&s.push(o);let a=zr(r);return a&&a!=="Unknown"&&s.push(a),[i,s.length?`(${s.join(": ")})`:""].join(" ").trim()}function _s(r){var n,i,o;let e=zi(r),t=(n=e==null?void 0:e.environment)==null?void 0:n.name;return!t&&((i=e==null?void 0:e.environment)!=null&&i.folderUri)&&zr(r)==="Conda"&&(t=mi((o=e==null?void 0:e.environment)==null?void 0:o.folderUri)),t}var Lse=["Unknown","Conda","PipEnv","Poetry","Pyenv","Venv","VirtualEnv","VirtualEnvWrapper"];function zr(r){let e=zi(r);return e?Kse(e):"Unknown"}function Kse(r){var t,n;if(((t=r.environment)==null?void 0:t.type)==="Conda")return"Conda";let e=[["Conda","Conda"],["Pyenv","Pyenv"],["Pipenv","PipEnv"],["Poetry","Poetry"],["VirtualEnvWrapper","VirtualEnvWrapper"],["VirtualEnv","VirtualEnv"],["Venv","Venv"]];for(let[i,o]of e)if(r.tools.includes(i))return o;if(((n=r.environment)==null?void 0:n.type)==="VirtualEnvironment")return"VirtualEnv";for(let i of Lse)if(r.tools.some(o=>o.toLowerCase()===i.toLowerCase()))return i;return"Unknown"}var Ho;function AH(r){Ho=r}function Ep(r){if(!r||!Ho)return!1;let e=zi(r);return e&&zr(e)==="Conda"&&!e.executable.uri}function zi(r){if(r){if(!Ho)throw new Error("Python API not initialized");return Ho.environments.known.find(e=>e.id===r.id)}}async function SL(r){var n;if(!(r!=null&&r.id))return;if(Ho){let i=Ho.environments.known.find(o=>o.id===r.id);if((n=i==null?void 0:i.executable)!=null&&n.sysPrefix)return i.executable.sysPrefix}let t=await(await IL.PythonExtension.api()).environments.resolveEnvironment(r.id).then(i=>{var o;return(o=i==null?void 0:i.executable)==null?void 0:o.sysPrefix});return t||b.warn(`Unable to find sysPrefix for interpreter ${ve(r.id)}`),t}function MH(r){var t;if(!(r!=null&&r.id))return;if(!Ho)throw new Error("Python API not initialized");let e=Ho.environments.known.find(n=>n.id===r.id);return(t=e==null?void 0:e.executable)==null?void 0:t.sysPrefix}async function Cp(r,e=!1){if(!(r!=null&&r.id))return;if(Ho&&!e){let i=Ho.environments.known.find(o=>o.id===r.id);if(i!=null&&i.version)return i.version}let n=await(await IL.PythonExtension.api()).environments.resolveEnvironment(r.id);return n!=null&&n.version||b.warn(`Unable to find Version for interpreter ${ve(r.id)}`),n==null?void 0:n.version}function Ku(r){if(!(r!=null&&r.id))return;if(!Ho)throw new Error("Python API not initialized");let e=Ho.environments.known.find(t=>t.id===r.id);return e==null?void 0:e.version}function OH(){return Ho?Ho.environments.known:[]}function QP(r){var n,i;if(!r)return;let e,t=r.id;if(r.executable.uri)e=r.executable.uri;else if(zr(r)==="Conda")e=Pi()==="Windows"?BE.Uri.joinPath(((n=r.environment)==null?void 0:n.folderUri)||BE.Uri.file(r.path),"python.exe"):BE.Uri.joinPath(((i=r.environment)==null?void 0:i.folderUri)||BE.Uri.file(r.path),"bin","python");else{b.warn(`Python environment ${ve(r.id)} excluded as Uri is undefined`);return}return{id:t,uri:e}}function Fse(r){return Lu(r)}var Fe;(S=>(S.bannerLabelYes=w.l10n.t("Yes"),S.bannerLabelNo=w.l10n.t("No"),S.canceled=w.l10n.t("Canceled"),S.cancel=w.l10n.t("Cancel"),S.ok=w.l10n.t("Ok"),S.refresh=w.l10n.t("Refresh"),S.refreshing=w.l10n.t("Refreshing..."),S.install=w.l10n.t("Install"),S.loadingExtension=w.l10n.t("Jupyter Extension loading..."),S.handleExtensionActivationError=w.l10n.t("Extension activation failed, run the 'Developer: Toggle Developer Tools' command for more information."),S.doNotShowAgain=w.l10n.t("Do not show again"),S.reload=w.l10n.t("Reload"),S.moreInfo=w.l10n.t("More Info"),S.learnMore=w.l10n.t("Learn more"),S.and=w.l10n.t("and"),S.reportThisIssue=w.l10n.t("Report this issue"),S.clickHereForMoreInfoWithHtml=_=>w.l10n.t("Click <a href='{0}'>here</a> for more info.",_)))(Fe||(Fe={}));var wp;(t=>(t.notInGroup=n=>w.l10n.t("User does not belong to experiment group '{0}'",n),t.inGroup=n=>w.l10n.t("User belongs to experiment group '{0}'",n)))(wp||(wp={}));var XP;(e=>e.jupyter=w.l10n.t("Jupyter"))(XP||(XP={}));var LH;(e=>e.currentWorkingDirectory="cwd:")(LH||(LH={}));var KH;(e=>e.bannerMessage=w.l10n.t("Would you like shift-enter to send code to the new Interactive Window experience?"))(KH||(KH={}));var FH;(e=>e.bannerMessage=w.l10n.t("Can you please take a minute to tell us about your notebooks experience in VS Code?"))(FH||(FH={}));var UH;(t=>(t.bannerLabelYes=w.l10n.t("Yes, take survey now"),t.bannerLabelNo=w.l10n.t("No, thanks")))(UH||(UH={}));var C;(T=>(T.warnWhenSelectingKernelWithUnSupportedPythonVersion=w.l10n.t("The version of Python associated with the selected kernel is no longer supported. Please consider selecting a different kernel."),T.installingPythonExtension=w.l10n.t("Installing Python extension and locating kernels."),T.pythonExtensionRequired=w.l10n.t("The Python Extension is required to perform that task. Click Yes to open Python Extension installation page."),T.rendererExtensionRequired=w.l10n.t("The Renderer Extension is required to view IPyWidgets. Click Yes to open Jupyter Notebook Renderer Extension installation page."),T.rendererExtension1015Required=w.l10n.t("The installed version of the Renderer Extension is outdated and requires and update to view IPyWidgets. Click Yes to open Jupyter Notebook Renderer Extension installation page."),T.pythonExtensionInstalled=w.l10n.t("Python Extension is now installed. Some features might not be available until a notebook or interactive window session is restarted."),T.unknownPackage=w.l10n.t("unknown"),T.interactiveWindowTitleFormat=B=>w.l10n.t("Interactive - {0}",B),T.interactiveWindowModeBannerTitle=w.l10n.t({message:"Do you want to open a new Interactive Window for this file? [More Information](command:workbench.action.openSettings?%5B%22jupyter.interactiveWindowMode%22%5D).",args:[],comment:'The string "command:workbench.action.openSettings?%5B%22jupyter.interactiveWindowMode%22%5D" should not be translated. It is a command that opens the settings page with the "jupyter.interactiveWindowMode" setting selected.'}),T.interactiveWindowModeBannerSwitchYes=w.l10n.t("Yes"),T.interactiveWindowModeBannerSwitchNo=w.l10n.t("No"),T.dataExplorerTitle=w.l10n.t("Data Viewer"),T.badWebPanelFormatString=B=>w.l10n.t({message:"<html><body><h1>{0} is not a valid file name</h1></body></html>",args:[B],comment:["Only translate the text within the HTML tags"]}),T.installingMissingDependencies=w.l10n.t("Installing missing dependencies"),T.validatingKernelDependencies=w.l10n.t("Validating kernel dependencies"),T.performingExport=w.l10n.t("Performing Export"),T.exportNotebookToPython=w.l10n.t("Exporting Notebook to Python"),T.sessionDisposed=w.l10n.t("Cannot execute code, session has been disposed. Please try restarting the Kernel."),T.passwordFailure=w.l10n.t("Failed to connect to password protected server. Check that password is correct."),T.incorrectPassword=w.l10n.t("Incorrect Password."),T.exportDialogFilter=w.l10n.t("Jupyter Notebooks"),T.exportDialogComplete=B=>w.l10n.t("Notebook written to {0}",B),T.exportDialogFailed=B=>w.l10n.t("Failed to export notebook. {0}",B),T.exportOpenQuestion1=w.l10n.t("Open in editor"),T.runCellLensCommandTitle=w.l10n.t("Run Cell"),T.importDialogTitle=w.l10n.t("Import Jupyter Notebook"),T.importDialogFilter="Jupyter Notebooks",T.notebookCheckForImportNo=w.l10n.t("Later"),T.libraryRequiredToLaunchJupyterNotInstalled=B=>w.l10n.t("Running cells requires {0} package.",B),T.librariesRequiredToLaunchJupyterNotInstalled=B=>w.l10n.t("Running cells requires {0} package.",B),T.libraryRequiredToLaunchJupyterNotInstalledInterpreter=(B,ze)=>w.l10n.t("Running cells with '{0}' requires the {1} package.",B,ze),T.libraryRequiredToLaunchJupyterKernelNotInstalledInterpreter=(B,ze)=>w.l10n.t("Running cells with '{0}' requires the {1} package.",B,ze),T.libraryRequiredToLaunchJupyterKernelNotInstalledInterpreterAndRequiresUpdate=(B,ze)=>w.l10n.t("Running cells with '{0}' requires the {1} package to be installed or requires an update.",B,ze),T.librariesRequiredToLaunchJupyterNotInstalledInterpreter=(B,ze)=>w.l10n.t("Running cells with '{0}' requires the {1} package.",B,ze),T.installPackageInstructions=(B,ze)=>w.l10n.t(`Run the following command to install '{0}' into the Python environment. 
Command: '{1}'`,B,ze),T.pythonCondaKernelsWithoutPython=w.l10n.t("The Python Runtime and IPyKernel will be automatically installed upon selecting this environment."),T.selectJupyterInterpreter=w.l10n.t("Select an Interpreter to start Jupyter"),T.jupyterInstall=w.l10n.t("Install"),T.currentlySelectedJupyterInterpreterForPlaceholder=B=>w.l10n.t("Selected Environment {0}",B),T.jupyterNotSupported=B=>w.l10n.t("Jupyter cannot be started. Error attempting to locate Jupyter: {0}",B),T.jupyterNotebookNotInstalledOrNotFound=B=>{if(B){let ze=Fse(B);return w.l10n.t("Failed to start Jupyter Server as the packages 'jupyter' and 'notebook' could not be located in the Python environment '{0}'.",ze)}else return w.l10n.t("Failed to start Jupyter Server as the packages 'jupyter' and 'notebook' could not be located in the Python environment.")},T.jupyterNotSupportedBecauseOfEnvironment=(B,ze)=>w.l10n.t("Activating {0} to run Jupyter failed with {1}",B,ze),T.jupyterNbConvertNotSupported=w.l10n.t("Jupyter nbconvert is not installed"),T.jupyterLaunchTimedOut=w.l10n.t("The Jupyter notebook server failed to launch in time"),T.jupyterLaunchNoURL=w.l10n.t("Failed to find the URL of the launched Jupyter notebook server"),T.jupyterSelfCertFail=B=>w.l10n.t(`The security certificate used by server {0} was not issued by a trusted certificate authority.\r
This may indicate an attempt to steal your information.\r
Do you want to enable the Allow Unauthorized Remote Connection setting for this workspace to allow you to connect?`,B),T.jupyterExpiredCertFail=B=>w.l10n.t(`The security certificate used by server {0} has expired.\r
This may indicate an attempt to steal your information.\r
Do you want to enable the Allow Unauthorized Remote Connection setting for this workspace to allow you to connect?`,B),T.jupyterSelfCertFailErrorMessageOnly=w.l10n.t(`The security certificate used by server was not issued by a trusted certificate authority.\r
This may indicate an attempt to steal your information.`),T.jupyterSelfCertExpiredErrorMessageOnly=w.l10n.t(`The security certificate used by server has expired.\r
This may indicate an attempt to steal your information.`),T.jupyterSelfCertEnable=w.l10n.t("Yes, connect anyways"),T.jupyterSelfCertClose=w.l10n.t("No, close the connection"),T.pythonInteractiveHelpLink=w.l10n.t("See <https://aka.ms/pyaiinstall> for help on installing Jupyter."),T.importingFormat=B=>w.l10n.t("Importing {0}",B),T.startingJupyter=w.l10n.t("Starting Jupyter Server"),T.connectingToKernel=B=>w.l10n.t("Connecting to kernel: {0}",B),T.connectingToJupyter=w.l10n.t("Connecting to Jupyter Server"),T.exportingFormat=B=>w.l10n.t("Exporting {0}",B),T.runAllCellsLensCommandTitle=w.l10n.t("Run All Cells"),T.runAllCellsAboveLensCommandTitle=w.l10n.t("Run Above"),T.runCellAndAllBelowLensCommandTitle=w.l10n.t("Run Below"),T.restartKernelMessage=w.l10n.t("Do you want to restart the Jupyter kernel? All variables will be lost."),T.restartKernelMessageYes=w.l10n.t("Restart"),T.restartKernelMessageDontAskAgain=w.l10n.t("Don't Ask Again"),T.automaticallyReconnectingToAKernelProgressMessage=B=>w.l10n.t("Reconnecting to the kernel {0}",B),T.restartingKernelStatus=B=>w.l10n.t("Restarting Kernel {0}",B),T.interruptingKernelFailed=w.l10n.t("Kernel interrupt failed. Jupyter Server is hung. Please reload VS Code."),T.sessionStartFailedWithKernel=B=>w.l10n.t({message:`Failed to start the Kernel '{0}'. 
View Jupyter [log](command:jupyter.viewOutput) for further details.`,args:[B],comment:['Do not translate the text "command:jupyter.viewOutput", that is a command Id that will be used by VS Code to open the output panel']}),T.failedToStartJupyter=B=>w.l10n.t({message:`Failed to start Jupyter in the environment '{0}'. 
View Jupyter [log](command:jupyter.viewOutput) for further details.`,args:[B],comment:['Do not translate the text "command:jupyter.viewOutput", that is a command Id that will be used by VS Code to open the output panel']}),T.failedToStartJupyterWithErrorInfo=(B,ze)=>w.l10n.t({message:`Failed to start Jupyter in the environment '{0}'. 
{1} 
View Jupyter [log](command:jupyter.viewOutput) for further details.`,args:[B,ze],comment:['Do not translate the text "command:jupyter.viewOutput", that is a command Id that will be used by VS Code to open the output panel']}),T.failedToStartJupyterDueToOutdatedTraitlets=(B,ze)=>w.l10n.t({message:`Failed to start Jupyter in the environment '{0}' possibly due to an outdated version of 'traitlets'. 
{1} 
Consider updating the 'traitlets' module to '5.1.1' or later. 
View Jupyter [log](command:jupyter.viewOutput) for further details.`,args:[B,ze],comment:['Do not translate the text "command:jupyter.viewOutput", that is a command Id that will be used by VS Code to open the output panel',"Do not translate the text 'traitlets', that is a Python module name"]}),T.failedToStartKernel=w.l10n.t("Failed to start the Kernel."),T.failedToRestartKernel=w.l10n.t("Failed to restart the Kernel."),T.failedToInterruptKernel=w.l10n.t("Failed to interrupt the Kernel."),T.rawKernelStartFailedDueToTimeout=B=>w.l10n.t({message:`Unable to start Kernel '{0}' due to a connection timeout. 
View Jupyter [log](command:jupyter.viewOutput) for further details.`,args:[B],comment:['Do not translate the text "command:jupyter.viewOutput", that is a command Id that will be used by VS Code to open the output panel']}),T.rawKernelStartFailedDueToTimeoutWaitingForPort=B=>w.l10n.t({message:`Unable to start Kernel '{0}' due to a timeout waiting for the ports to get used. 
View Jupyter [log](command:jupyter.viewOutput) for further details.`,args:[B],comment:['Do not translate the text "command:jupyter.viewOutput", that is a command Id that will be used by VS Code to open the output panel']}),T.viewJupyterLogForFurtherInfo=w.l10n.t({message:"View Jupyter [log](command:jupyter.viewOutput) for further details.",comment:['Do not translate the text "command:jupyter.viewOutput", that is a command Id that will be used by VS Code to open the output panel']}),T.kernelDied=B=>w.l10n.t({message:"The kernel died. Error: {0}... View Jupyter [log](command:jupyter.viewOutput) for further details.",args:[B],comment:['Do not translate the text "command:jupyter.viewOutput", that is a command Id that will be used by VS Code to open the output panel']}),T.kernelDiedWithoutError=B=>w.l10n.t({message:"The kernel '{0}' died. Click [here](https://aka.ms/vscodeJupyterKernelCrash) for more info. View Jupyter [log](command:jupyter.viewOutput) for further details.",args:[B],comment:['Do not translate the text "command:jupyter.viewOutput", that is a command Id that will be used by VS Code to open the output panel',"Do not translate the link https://aka.ms/vscodeJupyterKernelCrash"]}),T.failedToStartAnUntrustedKernelSpec=(B,ze)=>w.l10n.t({message:`The kernel '{0}' was not started as it is located in an insecure location '{1}'.  
Click [here](https://aka.ms/JupyterTrustedKernelPaths) for further details, optionally update the setting [jupyter.kernels.trusted](command:workbench.action.openSettings?["jupyter.kernels.trusted"]) to trust the kernel.`,args:[B,ze],comment:['Do not translate the text "jupyter.kernels.trusted", that is a setting in VS Code','Do not translate the text command:workbench.action.openSettings?["jupyter.kernels.trusted"], that is a command Id that will be used by VS Code to open the output panel',"Do not translate the link https://aka.ms/JupyterTrustedKernelPaths"]}),T.kernelDiedWithoutErrorAndAutoRestarting=B=>w.l10n.t({message:"The kernel '{0}' died and is being automatically restarted by Jupyter. Click [here](https://aka.ms/vscodeJupyterKernelCrash) for more info. View Jupyter [log](command:jupyter.viewOutput) for further details.",args:[B],comment:['Do not translate the text "command:jupyter.viewOutput", that is a command Id that will be used by VS Code to open the output panel',"Do not translate the link https://aka.ms/vscodeJupyterKernelCrash"]}),T.kernelCrashedDueToCodeInCurrentOrPreviousCell=w.l10n.t({message:`The Kernel crashed while executing code in the current cell or a previous cell. 
Please review the code in the cell(s) to identify a possible cause of the failure. 
Click <a href='https://aka.ms/vscodeJupyterKernelCrash'>here</a> for more info. 
View Jupyter [log](command:jupyter.viewOutput) for further details.`,comment:['Do not translate the text "command:jupyter.viewOutput", that is a command Id that will be used by VS Code to open the output panel',"Do not translate the link https://aka.ms/vscodeJupyterKernelCrash"]}),T.kernelDisconnected=B=>w.l10n.t("Unable to connect to the kernel '{0}', please verify the Jupyter Server connection. View Jupyter [log](command:jupyter.viewOutput) for further details.",B),T.cannotRunCellKernelIsDead=B=>w.l10n.t("Cannot run cells, as the kernel '{0}' is dead.",B),T.showJupyterLogs=w.l10n.t("Show Jupyter Logs."),T.restartKernel=w.l10n.t("Restart Kernel"),T.reloadRequired=w.l10n.t("Please reload the window for new settings to take effect."),T.restartedKernelHeader=B=>w.l10n.t("Restarted {0}",B),T.connectedKernelHeader=B=>w.l10n.t("Connected to {0}",B),T.restartingKernelCustomHeader=B=>w.l10n.t("_Restarting {0}..._",B),T.restartingKernelHeader=w.l10n.t("_Restarting kernel..._"),T.startingNewKernelHeader=w.l10n.t("_Connecting to kernel..._"),T.startingNewKernelCustomHeader=B=>w.l10n.t("_Connecting to {0}..._",B),T.noKernelConnected=w.l10n.t("No kernel connected"),T.jupyterSelectUriCommandLabel=w.l10n.t("Enter the URL of the running Jupyter Server..."),T.jupyterSelectUriInputTitle=w.l10n.t("Enter the URL of the running Jupyter Server"),T.jupyterSelectUriInputPlaceholder=w.l10n.t("Enter the url of the running Jupyter Server"),T.connectToToTheJupyterServer=B=>w.l10n.t("Connect to the Jupyter Server {0}",B),T.enterOrSelectRemoteJupyterPlaceholder=w.l10n.t("Enter a remote url, or select a remote server"),T.selectRemoteJupyterPlaceholder=w.l10n.t("Select a remote server"),T.jupyterServerLastConnectionForQuickPickDescription=B=>w.l10n.t("Last connected {0}",Gv(B,!0,!1,!1)),T.jupyterServerNotUsedBeforeQuickPickSeparatorTitle=w.l10n.t("Jupyter Servers"),T.jupyterSelectURIInvalidURI=w.l10n.t("Invalid URL specified"),T.jupyterSelectURIMustBeHttpOrHttps=w.l10n.t("Invalid protocol in URL specified, only HTTP or HTTPS are supported."),T.jupyterSelectLiveRemoteKernelDescription=(B,ze)=>B?ze===0?w.l10n.t("Last activity {0}",Gv(B,!0,!1,!1)):ze===1?w.l10n.t("Last activity {0}, 1 connection",Gv(B,!0,!1,!1)):w.l10n.t("Last activity {0}, {1} connections",Gv(B,!0,!1,!1),ze.toString()):ze===0?"":ze===1?w.l10n.t("1 connection"):w.l10n.t("{0} connections",ze.toString()),T.installJupyterHub=w.l10n.t("Install the JupyterHub extension to connect to JupyterHub servers."),T.useJupyterHubExtension=w.l10n.t("Select 'Existing JupyterHub Server...' from the Kernel Picker"),T.useJupyterHubExtensionDetail=w.l10n.t("Use this option when connecting to JupyterHub servers"),T.installJupyterHubDetail=w.l10n.t("Once installed, open the Kernel Picker and select 'Existing JupyterHub Server...'"),T.jupyterSelectUserAndPasswordTitle=w.l10n.t("Enter your user name and password to connect to Jupyter Hub"),T.jupyterRenameServer=w.l10n.t("Change Server Display Name (Leave Blank To Use URL)"),T.jupyterServerUriDisplayNameInputPlaceholder=w.l10n.t("Enter a display name"),T.jupyterSelectUserPrompt=w.l10n.t("Enter your user name"),T.jupyterSelectPasswordPrompt=w.l10n.t("Enter your password"),T.jupyterSelectPasswordTitle=w.l10n.t("Enter your password for the Jupyter Server"),T.pythonNotInstalled=w.l10n.t(`Python is not installed. 
Please download and install Python in order to execute cells in this notebook. 
Once installed please reload VS Code.`),T.pleaseReloadVSCodeOncePythonHasBeenInstalled=w.l10n.t("Upon installing Python please reload VS Code."),T.jupyterNotebookFailure=B=>w.l10n.t(`Jupyter notebook failed to launch. \r
{0}`,B),T.remoteJupyterServerProvidedBy3rdPartyExtensionNoLongerValid=B=>w.l10n.t("The remote Jupyter Server contributed by the extension '{0}' is no longer available.",B),T.remoteJupyterConnectionFailedWithServerWithError=(B,ze)=>w.l10n.t("Failed to connect to the remote Jupyter Server '{0}'. Verify the server is running and reachable. ({1}).",B,ze),T.remoteJupyterConnectionFailedWithServer=B=>w.l10n.t("Failed to connect to the remote Jupyter Server '{0}'. Verify the server is running and reachable.",B),T.remoteJupyterConnectionFailedWithoutServerWithError=B=>w.l10n.t("Connection failure. Verify the server is running and reachable. ({0}).",B),T.remoteJupyterConnectionFailedWithoutServerWithErrorWeb=B=>w.l10n.t(`Connection failure. Verify the server is running and reachable from a browser. ({0}). 
When connecting from vscode.dev Jupyter servers must be started with specific options to connect. 
Click [here](https://aka.ms/vscjremoteweb) for more information.`,B),T.removeRemoteJupyterConnectionButtonText=w.l10n.t("Forget Connection"),T.jupyterNotebookRemoteConnectFailedWeb=B=>w.l10n.t(`Failed to connect to remote Jupyter Server.\r
Check that the Jupyter Server URL can be reached from a browser.\r
{0}. Click [here](https://aka.ms/vscjremoteweb) for more information.`,B),T.packageNotInstalledWindowsLongPathNotEnabledError=(B,ze)=>w.l10n.t(`Support for Windows Long Path has not been enabled, hence the package {0} could not be installed into the Python Environment '{1}'.
Please ensure that support for Windows Long Path is enabled.
See [here](https://pip.pypa.io/warnings/enable-long-paths) for more information.`,B,ze),T.changeRemoteJupyterConnectionButtonText=w.l10n.t("Manage Connections"),T.rawConnectionBrokenError=w.l10n.t("Direct kernel connection broken"),T.jupyterServerCrashed=B=>w.l10n.t(`Jupyter Server crashed. Unable to connect. \r
Error code from Jupyter: {0}`,B.toString()),T.jupyterKernelSpecModuleNotFound=B=>w.l10n.t(`'Kernelspec' module not installed in the selected interpreter ({0}).
 Please re-install or update 'jupyter'.`,B),T.interruptKernelStatus=B=>w.l10n.t("Interrupting Kernel {0}",B),T.exportPythonQuickPickLabel=w.l10n.t("Python Script"),T.exportHTMLQuickPickLabel=w.l10n.t("HTML"),T.exportPDFQuickPickLabel=w.l10n.t("PDF"),T.restartKernelAfterInterruptMessage=B=>w.l10n.t("Interrupting the kernel '{0}' timed out. Do you want to restart the kernel instead? All variables will be lost.",B),T.documentMismatch=B=>w.l10n.t("Cannot run cells, duplicate documents for {0} found.",B),T.jupyterGetVariablesBadResults=w.l10n.t("Failed to fetch variable info from the Jupyter Server."),w.l10n.t("Failure to create an 'Interactive' window. Try reinstalling the Python Extension."),T.jupyterGetVariablesExecutionError=B=>w.l10n.t(`Failure during variable extraction: \r
{0}`,B),T.selectKernel=w.l10n.t("Change Kernel"),T.selectDifferentKernel=w.l10n.t("Select a different Kernel"),T.kernelFilterPlaceholder=w.l10n.t("Choose the kernels that are available in the kernel picker."),T.recommendedItemCategoryInQuickPick=w.l10n.t("Recommended"),T.selectedKernelCategoryInQuickPick=w.l10n.t("Selected"),T.createPythonEnvironmentInQuickPick=w.l10n.t("Create Python Environment"),T.createPythonEnvironmentInQuickPickTooltip=w.l10n.t("Create an isolated Python Environment per workspace folder"),T.selectDifferentJupyterInterpreter=w.l10n.t("Change Interpreter"),T.pandasTooOldForViewingFormat=(B,ze)=>w.l10n.t({message:"Python package 'pandas' is version {0}. Version {1} or greater is required for viewing data.",args:[B,ze],comment:["Do not translate 'pandas' as that is a Python module name"]}),T.pandasRequiredForViewing=B=>w.l10n.t({message:"Python package 'pandas' version {0} (or above) is required for viewing data.",args:[B],comment:["Do not translate 'pandas' as that is a Python module name"]}),T.tooManyColumnsMessage=w.l10n.t("Variables with over a 1000 columns may take a long time to display. Are you sure you wish to continue?"),T.tooManyColumnsYes=w.l10n.t("Yes"),T.tooManyColumnsNo=w.l10n.t("No"),T.tooManyColumnsDontAskAgain=w.l10n.t("Don't Ask Again"),T.plotViewerTitle=w.l10n.t("Plots"),T.exportPlotTitle=w.l10n.t("Save plot image"),T.pdfFilter="PDF",T.pngFilter="PNG",T.svgFilter="SVG",T.exportImageFailed=B=>w.l10n.t("Error exporting image: {0}",B),T.jupyterDataRateExceeded=w.l10n.t({message:"Cannot view variable because data rate exceeded. Please restart your server with a higher data rate limit. For example, --NotebookApp.iopub_data_rate_limit=10000000000.0",comment:["Do not translate the text --NotebookApp.iopub_data_rate_limit=10000000000.0 as that is a command argument."]}),T.addCellBelowCommandTitle=w.l10n.t("Add cell"),T.debugCellCommandTitle=w.l10n.t("Debug Cell"),T.debugStepOverCommandTitle=w.l10n.t("Step over"),T.debugContinueCommandTitle=w.l10n.t("Continue"),T.debugStopCommandTitle=w.l10n.t("Stop"),T.runCurrentCellAndAddBelow=w.l10n.t("Run current cell and add empty cell below"),T.jupyterDebuggerNotInstalledError=B=>w.l10n.t("Pip module {0} is required for debugging cells. You will need to install it to debug cells.",B),T.jupyterDebuggerOutputParseError=B=>w.l10n.t("Unable to parse {0} output, please log an issue with https://github.com/microsoft/vscode-jupyter",B),T.cellStopOnErrorMessage=w.l10n.t("Cell was canceled due to an error in a previous cell."),T.scrollToCellTitleFormatMessage=B=>w.l10n.t("Go to [{0}]",B.toString()),T.instructionComments=B=>w.l10n.t(`# To add a new cell, type '{0}'
# To add a new markdown cell, type '{0} [markdown]'
`,B),T.exportButtonTitle=w.l10n.t("Export"),T.exportAsQuickPickPlaceholder=w.l10n.t("Export As..."),T.openExportedFileMessage=w.l10n.t("Would you like to open the exported file?"),T.openExportFileYes=w.l10n.t("Yes"),T.openExportFileNo=w.l10n.t("No"),T.exportFailedGeneralMessage=w.l10n.t({message:"Please check the 'Jupyter' [output](command:jupyter.viewOutput) panel for further details.",comment:['Do not translate the text "command:jupyter.viewOutput", that is a command Id that will be used by VS Code to open the output panel']}),T.exportToPDFDependencyMessage=w.l10n.t(`If you have not installed xelatex (TeX), you will need to do so before you can export to PDF. For further instructions, please see https://nbconvert.readthedocs.io/en/latest/install.html#installing-tex. \r
To avoid installing xelatex (TeX), you might want to try exporting to HTML and using your browser's "Print to PDF" feature.`),T.failedExportMessage=w.l10n.t("Export failed."),T.startingJupyterLogMessage=(B,ze)=>w.l10n.t("Starting Jupyter from {0} with arguments {1}",B,ze),T.waitingForJupyterSessionToBeIdle=w.l10n.t("Waiting for Jupyter Session to be idle"),T.gettingListOfKernelsForRemoteConnection=w.l10n.t("Fetching Kernels"),T.gettingListOfKernelSpecs=w.l10n.t("Fetching Kernel specs"),T.startingJupyterNotebook=w.l10n.t("Starting Jupyter Notebook"),T.registeringKernel=w.l10n.t("Registering Kernel"),T.jupyterCommandLineReloadQuestion=w.l10n.t("Please reload the window when changing the Jupyter command line."),T.jupyterCommandLineReloadAnswer=w.l10n.t("Reload"),T.createdNewKernel=(B,ze)=>w.l10n.t("{0}: Kernel started: {1}",B,ze),T.kernelInvalid=B=>w.l10n.t("Kernel {0} is not usable. Check the Jupyter output tab for more information.",B),T.removeRemoteJupyterServerEntryInQuickPick=w.l10n.t("Remove"),T.loadClassFailedWithNoInternet=(B,ze)=>w.l10n.t("Error loading {0}:{1}. Internet connection required for loading 3rd party widgets.",B,ze),T.useCDNForWidgetsNoInformation=w.l10n.t("Widgets require us to download supporting files from a 3rd party website."),T.enableCDNForWidgetsSetting=(B,ze)=>w.l10n.t("Widgets require us to download supporting files from a 3rd party website. (Error loading {0}:{1}).",B,ze),T.enableCDNForWidgetsButton=w.l10n.t("Enable Downloads"),T.unhandledMessage=(B,ze)=>w.l10n.t("Unhandled kernel message from a widget: {0} : {1}",B,ze),T.cdnWidgetScriptNotAccessibleWarningMessage=(B,ze)=>w.l10n.t("Unable to download widget '{0}' from 3rd party website {1}, due to network access. Expected behavior may be affected. Click [here](https://aka.ms/PVSCIPyWidgets) for more information.",B,ze),T.widgetScriptNotFoundOnCDNWidgetMightNotWork=(B,ze,vte)=>w.l10n.t("Unable to find widget '{0}' version '{1}' from configured widget sources {2}. Expected behavior may be affected. Click [here](https://aka.ms/PVSCIPyWidgets) for more information.",B,ze,vte),T.insecureSessionMessage=w.l10n.t("Connecting over HTTP without a token may be an insecure connection. Do you want to connect to a possibly insecure server?"),T.insecureSessionDenied=w.l10n.t("Denied connection to insecure server."),T.selectKernelForEditor=w.l10n.t("[Select a kernel](command:_notebook.selectKernel) to run cells."),T.needIpykernel6=w.l10n.t("Ipykernel setup required for this feature"),T.setup=w.l10n.t("Setup"),T.showDataViewerFail=w.l10n.t("Failed to create the Data Viewer. Check the Jupyter tab of the Output window for more info."),T.defaultNotebookName=w.l10n.t("default"),T.recommendExtensionForNotebookLanguage=(B,ze)=>w.l10n.t("The {0} extension is recommended for notebooks targeting the language '{1}'",B,ze),T.kernelWasNotStarted=w.l10n.t("Kernel was not started. A kernel session is needed to start debugging."),T.noNotebookToDebug=w.l10n.t("No active notebook document to debug."),T.cantStartDebugging=w.l10n.t("Can't start debugging."),T.restartNotSupported=w.l10n.t("Restarting is not supported in the interactive window."),T.importingIpynb=w.l10n.t("Importing notebook file"),T.exportingToFormat=B=>w.l10n.t("Exporting to {0}",B),T.kernelCategoryForJupyterSession=w.l10n.t("Jupyter Session"),T.kernelDefaultRemoteDisplayName=w.l10n.t("Remote"),T.kernelCategoryForJupyterKernel=w.l10n.t("Jupyter Kernel"),T.kernelCategoryForRemoteJupyterKernel=w.l10n.t("Jupyter Kernel"),T.kernelCategoryForConda=w.l10n.t("Conda Env"),T.kernelCategoryForCondaWithoutPython=w.l10n.t("Conda Env Without Python"),T.kernelCategoryForPoetry=w.l10n.t("Poetry Env"),T.kernelCategoryForPipEnv=w.l10n.t("Pipenv Env"),T.kernelCategoryForPyEnv=w.l10n.t("PyEnv Env"),T.kernelCategoryForGlobal=w.l10n.t("Global Env"),T.kernelCategoryForVirtual=w.l10n.t("Virtual Env"),T.fileSeemsToBeInterferingWithKernelStartup=B=>w.l10n.t("The file '{0}' seems to be overriding built in modules and interfering with the startup of the kernel. Consider renaming the file and starting the kernel again.",B),T.moduleSeemsToBeInterferingWithKernelStartup=B=>w.l10n.t("The module '{0}' seems to be overriding built in modules and interfering with the startup of the kernel. Consider renaming the folder and starting the kernel again.",B),T.pipCondaInstallHoverWarning=(B,ze)=>w.l10n.t("'!{0} install' could install packages into the wrong environment. [More info]({1})",B,ze),T.percentPipCondaInstallInsteadOfBang=B=>w.l10n.t({message:"Use '%{0} install' instead of '!{0} install'",args:[B],comment:['Do not translate the string within quotes, such as "%{0} install" and "!{0} install" as that is a Jupyter Shell Magic command']}),T.replacePipCondaInstallCodeAction=B=>w.l10n.t("Replace with '%{0} install'",B),T.failedToStartKernelDueToMissingModule=B=>w.l10n.t("The kernel failed to start due to the missing module '{0}'. Consider installing this module.",B),T.failedToStartKernelDueToImportFailure=B=>w.l10n.t("The kernel failed to start as the module '{0}' could not be imported.",B),T.failedToStartKernelDueToImportFailureFromFile=(B,ze)=>w.l10n.t("The kernel failed to start as '{0}' could not be imported from '{1}'.",B,ze),T.failedToStartKernelDueToUnknownDllLoadFailure=w.l10n.t("The kernel failed to start as a dll could not be loaded."),T.failedToStartKernelDueToDllLoadFailure=B=>w.l10n.t("The kernel failed to start as the dll '{0}' could not be loaded.",B),T.failedToStartKernelDueToWin32APIFailure=w.l10n.t("The kernel failed to start due to an error with the Win32api module. Consider (re) installing this module."),T.failedToStartKernelDueToPyZmqFailure=w.l10n.t({message:"The kernel failed to start due to an error with the 'pyzmq' module. Consider re-installing this module.",comment:['Do not translate the string "pyzmq" as that is a Python module.']}),T.failedToStartKernelDueToOldIPython=w.l10n.t("The kernel failed to start due to an outdated version of IPython. Consider updating this module to the latest version."),T.failedToStartKernelDueToOldIPyKernel=w.l10n.t("The kernel failed to start due to an outdated version of IPyKernel. Consider updating this module to the latest version."),T.failedToStartKernelDueToMissingPythonEnv=B=>w.l10n.t("The kernel failed to start as the Python Environment '{0}' is no longer available. Consider selecting another kernel or refreshing the list of Python Environments.",B),T.matplotlibWidgetInsteadOfOther=w.l10n.t("'%matplotlib' widget works best inside of VS Code"),T.matplotlibWidgetCodeActionTitle=w.l10n.t("More info"),T.allowExtensionToUseJupyterKernelApi=(B,ze)=>w.l10n.t("Do you want to give the extension '{0}' access to the Jupyter Kernels? Clicking '{1}' would allow this extension to execute code against the Jupyter Kernels.",B,ze),T.thanksForUsingJupyterKernelApiPleaseRegisterWithUs=B=>w.l10n.t("Thank you for trying the Jupyter API. Please file an issue on our repo to allow the extension {0} to use this API in production. This would prevent us from breaking your extension when updating the API (as it is still a work in progress).",B),T.activatingPythonEnvironment=B=>w.l10n.t("Activating Python Environment '{0}'",B),T.runningKernelStartupHooksFor=B=>w.l10n.t("Running Kernel startup hooks in '{0}'",B),T.cellAtFormat=(B,ze)=>w.l10n.t("{0} Cell {1}",B,ze),T.jupyterServerConsoleOutputChannel=w.l10n.t("Jupyter Server Console"),T.kernelConsoleOutputChannel=B=>w.l10n.t("{0} Kernel Console Output",B),T.webNotSupported=w.l10n.t("Operation not supported in web version of Jupyter Extension."),T.failedToInstallPythonExtension=w.l10n.t("Failed to install the Python Extension."),T.filesPossiblyOverridingPythonModulesMayHavePreventedKernelFromStarting=B=>w.l10n.t("Some of the following files found in the working directory may have prevented the Kernel from starting. Consider renaming them.",B),T.listOfFilesWithLinksThatMightNeedToBeRenamed=B=>w.l10n.t("File(s): {0} might need to be renamed.",B),T.failedToGetVersionOfPandas=w.l10n.t("Failed to get version of Pandas to use the Data Viewer."),T.failedToInstallPandas=w.l10n.t("Failed to install Pandas to use the Data Viewer."),T.localKernelSpecs=w.l10n.t("Jupyter Kernel..."),T.localPythonEnvironments=w.l10n.t("Python Environments..."),T.quickPickTitleForSelectionOfJupyterServer=w.l10n.t("Select a Jupyter Server"),T.UserJupyterServerUrlProviderDisplayName=w.l10n.t("Existing Jupyter Server..."),T.UserJupyterServerUrlProviderDetail=w.l10n.t("Connect to an existing Jupyter Server"),T.kernelPickerSelectKernelTitle=w.l10n.t("Select Kernel"),T.kernelPickerSelectLocalKernelSpecTitle=w.l10n.t("Select a Jupyter Kernel"),T.quickPickSelectPythonEnvironmentTitle=w.l10n.t("Select a Python Environment"),T.kernelPickerSelectKernelFromRemoteTitle=B=>w.l10n.t("Select a Kernel from {0}",B),T.kernelPickerSelectKernelFromRemoteTitleWithoutName=w.l10n.t("Select a Jupyter Kernel"),T.installPythonExtensionViaKernelPickerTitle=w.l10n.t("Install Python Extension"),T.installPythonExtensionViaKernelPickerToolTip=w.l10n.t("Python Extension is required to detect and use Python environments for the execution of code cells."),T.installPythonQuickPickTitle=w.l10n.t("Install Python"),T.installPythonQuickPickToolTip=w.l10n.t("Python Environments not detected. Upon installation reload VS Code or refresh the list of Kernels."),T.failedToFetchKernelSpecsRemoteErrorMessageForQuickPickLabel=w.l10n.t({message:"$(error) Unable to connect to the remote server",comment:"Do not translate the string $(error) as that is a VS Code icon."}),T.failedToFetchKernelSpecsRemoteErrorMessageForQuickPickDetail=w.l10n.t("Ensure the server is running and reachable."),T.dataViewerDeprecationMessage=w.l10n.t("The built-in data viewer will be deprecated soon. Please install other data viewing extensions to keep the ability to inspect data."),T.dataViewerDeprecationRecommendationActionMessage=w.l10n.t("See Recommended Extensions")))(C||(C={}));var Bt;(We=>(We.collapseSingle=w.l10n.t("Collapse"),We.expandSingle=w.l10n.t("Expand"),We.noRowsInDataViewer=w.l10n.t("No rows match current filter"),We.sliceIndexError=w.l10n.t({message:"Index {0} out of range for axis {1} with {2} elements",comment:["Do not translate the strings {0}, {1} and {2} as they are variable names and will be replaced later"]}),We.sliceMismatchedAxesError=w.l10n.t({message:"Expected {0} axes, got {1} in slice expression",comment:["Do not translate the strings {0} and {2} as they are variable names and will be replaced later"]}),We.fetchingDataViewer=w.l10n.t("Fetching data ..."),We.dataViewerHideFilters=w.l10n.t("Hide filters"),We.dataViewerShowFilters=w.l10n.t("Show filters"),We.refreshDataViewer=w.l10n.t("Refresh data viewer"),We.sliceSummaryTitle=w.l10n.t("SLICING"),We.sliceData=w.l10n.t("Slice Data"),We.sliceSubmitButton=w.l10n.t("Apply"),We.sliceDropdownAxisLabel=w.l10n.t("Axis"),We.sliceDropdownIndexLabel=w.l10n.t("Index"),We.variableExplorerNameColumn=w.l10n.t("Name"),We.variableExplorerTypeColumn=w.l10n.t("Type"),We.variableExplorerCountColumn=w.l10n.t("Size"),We.variableExplorerValueColumn=w.l10n.t("Value"),We.collapseVariableExplorerLabel=w.l10n.t("Variables"),We.variableLoadingValue=w.l10n.t("Loading..."),We.showDataExplorerTooltip=w.l10n.t("Show variable snapshot in data viewer"),We.noRowsInVariableExplorer=w.l10n.t("No variables defined"),We.loadingRowsInVariableExplorer=w.l10n.t("Loading variables"),We.previousPlot=w.l10n.t("Previous"),We.nextPlot=w.l10n.t("Next"),We.panPlot=w.l10n.t("Pan"),We.zoomInPlot=w.l10n.t("Zoom in"),We.zoomOutPlot=w.l10n.t("Zoom out"),We.exportPlot=w.l10n.t("Export to different formats"),We.deletePlot=w.l10n.t("Remove"),We.selectedImageListLabel=w.l10n.t("Selected Image"),We.selectedImageLabel=w.l10n.t("Image"),We.errorOutputExceedsLinkToOpenFormatString=w.l10n.t({message:"Output exceeds the <a href={0}>size limit</a>. Open the full output data <a href={1}>in a text editor</a>",comment:['Do not translate the the Hyperlink text "<a href={0}>size limit</a>" and "<a href={1}>in a text editor</a>". However the text inside those tags can be translated']}),We.dvDeprecationWarning=w.l10n.t('The built-in data viewer will be deprecated and no longer usable starting with Visual Studio Code 1.92. Please <a href="command:workbench.extensions.search?%22@tag:jupyterVariableViewers%22">install other data viewing extensions</a> to continue inspecting data')))(Bt||(Bt={}));var iy;(n=>(n.SHOW_DEPRECATED_FEATURE_PROMPT_FORMAT_ON_SAVE=w.l10n.t({message:"The setting 'python.formatting.formatOnSave' is deprecated, please use 'editor.formatOnSave'.",comment:['Do not translate the string "python.formatting.formatOnSave" as that is a setting in VS Code','Do not translate the string "editor.formatOnSave" as that is a setting in VS Code']}),n.SHOW_DEPRECATED_FEATURE_PROMPT_LINT_ON_TEXT_CHANGE=w.l10n.t({message:"The setting 'python.linting.lintOnTextChange' is deprecated, please enable 'python.linting.lintOnSave' and 'files.autoSave'.",comment:['Do not translate the string "python.linting.lintOnTextChange" as that is a setting in VS Code','Do not translate the string "python.linting.lintOnSave" as that is a setting in VS Code']}),n.SHOW_DEPRECATED_FEATURE_PROMPT_FOR_AUTO_COMPLETE_PRELOAD_MODULES=w.l10n.t({message:"The setting 'python.autoComplete.preloadModules' is deprecated, please consider using Pylance Language Server ('python.languageServer' setting).",comment:['Do not translate the string "python.autoComplete.preloadModules" as that is a setting in VS Code','Do not translate the string "python.languageServer" as that is a setting in VS Code']})))(iy||(iy={}));var WH;(n=>(n.noCondaOrPipInstaller=w.l10n.t("There is no Conda or Pip installer available in the selected environment."),n.noPipInstaller=w.l10n.t("There is no Pip installer available in the selected environment."),n.searchForHelp=w.l10n.t("Search for help")))(WH||(WH={}));var VH;(e=>e.installingModule=t=>w.l10n.t("Installing {0}",t))(VH||(VH={}));u();var BH=_L(),ZP=class{constructor(e,t,n){this.channel=e;this.homeReplaceRegEx=t,this.userNameReplaceRegEx=n}format(e,t,...n){let i=e?`${eP()} [${e}] ${BH(t,...n)}`:BH(t,...n);return this.homeReplaceRegEx&&(i=i.replace(this.homeReplaceRegEx,"~")),this.userNameReplaceRegEx&&(i=i.replace(this.userNameReplaceRegEx,"<username>")),i}error(e,...t){this.channel.appendLine(this.format("error",e,...t))}warn(e,...t){this.channel.appendLine(this.format("warn",e,...t))}info(e,...t){this.channel.appendLine(this.format("info",e,...t))}debug(e,...t){this.channel.appendLine(this.format("debug",e,...t))}trace(e,...t){this.channel.appendLine(this.format("trace",e,...t))}ci(e,...t){}};u();var HH=_L();function HE(r,e,...t){let i=[...t].length===0?HH(e):HH(e,...t);return r?`${r} ${eP()}: ${i}`:i}var eT=class{constructor(e){this.prefix=e}error(e,...t){console.error(HE("error",`${this.prefix||""} ${e}`,...t))}warn(e,...t){console.warn(HE("warn",`${this.prefix||""} ${e}`,...t))}info(e,...t){console.info(HE("info",`${this.prefix||""} ${e}`,...t))}debug(e,...t){console.log(HE("debug",`${this.prefix||""} ${e}`,...t))}trace(e,...t){console.trace(HE("trace",`${this.prefix||""} ${e}`,...t))}ci(e,...t){}};var EL="",Vse=3,xp=[],Dp=gr.LogLevel.Info,b={error:(r,...e)=>jse(r,...e),warn:(r,...e)=>zH(r,...e),info:(r,...e)=>Bse(r,...e),debug:(r,...e)=>Hse(r,...e),trace:(r,...e)=>Jse(r,...e),ci:(r,...e)=>{e&&Array.isArray(e)?GH(r,...e):GH(r)}};function YH(r){Dp=qH(),Au(gr.workspace.onDidChangeConfiguration(t=>{t.affectsConfiguration("jupyter.logging")&&(Dp=qH())}));let e=gr.window.createOutputChannel(XP.jupyter,"log");return JH(new ZP(e,r==null?void 0:r.userNameRegEx,r==null?void 0:r.homePathRegEx)),JH(new eT(ji?void 0:"Jupyter Extension:")),e}function JH(r){return xp.push(r),{dispose:()=>{xp=xp.filter(e=>e!==r)}}}function qH(){try{let{level:r}=gr.workspace.getConfiguration("jupyter").get("logging",{level:"Info"});switch(r){case"debug":case"Debug":return gr.LogLevel.Debug;case"warn":case"Warn":case"warning":case"Warning":return gr.LogLevel.Warning;case"Off":case"off":return gr.LogLevel.Off;case"Error":case"error":return gr.LogLevel.Error;case"Trace":case"trace":return gr.LogLevel.Trace;default:return gr.LogLevel.Info}}catch(r){return console.error("Failed to get logging level from configuration",r),gr.LogLevel.Info}}function $H(...r){return Dp<=gr.LogLevel.Debug?r:r.map(t=>{if(!(t instanceof Error)||!("isJupyterError"in t))return t;let n=[`${t.name}: ${t.message}`.trim()];if("kernelConnectionMetadata"in t&&t.kernelConnectionMetadata&&typeof t.kernelConnectionMetadata=="object"&&"id"in t.kernelConnectionMetadata&&(n.push(`Kernel Id = ${t.kernelConnectionMetadata.id}`),"interpreter"in t.kernelConnectionMetadata&&t.kernelConnectionMetadata.interpreter&&typeof t.kernelConnectionMetadata.interpreter=="object"&&"id"in t.kernelConnectionMetadata.interpreter&&typeof t.kernelConnectionMetadata.interpreter.id=="string"&&n.push(`Interpreter Id = ${ve(t.kernelConnectionMetadata.interpreter.id)}`)),t.stack){let o=st(t.stack),s=o.find(a=>a.indexOf("at ")===0);o.length===1||(o.length===1?n.push(o[0]):o.length>1&&(s!=null&&s.length)?n.push(s):n.push(o[0]))}let i=["stack","message","name","kernelConnectionMetadata","category","exitCode","isJupyterError"];return Object.keys(t).filter(o=>i.indexOf(o)===-1).forEach(o=>n.push(`${o} = ${String(t[o]).trim()}`)),n.filter(o=>o.trim().length).map((o,s)=>s===0?o:`    > ${o}`).join(`
`)})}function jse(r,...e){Dp<=gr.LogLevel.Error&&(e=$H(...e),xp.forEach(t=>t.error(r,...e)))}function zH(r,...e){Dp<=gr.LogLevel.Warning&&(e=$H(...e),xp.forEach(t=>t.warn(r,...e)))}function Bse(r,...e){Dp<=gr.LogLevel.Info&&xp.forEach(t=>t.info(r,...e))}function Hse(r,...e){Dp<=gr.LogLevel.Debug&&xp.forEach(t=>t.debug(r,...e))}function Jse(r,...e){Dp<=gr.LogLevel.Trace&&xp.forEach(t=>t.trace(r,...e))}function GH(r,...e){if(ji)if(typeof r=="function"){let n=r(),i="",o=[];typeof n=="string"?i=n:(i=n.shift(),o=n),b.info(i,...o)}else b.info(r,...e)}function QH(r,e=Vse){return qse({message:r,opts:e,level:gr.LogLevel.Debug})}var Fu=new WeakMap;function wL(r){return(e,t,n)=>{Fu.has(e)||Fu.set(e,new Map);let i=Fu.get(e);i||Fu.set(e,i=new Map),i.has(t)||i.set(t,[]),i.get(t).push({parameterIndex:n,propertyOfParameterToLog:r})}}function XH(){return(r,e,t)=>{Fu.has(r)||Fu.set(r,new Map);let n=Fu.get(r);n||Fu.set(r,n=new Map),n.has(e)||n.set(e,[]),n.get(e).push({parameterIndex:t,ignore:!0})}}function qse(r){return k9((e,t)=>Qse(r,t,e),(r.opts&4)>0)}function Gse(r){let{kind:e,name:t,args:n}=r;return(!e||e==="")&&(e="Function"),(!t||t==="")&&(t="<anon>"),n||(n=[]),{kind:e,name:t,args:n,methodName:r.methodName||"",target:r.target||void 0}}function Yse(r){if(!r)return!1;let e=r;return typeof e.path=="string"&&typeof e.scheme=="string"}function CL(r){let e=EL?r.toLowerCase().indexOf(EL):-1;return e===-1?r:`~${r.substring(e+EL.length)}`}function $se(r,e,t,n){var a;if(Yse(t))return CL(t.path);if(!t)return t;let i=(a=Fu.get(r))==null?void 0:a.get(e),o=i==null?void 0:i.find(l=>l.parameterIndex===n);if(!o)return typeof t=="string"?CL(t):t;if("ignore"in o&&o.ignore)return"";let s=t;return"propertyOfParameterToLog"in o&&o.propertyOfParameterToLog&&(s=t[o.propertyOfParameterToLog]),typeof s=="string"?CL(s):s}function zse(r,e,t){t=Gse(t);let n=[r.message];return n.push(`${t.kind} name = ${t.name}`.trim()),e?(n.push(`completed in ${e.elapsed}ms`),n.push(`has a ${e.returnValue?"truthy":"falsy"} return value`)):n[n.length-1]=`${n[n.length-1]} (started execution)`,(r.opts&1)===1&&(r.level===gr.LogLevel.Debug?n.push(TO(t.args.map((i,o)=>t?$se(t.target,t.methodName,i,o):i))):n.push(TO(t.args))),e&&(r.opts&2)===2&&n.push(N9(e.returnValue)),n.join(", ")}function Qse(r,e,t){let n=zse(r,e,t);e?e.err===void 0?r.level&&r.level===gr.LogLevel.Error||(r.level?tT(r.level,n):tT(gr.LogLevel.Info,n)):tT(gr.LogLevel.Error,n,e.err):r.level&&r.level!==gr.LogLevel.Error&&tT(r.level,n)}function tT(r,e,...t){switch(r){case gr.LogLevel.Error:b.error(e,...t);break;case gr.LogLevel.Warning:zH(e,...t);break;case gr.LogLevel.Info:b.info(e,...t);break;case gr.LogLevel.Debug:case gr.LogLevel.Trace:b.debug(e,...t);break;default:break}}var Xl=require("vscode");u();var CV=require("vscode");u();var ZH=Symbol("IsDevMode"),Lm=Symbol("IOutputChannel"),e7=Symbol("IS_WINDOWS"),ie=Symbol("IDisposableRegistry"),St=Symbol("IGlobalMemento"),ir=Symbol("IGlobalMemento"),Es=Symbol("IWorkspaceMemento");var rT=Symbol("IPersistentStateFactory"),pNe=Symbol("IRandom"),Ae=Symbol("IConfigurationService"),ot=Symbol("ExtensionContext"),Ba=Symbol("IExtensions"),fNe=Symbol("IJupyterExtensionBanner"),nT=Symbol("IFeaturesManager"),oy=Symbol("ICryptoUtils"),Ha=Symbol("IAsyncDisposableRegistry");var Sc=Symbol("IExperimentService"),sy=Symbol("IDataScienceCommandListener"),ay=Symbol("IVariableScriptGenerator"),ly=Symbol("IDataFrameScriptGenerator");u();var Q$=require("vscode");u();var p7=$(d7()),JE=$(te());try{(0,JE.decorate)((0,JE.injectable)(),p7.EventEmitter)}catch(r){b.warn("Failed to decorate EventEmitter for DI (possibly already decorated by another Extension)",r)}var rt=class{constructor(e){this.container=e;rt._instance=this}static get instance(){return rt._instance}get(e,t){return t?this.container.getNamed(e,t):this.container.get(e)}getAll(e,t){return t?this.container.getAllNamed(e,t):this.container.getAll(e)}tryGet(e,t){try{return t?this.container.getNamed(e,t):this.container.get(e)}catch(n){}}};rt=E([(0,JE.injectable)()],rt);u();u();var Ct=require("vscode");u();var uy=Symbol("IPythonApi"),Io=Symbol("IPythonExtensionChecker");var xa=$(te());u();u();u();var DL="Python Kernel Debug Adapter",PL="Python Interactive Window Debug Adapter";u();u();var sT=$(m7()),YE=$(g7());u();u();var py=require("vscode");u();u();var it=class extends Error{constructor(t,n){super(n);this.category=t;this.isJupyterError=!0}},Xn=class r extends it{constructor(t,n,i){super(i||TL(n),t);this.originalException=n;n&&(this.stack=`${new Error("").stack}

${n.stack}`)}static from(t,n){return n instanceof it?n:new r(t,n)}static unwrap(t){return t&&(t instanceof r&&t.originalException&&t.originalException instanceof it&&(t=t.originalException),t)}};function TL(r){return r&&r instanceof it?r.category:"unknown"}var Pp=class extends it{constructor(t,n,i){super("jupyterconnection",t+(n?`
${n}`:""));this.interpreter=i}};u();var tn=class extends it{constructor(){super("sessionDisposed",C.sessionDisposed)}};function v7(r=""){let e=y7(r);return e?e[1]:void 0}function y7(r=""){if(!r)return;let e=r.trim().split(`
`).map(t=>t.trim()).filter(t=>t.trim().length).reverse();if(e.length!==0&&e[0].includes("Error"))return[e.length>1?e[1]:"",e[0]]}function b7(r){if(!r)return;let t=(Array.isArray(r)?r[0]:r).split(`
`).map(l=>l.trim().toLowerCase()).filter(l=>l.length).reverse().find(l=>l.startsWith("file ")&&l.includes(", line ")&&l.includes(".py")&&l.includes(".py"));if(!t)return;let i=(t.substring(0,t.lastIndexOf(".py"))+".py").replace(/\\/g,"/").split("/"),o=i.indexOf("site-packages"),s=o>=0&&i.length>o+1?i[o+1]:"",a=i.reverse();if(!(a.length<2))return{fileName:a[0],folderName:a[1],packageName:s}}function Km(r,e,t,n="",i=[]){let o=e instanceof it?e.stdErr||e.stack||"":e.toString(),s=y7(o),a=o.toLowerCase();if(e instanceof tn)return{reason:"sessionDisposed",message:C.sessionDisposed,moreInfoLink:"https://aka.ms/kernelDisposedCannotRunCell",telemetrySafeTags:["deadSession"]};if(a.includes("ImportError: No module named 'win32api'".toLowerCase()))return{reason:"importWin32apiFailure",message:C.failedToStartKernelDueToWin32APIFailure,moreInfoLink:"https://aka.ms/kernelFailuresWin32Api",telemetrySafeTags:["win32api"]};if(a.includes("ImportError: DLL load failed".toLowerCase())&&a.includes("win32api"))return{reason:"importWin32apiFailure",message:C.failedToStartKernelDueToWin32APIFailure,moreInfoLink:"https://aka.ms/kernelFailuresWin32Api",telemetrySafeTags:["dll.load.failed","win32api"]};if(a.includes("ImportError: DLL load failed".toLowerCase())){let d=s&&s[0].toLowerCase().startsWith("import")?s[0].substring(6).trim():void 0;return{reason:"dllLoadFailure",moduleName:d,message:d?C.failedToStartKernelDueToDllLoadFailure(d):C.failedToStartKernelDueToUnknownDllLoadFailure,moreInfoLink:"https://aka.ms/kernelFailuresDllLoad",telemetrySafeTags:["dll.load.failed"]}}if(a.includes("AssertionError: Couldn't find Class NSProcessInfo".toLowerCase()))return{reason:"oldIPythonFailure",message:C.failedToStartKernelDueToOldIPython,moreInfoLink:"https://aka.ms/kernelFailuresOldIPython",telemetrySafeTags:["oldipython"]};if(a.includes("NotImplementedError".toLowerCase())&&a.includes("asyncio".toLowerCase())&&a.includes("events.py".toLowerCase()))return{reason:"oldIPyKernelFailure",message:C.failedToStartKernelDueToOldIPyKernel,moreInfoLink:"https://aka.ms/kernelFailuresOldIPyKernel",telemetrySafeTags:["oldipykernel"]};{let d=[];if(a.includes("ImportError: cannot import name".toLowerCase())&&a.includes("from partially initialized module".toLowerCase())&&a.includes("zmq.backend.cython".toLowerCase())&&d.push("zmq.backend.cython"),a.includes("zmq".toLowerCase())&&a.includes("cython".toLowerCase())&&a.includes("__init__.py".toLowerCase())&&d.push("zmq.cython"),a.includes("zmq.error.ZMQError")&&d.push("zmq.error"),d.length)return{reason:"zmqModuleFailure",message:C.failedToStartKernelDueToPyZmqFailure,moreInfoLink:"https://aka.ms/kernelFailuresPyzmq",telemetrySafeTags:d}}if(s&&s[1].toLowerCase().startsWith("importerror")){let d=h7(s[1]);if(d&&n){let p=aae(d.moduleName,d.fileName,r,n);return p||{reason:"importFailure",moduleName:d.moduleName,fileName:d.fileName,message:d.fileName?C.failedToStartKernelDueToImportFailureFromFile(d.moduleName,d.fileName):C.failedToStartKernelDueToImportFailure(d.moduleName),moreInfoLink:d.fileName?"https://aka.ms/kernelFailuresModuleImportErrFromFile":"https://aka.ms/kernelFailuresModuleImportErr",telemetrySafeTags:["import.error"]}}}let l="No module named".toLowerCase(),c="is not a package".toLowerCase();if(a.includes(l)&&!c){let d=st(o).map(f=>f.trim()).filter(f=>f.length).find(f=>f.toLowerCase().includes(l)),p=d?d.substring(d.toLowerCase().indexOf(l)+l.length).trim():"";if(d)return{reason:"moduleNotFound",moduleName:p,message:C.failedToStartKernelDueToMissingModule(p),moreInfoLink:"https://aka.ms/kernelFailuresMissingModule",telemetrySafeTags:["module.notfound.error"]}}else if(a.includes(l)&&c){let d=st(o).map(h=>h.trim()).filter(h=>h.length).find(h=>h.toLowerCase().includes(l)),p=d?d.substring(d.toLowerCase().indexOf(l)+l.length).trim():"",f="",m="";p.split("'").length>2&&(f=p.split("'").slice(-2)[0]||"",f=f?`${f}.py`:"",m=f||"",p=p.split("'")[1]||p);let g=i.filter(h=>mi(h).toLowerCase()==="__init__.py").map(h=>mi(qv(h)));return p&&f&&p!==f&&i.some(h=>mi(h).toLowerCase()===f.toLowerCase())?{reason:"overridingBuiltinModules",fileName:f,moduleName:p,message:C.fileSeemsToBeInterferingWithKernelStartup(f),moreInfoLink:"https://aka.ms/kernelFailuresOverridingBuiltInModules",telemetrySafeTags:["import.error","override.modules"]}:p&&g&&p!==m&&g.some(h=>h.toLowerCase()===m.toLowerCase())?{reason:"overridingBuiltinModules",folderName:m,moduleName:p,message:C.moduleSeemsToBeInterferingWithKernelStartup(m),moreInfoLink:"https://aka.ms/kernelFailuresOverridingBuiltInModules",telemetrySafeTags:["import.error","override.modules"]}:{reason:"moduleNotFound",moduleName:p,message:C.failedToStartKernelDueToMissingModule(p),moreInfoLink:"https://aka.ms/kernelFailuresMissingModule",telemetrySafeTags:["module.notfound.error"]}}else if(e instanceof it&&e.category==="invalidkernel"&&i.length){let d=mi(i[0]);return{reason:"overridingBuiltinModules",fileName:d,moduleName:mi(i[0],".py"),message:C.fileSeemsToBeInterferingWithKernelStartup(d),moreInfoLink:"https://aka.ms/kernelFailuresOverridingBuiltInModules",telemetrySafeTags:["import.error","override.modules"]}}else if(s&&s[1].toLowerCase().startsWith("ModuleNotFoundError".toLowerCase())){let d=h7(s[1]);if(d)return{reason:"moduleNotFound",moduleName:d.moduleName,message:C.failedToStartKernelDueToMissingModule(d.moduleName),moreInfoLink:"https://aka.ms/kernelFailuresMissingModule",telemetrySafeTags:["module.notfound.error"]}}if(e instanceof Pp){let d=st(o).map(v=>v.trim()).reverse().find(v=>v.toLowerCase().includes("error: ")),p="AttributeError: 'Namespace' object has no attribute '_flags'",f=["jupyter.startup.failure"],m,g="jupyterStartFailure",h=st(e.message,{removeEmptyEntries:!0,trim:!0}).reverse().find(v=>v.toLowerCase().includes("error: "));if(h=h||st(e.stdErr||"",{removeEmptyEntries:!0,trim:!0}).reverse().find(v=>v.toLowerCase().includes("error: ")),a.includes(p.toLowerCase())?(g="jupyterStartFailureOutdatedTraitlets",d=C.failedToStartJupyterDueToOutdatedTraitlets(t||"",h||""),f.push("outdated.traitlets"),m="https://aka.ms/kernelFailuresJupyterTrailtletsOutdated"):(d=h?C.failedToStartJupyterWithErrorInfo(t||"",h):C.failedToStartJupyter(t||""),m=void 0),d)return{reason:g,message:d,pythonError:h,moreInfoLink:m,telemetrySafeTags:f}}}function h7(r){r=r.replace(/"/g,"'");let e=r.match(/'[^\\']*(\\'[^\\']*)*'/g),t=r.match(/\((.*?)\)/g),n,i;return e&&e[0].length>2&&(n=e[0],n=n.substring(1,n.length-1)),t&&t[0].length>2&&(i=t[0],i=i.substring(1,i.length-1)),n?{moduleName:n,fileName:i}:void 0}function aae(r,e,t,n){if(n&&t.length!==0&&e&&!e.toLowerCase().startsWith(n)&&t.some(i=>e.toLowerCase().startsWith(i.uri.fsPath.toLowerCase())))return{reason:"overridingBuiltinModules",fileName:e,moduleName:r,message:C.fileSeemsToBeInterferingWithKernelStartup(ve(py.Uri.file(e),t||[])),moreInfoLink:"https://aka.ms/kernelFailuresOverridingBuiltInModules",telemetrySafeTags:["import.error","override.modules"]}}function fy(r){if(!r)return;let e=/\[([^\[\]]*)\]\((.*?)\)/gm,t;for(;(t=e.exec(r))!==null;)t.length===3&&(r=r.replace(t[0],`<a href='${t[2]}'>${t[1]}</a>`));let n=st(r,{removeEmptyEntries:!1,trim:!1}).map(i=>`\x1B[1;31m${i}`).join(`
`);return new py.NotebookCellOutput([py.NotebookCellOutputItem.error({message:"",name:"",stack:n})])}var lae=[cae,uae];function I7(r){let e=[],t=Array.isArray(r)?r[0].toLowerCase():r.toLowerCase();lae.forEach(i=>i(t,e));let n=Km([],t,void 0);return n!=null&&n.telemetrySafeTags.length&&e.push(...n.telemetrySafeTags),Array.from(new Set(e)).join(",")}function cae(r,e=[]){r.includes("ChildProcess.exithandler".toLowerCase())&&e.push("childproc.exit")}function uae(r,e=[]){r.includes("KernelRestarter: restart failed".toLowerCase())&&e.push("KernelRestarter.failed")}function S7(){return(new Error().stack||"").split(`
`).filter(r=>r.includes(Ge))}async function _7(r,e){r.failed=!0,r.failureCategory=r.failureCategory||TL(e);let t=!sT.FetchError&&(e==null?void 0:e.name)==="TypeError"&&(e==null?void 0:e.message)==="Failed to fetch",i=(t||sT.FetchError!==void 0)&&fae(e,t?TypeError:sT.FetchError);r.failureCategory==="unknown"&&i&&(r.failureCategory="fetcherror"),r.stackTrace=dae(e),typeof e=="string"&&(r.failureSubCategory="errorisstring");let o=e.stdErr?e.stdErr:e.stack||"";if(!o)return;r.failureSubCategory=r.failureSubCategory||I7(o);let s=b7(o);s&&([r.pythonErrorFile,r.pythonErrorFolder,r.pythonErrorPackage]=await Promise.all([Promise.resolve(r.pythonErrorFile||Nt(s.fileName)),Promise.resolve(r.pythonErrorFolder||Nt(s.folderName)),Promise.resolve(r.pythonErrorPackage||Nt(s.packageName))]))}function kL(r){if(r.stack&&Array.isArray(r.stack)){let e={...r,stack:r.stack.join(`
`)};return YE.parse.call(YE,e)}return YE.parse.call(YE,r)}function dae(r){let e="";for(let t of kL(r)){let n=t.getFileName();if(n){let i=t.getLineNumber(),o=t.getColumnNumber();e+=`
	at ${pae(t)} ${n}:${i}:${o}`}else e+=`
	at <anonymous>`}return e.trim().replace(/\\/g,"/")}function pae(r){let e=[];return typeof r.getTypeName()=="string"&&r.getTypeName().length>0&&e.push(r.getTypeName()),typeof r.getMethodName()=="string"&&r.getMethodName().length>0&&e.push(r.getMethodName()),typeof r.getFunctionName()=="string"&&r.getFunctionName().length>0&&(e.length!==2||e.join(".")!==r.getFunctionName())&&e.push(r.getFunctionName()),e.join(".")}function fae(r,e){return e?r instanceof e||r instanceof Xn&&r.originalException instanceof e:(console.error("Error type is not defined",r),!1)}var m0=require("vscode");function zde(){try{return require("vscode")===void 0?!1:q4()!==void 0}catch(r){return!1}}function h0(){return m0.workspace.getConfiguration("telemetry").inspect("enableTelemetry").globalValue===!1}function v0(r){return m0.workspace.onDidChangeConfiguration(e=>{if(!e.affectsConfiguration("telemetry"))return;let n=m0.workspace.getConfiguration("telemetry").inspect("enableTelemetry").globalValue===!1;r(n)})}var g0={};function Jb(r,e){let t=r;PE()&&t.startsWith("ds_")||(e===void 0?delete g0[t]:g0[t]=e)}var M2;function q4(){if(M2)return M2;let r=(B4(),qD(j4)).default;return M2=new r(b9)}function H4(r,e){let t={};return Object.getOwnPropertyNames(e).forEach(n=>{if(!(e[n]===void 0||e[n]===null))try{t[n]=typeof e[n]=="string"?e[n]:typeof e[n]=="object"?"object":e[n].toString()}catch(i){b.error(`Failed to serialize ${n} for ${r}`,i)}}),t}function J(r,e,t,n){!G4(r.toString())&&(vn()||!zde())||Qde(r,e,t,n)}function G4(r){return r==="DATASCIENCE.JUPYTER_NOTEBOOK_EDIT_PERFORMANCE"||r==="DATASCIENCE.JUPYTER_JUPYTER_NOTEBOOK_EXEC_PERFORMANCE"||r==="DATASCIENCE.JUPYTER_NOTEBOOK_EXEC_PERFORMANCE"}function Qde(r,e,t,n){let i=q4(),o={},s=r;n?(o={},Object.assign(o,g0),Object.assign(o,t||{}),_7(o,n).then(()=>{o=H4(s,o),i.sendTelemetryEvent(s,o,e)}).catch(y)):(t&&(o=H4(s,t)),Object.assign(o,g0),G4(s)?i.sendDangerousTelemetryEvent(s,o,e):i.sendTelemetryEvent(s,o,e))}var J4=new Set;function Nr(r,e){return function(t,n,i){let o=i.value;return i.value=function(...s){let a=e||{},l=new It,c=`${r.toString()}${JSON.stringify(a)}`,d=!J4.has(c);J4.add(c);let p=o.apply(this,s);return p&&typeof p.then=="function"&&typeof p.catch=="function"?p.then(f=>{let m={...a};return d&&(m.firstTime=d),J(r,l?{duration:l==null?void 0:l.elapsedTime}:void 0,m),f}).catch(f=>{let m={...a};m.failed=!0,J(r,l?{duration:l==null?void 0:l.elapsedTime}:{},m,f)}):J(r,l?{duration:l==null?void 0:l.elapsedTime}:void 0,a),p},i}}function Mn(r,e){return function(t,n,i){let o=i.value;return i.value=function(...s){return J(r,void 0,e),o.apply(this,s)},i}}function Xde(){return{isInsiderExtension:{classification:"SystemMetaData",purpose:"FeatureInsight",comment:"Whether this is the Insider version of the Jupyter extension or not. Common to all events."},isPythonExtensionInstalled:{classification:"SystemMetaData",purpose:"FeatureInsight",comment:"Whether Python extension is installed or not. Common to all events."},rawKernelSupported:{classification:"SystemMetaData",purpose:"FeatureInsight",comment:"Whether the raw kernel is supported or not. Common to all events."}}}function lt(){return{duration:{classification:"PublicNonPersonalData",purpose:"PerformanceAndHealth",isMeasurement:!0}}}function ss(){return{resourceType:{classification:"PublicNonPersonalData",comment:"",purpose:"FeatureInsight"}}}function Pd(){return{failed:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},failureCategory:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},failureSubCategory:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},pythonErrorFile:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},pythonErrorFolder:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},pythonErrorPackage:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},stackTrace:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"}}}function so(){return{properties:{actionSource:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},disableUI:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},userExecutedCell:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},resourceHash:{classification:"PublicNonPersonalData",purpose:"PerformanceAndHealth"},pythonEnvironmentVersion:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},pythonEnvironmentType:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},pythonEnvironmentPath:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},pythonEnvironmentPackages:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},kernelSessionId:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},kernelLanguage:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},kernelSpecHash:{classification:"EndUserPseudonymizedInformation",purpose:"FeatureInsight"},kernelId:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},kernelConnectionType:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},isUsingActiveInterpreter:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},capturedEnvVars:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},newKernelPicker:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},...ss()}}}var K8e={...lt(),...Pd(),...Xde()};var Zde,epe,tpe,rpe,npe,ipe,ope,spe,ape,lpe,cpe,upe,dpe,ppe,fpe,mpe,gpe,hpe,vpe,ype,bpe,Ipe,Spe,_pe,Epe,Cpe,wpe,xpe,Dpe,Ppe,Tpe,kpe,Npe,Rpe,Ape,Mpe,Ope,Lpe,Kpe,Fpe,Upe,Wpe,Vpe,jpe,Bpe,Hpe,Jpe,qpe,Gpe,Ype,$pe,zpe,Qpe,Xpe,Zpe,efe,tfe,rfe,nfe,ife,ofe,sfe,afe,lfe,cfe,ufe,dfe,pfe,ffe,mfe,gfe,hfe,vfe,yfe,bfe,Ife,Sfe,_fe,Efe,Cfe,wfe,xfe,Dfe,Pfe,Tfe,kfe,Nfe,Rfe,Afe,Mfe,Ofe,Lfe,Kfe,Ffe,Ufe,Wfe,Vfe,jfe,Bfe,Hfe,Jfe,qfe,Gfe,Yfe,$fe,zfe,Qfe,Xfe,Zfe,eme,tme,rme,nme,ime,ome,sme,ame,lme,cme,ume,dme,pme,fme,mme,gme,hme,vme,yme,bme,Ime,Sme,_me,Eme,Cme,wme,xme,Dme,Pme,Tme,kme,Nme,Rme,Ame,Mme,Ome,Lme,Kme,Fme,Ume,Wme,Vme,jme,Bme,Hme,Jme,qme,Gme,Yme,$me,zme,Qme,Xme,Y4=class{constructor(){this[Zde]={owner:"donjayamanne",feature:"N/A",source:"N/A",measures:{totalActivateTime:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",isMeasurement:!0},codeLoadingTime:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",isMeasurement:!0},workspaceFolderCount:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",isMeasurement:!0}}};this[epe]={owner:"donjayamanne",feature:"N/A",source:"N/A",measures:lt()};this[tpe]={owner:"donjayamanne",feature:"N/A",source:"N/A"};this[rpe]={owner:"donjayamanne",feature:"N/A",source:"N/A"};this[npe]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{hashedNamev2:{classification:"SystemMetaData",purpose:"FeatureInsight"},when:{classification:"SystemMetaData",purpose:"FeatureInsight"},...ss()}};this[ipe]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{firstTime:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"}},measures:lt()};this[ope]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{mimeType:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},when:{classification:"SystemMetaData",purpose:"FeatureInsight"},...ss()}};this[spe]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{envType:{classification:"SystemMetaData",purpose:"FeatureInsight"},failed:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},reason:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},source:{classification:"SystemMetaData",purpose:"FeatureInsight"}},measures:lt()};this[ape]={owner:"IanMatthewHuff",source:"User Action",feature:["DataFrameViewer","VariableViewer"]};this[lpe]={owner:"IanMatthewHuff",source:"N/A",feature:["DataFrameViewer","VariableViewer"]};this[cpe]={owner:"IanMatthewHuff",source:"User Action",feature:["DataFrameViewer","VariableViewer"]};this[upe]={owner:"amunger",feature:["InteractiveWindow"],source:"User Action",measures:lt()};this[dpe]={owner:"amunger",feature:["InteractiveWindow"],source:"User Action",measures:lt()};this[ppe]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A",measures:{codeLensUpdateTime:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",isMeasurement:!0},maxCellCount:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0}}};this[fpe]={owner:"roblourens",feature:["Debugger"],source:"User Action"};this[mpe]={owner:"roblourens",feature:["Debugger"],source:"User Action"};this[gpe]={owner:"roblourens",feature:["Debugger"],source:"User Action"};this[hpe]={owner:"roblourens",feature:["Debugger"],source:"User Action"};this[vpe]={owner:"roblourens",feature:["Debugger"],source:"User Action"};this[ype]={owner:"donjayamanne",feature:"N/A",source:"N/A",tags:["KernelStartup"],properties:{...Pd(),failed:{classification:"CallstackOrException",purpose:"PerformanceAndHealth"},reason:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",comment:"Reason for failure to fetch kernel specs"},sessionManagerReady:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},specsManagerReady:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},wasSessionManagerReady:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},wasSpecsManagerReady:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"}},measures:lt()};this[bpe]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{kernelSpecHash:{classification:"EndUserPseudonymizedInformation",purpose:"FeatureInsight"},serverIdHash:{classification:"SystemMetaData",purpose:"FeatureInsight"},providerExtensionId:{classification:"SystemMetaData",purpose:"FeatureInsight"},baseUrlHash:{classification:"SystemMetaData",purpose:"FeatureInsight"},kernelId:{classification:"SystemMetaData",purpose:"FeatureInsight"},kernelConnectionType:{classification:"SystemMetaData",purpose:"FeatureInsight"},kernelLanguage:{classification:"SystemMetaData",purpose:"FeatureInsight"},envType:{classification:"SystemMetaData",purpose:"FeatureInsight"},isArgv0SameAsInterpreter:{classification:"SystemMetaData",purpose:"FeatureInsight"},argv0:{classification:"SystemMetaData",purpose:"FeatureInsight"},argv:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[Ipe]={owner:"donjayamanne",feature:"N/A",source:"N/A",tags:["KernelStartup"],properties:{serverIdHash:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},baseUrlHash:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},failed:{classification:"PublicNonPersonalData",purpose:"PerformanceAndHealth"},isLocalHost:{classification:"PublicNonPersonalData",purpose:"PerformanceAndHealth"},isJupyterHub:{classification:"PublicNonPersonalData",purpose:"PerformanceAndHealth"},reason:{classification:"PublicNonPersonalData",purpose:"PerformanceAndHealth"}}};this[Spe]={owner:"amunger",feature:["InteractiveWindow"],source:"User Action"};this[_pe]={owner:"amunger",feature:["InteractiveWindow"],source:"User Action"};this[Epe]={owner:"donjayamanne",feature:"N/A",source:"N/A",tags:["KernelStartup"],properties:so().properties,measures:{...lt()}};this[Cpe]={owner:"IanMatthewHuff",feature:["Import-Export","InteractiveWindow"],source:"User Action"};this[wpe]={owner:"IanMatthewHuff",feature:["Import-Export","InteractiveWindow"],source:"User Action"};this[xpe]={owner:"IanMatthewHuff",feature:["Import-Export","InteractiveWindow"],source:"User Action",properties:{format:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[Dpe]={owner:"IanMatthewHuff",feature:["Import-Export"],source:"N/A",properties:{format:{classification:"SystemMetaData",purpose:"FeatureInsight"},cancelled:{classification:"SystemMetaData",purpose:"FeatureInsight"},successful:{classification:"SystemMetaData",purpose:"FeatureInsight"},opened:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[Ppe]={owner:"IanMatthewHuff",feature:["Import-Export"],source:"User Action",properties:{scope:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[Tpe]={owner:"IanMatthewHuff",feature:["Import-Export"],source:"User Action",properties:{format:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[kpe]={owner:"IanMatthewHuff",feature:["Import-Export"],source:"N/A",properties:{format:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[Npe]={owner:"donjayamanne",feature:"N/A",source:"N/A"};this[Rpe]={owner:"donjayamanne",feature:"N/A",source:"N/A"};this[Ape]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{failed:{classification:"SystemMetaData",purpose:"FeatureInsight"},info:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[Mpe]={owner:"IanMatthewHuff",feature:["DataFrameViewer"],source:"N/A"};this[Ope]={owner:"IanMatthewHuff",feature:["DataFrameViewer"],source:"N/A"};this[Lpe]={owner:"IanMatthewHuff",feature:["DataFrameViewer"],source:"N/A"};this[Kpe]={owner:"IanMatthewHuff",feature:["DataFrameViewer"],source:"N/A"};this[Fpe]={owner:"donjayamanne",feature:"N/A",source:"N/A",measures:{nbformat:{classification:"PublicNonPersonalData",isMeasurement:!0,purpose:"FeatureInsight"},nbformat_minor:{classification:"PublicNonPersonalData",isMeasurement:!0,purpose:"FeatureInsight"}}};this[Upe]={owner:"IanMatthewHuff",feature:["PlotViewer"],source:"User Action"};this[Wpe]={owner:"amunger",feature:["InteractiveWindow"],source:"User Action"};this[Vpe]={owner:"amunger",feature:["InteractiveWindow"],source:"User Action"};this[jpe]={owner:"amunger",feature:["InteractiveWindow"],source:"User Action"};this[Bpe]={owner:"amunger",feature:["InteractiveWindow"],source:"User Action"};this[Hpe]={owner:"amunger",feature:["InteractiveWindow"],source:"User Action"};this[Jpe]={owner:"amunger",feature:["InteractiveWindow"],source:"User Action"};this[qpe]={owner:"amunger",feature:["InteractiveWindow"],source:"User Action"};this[Gpe]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A"};this[Ype]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A"};this[$pe]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A",measures:lt()};this[zpe]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A",measures:lt()};this[Qpe]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A",measures:lt()};this[Xpe]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A",measures:lt()};this[Zpe]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A",measures:lt()};this[efe]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A",measures:lt()};this[tfe]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A",measures:lt()};this[rfe]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A",measures:lt()};this[nfe]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A",measures:lt()};this[ife]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A",measures:lt()};this[ofe]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A",measures:lt()};this[sfe]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A",measures:lt()};this[afe]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A",measures:lt()};this[lfe]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A",measures:lt()};this[cfe]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A",measures:lt()};this[ufe]={owner:"donjayamanne",feature:"N/A",source:"N/A"};this[dfe]={owner:"donjayamanne",feature:"N/A",source:"N/A"};this[pfe]={owner:"donjayamanne",feature:"N/A",source:"N/A",tags:["KernelStartup"]};this[ffe]={owner:"IanMatthewHuff",feature:["DataFrameViewer"],source:"N/A"};this[mfe]={owner:"donjayamanne",feature:"N/A",source:"N/A",tags:["KernelStartup"]};this[gfe]={owner:"IanMatthewHuff",feature:["DataFrameViewer"],source:"N/A"};this[hfe]={owner:"IanMatthewHuff",feature:["KernelPicker"],source:"User Action",properties:{action:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[vfe]={owner:"donjayamanne",feature:["KernelPicker"],source:"User Action",properties:{action:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[yfe]={owner:"donjayamanne",feature:["KernelPicker"],source:"User Action",properties:{action:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[bfe]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{action:{classification:"SystemMetaData",purpose:"FeatureInsight"},isModulePresent:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},moduleName:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},pythonEnvType:{classification:"SystemMetaData",purpose:"FeatureInsight"},resourceHash:{classification:"SystemMetaData",purpose:"FeatureInsight"},...ss()},measures:lt()};this[Ife]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A"};this[Sfe]={owner:"IanMatthewHuff",feature:["DataFrameViewer"],source:"User Action",measures:lt()};this[_fe]={owner:"IanMatthewHuff",source:"N/A",feature:["DataFrameViewer"],measures:{rows:{classification:"PublicNonPersonalData",purpose:"FeatureInsight",isMeasurement:!0},columns:{classification:"PublicNonPersonalData",purpose:"FeatureInsight",isMeasurement:!0}}};this[Efe]={owner:"IanMatthewHuff",source:"N/A",feature:["DataFrameViewer"],measures:{rowsTimer:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"}}};this[Cfe]={owner:"IanMatthewHuff",feature:["DataFrameViewer","VariableViewer"],source:"N/A"};this[wfe]={owner:"IanMatthewHuff",feature:["DataFrameViewer"],source:"User Action"};this[xfe]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{failed:{classification:"SystemMetaData",purpose:"FeatureInsight"},fallbackTried:{classification:"SystemMetaData",purpose:"FeatureInsight"},alpine:{classification:"SystemMetaData",purpose:"FeatureInsight"},zmqarch:{classification:"SystemMetaData",purpose:"FeatureInsight"},libc:{classification:"SystemMetaData",purpose:"FeatureInsight"},armv:{classification:"SystemMetaData",purpose:"FeatureInsight"},distro_id:{classification:"SystemMetaData",purpose:"FeatureInsight"},distro_version_id:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[Dfe]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{failed:{classification:"SystemMetaData",purpose:"FeatureInsight"},fallbackTried:{classification:"SystemMetaData",purpose:"FeatureInsight"},alpine:{classification:"SystemMetaData",purpose:"FeatureInsight"},zmqarch:{classification:"SystemMetaData",purpose:"FeatureInsight"},libc:{classification:"SystemMetaData",purpose:"FeatureInsight"},armv:{classification:"SystemMetaData",purpose:"FeatureInsight"},distro_id:{classification:"SystemMetaData",purpose:"FeatureInsight"},distro_version_id:{classification:"SystemMetaData",purpose:"FeatureInsight"},errorMessage:{classification:"CallstackOrException",purpose:"FeatureInsight"},fallbackErrorMessage:{classification:"CallstackOrException",purpose:"FeatureInsight"},zmqBinaries:{classification:"CallstackOrException",purpose:"FeatureInsight"}}};this[Pfe]={owner:"IanMatthewHuff",feature:["VariableViewer"],source:"N/A",measures:lt()};this[Tfe]={owner:"IanMatthewHuff",feature:["VariableViewer"],source:"N/A",measures:{variableCount:{classification:"PublicNonPersonalData",purpose:"FeatureInsight",isMeasurement:!0}}};this[kfe]={owner:"donjayamanne",feature:"N/A",source:"N/A",tags:["KernelStartup"],properties:{kind:{classification:"SystemMetaData",purpose:"FeatureInsight"},language:{classification:"SystemMetaData",purpose:"FeatureInsight"},usesShell:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[Nfe]={owner:"donjayamanne",feature:"N/A",source:"N/A",tags:["KernelStartup"],properties:{...Pd(),...ss()},measures:{...lt()}};this[Rfe]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{kernelConnectionType:{classification:"SystemMetaData",purpose:"FeatureInsight"},pythonPathDefined:{classification:"SystemMetaData",purpose:"FeatureInsight"},pythonEnvFound:{classification:"SystemMetaData",purpose:"FeatureInsight"},language:{classification:"SystemMetaData",purpose:"FeatureInsight"},kernelSpecHash:{classification:"EndUserPseudonymizedInformation",purpose:"FeatureInsight"},argv0:{classification:"SystemMetaData",purpose:"FeatureInsight"},isCreatedByUs:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[Afe]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A"};this[Mfe]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A",properties:{hasKernel:{classification:"SystemMetaData",purpose:"FeatureInsight",comment:"If the kernel was known at the time of creation"},hasOwner:{classification:"SystemMetaData",purpose:"FeatureInsight",comment:"If the window was created for a text file"},mode:{classification:"SystemMetaData",purpose:"FeatureInsight",comment:"Creation mode: multiple, perfile or single"},restored:{classification:"SystemMetaData",purpose:"FeatureInsight",comment:"Was the window restored from a previous session"}},measures:{windowCount:{classification:"SystemMetaData",purpose:"FeatureInsight",comment:"Number of active interactive windows the user has open",isMeasurement:!0}}};this[Ofe]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],tags:["Widgets"],source:"N/A",properties:{cdnSearched:{classification:"SystemMetaData",purpose:"FeatureInsight"},hashedName:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},source:{classification:"SystemMetaData",purpose:"FeatureInsight"},moduleName:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},modelName:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},moduleVersion:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"}}};this[Lfe]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],tags:["Widgets"],source:"N/A",properties:{type:{classification:"SystemMetaData",purpose:"FeatureInsight"}},measures:lt()};this[Kfe]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],tags:["Widgets"],source:"N/A"};this[Ffe]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],tags:["Widgets"],source:"N/A",properties:{moduleHash:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},moduleVersion:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"}}};this[Ufe]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],tags:["Widgets"],source:"N/A",properties:{timedout:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},isOnline:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},moduleHash:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},moduleVersion:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"}}};this[Wfe]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],tags:["Widgets"],source:"N/A",properties:{moduleHash:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},moduleVersion:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"}}};this[Vfe]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],tags:["Widgets"],source:"N/A"};this[jfe]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],tags:["Widgets"],source:"N/A",properties:{selection:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"}}};this[Bfe]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],tags:["Widgets"],source:"N/A"};this[Hfe]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],tags:["Widgets"],source:"N/A",properties:{msg_type:{classification:"PublicNonPersonalData",purpose:"PerformanceAndHealth"}}};this[Jfe]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],source:"N/A",tags:["KernelStartup"],measures:{...lt(),attempts:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",isMeasurement:!0}},properties:{...so().properties,timedout:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"}}};this[qfe]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],source:"N/A",tags:["KernelStartup"],measures:lt()};this[Gfe]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],source:"User Action",tags:["Cell Execution"],measures:{...lt()},properties:{...so().properties,...Pd()}};this[Yfe]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],source:"User Action",tags:["Code Execution"],measures:lt(),properties:{...so().properties,...Pd(),extensionId:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[$fe]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],source:"User Action",tags:["Cell Execution"],properties:{...so().properties,...Pd()}};this[zfe]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],source:"N/A",tags:["KernelStartup"],properties:{...so().properties,...Pd()}};this[Qfe]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],source:"N/A",properties:so().properties};this[Xfe]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],source:"User Action",properties:{result:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},...ss(),...Pd(),...so().properties},measures:{...lt()}};this[Zfe]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],source:"User Action",properties:{...ss(),...Pd(),...so().properties},measures:lt()};this[eme]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],source:"N/A",properties:{...ss(),...so().properties},measures:{reason:{classification:"SystemMetaData",isMeasurement:!0,purpose:"PerformanceAndHealth"}}};this[tme]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],source:"N/A",properties:{exitReason:{classification:"CallstackOrException",purpose:"PerformanceAndHealth"},...ss(),...so().properties},measures:{exitCode:{classification:"CallstackOrException",purpose:"PerformanceAndHealth",isMeasurement:!0}}};this[rme]={owner:"donjayamanne",feature:["Notebook"],source:"N/A",properties:{...ss(),...so().properties,manuallySelectedKernel:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},wasAlreadyOpen:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"}},measures:{...lt(),computeCwd:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},duration:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},envVars:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},executeCell:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},getConnection:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},interruptHandle:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},kernelIdle:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},kernelInfo:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},kernelReady:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},portUsage:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},postKernelStart:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},preExecuteCellTelemetry:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},pythonEnvVars:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},sessionTelemetry:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},spawn:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},startKernel:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},startupCode:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},updateConnection:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},codeCellCount:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},mdCellCount:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},codeCellCharLength:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},mdCellCharLength:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},outputCount:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},outputsByteSize:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},attachmentCount:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},attachmentCharLength:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0}}};this[nme]={owner:"donjayamanne",feature:["Notebook"],source:"N/A",properties:{...ss(),...so().properties,wasAlreadyOpen:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"}},measures:{...lt(),callPythonApi:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},activatePython:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},discoverEnv:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},createController:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},selectController:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0}}};this[ime]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],source:"N/A",properties:{isRequestToShutdownRestartSession:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},stacktrace:{classification:"CallstackOrException",purpose:"PerformanceAndHealth"},...ss(),...so().properties}};this[ome]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],source:"N/A",properties:{stacktrace:{classification:"CallstackOrException",purpose:"PerformanceAndHealth"},...ss(),...so().properties}};this[sme]={owner:"roblourens",feature:["Debugger"],source:"User Action"};this[ame]={owner:"donjayamanne",feature:["KernelPicker"],source:"N/A",measures:{kernelSpecCount:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},kernelInterpreterCount:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},kernelLiveCount:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},localKernelSpecCount:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",isMeasurement:!0},remoteKernelSpecCount:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",isMeasurement:!0}}};this[lme]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],source:"N/A",properties:{outputType:{classification:"PublicNonPersonalData",purpose:"PerformanceAndHealth"}}};this[cme]={owner:"IanMatthewHuff",feature:["InteractiveWindow"],tags:["IntelliSense"],source:"N/A",measures:lt(),properties:{isResultNull:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[ume]={owner:"IanMatthewHuff",feature:["VariableViewer"],source:"N/A",measures:lt()};this[dme]={owner:"IanMatthewHuff",feature:["VariableViewer"],source:"N/A"};this[pme]={owner:"IanMatthewHuff",feature:["DataFrameViewer"],source:"N/A",measures:lt()};this[fme]={owner:"IanMatthewHuff",feature:["PlotViewer"],source:"N/A",measures:lt()};this[mme]={owner:"amunger",feature:"N/A",source:"N/A",properties:{command:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[gme]={owner:"IanMatthewHuff",feature:["DataFrameViewer"],source:"User Action",properties:{newState:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[hme]={owner:"IanMatthewHuff",feature:["DataFrameViewer"],source:"N/A",measures:{numberOfDimensions:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0}}};this[vme]={owner:"IanMatthewHuff",feature:["DataFrameViewer"],source:"User Action",properties:{source:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[yme]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{failed:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},reason:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},dependenciesInstalled:{classification:"SystemMetaData",purpose:"FeatureInsight"},envType:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[bme]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{extensionId:{classification:"SystemMetaData",purpose:"FeatureInsight"},action:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[Ime]={owner:"roblourens",feature:["Debugger"],source:"User Action"};this[Sme]={owner:"roblourens",feature:["Debugger"],source:"User Action"};this[_me]={owner:"roblourens",feature:["Debugger"],properties:{status:{classification:"SystemMetaData",purpose:"FeatureInsight"}},source:"N/A"};this[Eme]={owner:"roblourens",feature:["Debugger"],source:"User Action"};this[Cme]={owner:"roblourens",feature:["Debugger"],source:"N/A"};this[wme]={owner:"roblourens",feature:["Debugger"],source:"N/A"};this[xme]={owner:"roblourens",feature:["Debugger"],source:"User Action"};this[Dme]={owner:"roblourens",feature:["Debugger"],source:"N/A"};this[Pme]={owner:"roblourens",feature:["Debugger"],source:"N/A",properties:{reason:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[Tme]={owner:"donjayamanne",feature:"N/A",source:"N/A",measures:{...lt(),requestDuration:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",isMeasurement:!0},timesExceededTimeout:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",isMeasurement:!0},completionItems:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",isMeasurement:!0}},properties:{kernelConnectionType:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},kernelLanguage:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},monacoLanguage:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},kernelId:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},cancelled:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},completed:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},kernelStatusAfterRequest:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},kernelStatusBeforeRequest:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},requestSent:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"}}};this[kme]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{kernelConnectionType:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},kernelLanguage:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},kernelId:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"}}};this[Nme]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{extensionId:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},pemUsed:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"}}};this[Rme]={owner:"donjayamanne",feature:"N/A",source:"N/A",measures:{executionCount:{classification:"SystemMetaData",isMeasurement:!0,purpose:"FeatureInsight"}},properties:{extensionId:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},pemUsed:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},kernelId:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"}}};this[Ame]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{accessAllowed:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},extensionId:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},pemUsed:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"}}};this[Mme]={owner:"donjayamanne",feature:"N/A",source:"N/A",measures:{executionCount:{classification:"SystemMetaData",isMeasurement:!0,purpose:"FeatureInsight"},cancelledAfter:{classification:"SystemMetaData",isMeasurement:!0,purpose:"FeatureInsight"},requestAcknowledgedAfter:{classification:"SystemMetaData",isMeasurement:!0,purpose:"FeatureInsight"},requestSentAfter:{classification:"SystemMetaData",isMeasurement:!0,purpose:"FeatureInsight"},...lt()},properties:{extensionId:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},kernelId:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},cancelled:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},requestAcknowledged:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},requestSent:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},cancelledBeforeRequestAcknowledged:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},cancelledBeforeRequestSent:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},mimeTypes:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},failed:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"}}};this[Ome]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{clientExtId:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},pemUsed:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"}}};this[Lme]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{extensionId:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},allowed:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[Kme]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{extensionId:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},providerId:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"}},measures:lt()};this[Fme]={owner:"IanMatthewHuff",feature:["VariableViewer"],source:"N/A"};this[Ume]={owner:"roblourens",feature:["InteractiveWindow","Debugger"],source:"N/A"};this[Wme]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],source:"N/A",properties:{...so().properties,...ss()}};this[Vme]={owner:"donjayamanne",source:"N/A",feature:["KernelPicker"]};this[jme]={owner:"donjayamanne",source:"User Action",feature:["KernelPicker"]};this[Bme]={owner:"amunger",feature:"N/A",source:"N/A",properties:{testName:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},testResult:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},perfWarmup:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},commitHash:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},timedCheckpoints:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"}}};this[Hme]={owner:"donjayamanne",feature:["KernelPicker"],source:"N/A",measures:{matchedReason:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[Jme]={owner:"donjayamanne",feature:["Notebook","Notebook"],tags:["Widgets"],source:"N/A",measures:{requireEntryPointCount:{classification:"SystemMetaData",isMeasurement:!0,purpose:"PerformanceAndHealth"}},properties:{failed:{classification:"CallstackOrException",purpose:"PerformanceAndHealth"},failure:{classification:"CallstackOrException",purpose:"PerformanceAndHealth"},patternUsedToRegisterRequireConfig:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},widgetFolderNameHash:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[qme]={owner:"donjayamanne",feature:["Notebook","Notebook"],tags:["Widgets"],source:"N/A",measures:lt()};this[Gme]={owner:"donjayamanne",feature:["DataFrameViewer"],source:"N/A"};this[Yme]={owner:"IanMatthewHuff",feature:["DataFrameViewer"],source:"N/A"};this[$me]={owner:"IanMatthewHuff",feature:["DataFrameViewer"],source:"N/A"};this[zme]={owner:"donjayamanne",feature:["Notebook","Notebook"],tags:["Widgets"],source:"N/A",measures:{...lt(),codeCellCount:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",comment:"Total number of code cells.",isMeasurement:!0},markdownCellCount:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",comment:"Total number of markdown cells.",isMeasurement:!0},preExecuteDuration:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",comment:"Total time spent in VS Code before starting execution.",isMeasurement:!0},executeDuration:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",comment:"Total time spent executing cells.",isMeasurement:!0},postExecuteDuration:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",comment:"Total time spent in VS Code after executing cells.",isMeasurement:!0}},properties:{outputType:{classification:"PublicNonPersonalData",purpose:"FeatureInsight",comment:"The kind of outputs generated in the notebook, text, html or images."}}};this[Qme]={owner:"donjayamanne",feature:["Notebook","Notebook"],tags:["Widgets"],source:"N/A",measures:{...lt(),codeCellCount:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",comment:"Total number of code cells.",isMeasurement:!0},markdownCellCount:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",comment:"Total number of markdown cells.",isMeasurement:!0}},properties:{outputType:{classification:"PublicNonPersonalData",purpose:"FeatureInsight",comment:"The kind of outputs generated in the notebook, text, html or images."}}};this[Xme]={owner:"donjayamanne",feature:["Notebook","Notebook"],tags:["Widgets"],source:"N/A",measures:{...lt(),codeCellCount:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",comment:"Total number of code cells.",isMeasurement:!0},markdownCellCount:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",comment:"Total number of markdown cells.",isMeasurement:!0}}}}};Zde="EXTENSION.LOAD",epe="DS_INTERNAL.EXPERIMENT_LOAD",tpe="ENVFILE_VARIABLE_SUBSTITUTION",rpe="ENVFILE_WORKSPACE",npe="HASHED_PACKAGE_NAME",ipe="DS_INTERNAL.ACTIVE_INTERPRETER_LISTING_PERF",ope="DS_INTERNAL.CELL_OUTPUT_MIME_TYPE",spe="DS_INTERNAL.GET_ACTIVATED_ENV_VARIABLES",ape="OPEN_DATAVIEWER_FROM_VARIABLE_WINDOW_REQUEST_EX",lpe="OPEN_DATAVIEWER_FROM_VARIABLE_WINDOW_ERROR_EX",cpe="OPEN_DATAVIEWER_FROM_VARIABLE_WINDOW_SUCCESS_EX",upe="DATASCIENCE.ADD_CELL_BELOW",dpe="DS_INTERNAL.CODE_LENS_ACQ_TIME",ppe="DS_INTERNAL.DOCUMENT_WITH_CODE_CELLS",fpe="DATASCIENCE.DEBUG_CONTINUE",mpe="DATASCIENCE.DEBUG_CURRENT_CELL",gpe="DATASCIENCE.DEBUG_STEP_OVER",hpe="DATASCIENCE.DEBUG_STOP",vpe="DATASCIENCE.DEBUG_FILE_INTERACTIVE",ype="DATASCIENCE.JUPYTER_KERNEL_SPEC_FETCH_FAILURE",bpe="DS_INTERNAL.JUPYTER_KERNEL_SPEC",Ipe="DATASCIENCE.ENTER_REMOTE_JUPYTER_URL",Spe="DATASCIENCE.DISABLE_INTERACTIVE_SHIFT_ENTER",_pe="DATASCIENCE.ENABLE_INTERACTIVE_SHIFT_ENTER",Epe="DS_INTERNAL.PERCEIVED_JUPYTER_STARTUP_NOTEBOOK",Cpe="DATASCIENCE.EXPORT_PYTHON_FILE",wpe="DATASCIENCE.EXPORT_PYTHON_FILE_AND_OUTPUT",xpe="DATASCIENCE.CLICKED_EXPORT_NOTEBOOK_AS_QUICK_PICK",Dpe="DATASCIENCE.EXPORT_NOTEBOOK_AS",Ppe="DATASCIENCE.IMPORT_NOTEBOOK",Tpe="DATASCIENCE.EXPORT_NOTEBOOK_AS_COMMAND",kpe="DATASCIENCE.EXPORT_NOTEBOOK_AS_FAILED",Npe="DS_INTERNAL.GET_PASSWORD_FAILURE",Rpe="DS_INTERNAL.GET_PASSWORD_SUCCESS",Ape="DS_INTERNAL.JUPYTER_HUB_PASSWORD",Mpe="DS_INTERNAL.SHOW_DATA_NO_PANDAS",Ope="DS_INTERNAL.SHOW_DATA_PANDAS_TOO_OLD",Lpe="DS_INTERNAL.SHOW_DATA_PANDAS_OK",Kpe="DS_INTERNAL.SHOW_DATA_PANDAS_INSTALL_CANCELED",Fpe="DATASCIENCE.NATIVE.OPEN_NOTEBOOK_ALL",Upe="DATASCIENCE.OPEN_PLOT_VIEWER",Wpe="DATASCIENCE.RUN_ALL_CELLS",Vpe="DATASCIENCE.RUN_SELECTION_OR_LINE",jpe="DATASCIENCE.RUN_CURRENT_CELL",Bpe="DATASCIENCE.RUN_ALL_CELLS_ABOVE",Hpe="DATASCIENCE.RUN_CELL_AND_ALL_BELOW",Jpe="DATASCIENCE.RUN_CURRENT_CELL_AND_ADVANCE",qpe="DATASCIENCE.RUN_FILE_INTERACTIVE",Gpe="DATASCIENCE.RUN_TO_LINE",Ype="DATASCIENCE.RUN_FROM_LINE",$pe="DATASCIENCE.RUN_INSERT_CELL_BELOW_POSITION",zpe="DATASCIENCE.RUN_INSERT_CELL_BELOW",Qpe="DATASCIENCE.RUN_INSERT_CELL_ABOVE",Xpe="DATASCIENCE.RUN_DELETE_CELLS",Zpe="DATASCIENCE.RUN_SELECT_CELL",efe="DATASCIENCE.RUN_SELECT_CELL_CONTENTS",tfe="DATASCIENCE.RUN_EXTEND_SELECTION_BY_CELL_ABOVE",rfe="DATASCIENCE.RUN_EXTEND_SELECTION_BY_CELL_BELOW",nfe="DATASCIENCE.RUN_MOVE_CELLS_UP",ife="DATASCIENCE.RUN_MOVE_CELLS_DOWN",ofe="DATASCIENCE.RUN_CHANGE_CELL_TO_MARKDOWN",sfe="DATASCIENCE.RUN_CHANGE_CELL_TO_CODE",afe="DATASCIENCE.GOTO_NEXT_CELL_IN_FILE",lfe="DATASCIENCE.GOTO_PREV_CELL_IN_FILE",cfe="DATASCIENCE.RUN_CURRENT_CELL_AND_ADD_BELOW",ufe="DATASCIENCE.SELFCERTSMESSAGECLOSE",dfe="DATASCIENCE.SELFCERTSMESSAGEENABLED",pfe="DATASCIENCE.USER_INSTALLED_JUPYTER",ffe="DATASCIENCE.USER_INSTALLED_PANDAS",mfe="DATASCIENCE.USER_DID_NOT_INSTALL_JUPYTER",gfe="DATASCIENCE.USER_DID_NOT_INSTALL_PANDAS",hfe="DS_INTERNAL.PYTHON_NOT_INSTALLED",vfe="DS_INTERNAL.PYTHON_EXTENSION_NOT_INSTALLED",yfe="DS_INTERNAL.PYTHON_EXTENSION_INSTALLED_VIA_KERNEL_PICKER",bfe="DS_INTERNAL.PYTHON_MODULE_INSTALL",Ife="DS_INTERNAL.SHIFTENTER_BANNER_SHOWN",Sfe="DATASCIENCE.START_SHOW_DATA_EXPLORER",_fe="DATASCIENCE.SHOW_DATA_EXPLORER",Efe="DATASCIENCE.SHOW_DATA_EXPLORER_ROWS_LOADED",Cfe="DATASCIENCE.FAILED_SHOW_DATA_EXPLORER",wfe="DATASCIENCE.REFRESH_DATA_VIEWER",xfe="DS_INTERNAL.JUPYTER_ZMQ_SUPPORT",Dfe="DS_INTERNAL.JUPYTER_ZMQ_SUPPORT_FAILURE",Pfe="DS_INTERNAL.VARIABLE_EXPLORER_FETCH_TIME",Tfe="DS_INTERNAL.VARIABLE_EXPLORER_VARIABLE_COUNT",kfe="DATASCIENCE.KERNEL_SPEC_LANGUAGE",Nfe="DS_INTERNAL.KERNEL_LAUNCHER_PERF",Rfe="GLOBAL_PYTHON_KERNELSPEC",Afe="DS_INTERNAL.NEW_FILE_USED_IN_INTERACTIVE",Mfe="DS_INTERNAL.CREATED_INTERACTIVE_WINDOW",Ofe="DS_INTERNAL.IPYWIDGET_USED_BY_USER",Lfe="DS_INTERNAL.IPYWIDGET_DISCOVER_WIDGETS_NB_EXTENSIONS",Kfe="DS_INTERNAL.IPYWIDGET_DISCOVERY_ERRORED",Ffe="DS_INTERNAL.IPYWIDGET_LOAD_SUCCESS",Ufe="DS_INTERNAL.IPYWIDGET_LOAD_FAILURE",Wfe="DS_INTERNAL.IPYWIDGET_WIDGET_VERSION_NOT_SUPPORTED_LOAD_FAILURE",Vfe="DS_INTERNAL.IPYWIDGET_PROMPT_TO_USE_CDN",jfe="DS_INTERNAL.IPYWIDGET_PROMPT_TO_USE_CDN_SELECTION",Bfe="DS_INTERNAL.IPYWIDGET_RENDER_FAILURE",Hfe="DS_INTERNAL.IPYWIDGET_UNHANDLED_MESSAGE",Jfe="DS_INTERNAL.RAWKERNEL_INFO_RESPONSE",qfe="DS_INTERNAL.RAWKERNEL_PROCESS_LAUNCH",Gfe="DATASCIENCE.EXECUTE_CELL",Yfe="DATASCIENCE.EXECUTE_CODE",$fe="DATASCIENCE.RESUME_EXECUTE_CELL",zfe="DATASCIENCE.NOTEBOOK_START",Qfe="DS_INTERNAL.SWITCH_KERNEL",Xfe="DATASCIENCE.NOTEBOOK_INTERRUPT",Zfe="DATASCIENCE.NOTEBOOK_RESTART",eme="DS_INTERNAL.RAWKERNEL_SESSION_NO_IPYKERNEL",tme="DS_INTERNAL.RAWKERNEL_SESSION_KERNEL_PROCESS_EXITED",rme="DATASCIENCE.NOTEBOOK_FIRST_START_BREAKDOWN",nme="DATASCIENCE.NOTEBOOK_FIRST_KERNEL_AUTO_SELECTION_BREAKDOWN",ime="DS_INTERNAL.RAWKERNEL_SESSION_SHUTDOWN",ome="DS_INTERNAL.RAWKERNEL_SESSION_DISPOSED",sme="DATASCIENCE.RUN_BY_LINE_VARIABLE_HOVER",ame="DS_INTERNAL.KERNEL_COUNT",lme="DS_INTERNAL.VSCNOTEBOOK_CELL_TRANSLATION_FAILED",cme="DS_INTERNAL.INTERACTIVE_FILE_TOOLTIPS_PERF",ume="DS_INTERNAL.NATIVE_VARIABLE_VIEW_LOADED",dme="DS_INTERNAL.NATIVE_VARIABLE_VIEW_MADE_VISIBLE",pme="DATAVIEWER.WEBVIEW_LOADED",fme="PLOTVIEWER.WEBVIEW_LOADED",mme="DS_INTERNAL.COMMAND_EXECUTED",gme="DATASCIENCE.DATA_VIEWER_SLICE_ENABLEMENT_STATE_CHANGED",hme="DATASCIENCE.DATA_VIEWER_DATA_DIMENSIONALITY",vme="DATASCIENCE.DATA_VIEWER_SLICE_OPERATION",yme="DATASCIENCE.CREATE_PYTHON_ENVIRONMENT",bme="DATASCIENCE.RECOMMENT_EXTENSION",Ime="DATASCIENCE.DEBUGGING.CLICKED_ON_SETUP",Sme="DATASCIENCE.DEBUGGING.CLOSED_MODAL",_me="DATASCIENCE.DEBUGGING.IPYKERNEL6_STATUS",Eme="DATASCIENCE.DEBUGGING.CLICKED_RUNBYLINE",Cme="DATASCIENCE.DEBUGGING.SUCCESSFULLY_STARTED_RUNBYLINE",wme="DATASCIENCE.DEBUGGING.SUCCESSFULLY_STARTED_IW_JUPYTER",xme="DATASCIENCE.DEBUGGING.CLICKED_RUN_AND_DEBUG_CELL",Dme="DATASCIENCE.DEBUGGING.SUCCESSFULLY_STARTED_RUN_AND_DEBUG_CELL",Pme="DATASCIENCE.DEBUGGING.ENDED_SESSION",Tme="DATASCIENCE.JUPYTER_KERNEL_CODE_COMPLETION",kme="DATASCIENCE.JUPYTER_KERNEL_CODE_COMPLETION_CANNOT_RESOLVE",Nme="DATASCIENCE.JUPYTER_KERNEL_API_USAGE",Rme="DATASCIENCE.JUPYTER_NEW_KERNEL_API_USAGE",Ame="DATASCIENCE.JUPYTER_NEW_KERNELS_API_USAGE",Mme="DATASCIENCE.JUPYTER_NEW_KERNEL_API_EXEC",Ome="DATASCIENCE.JUPYTER_API_USAGE",Lme="DATASCIENCE.JUPYTER_KERNEL_API_ACCESS",Kme="DATASCIENCE.JUPYTER_KERNEL_STARTUP_HOOK",Fme="DATASCIENCE.PYTHON_VARIABLE_FETCHING_CODE_FAILURE",Ume="DATASCIENCE.INTERACTIVE_WINDOW_DEBUG_SETUP_CODE_FAILURE",Wme="DATASCIENCE.KERNEL_CRASH",Vme="DATASCIENCE.JUPYTER_KERNEL_HIDDEN_VIA_FILTER",jme="DATASCIENCE.JUPYTER_KERNEL_FILTER_USED",Bme="DS_INTERNAL.RUNTEST",Hme="DS_INTERNAL.PREFERRED_KERNEL_EXACT_MATCH",Jme="DS_INTERNAL.IPYWIDGET_EXTENSIONJS_INFO",qme="DS_INTERNAL.IPYWIDGET_TIME_TO_COPY_NBEXTENSIONS_DIR",Gme="DATASCIENCE.NO_ACTIVE_KERNEL_SESSION",Yme="DATAVIEWER.USING_INTERPRETER",$me="DATAVIEWER.USING_KERNEL",zme="DATASCIENCE.JUPYTER_NOTEBOOK_EXEC_PERFORMANCE",Qme="DATASCIENCE.JUPYTER_JUPYTER_NOTEBOOK_EXEC_PERFORMANCE",Xme="DATASCIENCE.JUPYTER_NOTEBOOK_EDIT_PERFORMANCE";u();var Pf=require("vscode");function qb(r){let e=Oc(r.uri);return Nt(e.path)}function L2(r=Pf.Uri.file(""),e=Pf.Uri.file(""),t=Pi(),n=!1){let i=Oc(r,t,t=="Windows"||n),o=Oc(e,t,t=="Windows"||n);return i===o||ea(i,o,!0)}function Oc(r=Pf.Uri.file(""),e=Pi(),t=!1){let n=at(r);return t&&(n=n.toLowerCase()),n.endsWith("/bin/python")?["Linux","OSX"].includes(e)?n.endsWith("/bin/python")&&n.split("/").length>4?Pf.Uri.file(n.replace("/bin/python","/python")):Pf.Uri.file(n):Pf.Uri.file(n):Pf.Uri.file(n)}u();var $4=require("vscode");var Gb=class{constructor(){this.promises=new Set;this._onStateChange=new $4.EventEmitter;this.onStateChange=this._onStateChange.event}get isComplete(){return this.promises.size===0}dispose(){this._onStateChange.dispose()}push(e){this.promises.add(e),this._onStateChange.fire(),e.finally(()=>{this.promises.delete(e),this.isComplete&&this._onStateChange.fire()}).catch(y)}};u();var y0=class extends Xn{constructor(e){super("Python Extension failed to activate",e,"pythonExtension")}};u();var b0=class extends it{constructor(){super("pythonExtension","Python Extension API not exported")}};var PG=$(tW());u();var wh=require("vscode");var T0=class{};function pG(r,e=""){let t=r?wh.workspace.getWorkspaceFolder(r):wh.workspace.workspaceFolders?wh.workspace.workspaceFolders[0]:void 0;return t?Ss(Pi()==="Windows"?t.uri.path.toUpperCase():t.uri.path):e}function tI(){let r=Array.isArray(wh.workspace.workspaceFolders)&&wh.workspace.workspaceFolders.length>0?wh.workspace.workspaceFolders[0]:void 0;return r==null?void 0:r.uri}u();var kh=require("vscode");u();u();u();var fG=$(tW());var Dh=require("vscode");u();function xh(r){return(e,t=null,n)=>{let i=!1,o;return o=r(s=>{if(!i)return o?o.dispose():i=!0,e.call(t,s)},null,n),i&&o.dispose(),o}}function ax(r,e=null,t){return new Promise(n=>xh(r)(n,e,t))}var Oge={output_type:"stream",name:"stdout",text:""},Lge={output_type:"error",ename:"",evalue:"",traceback:[""]},Kge={output_type:"display_data",data:{},metadata:{}},Fge={output_type:"execute_result",execution_count:0,data:{},metadata:{}},y5e={stream:new Set(Object.keys(Oge)),error:new Set(Object.keys(Lge)),display_data:new Set(Object.keys(Kge)),execute_result:new Set(Object.keys(Fge))};function Al(r){return r&&Jv(r).toLowerCase().endsWith("ipynb")?"notebook":"interactive"}function Kc(r){return r=r.toLowerCase(),r.length===2&&r.endsWith("#")?`${r.substring(0,1)}sharp`:E9.get(r)||r}function hr(r){return typeof r=="string"?r===bt||r===ht:r.notebookType===bt||r.notebookType===ht}function Ca(r){let e=r.metadata;return JSON.parse(JSON.stringify((e==null?void 0:e.metadata)||{}))}async function mG(r,e){let t=new Dh.WorkspaceEdit;t.set(r.uri,[Dh.NotebookEdit.updateNotebookMetadata(rW({...r.metadata||{},metadata:e}))]),await Dh.workspace.applyEdit(t)}function rI(r){return Dh.workspace.notebookDocuments.find(e=>hr(e)&&e.getCells().some(t=>t.document===r))}function Fc(r){if(Array.isArray(r)){let e="";for(let t=0;t<r.length;t+=1){let n=r[t];t<r.length-1&&!n.endsWith(`
`)?e=e.concat(`${n}
`):e=e.concat(n)}return e}return r.toString()}function nI(r){if(Array.isArray(r))return r;let e=r.toString();if(e.length>0){let t=e.split(`
`);return t.map((n,i)=>i<t.length-1?`${n}
`:n).filter(n=>n.length>0)}return[]}function Uge(r){let e=r;do r=e,e=r.replace(/[^\n]\x08/gm,"");while(e.length<r.length);return r}function Wge(r){for(r=r.replace(/\r+\n/gm,`
`);r.search(/\r[^$]/g)>-1;){var e=r.match(/^(.*)\r+/m)[1],t=r.match(/\r+(.*)$/m)[1];t=t+e.slice(t.length,e.length),r=r.replace(/\r+.*$/m,"\r").replace(/^.*\r/m,t)}return r}function gG(r){return Wge(Uge(r))}var k0="'''",N0='"""';function Ph(r,e,t){let n,i,o=0;for(let s of r){let a=s.trim(),l=a.startsWith(k0)?k0:a.startsWith(N0)?N0:void 0,c=a.includes(k0)?k0:a.includes(N0)?N0:void 0;if(i)i===c&&(i=void 0),t(s,o);else if(n)n===l&&(n=void 0),n&&e(s,o);else if(c&&!l){let d=a.indexOf(c);i=a.lastIndexOf(c)!==d?void 0:c,t(s,o)}else if(l){let d=a.indexOf(l,3);n=d>=0?void 0:l,a.length>3&&e(a.slice(3,d>=0?d:void 0),o)}else a.startsWith("#")?e(a.slice(1),o):t(s,o);o+=1}}function iI(r,e=`
`,t){return r.map((n,i)=>{let o=t?t(n):n;return i===r.length-1?`${o}`:`${o}${e}`})}function Vge(r){let e=[];return Ph(r,t=>e.push(t),t=>{}),e}function R0(r){return iI(Vge(r.slice(r.length>1?1:0)))}function hG(r){let e=r.length,t=-1;return r.forEach((n,i)=>{n.trim()&&(e=i,t<0&&(t=i))}),t>=0?r.slice(t,e+1):[]}function vG(r){var t;let e=/^\s*(\d+)\.(\d+)\.(.+)\s*$/.exec(r);if(e&&e.length>2){let n=parseInt(e[1],10),i=parseInt(e[2],10),o=parseInt(e[3],10);return(t=(0,fG.parse)(`${n}.${i}.${o}`,!0))!=null?t:void 0}}function Tf(r){let e=JSON.parse(JSON.stringify(r.metadata||{}))||{metadata:{}};return e.metadata=e.metadata||{},e}function rW(r){return jge(r)}function jge(r){return Array.isArray(r)?r.map(rW):r!=null&&typeof r=="object"&&Object.keys(r).length>0?Object.keys(r).sort().reduce((e,t)=>(e[t]=rW(r[t]),e),{}):r}async function Th(r,e=[]){let t=ax(r.onDidDispose,void 0,e);r.dispose(),await t}var A0=new Map,iW=new Map,nW;function yG(r){nW=r}function oW(r,e){if(!r.pythonEnvironmentPath)return;let t=Te();Bge({interpreterHash:r.pythonEnvironmentPath}).then(n=>{r.pythonEnvironmentPackages=n||r.pythonEnvironmentPackages,e&&(e.pythonEnvironmentPackages=n||e.pythonEnvironmentPackages)}).catch(()=>{}).finally(()=>{t.resolve()})}async function Bge(r){if(!nW)return b.error("Python package provider is not initialized."),"{}";let e;if("interpreter"in r?e=r.interpreter:e=iW.get(r.interpreterHash),!e)return"{}";let t=await nW(e);return!t||t.size===0?"{}":JSON.stringify(Object.fromEntries(t))}async function bG(r){if(!r)return{};let e=A0.get(Fa(r)),t=Al(r);if(!e&&t)return{resourceType:t,resourceHash:r?await Nt(r.toString()):void 0};if(!e)return{};let n=JSON.parse(JSON.stringify(e[0]));return oW(e[0],n),n}function Jr(r,e,t,n,i){bG(r).then(o=>{Object.assign(o,n||{}),J(e,t,o,i)}).catch(y)}var $n=!1,oI=new WeakMap,M0=new Map,wa,SG=0;function Uc(r){var t,n;if(!r)return;if(Dn(r)&&!M0.has(r.toString())){let i=kh.workspace.notebookDocuments.find(o=>o.uri.toString()===r.toString());i&&M0.set(r.toString(),new WeakRef(i))}let e=Dn(r)?(t=M0.get(r.toString()))==null?void 0:t.deref():r;if(e)return(n=oI.get(e))==null?void 0:n.tracker}function _G(r){let e=new Pn;return wa=r,SG=r.elapsedTime,kh.workspace.notebookDocuments.forEach(t=>oI.set(t,IG(t,!0,r))),e.add(kh.workspace.onDidOpenNotebookDocument(t=>{!oI.has(t)&&!$n&&oI.set(t,IG(t,!1,r))})),e.add(kh.workspace.onDidCloseNotebookDocument(t=>{oI.delete(t),M0.delete(t.uri.toString())})),e}function EG(r){var e;(e=oI.get(r))==null||e.tracker.kernelManuallySelected()}var O0={starAfter:-1,completedAfter:-1},sW=new Map,CG=new Map,Hge=new Map,wG=ur(()=>(O0.starAfter=wa==null?void 0:wa.elapsedTime,{stop:ur(()=>{O0.completedAfter=wa.elapsedTime})}));function xG(r,e){sW.set(r,wa==null?void 0:wa.elapsedTime),Hge.set(r,e||"")}function DG(r){r.executable.uri&&CG.set(r.id,wa==null?void 0:wa.elapsedTime)}function IG(r,e,t){let n=wa.elapsedTime,i=t.elapsedTime,o={openedAfter:i},s=c=>(c==="executeCell"&&($n=!0),o[`${c}StartedAfter`]=t.elapsedTime,{stop:ur(()=>{o[`${c}CompletedAfter`]=t.elapsedTime})}),a={wasAlreadyOpen:e},l=()=>{};return{measures:o,info:a,tracker:{kernelSelected:ur((c,d)=>{let p=sW.get(c);typeof p=="number"&&(a.wasAlreadyOpen?o.controllerCreatedAfter=sW.get(c):o.controllerCreatedAfter=n-p),o.interpreterDiscoveredAfter=CG.get(d||""),o.kernelSelectedAfter=t.elapsedTime,a.manuallySelectedKernel||Gge(r,{wasAlreadyOpen:a.wasAlreadyOpen},{controllerCreatedAfter:o.controllerCreatedAfter,kernelSelectedAfter:o.kernelSelectedAfter,openedAfter:i,interpreterDiscoveredAfter:o.interpreterDiscoveredAfter})}),kernelManuallySelected:ur(()=>a.manuallySelectedKernel=!0),cellExecutionCount:$n?l:ur(c=>o.executeCellCount=c),preExecuteCellTelemetry:$n?l:ur(()=>s("preExecuteCellTelemetry")),startKernel:$n?l:ur(()=>s("startKernel")),executeCell:$n?l:ur(()=>s("executeCell")),executeCellAcknowledged:$n?l:ur(()=>{o.executeCellAcknowledgedAfter=t.elapsedTime,Jge(r,a,o)}),jupyterSessionTelemetry:$n?l:ur(()=>s("sessionTelemetry")),postKernelStartup:$n?l:ur(()=>s("postKernelStart")),computeCwd:$n?l:ur(()=>s("computeCwd")),getConnection:$n?l:ur(()=>s("getConnection")),updateConnection:$n?l:ur(()=>s("updateConnection")),kernelReady:$n?l:ur(()=>s("kernelReady")),portUsage:$n?l:ur(()=>s("portUsage")),spawn:$n?l:ur(()=>s("spawn")),pythonEnvVars:$n?l:ur(()=>s("pythonEnvVars")),envVars:$n?l:ur(()=>s("envVars")),interruptHandle:$n?l:ur(()=>s("interruptHandle")),kernelInfo:$n?l:ur(()=>s("kernelInfo")),kernelIdle:$n?l:ur(()=>s("kernelIdle"))}}}var Jge=ur(function(r,e,t){if(typeof t.preExecuteCellTelemetryStartedAfter!="number"||typeof t.preExecuteCellTelemetryCompletedAfter!="number"||typeof t.executeCellAcknowledgedAfter!="number"||typeof t.startKernelStartedAfter!="number"||typeof t.startKernelCompletedAfter!="number"||typeof t.executeCellStartedAfter!="number"||typeof t.sessionTelemetryStartedAfter!="number"||typeof t.sessionTelemetryCompletedAfter!="number"||typeof t.postKernelStartStartedAfter!="number"||typeof t.postKernelStartCompletedAfter!="number"||typeof t.kernelInfoStartedAfter!="number"||typeof t.kernelInfoCompletedAfter!="number"||typeof t.kernelIdleStartedAfter!="number"||typeof t.kernelIdleCompletedAfter!="number"||typeof t.computeCwdStartedAfter!="number"||typeof t.computeCwdCompletedAfter!="number"||typeof t.kernelReadyStartedAfter!="number"||typeof t.kernelReadyCompletedAfter!="number"||typeof t.getConnectionStartedAfter!="number"||typeof t.getConnectionCompletedAfter!="number"||typeof t.updateConnectionStartedAfter!="number"||typeof t.updateConnectionCompletedAfter!="number"||typeof t.portUsageStartedAfter!="number"||typeof t.portUsageCompletedAfter!="number"||typeof t.spawnStartedAfter!="number"||typeof t.spawnCompletedAfter!="number"||typeof t.pythonEnvVarsStartedAfter!="number"||typeof t.pythonEnvVarsCompletedAfter!="number"||typeof t.envVarsStartedAfter!="number"||typeof t.envVarsCompletedAfter!="number")return;let n={duration:0,preExecuteCellTelemetry:0,startKernel:0,executeCell:0};{let c=[{name:"preExecuteCellTelemetry",start:t.preExecuteCellTelemetryStartedAfter,end:t.preExecuteCellTelemetryCompletedAfter},{name:"startKernel",start:t.startKernelStartedAfter,end:t.startKernelCompletedAfter},{name:"executeCell",start:t.executeCellStartedAfter,end:t.executeCellAcknowledgedAfter}],d=t.executeCellAcknowledgedAfter-t.preExecuteCellTelemetryStartedAfter;n.duration=d,lx(n,c,d,t.openedAfter)}let i={sessionTelemetry:0,postKernelStart:0,computeCwd:0,getConnection:0,updateConnection:0,kernelReady:0,portUsage:0,spawn:0};{let c=[{name:"sessionTelemetry",start:t.sessionTelemetryStartedAfter,end:t.sessionTelemetryCompletedAfter},{name:"postKernelStart",start:t.postKernelStartStartedAfter,end:t.postKernelStartCompletedAfter},{name:"computeCwd",start:t.computeCwdStartedAfter,end:t.computeCwdCompletedAfter},{name:"getConnection",start:t.getConnectionStartedAfter,end:t.getConnectionCompletedAfter},{name:"updateConnection",start:t.updateConnectionStartedAfter,end:t.updateConnectionCompletedAfter},{name:"spawn",start:t.spawnStartedAfter,end:t.spawnCompletedAfter},{name:"portUsage",start:t.portUsageStartedAfter,end:t.portUsageCompletedAfter},{name:"kernelReady",start:t.kernelReadyStartedAfter,end:t.kernelReadyCompletedAfter}],d=t.startKernelCompletedAfter-t.startKernelStartedAfter;lx(i,c,d,t.openedAfter)}let o={startupCode:0,kernelInfo:0,kernelIdle:0};{let c=[{name:"startupCode",start:t.postKernelStartStartedAfter,end:t.kernelInfoStartedAfter},{name:"kernelInfo",start:t.kernelInfoStartedAfter,end:t.kernelInfoCompletedAfter},{name:"kernelIdle",start:t.kernelIdleStartedAfter,end:t.kernelIdleCompletedAfter}],d=t.postKernelStartCompletedAfter-t.postKernelStartStartedAfter;lx(o,c,d,t.openedAfter)}let s={pythonEnvVars:0,envVars:0,interruptHandle:0};{let c=[{name:"pythonEnvVars",start:t.pythonEnvVarsStartedAfter,end:t.pythonEnvVarsCompletedAfter},{name:"envVars",start:t.envVarsStartedAfter,end:t.envVarsCompletedAfter},{name:"interruptHandle",start:t.interruptHandleStartedAfter||0,end:t.interruptHandleCompletedAfter||0}],d=t.spawnCompletedAfter-t.spawnStartedAfter;lx(s,c,d,t.openedAfter)}let a=qge(r),l={...n,...i,...o,...s,...a};Jr(r.uri,"DATASCIENCE.NOTEBOOK_FIRST_START_BREAKDOWN",l,e)});function qge(r){let e={attachmentCharLength:0,attachmentCount:0,codeCellCharLength:0,codeCellCount:0,mdCellCharLength:0,mdCellCount:0,outputCount:0,outputsByteSize:0};return r.getCells().forEach(t=>{let n=t.document.lineAt(t.document.lineCount-1).range.end,i=t.document.offsetAt(n);if(t.kind===kh.NotebookCellKind.Markup){e.mdCellCount+=1,e.mdCellCharLength+=i;try{let s=Tf(t).attachments||{};Object.keys(s).forEach(a=>{e.attachmentCount+=1;let l=s[a];typeof l=="object"&&Object.keys(l).forEach(c=>{let d=l[c];d&&typeof d=="string"&&(e.attachmentCharLength+=d.length)})})}catch(o){b.warn("Error parsing attachments in cell metadata",o)}}else e.codeCellCount+=1,e.codeCellCharLength+=i,e.outputCount+=t.outputs.length,e.outputsByteSize+=t.outputs.reduce((o,s)=>o+s.items.reduce((a,l)=>a+l.data.byteLength,0),0)}),e}var Gge=ur(function(r,e,t){if(t.pythonExtensionActivationStartedAfter=O0.starAfter,t.pythonExtensionActivationCompletedAfter=O0.completedAfter,typeof t.controllerCreatedAfter=="undefined"||typeof t.interpreterDiscoveredAfter=="undefined"||typeof t.pythonExtensionActivationCompletedAfter=="undefined"||typeof t.pythonExtensionActivationStartedAfter=="undefined")return;let n=[{name:"callPythonApi",start:SG,end:t.pythonExtensionActivationStartedAfter},{name:"activatePython",start:t.pythonExtensionActivationStartedAfter,end:t.pythonExtensionActivationCompletedAfter},{name:"discoverEnv",start:t.pythonExtensionActivationCompletedAfter,end:t.interpreterDiscoveredAfter},{name:"createController",start:t.interpreterDiscoveredAfter,end:t.controllerCreatedAfter},{name:"selectController",start:t.controllerCreatedAfter,end:t.kernelSelectedAfter}],i=t.kernelSelectedAfter-t.openedAfter,o={duration:i};lx(o,n,i,t.openedAfter),Jr(r.uri,"DATASCIENCE.NOTEBOOK_FIRST_KERNEL_AUTO_SELECTION_BREAKDOWN",o,e)});function lx(r,e,t,n){e.sort((i,o)=>i.start-o.start).forEach(i=>{typeof n=="number"&&n>=i.start&&n<=i.end?r[i.name]=(i.end-n)*100/t:typeof n=="number"&&n>i.end?r[i.name]=0:(typeof n=="number"&&n<i.start||typeof n!="number")&&(r[i.name]=(i.end-i.start)*100/t)})}function cx(r,e){if(r){let t={...r,uri:Ct.Uri.file(r.path||""),id:e||r.id};return delete t.path,t}}function ux(r){if(r){let e=Object.assign({},r,{path:at(r.uri)});return delete e.uri,e}}var sI=class{constructor(e,t){this.disposables=e;this.extensionChecker=t;this.api=Te();this.didActivatePython=new Ct.EventEmitter;this._pythonExtensionHooked=Te();this.extensionChecker.isPythonExtensionInstalled||Ct.extensions.onDidChange(async()=>{this.extensionChecker.isPythonExtensionInstalled&&await this.registerHooks()},this,this.disposables),this.disposables.push(this.didActivatePython)}get onDidActivatePythonExtension(){return this.didActivatePython.event}get pythonExtensionHooked(){return this._pythonExtensionHooked.promise}get pythonExtensionVersion(){return this._pythonExtensionVersion}getApi(){return this.init().catch(y),this.api.promise}async getNewApi(){var t,n;await this.init();let e=Ct.extensions.getExtension(Qs);return(t=e==null?void 0:e.packageJSON)!=null&&t.version&&(this._pythonExtensionVersion=new PG.SemVer((n=e==null?void 0:e.packageJSON)==null?void 0:n.version)),e!=null&&e.exports&&(AH(e.exports),e.exports.environments.known.forEach(i=>{DG(i)})),e==null?void 0:e.exports}setApi(e){this.api.resolved||!Ct.workspace.isTrusted||this.api.resolve(e)}async init(){if(this.initialized)return;Ct.extensions.getExtension(Qs)?await this.registerHooks():await this.extensionChecker.showPythonExtensionInstallRequiredPrompt(),this.initialized=!0}async registerHooks(){var n;if(this.hooksRegistered)return;let e=Ct.extensions.getExtension(Qs);if(!e)return;let t=!1;if(!e.isActive){let i=wG();try{let o=e.activate();o.then(()=>i.stop(),()=>i.stop()),await o,t=!0}catch(o){b.error("Failed activating the python extension: ",o),this.api.reject(new y0(o));return}}this.hooksRegistered||(this.hooksRegistered=!0,t&&this.didActivatePython.fire(),(n=e.exports)!=null&&n.jupyter?e.exports.jupyter.registerHooks():(b.error("Python extension is not exporting the jupyter API"),this.api.reject(new b0)),this._pythonExtensionHooked.resolve())}};sI=E([(0,xa.injectable)(),I(0,(0,xa.inject)(ie)),I(1,(0,xa.inject)(Io))],sI);var kf=class{constructor(e){this.disposables=e;this.pythonExtensionInstallationStatusChanged=new Ct.EventEmitter;Ct.extensions.onDidChange(this.extensionsChangeHandler.bind(this),this,this.disposables),this.previousInstallState=this.isPythonExtensionInstalled}get onPythonExtensionInstallationStatusChanged(){return this.pythonExtensionInstallationStatusChanged.event}get isPythonExtensionInstalled(){return Ct.extensions.getExtension(Qs)!==void 0}get isPythonExtensionActive(){var e;return((e=Ct.extensions.getExtension(Qs))==null?void 0:e.isActive)===!0}async directlyInstallPythonExtension(){return Ct.commands.executeCommand("workbench.extensions.installExtension",Qs,{context:{skipWalkthrough:!0}})}async showPythonExtensionInstallRequiredPrompt(){if(!Ct.workspace.isTrusted)return;kf.promptDisplayed=!0;let e=Fe.bannerLabelYes;J("DS_INTERNAL.PYTHON_EXTENSION_NOT_INSTALLED",void 0,{action:"displayed"}),await Ct.window.showInformationMessage(C.pythonExtensionRequired,{modal:!0},e)===e?(J("DS_INTERNAL.PYTHON_EXTENSION_NOT_INSTALLED",void 0,{action:"download"}),await this.installPythonExtension()):J("DS_INTERNAL.PYTHON_EXTENSION_NOT_INSTALLED",void 0,{action:"dismissed"})}async installPythonExtension(){Ct.commands.executeCommand("extension.open",Qs).then(y,y)}async extensionsChangeHandler(){let e=this.isPythonExtensionInstalled;e!==this.previousInstallState&&(this.pythonExtensionInstallationStatusChanged.fire(e?"installed":"uninstalled"),this.previousInstallState=e)}};kf=E([(0,xa.injectable)(),I(0,(0,xa.inject)(ie))],kf);var L0=class{constructor(e,t,n,i){this.apiProvider=e;this.extensionChecker=t;this.disposables=n;this.context=i;this.didChangeInterpreter=new Ct.EventEmitter;this.didChangeInterpreters=new Ct.EventEmitter;this._onDidEnvironmentVariablesChange=new Ct.EventEmitter;this._onDidRemoveInterpreter=new Ct.EventEmitter;this.onDidRemoveInterpreter=this._onDidRemoveInterpreter.event;this.onDidEnvironmentVariablesChange=this._onDidEnvironmentVariablesChange.event;this._status="idle";this._onDidChangeStatus=new Ct.EventEmitter;this.onDidChangeStatus=this._onDidChangeStatus.event;this.refreshPromises=new Gb;this.onResumeEnvDetection=new Ct.EventEmitter;this.workspaceCachedActiveInterpreter=new Set;this.lastLoggedResourceAndInterpreterId="";this.pythonEnvHashes=new Map;this.loggedEnvsWithoutInterpreterPath=new Set;this.pendingInterpreterChangeEventTriggers=new Map;this.pendingInterpretersChangeEventTriggers=new Map;this.extensionChecker.isPythonExtensionInstalled&&!this.extensionChecker.isPythonExtensionActive&&this.apiProvider.onDidActivatePythonExtension(()=>{this.hookupOnDidChangeInterpreterEvent()},this,this.disposables),Ct.workspace.onDidGrantWorkspaceTrust(()=>this.refreshInterpreters(!0),this,this.disposables),this.disposables.push(this._onDidChangeStatus),this.disposables.push(this.refreshPromises),this.disposables.push(this.onResumeEnvDetection),this.refreshPromises.onStateChange(()=>{this.status=this.refreshPromises.isComplete?"idle":"refreshing"})}get status(){return this._status}set status(e){this._status!==e&&(this._status=e,this._onDidChangeStatus.fire())}initialize(){this.hookupOnDidChangeInterpreterEvent()}async resolveEnvironment(e){return this.getApi().then(t=>{if(!t)return;let n=typeof e=="string"?t.environments.known.find(i=>i.id===e||i.path===e):e;return t.environments.resolveEnvironment(n||e)})}get onDidChangeInterpreter(){return this.hookupOnDidChangeInterpreterEvent(),this.didChangeInterpreter.event}get onDidChangeInterpreters(){return this.hookupOnDidChangeInterpreterEvent(),this.didChangeInterpreters.event}async refreshInterpreters(e=!1){let t=(async()=>{let n=await this.getApi();if(n)try{await n.environments.refreshEnvironments({forceRefresh:e}),this.hookupOnDidChangeInterpreterEvent(),b.debug("Refreshed Environments")}catch(i){b.error("Failed to refresh the list of interpreters")}})();this.refreshPromises.push(t),this.refreshPromises.push(t.then(()=>tc(1e3))),await t}async getActiveInterpreter(e){var o,s,a;if(!Ct.workspace.isTrusted)return;let t=new It;this.hookupOnDidChangeInterpreterEvent(),!e&&((o=Ct.workspace.workspaceFolders)==null?void 0:o.length)===1&&(e=Ct.workspace.workspaceFolders[0].uri),(s=Ct.workspace.workspaceFolders)!=null&&s.length&&(e=(e?(a=Ct.workspace.getWorkspaceFolder(e))==null?void 0:a.uri:void 0)||Ct.workspace.workspaceFolders[0].uri);let n=pG(e),i=this.getApi().then(async l=>{if(!l)return;let c=l.environments.getActiveEnvironmentPath(e),d=await l.environments.resolveEnvironment(c);return this.trackResolvedEnvironment(d)});return i.then(()=>{this.workspaceCachedActiveInterpreter.has(n)||(this.workspaceCachedActiveInterpreter.add(n),J("DS_INTERNAL.ACTIVE_INTERPRETER_LISTING_PERF",{duration:t.elapsedTime},{firstTime:!0}))}).catch(l=>{b.warn(`Failed to get active interpreter from Python for workspace ${n}`,l)}),(ji||[Ct.ExtensionMode.Development,Ct.ExtensionMode.Test].includes(this.context.extensionMode))&&i.then(l=>{let c=`${ve(e)}'-${ve(l==null?void 0:l.id)}`;if(this.lastLoggedResourceAndInterpreterId===c)return;this.lastLoggedResourceAndInterpreterId=c;let d=Ku(l);b.trace(`Active Interpreter ${e?`for '${ve(e)}' `:""}is ${ve(l==null?void 0:l.id)} (${l&&zr(l)}, '${l?_s(l):""}', ${d==null?void 0:d.major}.${d==null?void 0:d.minor}.${d==null?void 0:d.micro})`)}).catch(y),i}getInterpreterHash(e){return this.pythonEnvHashes.get(e)}async getInterpreterDetails(e,t){if(!Ct.workspace.isTrusted)throw new Error("Unable to determine active Interpreter as Workspace is not trusted");this.hookupOnDidChangeInterpreterEvent();try{return await this.getApi().then(async n=>{if(!n||t!=null&&t.isCancellationRequested)return;let i=n.environments.known.find(l=>Dn(e)?L2(l.executable.uri,e):typeof e=="string"?l.id===e:L2(Ct.Uri.file(l.path),Ct.Uri.file(e.path))),o=Dn(e)?ve(e):typeof e=="string"?e:ve(Ct.Uri.file(e.path));if(i){let l=await n.environments.resolveEnvironment(i),c=this.trackResolvedEnvironment(l);return b.ci(`Interpreter details for ${o} from Python is ${JSON.stringify(l)} and our mapping is ${JSON.stringify(c)}`),c}let s=o;if(this.loggedEnvsWithoutInterpreterPath.has(s)||(this.loggedEnvsWithoutInterpreterPath.add(s),b.warn(`No interpreter with path ${o} found in Python API, will convert Uri path to string as Id ${o}`)),t!=null&&t.isCancellationRequested)return;let a=await n.environments.resolveEnvironment(Dn(e)?e.fsPath:typeof e=="string"?e:e.path);return this.trackResolvedEnvironment(a)})}catch(n){b.warn(`Failed to get Python interpreter details from Python Extension API for ${typeof e=="string"?e:ve(Dn(e)?e:Ct.Uri.file(e.path))}`,n);return}}trackResolvedEnvironment(e){if(e){let t=QP(e);return t?(qb(t).then(n=>{this.pythonEnvHashes.set(t.id,n)}).catch(y),this.triggerEventIfAllowed("interpretersChangeEvent",t),t):void 0}}triggerEventIfAllowed(e,t){e==="interpreterChangeEvent"?this.pendingInterpreterChangeEventTriggers.set((t==null?void 0:t.id)||"",t):this.pendingInterpretersChangeEventTriggers.set((t==null?void 0:t.id)||"",t),this.triggerPendingEvents()}triggerPendingEvents(){this.pendingInterpreterChangeEventTriggers.forEach(t=>this.didChangeInterpreter.fire(t)),this.pendingInterpreterChangeEventTriggers.clear();let e=Array.from(this.pendingInterpretersChangeEventTriggers.values());if(e.length){let t=e.filter(n=>!!n);t.length!==e.length&&t.length===0?this.didChangeInterpreters.fire([]):this.didChangeInterpreters.fire(t)}this.pendingInterpretersChangeEventTriggers.clear()}async getApi(){if(this.extensionChecker.isPythonExtensionInstalled)return this.apiPromise||(this.apiPromise=this.apiProvider.getNewApi()),this.apiPromise}hookupOnDidChangeInterpreterEvent(){this.eventHandlerAdded||this.getApi().then(e=>{!this.eventHandlerAdded&&e&&(this.eventHandlerAdded=!0,e.environments.onDidEnvironmentVariablesChange(t=>{var n,i;b.debug(`Detected changes to env file ${(i=(n=t.resource)==null?void 0:n.uri)==null?void 0:i.path} in PythonApi`),this._onDidEnvironmentVariablesChange.fire()},this,this.disposables),e.environments.onDidChangeActiveEnvironmentPath(()=>{b.trace("Detected change in Active Python environment via Python API"),this.workspaceCachedActiveInterpreter.clear(),this.triggerEventIfAllowed("interpreterChangeEvent",void 0)},this,this.disposables),e.environments.onDidChangeEnvironments(async t=>{if(b.trace(`Python API env change detected, ${t.type} => '${t.env.id}'`),t.type==="remove"){this.triggerEventIfAllowed("interpreterChangeEvent",void 0),this.triggerEventIfAllowed("interpretersChangeEvent",void 0),this._onDidRemoveInterpreter.fire({id:t.env.id});return}let n=QP(zi(t.env));n&&(this.triggerEventIfAllowed("interpreterChangeEvent",n),this.triggerEventIfAllowed("interpretersChangeEvent",n))},this,this.disposables),this.didChangeInterpreters.fire(OH().map(QP).filter(t=>!!t).map(t=>t)))}).catch(y)}};L0=E([(0,xa.injectable)(),I(0,(0,xa.inject)(uy)),I(1,(0,xa.inject)(Io)),I(2,(0,xa.inject)(ie)),I(3,(0,xa.inject)(ot))],L0);u();var gI=require("vscode");u();function TG(r,e){let t=r.length>0?`?token=${r}`:"";return`${e}${t}`}async function DR(r,e){let t=C.jupyterSelfCertEnable,n=C.jupyterSelfCertClose,i=await gI.window.showErrorMessage(C.jupyterSelfCertFail(e),{modal:!0},t,n);return i===t?(J("DATASCIENCE.SELFCERTSMESSAGEENABLED"),await r.updateSetting("allowUnauthorizedRemoteConnection",!0,void 0,gI.ConfigurationTarget.Workspace),!0):(i===n&&J("DATASCIENCE.SELFCERTSMESSAGECLOSE"),!1)}async function PR(r,e){let t=C.jupyterSelfCertEnable,n=C.jupyterSelfCertClose,i=await gI.window.showErrorMessage(C.jupyterExpiredCertFail(e),{modal:!0},t,n);return i===t?(J("DATASCIENCE.SELFCERTSMESSAGEENABLED"),await r.updateSetting("allowUnauthorizedRemoteConnection",!0,void 0,gI.ConfigurationTarget.Workspace),!0):(i===n&&J("DATASCIENCE.SELFCERTSMESSAGECLOSE"),!1)}function uV(r,e,t,n,i,o,s){var _;let a=e.baseUrl,l=e.token,c=new URL(e.baseUrl).hostname,d=e.authorizationHeader&&Object.keys((_=e==null?void 0:e.authorizationHeader)!=null?_:{}).length>0?e.authorizationHeader:void 0,p=d?()=>d:void 0,f={baseUrl:a,appUrl:"",wsUrl:a.replace("http","ws"),fetch:e.fetch,WebSocket:e.WebSocket},m=t.getRequestInit();(!(l===""||l==="null")||p)&&(f={...f,token:l,appendToken:!0});let h=i.getSettings(void 0).allowUnauthorizedRemoteConnection;if(a.startsWith("https")&&h&&n){let D=n.createHttpRequestAgent();m={...m,agent:D}}let{ServerConnection:v}=oi();return f={...f,init:m,WebSocket:e.WebSocket?t.wrapWebSocketCtor(e.WebSocket):t.getWebsocketCtor(void 0,h,p),fetch:e.fetch||t.getFetchMethod(),Request:t.getRequestCtor(void 0,h,p),Headers:t.getHeadersCtor()},{baseUrl:a,providerId:r.id,serverProviderHandle:r,token:l,hostName:c,displayName:e&&e.displayName?e.displayName:TG(l,a),dispose:()=>s==null?void 0:s.dispose(),rootDirectory:o,getAuthHeader:p,settings:v.makeSettings(f)}}async function h$(r){let e=Jt(r);return ja(e,"SHA-256")}var rbe=new Set([Ge,"ms-toolsai.vscode-ai","GitHub.codespaces"].map(r=>r.toLowerCase()));function Jt(r){return rbe.has(r.extensionId.toLowerCase())?`${tt.REMOTE_URI}?${tt.REMOTE_URI_ID_PARAM}=${r.id}&${tt.REMOTE_URI_HANDLE_PARAM}=${encodeURI(r.handle)}`:`${tt.REMOTE_URI}?${tt.REMOTE_URI_ID_PARAM}=${r.id}&${tt.REMOTE_URI_HANDLE_PARAM}=${encodeURI(r.handle)}&${tt.REMOTE_URI_EXTENSION_ID_PARAM}=${encodeURI(r.extensionId)}`}async function TR(r){var e;if(!dp()&&((e=r.interpreter)!=null&&e.uri)){let t=r.interpreter.uri.fsPath,n=Oc(r.interpreter.uri).fsPath,i=r.id.replace(t,n);return Nt(i)}return Nt(r.id)}var Yc=class{static fromJSON(e){let t=Object.assign(e,{});switch(t.interpreter&&(t.interpreter=cx(t.interpreter,"")),e.kind){case"startUsingLocalKernelSpec":return dV.create(t);case"connectToLiveRemoteKernel":return Px.create(t);case"startUsingRemoteKernelSpec":return Tx.create(t);case"startUsingPythonInterpreter":return kx.create(t);default:throw new Error(`Invalid object to be deserialized into a connection, kind = ${t.kind}`)}}},Px=class r{constructor(e){this.kind="connectToLiveRemoteKernel";this.kernelModel=e.kernelModel,this.interpreter=e.interpreter,this.baseUrl=e.baseUrl,this.id=e.id,this.serverProviderHandle=e.serverProviderHandle,kR(this)}static create(e){return new r(e)}updateModel(e){Object.assign(this.kernelModel,e)}getHashId(){return TR(this)}toJSON(){return{id:this.id,kind:this.kind,baseUrl:this.baseUrl,interpreter:ux(this.interpreter),kernelModel:this.kernelModel,serverProviderHandle:this.serverProviderHandle}}static fromJSON(e){return Yc.fromJSON(e)}},dV=class r{constructor(e){this.kind="startUsingLocalKernelSpec";this.kernelSpec=e.kernelSpec,this.interpreter=e.interpreter,this.id=e.id,kR(this)}static create(e){return new r(e)}getHashId(){return TR(this)}toJSON(){return{id:this.id,kernelSpec:this.kernelSpec,interpreter:ux(this.interpreter),kind:this.kind}}static fromJSON(e){return Yc.fromJSON(e)}},Tx=class r{constructor(e){this.kind="startUsingRemoteKernelSpec";this.interpreter=e.interpreter,this.kernelSpec=e.kernelSpec,this.baseUrl=e.baseUrl,this.id=e.id,this.serverProviderHandle=e.serverProviderHandle,kR(this)}static create(e){return new r(e)}getHashId(){return TR(this)}toJSON(){return{id:this.id,kernelSpec:this.kernelSpec,interpreter:ux(this.interpreter),baseUrl:this.baseUrl,kind:this.kind,serverProviderHandle:this.serverProviderHandle}}static fromJSON(e){return Yc.fromJSON(e)}},kx=class r{constructor(e){this.kind="startUsingPythonInterpreter";this.kernelSpec=e.kernelSpec,this.interpreter=e.interpreter,this.id=e.id,kR(this)}static create(e){return new r(e)}getHashId(){return TR(this)}toJSON(){return{id:this.id,kernelSpec:this.kernelSpec,interpreter:ux(this.interpreter),kind:this.kind}}updateInterpreter(e){Object.assign(this.interpreter,e)}static fromJSON(e){return Yc.fromJSON(e)}};function er(r){return r.kind==="startUsingLocalKernelSpec"||r.kind==="startUsingPythonInterpreter"}function Mt(r){return!er(r)}var He=Symbol("IKernelProvider"),Wh=Symbol("IThirdPartyKernelProvider");var aqe=Symbol("IJupyterServerConnector"),Nx=Symbol("IKernelSessionFactory");var hI=Symbol("IKernelDependencyService"),ai=Symbol("IKernelFinder"),vI=Symbol("ITracebackFormatter");var Ad=Symbol("IStartupCodeProviders"),v$=new Set;function kR(r){var m,g;if(v$.has(r.id))return;v$.add(r.id);let e="kernelSpec"in r?r.kernelSpec:void 0,t=(e==null?void 0:e.language)||(r.kind==="startUsingPythonInterpreter"?Je:void 0),n="",i="",o="interpreter"in r?r.interpreter:void 0,s="<#>",a;e&&Array.isArray(e.argv)&&e.argv.length>0&&(n=e.argv[0],a=n.toLowerCase()===((g=(m=o==null?void 0:o.uri)==null?void 0:m.fsPath)==null?void 0:g.toLowerCase()),tr(n)!==n&&(n=`<P>${tr(n)}`),i=e.argv.map(h=>h.includes("/")||h.includes("\\")?`<P>${tr(h)}`:h).join(s));let l="kernelSpec"in r&&r.kernelSpec.specFile?Nt(r.kernelSpec.specFile):Promise.resolve(""),c=Nt(r.id),d=Mt(r)?Nt(Jt(r.serverProviderHandle)):Promise.resolve(""),p=Mt(r)?r.serverProviderHandle.extensionId:Ge,f=Mt(r)?Nt(r.baseUrl.toLowerCase()):Promise.resolve("");Promise.all([l,c,d,f]).then(([h,v,S,_])=>J("DS_INTERNAL.JUPYTER_KERNEL_SPEC",void 0,{kernelId:v,serverIdHash:S,kernelSpecHash:h,baseUrlHash:_,providerExtensionId:p,kernelConnectionType:r.kind,kernelLanguage:t,envType:o&&zr(o),isArgv0SameAsInterpreter:a,argv0:n,argv:i})).catch(y)}u();var zn=require("vscode");u();var ube=$(pW()),Md=require("vscode");u();var yI=class{constructor(e,t,n,i){this.specFile=t;this.interpreterPath=n;this.isRegisteredByVSC=i;this.name=e.name,this.argv=e.argv,this.language=e.language,this.executable=e.argv&&e.argv.length>0?e.argv[0]:"",this.display_name=e.display_name,this.metadata=e.metadata,this.env=e.env,this.interrupt_mode=e.interrupt_mode}};u();var li=require("vscode"),w$=$(pV());u();var fV=class{constructor(e,t,n,i=!1){this._impl=e;this.controllerId=t;this._endCallback=n;this.clearOutputOnStartWithTime=i;this._started=!1}get started(){return this._started}get cell(){return this._impl.cell}get token(){return this._impl.token}get executionOrder(){return this._impl.executionOrder}set executionOrder(e){var t;e&&((t=Uc(this._impl.cell.notebook))==null||t.executeCellAcknowledged()),this._impl.executionOrder=e}startIfNecessary(){this.started||this._impl.start()}start(e){this.started||(this._started=!0,this._impl.start(e),this._startTime=e,this.clearOutputOnStartWithTime?(b.trace(`Start cell ${this.cell.index} execution @ ${e} (clear output)`),this._impl.clearOutput().then(y,y)):b.trace(`Start cell ${this.cell.index} execution @ ${e}`))}end(e,t){if(this._endCallback)try{this._impl.end(e,t,this.errorInfo),b.trace(`Cell ${this.cell.index} completed in ${((t||0)-(this._startTime||0))/1e3}s (start: ${this._startTime}, end: ${t})`)}finally{this._endCallback(),this._endCallback=void 0}}clearOutput(e){return this.startIfNecessary(),this._impl.clearOutput(e)}replaceOutput(e,t){return this.startIfNecessary(),this._impl.replaceOutput(e,t)}appendOutput(e,t){return this.startIfNecessary(),this._impl.appendOutput(e,t)}replaceOutputItems(e,t){return this.startIfNecessary(),this._impl.replaceOutputItems(e,t)}appendOutputItems(e,t){return this.startIfNecessary(),this._impl.appendOutputItems(e,t)}},Ff=class Ff{static getOrCreate(e,t,n=!1){let i,o=e.document;if(i=this.get(e),!i)i=Ff.create(o,e,t,n);else if(i.controllerId!==t.id){let s=i;s.end(void 0),i=Ff.create(o,e,t,n),s.started&&i.start(new Date().getTime())}return i}static get(e){let t=e.document;return Ff._map.get(t)}static create(e,t,n,i=!1){let o=new fV(n.createNotebookCellExecution(t),n.id,()=>{Ff._map.delete(e)},i);return Ff._map.set(e,o),o}};Ff._map=new WeakMap;var lo=Ff;u();function NR(r){return typeof Buffer!="undefined"&&typeof Buffer.from=="function"?Buffer.from(r,"base64"):Uint8Array.from(atob(r),e=>e.charCodeAt(0))}var ibe=new TextDecoder;function RR(r){if(typeof Buffer!="undefined"&&typeof Buffer.from=="function")return Buffer.from(r).toString("base64");{let e=ibe.decode(r);return btoa(encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,function(t,n){return String.fromCharCode(Number.parseInt("0x"+n))}))}}var S$=["application/vnd.*","application/vdom.*","application/geo+json","application/x-nteract-model-debug+json","text/html","application/javascript","image/gif","text/latex","text/markdown","image/png","image/svg+xml","image/jpeg","application/json","text/plain"];function _$(r){if(r.mime.startsWith("application/vnd."))try{return new TextDecoder().decode(r.data).length===0}catch(e){}return!1}function obe(r){return r.sort((e,t)=>{let n=(s,a)=>(s.endsWith(".*")&&(s=s.substr(0,s.indexOf(".*"))),a.startsWith(s)),i=S$.findIndex(s=>n(s,e.mime)),o=S$.findIndex(s=>n(s,t.mime));return _$(e)&&(i=-1),_$(t)&&(o=-1),i=i==-1?100:i,o=o==-1?100:o,i-o})}var Uf=class Uf{static getCellState(e){var t;return(t=Uf.cellStates.get(e))==null?void 0:t.state}static getCellStatus(e){var t;return(((t=Uf.cellStates.get(e))==null?void 0:t.stateTransition)||[]).join(", ")||""}static setCellState(e,t){var o,s;let n=((o=Uf.cellStates.get(e))==null?void 0:o.start)||new It,i=((s=Uf.cellStates.get(e))==null?void 0:s.stateTransition)||[];i.push(`${t} ${i.length===0?"@ start":`After ${n.elapsedTime}ms`}`),Uf.cellStates.set(e,{stateTransition:i,state:t,start:n})}};Uf.cellStates=new WeakMap;var Wf=Uf;function nt(r,e){let t=typeof e=="string"?()=>e:e;b.ci(()=>{var n;return`Cell Index:${r.index}, of document ${mi(r.notebook.uri)} with state:${Wf.getCellStatus(r)}, exec: ${(n=r.executionSummary)==null?void 0:n.executionOrder}. ${t()}. called from ${S7()}`})}var II=new Map;II.set("display_data",MR);II.set("error",cbe);II.set("execute_result",MR);II.set("stream",sbe);II.set("update_display_data",MR);function us(r){let e=II.get(r.output_type),t;return e?t=e(r):(b.warn(`Unable to translate cell from ${r.output_type} to NotebookCellData for VS Code.`),t=MR(r)),t}function mV(r){let e={outputType:r.output_type};switch(r.transient&&(e.transient=r.transient),r.output_type){case"display_data":case"execute_result":case"update_display_data":{e.executionCount=r.execution_count,e.metadata=r.metadata?JSON.parse(JSON.stringify(r.metadata)):{};break}default:break}return e}function Vh(r){return r.metadata}function MR(r){let e=mV(r);("image/svg+xml"in r.data||"image/png"in r.data)&&(e.__displayOpenPlotIcon=!0);let t=[];if(r.data)for(let n in r.data)t.push(lbe(n,r.data[n]));return new li.NotebookCellOutput(obe(t),e)}function sbe(r){let e=Fc(r.text),t=r.name==="stderr"?li.NotebookCellOutputItem.stderr:li.NotebookCellOutputItem.stdout;return new li.NotebookCellOutput([t(e)],mV(r))}function abe(r){if(r.items.length>0)return r.items[0].mime==="application/vnd.code.notebook.stderr"?"stderr":"stdout"}function E$(r){var i;let e=r.items[0];if(!e.data)return{output_type:"error",ename:"",evalue:"",traceback:[]};let t=(i=r.metadata)==null?void 0:i.originalError,n=JSON.parse(new TextDecoder().decode(e.data));return{output_type:"error",ename:n.name,evalue:n.message,traceback:(t==null?void 0:t.traceback)||nI(n.stack||n.message||"")}}var bI=new TextDecoder,x$=["text/plain","text/markdown","application/vnd.code.notebook.stderr","application/vnd.code.notebook.stdout"];function AR(r,e){if(!e)return"";try{if(r==="application/vnd.code.notebook.error"){let t=bI.decode(e);return JSON.parse(t)}else if(r.startsWith("text/")||x$.includes(r)){let t=bI.decode(e);return nI(t)}else{if(r.startsWith("image/")&&r!=="image/svg+xml")return RR(e);if(r.toLowerCase().startsWith("application/vnd.holoviews_load.v")&&r.toLowerCase().endsWith("+json")){let t=bI.decode(e);try{return t.length>0?JSON.parse(t):t}catch(n){return t}}else if(r.toLowerCase().includes("json")){let t=bI.decode(e);return t.length>0?JSON.parse(t):t}else return bI.decode(e)}}catch(t){return b.error(`Failed to convert ${r} output from a buffer ${typeof e}, ${e}`,t),""}}function lbe(r,e){if(!e)return li.NotebookCellOutputItem.text("",r);try{if((r.startsWith("text/")||x$.includes(r))&&(Array.isArray(e)||typeof e=="string")){let t=Array.isArray(e)?Fc(e):e;return li.NotebookCellOutputItem.text(t,r)}else return r.startsWith("image/")&&typeof e=="string"&&r!=="image/svg+xml"?new li.NotebookCellOutputItem(NR(e),r):typeof e=="object"&&e!==null&&!Array.isArray(e)?li.NotebookCellOutputItem.text(JSON.stringify(e),r):(e=Array.isArray(e)?Fc(e):e,li.NotebookCellOutputItem.text(e,r))}catch(t){return b.error(`Failed to convert ${r} output to a buffer ${typeof e}, ${e}`,t),li.NotebookCellOutputItem.text("")}}function C$(r){let e=[];r.items.filter(n=>n.mime==="application/vnd.code.notebook.stderr"||n.mime==="application/vnd.code.notebook.stdout").map(n=>bI.decode(n.data)).forEach(n=>{let i=n.split(`
`);e.length&&i.length&&i[0].length>0&&(e[e.length-1]=`${e[e.length-1]}${i.shift()}`);for(let o of i)e.push(o)});for(let n=0;n<e.length-1;n++)e[n]=`${e[n]}
`;return e.length&&e[e.length-1].length===0&&e.pop(),{output_type:"stream",name:abe(r)||"stdout",text:e}}function gV(r){let e=r.metadata,t;switch(e==null?void 0:e.outputType){case"error":{t=E$(r);break}case"stream":{t=C$(r);break}case"display_data":{t={output_type:"display_data",data:r.items.reduce((i,o)=>(i[o.mime]=AR(o.mime,o.data),i),{}),metadata:(e==null?void 0:e.metadata)||{}};break}case"execute_result":{t={output_type:"execute_result",data:r.items.reduce((i,o)=>(i[o.mime]=AR(o.mime,o.data),i),{}),metadata:(e==null?void 0:e.metadata)||{},execution_count:typeof(e==null?void 0:e.executionCount)=="number"?e==null?void 0:e.executionCount:null};break}case"update_display_data":{t={output_type:"update_display_data",data:r.items.reduce((i,o)=>(i[o.mime]=AR(o.mime,o.data),i),{}),metadata:(e==null?void 0:e.metadata)||{}};break}default:{let i=r.items.length===1&&r.items.every(l=>l.mime==="application/vnd.code.notebook.error"),o=r.items.every(l=>l.mime==="application/vnd.code.notebook.stderr"||l.mime==="application/vnd.code.notebook.stdout");if(i)return E$(r);let s=(e==null?void 0:e.outputType)||(o?"stream":"display_data");J("DS_INTERNAL.VSCNOTEBOOK_CELL_TRANSLATION_FAILED",void 0,{outputType:s});let a;s==="stream"?a=C$(r):s==="display_data"?a={data:{},metadata:{},output_type:"display_data"}:a={output_type:s},e!=null&&e.metadata&&(a.metadata=e.metadata),r.items.length>0&&(a.data=r.items.reduce((l,c)=>(l[c.mime]=AR(c.mime,c.data),l),{})),t=a;break}}return t&&e&&e.transient&&(t.transient=e.transient),t}function cbe(r){return r=r||{output_type:"error",ename:"",evalue:"",traceback:[]},new li.NotebookCellOutput([li.NotebookCellOutputItem.error({name:(r==null?void 0:r.ename)||"",message:(r==null?void 0:r.evalue)||"",stack:((r==null?void 0:r.traceback)||[]).join(`
`)})],{...mV(r),originalError:r})}async function D$(r,e,t){var a,l,c,d,p,f,m,g,h,v,S,_,D,P,M,x;let n=!1,i;if(!r)return{changed:n,kernelId:i};(a=r==null?void 0:r.language_info)!=null&&a.name||(r.language_info=r.language_info||{name:""});let o;switch(e==null?void 0:e.kind){case"connectToLiveRemoteKernel":o=e.kernelModel.language;break;case"startUsingRemoteKernelSpec":case"startUsingLocalKernelSpec":o=e.kernelSpec.language;break;case"startUsingPythonInterpreter":o=Je;break;default:break}if(r.language_info.name!==o&&o&&(r.language_info.name=o,n=!0),t&&"language_info"in t&&t.language_info)(0,w$.default)(r.language_info,t.language_info)||(r.language_info=JSON.parse(JSON.stringify(t.language_info)),n=!0);else{let A=qt(e),j=A?T$(e):void 0,re=await Cp(j),R=re?`${re.major}.${re.minor}.${re.micro}`:"";j&&re&&r&&r.language_info&&r.language_info.version!==R?(r.language_info.version=R,n=!0):!j&&(r!=null&&r.language_info)&&A&&(r.language_info=void 0,n=!0)}let s=e&&SI(e)?e.kernelModel:e&&"kernelSpec"in e?e.kernelSpec:void 0;if((e==null?void 0:e.kind)==="startUsingPythonInterpreter"){let A=e.kernelSpec,j=A.display_name||((c=(l=zi(e.interpreter))==null?void 0:l.environment)==null?void 0:c.name)||"",re="";switch(jh(A)){case"registeredByOldVersionOfExt":case"registeredByNewVersionOfExt":re="python3";break;case"registeredByNewVersionOfExtForCustomKernelSpec":{re=((p=(d=A.metadata)==null?void 0:d.vscode)!=null&&p.originalSpecFile?tr(Di(A.metadata.vscode.originalSpecFile)):void 0)||A.name,j=((m=(f=A.metadata)==null?void 0:f.vscode)==null?void 0:m.originalDisplayName)||j;break}default:re=A.name;break}((g=r.kernelspec)==null?void 0:g.name)!==re&&(n=!0,r.kernelspec={name:re,language:Je,display_name:j},"vscode"in r&&delete r.vscode,"interpreter"in r&&delete r.interpreter)}else if(s&&!r.kernelspec){let A=(v=(h=s.metadata)==null?void 0:h.vscode)!=null&&v.originalSpecFile?tr(Di(s.metadata.vscode.originalSpecFile)):void 0;r.kernelspec={name:A||s.name||s.display_name||"",display_name:((_=(S=s.metadata)==null?void 0:S.vscode)==null?void 0:_.originalDisplayName)||s.display_name||s.name||""},s.language&&(r.kernelspec.language=s.language),i=s.id,n=!0}else if(s&&r.kernelspec){let j=((P=(D=s.metadata)==null?void 0:D.vscode)!=null&&P.originalSpecFile?tr(Di(s.metadata.vscode.originalSpecFile)):void 0)||s.name||s.display_name||"",re=((x=(M=s.metadata)==null?void 0:M.vscode)==null?void 0:x.originalDisplayName)||s.display_name||s.name||"",R=s.language||s.language||"";(r.kernelspec.name!==j||r.kernelspec.language!==R||r.kernelspec.display_name!==re||i!==s.id)&&(n=!0,r.kernelspec.name=j,r.kernelspec.display_name=re,r.kernelspec.language=R,i=s.id);try{delete r.kernelspec.metadata}catch(Z){}}return{changed:n,kernelId:i}}async function Vf(r,e,t,n){var a,l,c,d,p,f,m;let i=fy(t);if(!i){let g=lo.get(r);n&&(g!=null&&g.started)&&g.end(n?void 0:!1,(l=(a=r.executionSummary)==null?void 0:a.timing)==null?void 0:l.endTime);return}lo.get(r)||(n=!0);let o=lo.getOrCreate(r,e),s=o.executionOrder;o.started||(o.start((d=(c=r.executionSummary)==null?void 0:c.timing)==null?void 0:d.startTime),o.executionOrder=((p=r.executionSummary)==null?void 0:p.executionOrder)||s),await o.appendOutput(i),o.end(n?void 0:!1,(m=(f=r.executionSummary)==null?void 0:f.timing)==null?void 0:m.endTime)}function P$(r,e){var s;let t=/Cell\s+(?:\u001b\[.+?m)?In\s*\[(?<executionCount>\d+)\],\s*line (?<lineNumber>\d+).*/,n=/Input\s+?(?:\u001b\[.+?m)?In\s*\[(?<executionCount>\d+)\][^<]*<cell line:\s?(?<lineNumber>\d+)>.*/,i;for(let a of r){let l=(s=t.exec(a))!=null?s:n.exec(a);if(l&&l.groups){i=parseInt(l.groups.lineNumber);break}}let o;if(i&&i>0&&i<=e.document.lineCount){let a=e.document.lineAt(i-1),l=a.text.split("#")[0].trimEnd().length;o=new li.Range(new li.Position(a.lineNumber,a.firstNonWhitespaceCharacterIndex),new li.Position(a.lineNumber,l))}return o}u();function Rx(r){if(r.hasOwnProperty("text/html")){let e=r["text/html"];typeof e=="string"&&e.includes('<iframe id="tensorboard-frame-')&&(r["text/html"]=e.replace(/new URL\((.*), window.location\)/,'new URL("http://localhost")'))}return r}var dbe="{connection_file}";var jf="-jvsc-",pbe=/^python\d*.?\d*$/;async function Mx(r,e){return fbe(await ybe(r),r,e)}function fbe(r,e,t){var s,a;let n=e?{path:at(e.uri)}:{},i={name:r,language:"python",display_name:(e?(a=(s=zi(e))==null?void 0:s.environment)==null?void 0:a.name:"")||"Python 3",metadata:{interpreter:n},argv:["python","-m","ipykernel_launcher","-f",dbe],env:{},resources:{}},o=t&&i.name?Hi(t,i.name,"kernel.json"):void 0;return new yI(i,o?at(o):void 0,at(e==null?void 0:e.uri),"registeredByNewVersionOfExt")}function OR(r){var t,n,i;let e=r==null?void 0:r.kernelspec;return(t=r==null?void 0:r.language_info)!=null&&t.name&&r.language_info.name!==Je?!1:(n=e==null?void 0:e.name)!=null&&n.includes(Je)?!0:(e==null?void 0:e.language)===Je||((i=r==null?void 0:r.language_info)==null?void 0:i.name)===Je}function mbe(r){var i,o,s,a,l;let e=((o=(i=r.metadata)==null?void 0:i.vscode)==null?void 0:o.originalSpecFile)||((s=r.metadata)==null?void 0:s.originalSpecFile),t=e?tr(Di(e)):r.name||"",n=((l=(a=r.metadata)==null?void 0:a.vscode)==null?void 0:l.originalDisplayName)||r.display_name||"";return!!(t.toLowerCase().match(pbe)||n.toLowerCase()==="python 3 (ipykernel)"||n.toLowerCase()==="python 3")}function gbe(r){if(r.includes(jf)){let e=/[a-f0-9]$/;if(r.substring(r.lastIndexOf(jf)+jf.length).search(e)!==-1){let t=r.substring(0,r.lastIndexOf(jf));return t.toLowerCase().endsWith(".ipynb")||t.toLowerCase().endsWith(".py")?t:`${t}.ipynb`}}return r}function LR(r){return r.kind!=="connectToLiveRemoteKernel"}function SI(r){return r.kind==="connectToLiveRemoteKernel"}function KR(r,e,t){var c,d,p;e=hV(r)?e:void 0;let n=r.name,i=jh(r);if(i&&n.includes(Ax)&&(n=n.substring(n.indexOf(Ax)),i==="registeredByNewVersionOfExtForCustomKernelSpec")){let f=((d=(c=r.metadata)==null?void 0:c.vscode)==null?void 0:d.originalSpecFile)||((p=r.metadata)==null?void 0:p.originalSpecFile);f&&(n=`${n}#${tr(Di(f))}`)}let o="";hV(r)?o=r.argv.slice(1).filter(f=>!["-f","{connection_file}"].includes(f)).join("#").toLowerCase():o=r.argv.join("#").toLowerCase();let s=t?`${t}.`:"",a=at(Oc(r.interpreterPath?Md.Uri.file(r.interpreterPath):Md.Uri.file(r.executable))),l=at(Oc(e==null?void 0:e.uri))||"";return`${s}${r.id||""}.${n}.${a}.${l}.${o}`}function ct(r){var t,n,i,o;let e=hbe(r);if(!r)return e;switch(r.kind){case"connectToLiveRemoteKernel":{let a=gbe(((n=(t=r.kernelModel)==null?void 0:t.notebook)==null?void 0:n.path)||((o=(i=r.kernelModel)==null?void 0:i.model)==null?void 0:o.path)||"");return a?`${e} (${a})`:e}case"startUsingRemoteKernelSpec":case"startUsingLocalKernelSpec":if(r.interpreter&&zr(r.interpreter)!=="Unknown"){let a=_s(r.interpreter);if(r.kernelSpec.language===Je){let l=`Python ${ry(Ku(r.interpreter))||""}`.trim();return a?`${e} (${l})`:e}else return a?`${e} (${a})`:e}else return e;case"startUsingPythonInterpreter":let s=(ry(Ku(r.interpreter))||"").trim();if(r.interpreter&&zr(r.interpreter)!=="Unknown"){if(r.kernelSpec.display_name&&jh(r.kernelSpec)==="registeredByNewVersionOfExtForCustomKernelSpec")return r.kernelSpec.display_name;let a=Ep(r.interpreter),l=s.trim()?`Python ${s}`:"Python",c=_s(r.interpreter);return a&&c?c:c?`${c} (${l})`:l}else return`Python ${s}`.trim()}return e}function hbe(r){var i,o;if(!r)return"";let e=r.kind==="connectToLiveRemoteKernel"?r.kernelModel.display_name:(i=r.kernelSpec)==null?void 0:i.display_name,t=r.kind==="connectToLiveRemoteKernel"?r.kernelModel.name:(o=r.kernelSpec)==null?void 0:o.name,n=r.kind==="startUsingPythonInterpreter"?Lu(r.interpreter):void 0;return[e,t,n,""].find(s=>typeof s=="string"&&s.length>0)||""}function k$(r,e=""){var t;return r?r.kind==="connectToLiveRemoteKernel"?r.kernelModel.name:(t=r.kernelSpec)==null?void 0:t.name:e}function vbe(r){var n,i,o,s,a;if(!r)return;let e=SI(r)?r.kernelModel:void 0,t=LR(r)?r.kernelSpec:void 0;if(r.kind==="startUsingPythonInterpreter"||(r.kind==="startUsingRemoteKernelSpec"||r.kind==="startUsingLocalKernelSpec")&&r.kernelSpec.language===Je){let l=((i=(n=t==null?void 0:t.metadata)==null?void 0:n.interpreter)==null?void 0:i.path)||(t==null?void 0:t.interpreterPath)||(t==null?void 0:t.executable);if(l==="/python"||l==="python"){let c=zi(r.interpreter);return((o=c==null?void 0:c.environment)==null?void 0:o.folderUri)||(c?Md.Uri.file(c.path):void 0)}return l?Md.Uri.file(l):void 0}else{let l=(e==null?void 0:e.executable)||(t==null?void 0:t.executable)||((a=(s=t==null?void 0:t.metadata)==null?void 0:s.interpreter)==null?void 0:a.path)||(t==null?void 0:t.interpreterPath);return l?Md.Uri.file(l):void 0}}function vV(r,e=""){if((r==null?void 0:r.kind)==="connectToLiveRemoteKernel"){let t;if(typeof r.kernelModel.lastActivityTime=="string")try{t=new Date(r.kernelModel.lastActivityTime)}catch(n){b.debug(`Error parsing date ${n}`)}else t=r.kernelModel.lastActivityTime;return C.jupyterSelectLiveRemoteKernelDescription(t,r.kernelModel.numberOfConnections)}return e}function N$(r,e){if((r==null?void 0:r.kind)==="connectToLiveRemoteKernel")return;let t=vbe(r),n=Md.workspace.workspaceFolders?Md.workspace.workspaceFolders:[];return t?ve(t,n,e.homeDir):""}function T$(r){var n,i,o;if(!r)return;if(r.interpreter)return r.interpreter;let e=SI(r)?r.kernelModel:void 0;if((n=e==null?void 0:e.metadata)!=null&&n.interpreter)return cx((i=e==null?void 0:e.metadata)==null?void 0:i.interpreter,"");let t=LR(r)?r.kernelSpec:void 0;return cx((o=t==null?void 0:t.metadata)==null?void 0:o.interpreter,"")}function R$(r){return r.kind==="startUsingLocalKernelSpec"||r.kind==="startUsingPythonInterpreter"&&r.kernelSpec&&jh(r.kernelSpec)==="registeredByNewVersionOfExtForCustomKernelSpec"}function qt(r){if(!r)return!1;if(r.kind==="startUsingPythonInterpreter")return!0;let e=SI(r)?r.kernelModel:void 0,t=LR(r)?r.kernelSpec:void 0;return(e==null?void 0:e.language)===Je||hV(t)}function hV(r){return((r==null?void 0:r.language)||"").toLowerCase()===Je}function $c(r){if(!r)return;if(r.kind==="startUsingPythonInterpreter")return Je;let e=SI(r)?r.kernelModel:void 0,t=LR(r)?r.kernelSpec:void 0;return(e==null?void 0:e.language)||M$(t)}function A$(r){var t;if(!r)return;let e=r.kernelspec;return M$(e)||((t=r.language_info)==null?void 0:t.name)}function M$(r){return r==null?void 0:r.language}var Ax="jvsc74a57bd0";async function ybe(r){let t=(ry(Ku(r))||"3").replace(/\./g,""),n=r?`python${t}`:"";return r?`${n}${Ax}${await qb(r)}`:"python3"}function jh(r){var o,s,a,l;if(r.isRegisteredByVSC)return r.isRegisteredByVSC;if(!r.name)return;let e=((s=(o=r.metadata)==null?void 0:o.vscode)==null?void 0:s.originalSpecFile)||((a=r.metadata)==null?void 0:a.originalSpecFile),t=e?tr(Di(e)):r.name,n=mbe({...r,name:t})?Object.keys(r.env||{}).length>0:typeof e=="string"&&!e.includes(Ax);if(r.name.includes(Ax))return n?"registeredByNewVersionOfExtForCustomKernelSpec":"registeredByNewVersionOfExt";let i=/[a-f0-9]{32}$/;if((l=r.metadata)!=null&&l.interpreter&&r.name.toLowerCase().search(i)!==-1)return"registeredByOldVersionOfExt"}function O$(r,e){return!r&&!e?!0:!r&&e||r&&!e?!1:(r==null?void 0:r.id)===(e==null?void 0:e.id)}async function Fi(r,e,t){b.trace(`Executing silently Code (${r.status}) = ${st(e.substring(0,100)).join("\\n")}`);let n=oi(),i=r.requestExecute({code:e.replace(/\r\n/g,`
`),silent:!1,stop_on_error:!1,allow_stdin:!0,store_history:!1},!0),o=[];i.onIOPub=a=>{if(n.KernelMessage.isStreamMsg(a))if(b.ci(`Got io pub message (stream), ${st(a.content.text.substr(0,100)).join("\\n")}`),o.length>0&&o[o.length-1].output_type==="stream"&&o[o.length-1].name===a.content.name){let l=o[o.length-1];l.text+=a.content.text}else{let l={name:a.content.name,text:a.content.text,output_type:"stream"};o.push(l)}else if(n.KernelMessage.isExecuteResultMsg(a)){b.ci("Got io pub message (execresult)}");let l={data:a.content.data,execution_count:a.content.execution_count,metadata:a.content.metadata,output_type:"execute_result"};o.push(l)}else if(n.KernelMessage.isDisplayDataMsg(a)){b.ci("Got io pub message (displaydata)}");let l={data:a.content.data,metadata:a.content.metadata,output_type:"display_data"};o.push(l)}else if(n.KernelMessage.isErrorMsg(a)){if(b.ci(`Got io pub message (error), ${a.content.ename},${a.content.evalue}, ${a.content.traceback.join().substring(0,100)}}`),t!=null&&t.traceErrors){let c=`${t.traceErrorsMessage||"Failed to execute (silent) code against the kernel"}, 
Code = ${e}
Error details: `;b.error(`${c} ${a.content.ename},${a.content.evalue}, ${a.content.traceback.join()}`)}let l={ename:a.content.ename,evalue:a.content.evalue,traceback:a.content.traceback,output_type:"error"};o.push(l)}else b.ci(`Got io pub message (${a.header.msg_type})`)},await i.done;let s=st(e.substring(0,100)).join("\\n");return t&&bbe(o,t,s),b.trace(`Executing silently Code (completed) = ${s} with ${o.length} output(s)`),o}function L$(r,e,t,n){e=e.replace(/\r\n/g,`
`);let i=oi(),o=r.requestExecute({code:e,silent:!1,stop_on_error:!1,allow_stdin:!1,store_history:!1},!0),s=ur(t);return o.onIOPub=a=>{s(),i.KernelMessage.isStreamMsg(a)?n(us({output_type:"stream",name:a.content.name,text:a.content.text})):i.KernelMessage.isExecuteResultMsg(a)?n(us({output_type:"execute_result",data:a.content.data,metadata:a.content.metadata,transient:a.content.transient,execution_count:a.content.execution_count})):i.KernelMessage.isDisplayDataMsg(a)?n(us({output_type:"display_data",data:Rx(a.content.data),metadata:a.content.metadata,transient:a.content.transient})):i.KernelMessage.isUpdateDisplayDataMsg(a)?n(us({output_type:"display_data",data:Rx(a.content.data),metadata:a.content.metadata,transient:a.content.transient})):i.KernelMessage.isErrorMsg(a)?n(us({output_type:"error",ename:a.content.ename,evalue:a.content.evalue,traceback:a.content.traceback})):i.KernelMessage.isExecuteInputMsg(a)||i.KernelMessage.isStatusMsg(a)||b.warn(`Got unexpected io pub message when executing code sillenty (${a.header.msg_type})`)},o}function bbe(r,e,t){r.filter(n=>n.output_type==="error").forEach(n=>{let i=n,o=`${i.ename}: ${i.evalue} 
 ${i.traceback.map(a=>`    ${a}`).join(`
`)}`,s=`${e.traceErrorsMessage||""} ${t} ${o}`;e.traceErrors?b.error(s):b.warn(s),e.telemetryName&&J(e.telemetryName)})}u();var FR="application/vnd.vscode.chat_message",K$=`
def __VSCODE_inject_module():

    def __VSCODE_call_function(function, callback, data=None):
        __VSCODE_send_chat_message__(function, data, callback=callback)

    def __VSCODE_send_chat_message__(function, data, callback):
        requests = {}
        try:
            requests = __VSCODE_send_chat_message__.__requests
        except Exception:
            __VSCODE_send_chat_message__.__requests = requests

        import uuid as __VSCODE_send_chat_message__uuid
        import IPython.display as __VSCODE_send_chat_message__ipython_display

        id = str(__VSCODE_send_chat_message__uuid.uuid4())
        requests[id] = callback
        data_is_none = data is None
        __VSCODE_send_chat_message__ipython_display.display({"${FR}": data}, metadata={"id":id, "function": function, "dataIsNone": data_is_none}, raw=True)

        del __VSCODE_send_chat_message__ipython_display
        del __VSCODE_send_chat_message__uuid

    def __VSCODE_on_chat_message(id, data):
        requests = {}
        try:
            requests = __VSCODE_send_chat_message__.__requests
        except Exception:
            __VSCODE_send_chat_message__.__requests = requests

        if id in requests:
            requests[id](data)
            del requests[id]
        else:
            raise NotImplementedError(f"Callback not found for message {id}")

    import sys as __VSCODE_send_chat_message__sys
    import IPython as __VSCODE_send_chat_message__IPython
    chat = type(__VSCODE_send_chat_message__IPython)("chat")
    chat.send_message = __VSCODE_send_chat_message__
    chat.call_function = __VSCODE_call_function
    chat.__on_message = __VSCODE_on_chat_message
    __VSCODE_send_chat_message__sys.modules["vscode"] = type(__VSCODE_send_chat_message__IPython)("vscode")
    __VSCODE_send_chat_message__sys.modules["vscode"].chat = chat
    del __VSCODE_send_chat_message__sys
    del __VSCODE_send_chat_message__IPython


__VSCODE_inject_module()
del __VSCODE_inject_module
`,Ibe=[[new RegExp("\\\\","g"),"\\\\"],[new RegExp('"',"g"),'\\"'],[new RegExp("'","g"),"'"],[new RegExp("\\\b","g"),"\\b"],[new RegExp("\\f","g"),"\\f"],[new RegExp("\\n","g"),"\\n"],[new RegExp("\\r","g"),"\\r"],[new RegExp("\\t","g"),"\\t"]];function F$(r,e){let t=Ox(e),n=typeof t=="string"?`"${t}"`:"None";return`
import vscode as __vscode
try:
    __vscode.chat.__on_message('${r}', ${n})
finally:
    del __vscode
`}function Ox(r){if(typeof r!="string")return r;for(let[e,t]of Ibe)r=r.replace(e,t);return r}u();var Lx=new WeakMap;function UR(r,e,t){var a,l;let n=Vh(t),i=(a=n==null?void 0:n.transient)==null?void 0:a.display_id;if(((l=t.metadata)==null?void 0:l.outputType)!=="display_data"||!i)return;let o=Lx.get(e)||new Map;Lx.set(e,o);let s=o.get(r)||[];o.set(r,s),s.push(i),s.length>1e3&&s.shift()}function U$(r,e){let t=Lx.get(r)||new Map;for(let n of t.values())if(n.includes(e))return!0;return!1}function W$(r,e,t){return((Lx.get(e)||new Map).get(r)||[]).includes(t)}function V$(r,e){let t=Lx.get(r)||new Map;for(let n of t.values()){let i=n.indexOf(e);i>=0&&n.splice(i,1)}}u();var On=require("vscode");var _I=new Map,j$=new Set,jR=new On.EventEmitter;Au(jR);function B$(r){return jR.event(r)}async function H$(r){if(!On.workspace.isTrusted)return{accessAllowed:!1};if(r===Ge)return{accessAllowed:!0};let e=_I.get(r);return e||(e=Sbe(r),_I.set(r,e),e.then(({result:t})=>{(t==="learnMore"||t==="cancelled")&&_I.get(r)===e&&(_I.delete(r),j$.add(r))})),e.then(({result:t})=>({accessAllowed:t==="allowed"}))}async function Sbe(r){var s,a;let e=await yV();if(e.get(r)===!0)return{result:"allowed"};if(e.get(r)===!1)return{result:"denied"};let t=(a=(s=On.extensions.getExtension(r))==null?void 0:s.packageJSON)==null?void 0:a.displayName;if(!t)return b.error(`Kernel API access revoked, as extension ${r} does not exist!`),{result:"denied"};let n=On.l10n.t("Allow"),i=On.l10n.t("Deny"),o=await On.window.showInformationMessage(On.l10n.t("Do you want to grant Kernel access to the extension {0} ({1})?",t,r),{modal:!0,detail:On.l10n.t("This allows the extension to execute code against Jupyter Kernels.")},n,Fe.learnMore,i);switch(o===Fe.learnMore?On.env.openExternal(On.Uri.parse("https://aka.ms/vscodeJupyterKernelApiAccess")).then(y,y):(o===n||o===i)&&await _be(r,o===n),o){case n:return{result:"allowed"};case Fe.learnMore:return{result:"learnMore"};case i:return{result:"denied"};default:return{result:"cancelled"}}}async function J$(){let r=new Set,[e]=await Promise.all([yV().then(t=>new Map(t)),...Array.from(_I.entries()).map(async([t,n])=>{(await n).result!=="allowed"&&r.add(t)})]);return r.forEach(t=>e.set(t,!1)),j$.forEach(t=>e.set(t,e.get(t)===!0)),e}var WR="API.Access",Bf;async function yV(r=!1){let e=rt.instance.get(ot);if(e.extensionMode===On.ExtensionMode.Test)return new Map;if(ur(()=>{rt.instance.get(ie).push(e.secrets.onDidChange(i=>{i.key===WR&&(Bf=void 0)}))})(),Bf&&!r)return Bf;let t="";try{return t=await e.secrets.get(WR),!t||t.length===0?new Map:(Bf=new Map(Object.entries(JSON.parse(t))),Bf)}catch(n){return b.error(`Failed to parse API access information ${t}`,n),new Map}}var VR=Promise.resolve();async function q$(r){return VR=VR.then(async()=>{await Promise.all(Array.from(_I.entries()).map(async([t,n])=>{let i=await n;i.result=r.includes(t)===!0?"allowed":"denied"})),Bf=new Map(r.map(t=>[t,!0]));let e=rt.instance.get(ot);if(e.extensionMode!==On.ExtensionMode.Test)try{await e.secrets.store(WR,JSON.stringify(Object.fromEntries(Bf))),jR.fire()}catch(t){b.error(`Failed to update API access information ${JSON.stringify(Object.fromEntries(Bf))}`,t)}})}async function _be(r,e){return VR=VR.then(async()=>{let t=rt.instance.get(ot);if(t.extensionMode===On.ExtensionMode.Test)return;let n=await yV(!0);if(e!==n.get(r)){n.set(r,e);try{await t.secrets.store(WR,JSON.stringify(Object.fromEntries(n))),jR.fire()}catch(i){b.error(`Failed to store API access information ${JSON.stringify(Object.fromEntries(n))}`,i)}}})}u();var G$=" (Interactive)",Tt=Symbol("IControllerRegistration");var BR=Symbol("IRemoteNotebookKernelSourceSelector"),Y$=Symbol("ILocalNotebookKernelSourceSelector"),HR=Symbol("ILocalPythonNotebookKernelSourceSelector"),EI=Symbol("IConnectionDisplayData");var IV=class extends hP{constructor(t,n){super();this.controller=t;this.notebook=n}dispose(){this.disposeExistingExecution()}createReferencedObject(t,...n){return this.existingExecutions||(this.existingExecutions=this.controller.createNotebookExecution(this.notebook),this.existingExecutions.start()),this.existingExecutions}destroyReferencedObject(t,n){this.disposeExistingExecution()}disposeExistingExecution(){var t;try{(t=this.existingExecutions)==null||t.end()}catch(n){}this.existingExecutions=void 0}},Kx=class Kx{constructor(e,t,n){this.extensionId=e;this.kernel=t;var o,s;this.executionRefCountedDisposableFactory=n?new IV(n,t.notebook):void 0;let i=((s=(o=zn.extensions.getExtension(e))==null?void 0:o.packageJSON)==null?void 0:s.displayName)||e;this.notebook=zn.workspace.notebookDocuments.find(a=>{var l;return a.uri.toString()===((l=t.resourceUri)==null?void 0:l.toString())}),this.controllerDisplayName=ct(t.kernelConnectionMetadata),this.title=zn.l10n.t("Executing code in {0} from {1}",this.controllerDisplayName,i),this.eventHandler=zn.window.onDidChangeVisibleNotebookEditors(this.showProgressImpl,this)}dispose(){var e,t;this.eventHandler.dispose(),(e=this.disposable)==null||e.dispose(),(t=this.executionRefCountedDisposableFactory)==null||t.dispose()}show(){var t;let e=(t=this.executionRefCountedDisposableFactory)==null?void 0:t.acquire("");if(this.deferred&&!this.deferred.completed){let n=this.deferred;this.deferred=Te(),n.resolve()}else this.deferred=Te(),this.showProgress().catch(y);return this.disposable=new zn.Disposable(()=>{var n;e==null||e.dispose(),(n=this.deferred)==null||n.resolve()})}async showProgress(){await tc(1e3),!(!this.deferred||this.deferred.completed||this.displayInProgress)&&(this.shouldDisplayProgress=!0,await Promise.all([this.showProgressImpl(),this.waitUntilCompleted()]),this.shouldDisplayProgress=!1)}async showProgressImpl(){let e=Kx.notificationsPerExtension.get(this.kernel)||new Set;Kx.notificationsPerExtension.set(this.kernel,e),!e.has(this.extensionId)&&(e.add(this.extensionId),!(!this.notebook||!this.shouldDisplayProgress)&&zn.window.visibleNotebookEditors.some(t=>t.notebook===this.notebook)&&(this.displayInProgress=!0,await zn.window.withProgress({location:zn.ProgressLocation.Notification,title:this.title},async()=>this.waitUntilCompleted()),this.displayInProgress=!1))}async waitUntilCompleted(){let e=this.deferred;for(;e&&!e.completed;)await e.promise,e=this.deferred}};Kx.notificationsPerExtension=new WeakMap;var SV=Kx,_V=class r extends Fr{constructor(t,n,i,o){super();this.extensionId=t;this.kernel=n;this.execution=i;this._onDidChangeStatus=this._register(new zn.EventEmitter);this._onDidReceiveDisplayUpdate=this._register(new zn.EventEmitter);this.progress=this._register(new SV(t,n,o)),this._register(xh(n.onDisposed)(()=>this.progress.dispose())),this.language=n.kernelConnectionMetadata.kind==="connectToLiveRemoteKernel"?Je:n.kernelConnectionMetadata.kernelSpec.language||Je,this._register(this.kernel.onStatusChanged(()=>this._onDidChangeStatus.fire(this.kernel.status))),this._register(i.onDidReceiveDisplayUpdate(a=>{var d,p;let l=this.kernel.session,c=Vh(a);(c==null?void 0:c.outputType)==="display_data"&&((d=c==null?void 0:c.transient)!=null&&d.display_id)&&l&&W$(this.extensionId,l,(p=c==null?void 0:c.transient)==null?void 0:p.display_id)&&this._onDidReceiveDisplayUpdate.fire(a)}));let s=this;this._api=Object.freeze({language:this.language,get status(){return s.kernel.status},onDidChangeStatus:s.onDidChangeStatus.bind(this),get onDidReceiveDisplayUpdate(){if(![Ge,y9].includes(t))throw new Error(`Proposed API is not supported for extension ${t}`);return s.onDidReceiveDisplayUpdate.bind(this)},executeCode:(a,l)=>this.executeCode(a,l),executeChatCode:(a,l,c)=>this.executeChatCode(a,l,c)})}get status(){return this.kernel.status}get onDidChangeStatus(){return this._onDidChangeStatus.event}get onDidReceiveDisplayUpdate(){return this._onDidReceiveDisplayUpdate.event}static createApiKernel(t,n,i,o){let s=new r(t,n,i,o);return rt.instance.get(ie).push(s),s._api}async checkAccess(){if(this.extensionId===Ge)return;if(this.accessAllowed||(this.accessAllowed=this.doCheckAccess(),this._register(B$(()=>this.accessAllowed=void 0))),!await this.accessAllowed)throw new Error(zn.l10n.t("Access to Jupyter Kernel has been revoked"))}async doCheckAccess(){let n=(await H$(this.extensionId)).accessAllowed;return J("DATASCIENCE.JUPYTER_NEW_KERNELS_API_USAGE",void 0,{extensionId:this.extensionId,pemUsed:"getKernel",accessAllowed:n}),n}async*executeCode(t,n){await this.checkAccess();for await(let i of this.executeCodeInternal(t,void 0,n))yield i}async*executeChatCode(t,n,i){if(await this.checkAccess(),!["ms-vscode.dscopilot-agent",Ge].includes(this.extensionId.toLowerCase()))throw new Error(`Proposed API is not supported for extension ${this.extensionId}`);if(!qt(this.kernel.kernelConnectionMetadata))throw new Error("Chat code execution is only supported for Python kernels");for await(let s of this.executeCodeInternal(t,n,i))yield s}async*executeCodeInternal(t,n={},i){var m;let o=!1,s={executionCount:this.execution.executionCount,requestSentAfter:0,requestAcknowledgedAfter:0,cancelledAfter:0,duration:0},a={kernelId:"",extensionId:this.extensionId,cancelled:!1,requestSent:!1,requestAcknowledged:!1,cancelledBeforeRequestSent:!1,cancelledBeforeRequestAcknowledged:!1,mimeTypes:"",failed:!1},l=new It,c=new Set;if(Ebe(this.extensionId,this.kernel,"executeCode",s.executionCount).catch(y),this.kernel.disposed)throw a.failed=!0,bV(this.kernel,s,a).catch(y),new Error("Kernel is disposed");if(!((m=this.kernel.session)!=null&&m.kernel))throw a.failed=!0,bV(this.kernel,s,a).catch(y),this.kernel.status==="dead"||this.kernel.status==="terminating"?new Error("Kernel is dead or terminating"):new Error("Kernel connection not available to execute 3rd party code");let d=[];d.push({dispose:()=>{s.duration=l.elapsedTime,a.mimeTypes=Array.from(c).join(","),o=!0,bV(this.kernel,s,a).catch(y)}});let p=rt.instance.get(He).getKernelExecution(this.kernel),f={started:new zn.EventEmitter,executionAcknowledged:new zn.EventEmitter};f.started.event(()=>{a.requestSent=!0,s.requestSentAfter=l.elapsedTime,!i.isCancellationRequested&&this.extensionId!==Ge&&d.push(this.progress.show())},this,d),f.executionAcknowledged.event(()=>{a.requestAcknowledged=!0,s.requestAcknowledgedAfter=l.elapsedTime},this,d),i.onCancellationRequested(()=>{o||(a.cancelled=!0,s.cancelledAfter=l.elapsedTime,a.cancelledBeforeRequestSent=!a.requestSent,a.cancelledBeforeRequestAcknowledged=!a.requestAcknowledged,b.debug(`Code execution cancelled by extension ${this.extensionId}`))},this,d);try{for await(let g of p.executeCode(t,this.extensionId,f,i))if(UR(this.extensionId,this.kernel.session,g),g.items.forEach(h=>c.add(h.mime)),n&&$$(g))for await(let h of this.handleChatOutput(g,p,f,c,n,i))yield h;else yield g}finally{fe(d)}}async*handleChatOutput(t,n,i,o,s={},a){let l=t.items.find(v=>v.mime===FR);if(!l)return;let c=(t.metadata||{}).metadata,d=c.function,p=c.id,f=c.dataIsNone?void 0:new TextDecoder().decode(l.data),m=s[d];if(!m)throw new Error(`Chat Function ${d} not found`);let g=await m(f),h=F$(p,g);for await(let v of n.executeCode(h,this.extensionId,i,a))if(v.items.forEach(S=>o.add(S.mime)),$$(v))for await(let S of this.handleChatOutput(v,n,i,o,s,a))yield S;else yield v}};function $$(r){return r.items.some(e=>e.mime===FR)}async function Ebe(r,e,t,n){let i=await Nt(e.id);J("DATASCIENCE.JUPYTER_NEW_KERNEL_API_USAGE",{executionCount:n},{kernelId:i,pemUsed:t,extensionId:r})}async function bV(r,e,t){t.kernelId=await Nt(r.id),J("DATASCIENCE.JUPYTER_NEW_KERNEL_API_EXEC",e,t)}function JR(r,e){var i;let t=rt.instance.get(He),n=(i=rt.instance.get(Tt).getSelected(e.notebook))==null?void 0:i.controller;return _V.createApiKernel(r,e,t.getKernelExecution(e),n)}var z$=new WeakMap;function X$(r){return{async getKernel(e){let t,n=rt.instance.get(He),i=Q$.workspace.notebookDocuments.find(l=>l.uri.toString()===e.toString()),o=n.get(i||e);if(!o||!o.startedAtLeastOnce){J("DATASCIENCE.JUPYTER_NEW_KERNELS_API_USAGE",void 0,{extensionId:r,pemUsed:"getKernel",accessAllowed:t});return}let s=n.getKernelExecution(o);if(!Mt(o.kernelConnectionMetadata)&&s.executionCount===0){J("DATASCIENCE.JUPYTER_NEW_KERNELS_API_USAGE",void 0,{extensionId:r,pemUsed:"getKernel",accessAllowed:t});return}let a=z$.get(o)||JR(r,o);return z$.set(o,a),a}}}u();u();var qR=Symbol("JupyterServerHelper"),rGe=Symbol("INotebookImporter"),CI=Symbol("INotebookExporter"),Z$=Symbol("IJupyterInterpreterDependencyManager"),nGe=Symbol("INbConvertInterpreterDependencyChecker"),iGe=Symbol("INbConvertExportToPythonService"),GR=Symbol("IJupyterServerProvider"),fr=Symbol("IJupyterServerUriStorage"),YR=Symbol("IJupyterKernelService"),$R=Symbol("IJupyterRequestAgentCreator"),Bh=Symbol("IJupyterRequestCreator"),oGe=Symbol("INotebookStarter"),Hh=Symbol("ILiveRemoteKernelConnectionUsageTracker"),zR=Symbol("IJupyterRemoteCachedKernelValidator"),lr=Symbol("IJupyterServerProviderRegistry");function QR(r,e,t,n,i){J("DATASCIENCE.JUPYTER_API_USAGE",void 0,{clientExtId:n,pemUsed:"createJupyterServerCollection"});let s=i.get(lr).createJupyterServerCollection(n,r,jv(e),t);return{dispose:()=>{s==null||s.dispose()},get id(){return r},set label(l){s.label=jv(l)},get label(){return s.label},set documentation(l){s.documentation=l},get documentation(){return s.documentation},set commandProvider(l){s.commandProvider=l},get commandProvider(){return s.commandProvider}}}u();var ez=!1;function tz(r,e){if(ez)return;ez=!0,e.get(uy).setApi(r)}u();var Gf=require("vscode");u();var wI=$(te());u();var Xc=$(te());u();var Hf=class extends it{constructor(t,n){super("remotejupyterserveruriprovider",n.message||n.toString());this.serverProviderHandle=t;this.originalError=n}};u();var Ks=class extends it{constructor(e){super("jupyterselfcert",e)}static isSelfCertsError(e){return e.message.indexOf("reason: self signed certificate")>=0}};u();var zc=class extends it{constructor(e){super("jupyterselfexpiredcert",e)}static isSelfCertsExpiredError(e){return e.message.indexOf("reason: certificate has expired")>=0}};u();var Cn=Symbol("IDataScienceErrorHandler"),_i=class extends it{constructor(t,n,i){super(t,n);this.kernelConnectionMetadata=i}},Qc=class extends Xn{constructor(t,n,i){super(t,n);this.kernelConnectionMetadata=i}};u();var co=class extends it{constructor(t,n,i){super("remotejupyterserverconnection",C.remoteJupyterConnectionFailedWithServerWithError(rz(t),i.message||i.toString()));this.url=t;this.serverProviderHandle=n;this.originalError=i;this.baseUrl=rz(t)}};function rz(r){let e=new URL(r);return`${e.protocol}//${e.host}/`}var Fx=require("vscode");u();var nz=require("vscode");var Jf=class r extends ic{constructor(t){super();this.serverSettings=t;this._isDisposing=!1;this.kernelSpecManager=new this.jupyterlab.KernelSpecManager({serverSettings:this.serverSettings}),this.kernelManager=new this.jupyterlab.KernelManager({serverSettings:this.serverSettings}),this.sessionManager=new this.jupyterlab.SessionManager({serverSettings:this.serverSettings,kernelManager:this.kernelManager}),this.contentsManager=new this.jupyterlab.ContentsManager({serverSettings:this.serverSettings})}get jupyterlab(){return this._jupyterlab||(this._jupyterlab=oi()),this._jupyterlab}static create(t){return new r(t)}dispose(){this.isDisposed||this._isDisposing||(this._isDisposing=!0,(async()=>{var t,n,i,o;b.trace("Disposing Jupyter Lab Helper");try{this.contentsManager&&(b.trace("SessionManager - dispose contents manager"),this.contentsManager.dispose()),this.sessionManager&&!this.sessionManager.isDisposed&&(b.trace("ShutdownSessionAndConnection - dispose session manager"),await ho(1e4,this.sessionManager.ready),this.sessionManager.dispose()),(t=this.kernelManager)!=null&&t.isDisposed||(n=this.kernelManager)==null||n.dispose(),(i=this.kernelSpecManager)!=null&&i.isDisposed||(o=this.kernelSpecManager)==null||o.dispose()}catch(s){b.error("Exception on Jupyter Lab Helper shutdown: ",s)}finally{b.trace("Finished disposing Jupyter Lab Helper")}})().catch(y).finally(()=>super.dispose()))}async getRunningSessions(){if(!this.sessionManager)return[];await ho(1e4,this.sessionManager.ready).catch(y),await this.sessionManager.refreshRunning();let t=[],n=this.sessionManager.running(),i=n.next();for(;i;)t.push(i),i=n.next();return t}async getRunningKernels(){let t=await this.jupyterlab.KernelAPI.listRunning(this.serverSettings),n=new Set;return t.map(i=>{let o=i;return{id:i.id,name:i.name,lastActivityTime:o.last_activity?new Date(Date.parse(o.last_activity.toString())):new Date,numberOfConnections:o.connections?parseInt(o.connections.toString(),10):0}}).filter(i=>n.has(i.id)?!1:(n.add(i.id),!0))}async getKernelSpecs(){var t,n,i;if(!this.serverSettings||!this.sessionManager||!this.contentsManager)throw new tn;try{let o=new It,s=this.kernelSpecManager;if(!s)return b.error(`No SessionManager to enumerate kernelspecs (no specs manager). Returning a default kernel. Specs ${JSON.stringify(((n=(t=this.kernelSpecManager)==null?void 0:t.specs)==null?void 0:n.kernelspecs)||{})}.`),J("DATASCIENCE.JUPYTER_KERNEL_SPEC_FETCH_FAILURE",void 0,{failed:!0,reason:"NoSpecsManager"}),[await Mx()];let a={wasSessionManagerReady:this.sessionManager.isReady,wasSpecsManagerReady:s.isReady,sessionManagerReady:this.sessionManager.isReady,specsManagerReady:s.isReady,waitedForChangeEvent:!1},l=(f={})=>s.specs&&Object.keys(s.specs.kernelspecs).length?s.specs.kernelspecs:f,c=l();await ho(1e4,this.sessionManager.ready),a.sessionManagerReady=this.sessionManager.isReady,await ho(1e4,s.refreshSpecs()),a.specsManagerReady=s.isReady;let d=!1;if(s&&Object.keys(((i=s.specs)==null?void 0:i.kernelspecs)||{}).length===0){let f=[],m=Te(),g=m.resolve.bind(m);s.specsChanged.connect(g),f.push(new nz.Disposable(()=>s.specsChanged.disconnect(g)));let h=Promise.all([m.promise,s.ready,s.refreshSpecs(),this.sessionManager.ready]);await ho(1e4,h),a.waitedForChangeEvent=!0,m.completed||(d=!0,J("DATASCIENCE.JUPYTER_KERNEL_SPEC_FETCH_FAILURE",void 0,{failed:!0,sessionManagerReady:this.sessionManager.isReady,specsManagerReady:s.isReady,reason:s.isReady?this.sessionManager.isReady?"SpecsDidNotChangeInTime":"SessionManagerIsNotReady":"SpecManagerIsNotReady"})),fe(f)}let p=l(c);if(Object.keys(p||{}).length){let f=[];return Object.entries(p).forEach(([m,g])=>{g&&f.push(new yI(g))}),J("DATASCIENCE.JUPYTER_KERNEL_SPEC_FETCH_FAILURE",{duration:o.elapsedTime},a),f}else return b.error(`Jupyter Lab Helper cannot enumerate kernelspecs. Returning a default kernel. Specs ${JSON.stringify(p)}.`),d||J("DATASCIENCE.JUPYTER_KERNEL_SPEC_FETCH_FAILURE",void 0,{failed:!0,reason:"NoSpecsEventAfterRefresh"}),[await Mx()]}catch(o){return b.error("Jupyter Lab Helper:getKernelSpecs failure: ",o),[]}}};var gn=class{constructor(e,t,n,i,o){this.jupyterPickerRegistration=e;this.configService=t;this.errorHandler=n;this.requestAgentCreator=i;this.requestCreator=o}async createConnectionInfo(e){let t=await this.getJupyterServerUri(e);if(!t)throw new Error(`Unable to get resolved server information for ${e.extensionId}:${e.id}:${e.handle}`);let n={baseUrl:t.connectionInformation.baseUrl.toString(!0),displayName:t.label,token:t.connectionInformation.token||"",authorizationHeader:t.connectionInformation.headers||{},fetch:t.connectionInformation.fetch,mappedRemoteNotebookDir:void 0,WebSocket:t.connectionInformation.WebSocket};return uV(e,n,this.requestCreator,this.requestAgentCreator,this.configService,Fx.Uri.file(""))}async validateRemoteUri(e,t,n){let i;if(!t){let s=await this.getJupyterServerUri(e);if(s)t={baseUrl:s.connectionInformation.baseUrl.toString(!0),displayName:s.label,token:s.connectionInformation.token||"",authorizationHeader:s.connectionInformation.headers||{},fetch:s.connectionInformation.fetch,mappedRemoteNotebookDir:void 0,WebSocket:s.connectionInformation.WebSocket};else throw new Error(`Unable to get resolved server information for ${e.extensionId}:${e.id}:${e.handle}`)}let o=uV(e,t,this.requestCreator,this.requestAgentCreator,this.configService,Fx.Uri.file(""));try{i=Jf.create(o.settings),await Promise.all([i.getRunningKernels(),i.getKernelSpecs()])}catch(s){if(Ks.isSelfCertsError(s)){if(!await DR(this.configService,s.message))throw s}else if(zc.isSelfCertsExpiredError(s)){if(!await PR(this.configService,s.message))throw s}else throw t&&!n&&await this.errorHandler.handleError(new co(t.baseUrl,e,s)),s}finally{o.dispose(),i&&i.dispose()}}async getJupyterServerUri(e){let t=new Fx.CancellationTokenSource;try{let n=this.jupyterPickerRegistration.jupyterCollections.find(l=>l.extensionId===e.extensionId&&l.id===e.id)||await this.jupyterPickerRegistration.activateThirdPartyExtensionAndFindCollection(e.extensionId,e.id);if(!n)return;let i=await Promise.resolve(n.serverProvider.provideJupyterServers(t.token)),o=i==null?void 0:i.find(l=>l.id===e.handle);if(!o&&(i==null?void 0:i.length)===0)try{o=await n.serverProvider.resolveJupyterServer({id:e.handle,label:""},t.token)}catch(l){}if(!o)return;if(o.connectionInformation)return o;let s=await Promise.resolve(n.serverProvider.resolveJupyterServer(o,t.token));if(!(s!=null&&s.connectionInformation))return;let a=Object.assign({},o);return a.connectionInformation=s.connectionInformation,a}catch(n){throw n instanceof it?n:new Hf(e,n)}finally{t.dispose()}}};gn=E([(0,Xc.injectable)(),I(0,(0,Xc.inject)(lr)),I(1,(0,Xc.inject)(Ae)),I(2,(0,Xc.inject)(Cn)),I(3,(0,Xc.inject)($R)),I(3,(0,Xc.optional)()),I(4,(0,Xc.inject)(Bh))],gn);var Fl=class{constructor(e,t,n){this.serverUriStorage=e;this.jupyterConnection=t;this.serverProviderRegistry=n}async addJupyterServer(e){if(e.extensionId.toLowerCase()!=Zl.toLowerCase())throw new Error("Deprecated API");try{await this.jupyterConnection.validateRemoteUri(e)}catch(t){b.error(`Error in validating the Remote Uri ${e.id}.${e.handle}`,t);return}this.serverProviderRegistry.jupyterCollections.some(t=>t.extensionId===e.extensionId)||await this.serverUriStorage.add(e)}};Fl=E([(0,wI.injectable)(),I(0,(0,wI.inject)(fr)),I(1,(0,wI.inject)(gn)),I(2,(0,wI.inject)(lr))],Fl);u();var oz=$(te()),Zc=require("vscode");u();var qf=require("vscode");function Ei(r,e=!1){return typeof r!="object"||!r?!1:!!(r instanceof qf.CancellationError||e&&(r.message.includes("Canceled")||r.message.includes(Fe.canceled)))}async function Fs(r,e,...t){let n;return XD(e)?(t.push(e),n=void 0):n=e,r?r.isCancellationRequested?n:new Promise((i,o)=>{if(r.isCancellationRequested)return i(n);let s=r.onCancellationRequested(()=>{s.dispose(),i(n)});Promise.race(t).then(i,o).finally(()=>s.dispose())}):await Promise.race(t)}async function ds(r,...e){if(!r)return Promise.race(e);if(r.isCancellationRequested)throw new qf.CancellationError;return new Promise((t,n)=>{if(r.isCancellationRequested)return n(new qf.CancellationError);let i=r.onCancellationRequested(()=>{i.dispose(),n(new qf.CancellationError)});Promise.race(e).then(t,n).finally(()=>i.dispose())})}function iz(...r){let e=new qf.CancellationTokenSource,t=[];for(let i of r)i&&(i.isCancellationRequested&&e.cancel(),i.onCancellationRequested(()=>e.cancel(),void 0,t));let n=e.dispose.bind(e);return e.dispose=()=>{n(),fe(t)},e}var Od;(e=>{function r(t){if(t!=null&&t.isCancellationRequested)throw new qf.CancellationError}e.throwIfCanceled=r})(Od||(Od={}));function sz(r){let e=new Map,t=(a,l)=>{if(!e.has(a)){let c={id:a,label:l.displayName,connectionInformation:{baseUrl:Zc.Uri.parse(l.baseUrl),token:l.token,fetch:l.fetch,headers:l.authorizationHeader,WebSocket:l.WebSocket}};e.set(a,{serverUri:l,server:c})}return e.get(a).server},n=new Zc.EventEmitter,i={async provideJupyterServers(a){let l=r.getHandles?await ds(a,r.getHandles()):[];return!l||l.length===0?[]:ds(a,Promise.all(l.map(c=>r.getServerUri(c).then(d=>t(c,d)))))},resolveJupyterServer(a,l){return a},onDidChangeServers:n.event};if(!r.handleQuickPick||!r.getQuickPickEntryItems)return{serverProvider:i};let o=new Map;return{serverProvider:i,commandProvider:{async handleCommand(a,l){let c=o.get(a.label);if(!c||!r.handleQuickPick)return;let d=await ds(l,r.handleQuickPick(c,!0));if(d==="back")return;if(!d)throw new Zc.CancellationError;let p=await r.getServerUri(d);return t(d,p)},async provideCommands(a,l){return r.getQuickPickEntryItems?(await ds(l,Promise.resolve(r.getQuickPickEntryItems()))).map(d=>{let p={label:jv(d.label),canBeAutoSelected:d.default,description:jv(d.description)};return o.set(p.label,d),p}):[]}}}}var EV=class extends ic{constructor(t,n,i,o){super();this.extensionId=t;this.id=n;this.label=i;this.serverProvider=o;this._onDidChangeProvider=new Zc.EventEmitter;this.onDidChangeProvider=this._onDidChangeProvider.event}set commandProvider(t){this._commandProvider=t,this._onDidChangeProvider.fire()}get commandProvider(){return this._commandProvider}},xI=class extends Fr{constructor(){super();this._onDidChangeCollections=new Zc.EventEmitter;this._collections=new Map;rt.instance.get(ie).push(this)}get onDidChangeCollections(){return this._onDidChangeCollections.event}get jupyterCollections(){return Array.from(this._collections.values())}async activateThirdPartyExtensionAndFindCollection(t,n){return await this.loadExtension(t,n).catch(y),this.jupyterCollections.find(i=>i.extensionId===t&&i.id===n)}async loadExtension(t,n){if(t===Ge)return;let i=Zc.extensions.getExtension(t);if(!i)throw new Error(`Extension '${t}' that provides Jupyter Server '${n}' not found`);i.isActive||await i.activate().then(y,y)}createJupyterServerCollection(t,n,i,o){let s=`${t}#${n}`;if(this._collections.has(s)&&t!==Ge)throw new Error(`Jupyter Server Provider with id ${s} already exists`);let a=new EV(t,n,i,o);return this._collections.set(s,a),this._onDidChangeCollections.fire({added:[a],removed:[]}),this._register(a.onDidDispose(()=>{this._collections.delete(s),this._onDidChangeCollections.fire({removed:[a],added:[]})},this)),a}};xI=E([(0,oz.injectable)()],xI);u();var XR=Symbol("IExportedKernelServiceFactory");function Cbe(r,e){return new Promise(t=>{e.onDidChange(n=>{for(let i of n.added)Mt(i.connection)&&i.connection.serverProviderHandle.id===r.id&&i.connection.serverProviderHandle.handle===r.handle&&t()})})}function az(r,e){let t=e.get(Ba),n=r.id.startsWith("_builtin")?Ge:t.determineExtensionFromCallStack().extensionId;if(b.error(`The API registerRemoteServerProvider has being deprecated and will be removed soon, please use createJupyterServerCollection (extension ${n}).`),n.toLowerCase()!=Zl.toLowerCase())throw new Error("Deprecated API");J("DATASCIENCE.JUPYTER_API_USAGE",void 0,{clientExtId:n,pemUsed:"registerRemoteServerProvider"});let{serverProvider:i,commandProvider:o}=sz(r),s=QR(r.id,r.displayName||r.detail||r.id,i,n,e);return o&&(s.commandProvider=o),{dispose:()=>{s.dispose()}}}function lz(r){return r.then(()=>void 0).catch(e=>(b.error("Failure during activation.",e),Promise.reject(e)))}function cz(r){let e=r.get(Ba);return J("DATASCIENCE.JUPYTER_API_USAGE",void 0,{clientExtId:e.determineExtensionFromCallStack().extensionId,pemUsed:"registerRemoteServerProvider"}),r.get(XR).getService()}async function uz(r,e,t){let n=t.get(Ba);b.error("The API addRemoteJupyterServer has being deprecated and will be removed soon, please use createJupyterServerCollection.");let i=n.determineExtensionFromCallStack().extensionId;if(i.toLowerCase()!=Zl.toLowerCase())throw new Error("Deprecated API");J("DATASCIENCE.JUPYTER_API_USAGE",void 0,{clientExtId:i,pemUsed:"addRemoteJupyterServer"});let o=t.get(Fl),s=t.get(Tt),a=Cbe({id:r,handle:e},s);await o.addJupyterServer({id:r,handle:e,extensionId:i}),await a}async function dz(r,e,t){var c,d,p,f,m,g;let n=t.get(Ba);J("DATASCIENCE.JUPYTER_API_USAGE",void 0,{clientExtId:n.determineExtensionFromCallStack().extensionId,pemUsed:"openNotebook"});let i=t.get(Tt),o=typeof e=="string"?e:void 0,s=typeof e=="string"?void 0:e,a=o&&((c=i.all.find(h=>h.id===e))==null?void 0:c.id);if(!a&&s&&!dp()&&(a=(d=i.all.find(h=>h.kind==="startUsingPythonInterpreter"&&h.interpreter.id===s.id))==null?void 0:d.id,!a)){let v=await t.get(HR).getKernelConnection(s);a=v&&((p=i.all.find(S=>S.id===(v==null?void 0:v.id)))==null?void 0:p.id)}if(!a)throw new Error(`Kernel ${e} not found.`);let l=((g=(m=(f=Gf.window.activeNotebookEditor)==null?void 0:f.notebook)==null?void 0:m.uri)==null?void 0:g.toString())===r.toString()?Gf.window.activeNotebookEditor:await Gf.window.showNotebookDocument(await Gf.workspace.openNotebookDocument(r));return await Gf.commands.executeCommand("notebook.selectKernel",{notebookEditor:l,id:a,extension:Ge}),l.notebook}function pz(r,e,t,n){let i=t.get(Ba),o={ready:lz(r),registerPythonApi:s=>tz(s,t),registerRemoteServerProvider:s=>az(s,t),getKernelService:()=>cz(t),addRemoteJupyterServer:(s,a)=>uz(s,a,t),openNotebook:async(s,a)=>dz(s,a,t),createJupyterServerCollection:(s,a,l)=>QR(s,a,l,i.determineExtensionFromCallStack().extensionId,t),get kernels(){return X$(i.determineExtensionFromCallStack().extensionId)}};return(vn()||n.extensionMode===CV.ExtensionMode.Development||n.extensionMode===CV.ExtensionMode.Test)&&(o.serviceContainer=t,o.serviceManager=e),o}u();var fz=require("vscode"),mz={codeLoadingTime:0,endActivateTime:0,startActivateTime:0,totalActivateTime:0,workspaceFolderCount:0};function gz(r,e){if(!vn())try{r.endActivateTime=e.elapsedTime,r.totalActivateTime=e.elapsedTime,Object.assign(mz,r),vz(r),J("EXTENSION.LOAD",r)}catch(t){b.error("sendStartupTelemetry() failed.",t)}}function hz(r,e,t){try{let n={};e.endActivateTime=t.elapsedTime,e.totalActivateTime=t.elapsedTime,Object.assign(mz,e),vz(e),J("EXTENSION.LOAD",e,n,r)}catch(n){b.error("sendErrorTelemetry() failed.",n)}}function vz(r){var t,n;let e=(n=(t=fz.workspace.workspaceFolders)==null?void 0:t.length)!=null?n:0;r.workspaceFolderCount=e}u();u();var ZR=Symbol("IWorkspaceService"),uo=Symbol("IDebugManager"),DI=Symbol("IApplicationEnvironment"),d$e=Symbol("IWebviewPanelMessageListener"),p$e=Symbol("IWebviewViewMessageListener"),f$e=Symbol("IWebview"),m$e=Symbol("IWebviewView"),g$e=Symbol("IWebviewPanel"),PI=Symbol("IWebviewPanelProvider"),e1=Symbol("IWebviewViewProvider"),Ux=Symbol("IEncryptedStorage");u();var yz=$(te());u();var Ci=require("vscode");u();var Ld=require("vscode");var Jh=class Jh{constructor(e){this.jupyterConfig=e}async migrateSettings(){let e=[];for(let t of Object.keys(Jh.migratedSettings))e.push(...this.migrateSetting(t,Jh.migratedSettings[t]));e.push(this.migrateIntellisenseSettings());try{await Promise.all(e)}catch(t){TI(t)}}async migrateIntellisenseSettings(){let e="pythonCompletionTriggerCharacters",t="completionTriggerCharacters",n=this.jupyterConfig.inspect(e),i=this.jupyterConfig.inspect(t);try{if((n==null?void 0:n.globalValue)===(n==null?void 0:n.defaultValue)||!i||i!=null&&i.globalValue&&i.globalValue[Je])return;if(typeof(n==null?void 0:n.globalValue)=="string"){let o=i.globalValue||i.defaultValue||{};o[Je]=n.globalValue.split(""),await this.jupyterConfig.update(t,o,Ld.ConfigurationTarget.Global).then(y,TI)}}finally{n!=null&&n.globalValue&&await this.jupyterConfig.update(e,void 0,Ld.ConfigurationTarget.Global).then(y,TI)}}migrateSetting(e,t){let n=this.jupyterConfig.inspect(e),i=this.jupyterConfig.inspect(t),o=[];if((n==null?void 0:n.workspaceValue)!==void 0){let s=Promise.resolve();(i==null?void 0:i.workspaceValue)===void 0&&(s=this.jupyterConfig.update(t,n.workspaceValue,Ld.ConfigurationTarget.Workspace)),o.push(s.then(()=>this.jupyterConfig.update(e,void 0,Ld.ConfigurationTarget.Workspace),TI))}if((n==null?void 0:n.workspaceFolderValue)!==void 0){let s=Promise.resolve();(i==null?void 0:i.workspaceFolderValue)===void 0&&(s=this.jupyterConfig.update(t,n.workspaceFolderValue,Ld.ConfigurationTarget.WorkspaceFolder)),o.push(s.then(()=>this.jupyterConfig.update(e,void 0,Ld.ConfigurationTarget.WorkspaceFolder),TI))}if((n==null?void 0:n.globalValue)!==void 0){let s=Promise.resolve();(i==null?void 0:i.globalValue)===void 0&&(s=this.jupyterConfig.update(t,n.globalValue,Ld.ConfigurationTarget.Global)),o.push(s.then(()=>this.jupyterConfig.update(e,void 0,Ld.ConfigurationTarget.Global),TI))}return o}};Jh.migratedSettings={interactiveWindowMode:"interactiveWindow.creationMode",interactiveWindowViewColumn:"interactiveWindow.viewColumn",splitRunFileIntoCells:"interactiveWindow.splitRunFileIntoCells",sendSelectionToInteractiveWindow:"interactiveWindow.textEditor.executeSelection",normalizeSelectionForInteractiveWindow:"interactiveWindow.textEditor.normalizeSelection",magicCommandsAsComments:"interactiveWindow.textEditor.magicCommandsAsComments",enableAutoMoveToNextCell:"interactiveWindow.textEditor.autoMoveToNextCell",newCellOnRunLast:"interactiveWindow.textEditor.autoAddNewCell",pythonCellFolding:"interactiveWindow.textEditor.cellFolding",enableCellCodeLens:"interactiveWindow.codeLens.enable",addGotoCodeLenses:"interactiveWindow.codeLens.enableGotoCell",codeLenses:"interactiveWindow.codeLens.commands",debugCodeLenses:"interactiveWindow.codeLes.debugCommands",codeRegularExpression:"interactiveWindow.cellMarker.codeRegex",markdownRegularExpression:"interactiveWindow.cellMarker.markdownRegex",decorateCells:"interactiveWindow.cellMarker.decorateCells",defaultCellMarker:"interactiveWindow.cellMarker.default",enableExtendedKernelCompletions:"enableExtendedPythonKernelCompletions"},Jh.fullSettingIds={...Jh.migratedSettings};var Wx=Jh;function TI(r){b.warn("Error migrating Jupyter configuration",r)}u();function wbe(r){return(e,t,n)=>{let i=null,o=null;if(typeof n.value=="function"?(i="value",o=n.value):typeof n.get=="function"&&(i="get",o=n.get),!o)throw new Error("not supported");n[i]=r(o,t)}}function t1(r,e,t){return wbe((n,i)=>{let o=`$debounce$${i}`,s=`$debounce$result$${i}`;return function(...a){this[s]||(this[s]=t?t():void 0),clearTimeout(this[o]),e&&(this[s]=e(this[s],...a),a=[this[s]]),this[o]=setTimeout(()=>{n.apply(this,a),this[s]=t?t():void 0},r)}})}var Da=class Da{constructor(e,t,n){this._systemVariablesCtor=t;this._type=n;this.allowUnauthorizedRemoteConnection=!1;this.jupyterInterruptTimeout=1e4;this.jupyterLaunchTimeout=6e4;this.jupyterLaunchRetries=3;this.notebookFileRoot="";this.useDefaultConfigForJupyter=!1;this.sendSelectionToInteractiveWindow=!1;this.normalizeSelectionForInteractiveWindow=!0;this.splitRunFileIntoCells=!0;this.markdownRegularExpression="";this.codeRegularExpression="";this.errorBackgroundColor="";this.variableExplorerExclude="";this.decorateCells="currentCell";this.enableCellCodeLens=!1;this.askForLargeDataFrames=!1;this.enableAutoMoveToNextCell=!1;this.askForKernelRestart=!1;this.codeLenses="";this.debugCodeLenses="";this.debugpyDistPath="";this.stopOnFirstLineWhileDebugging=!1;this.magicCommandsAsComments=!1;this.pythonExportMethod="direct";this.stopOnError=!1;this.addGotoCodeLenses=!1;this.runStartupCommands=[];this.debugJustMyCode=!1;this.defaultCellMarker="";this.themeMatplotlibPlots=!1;this.disableJupyterAutoStart=!1;this.enablePythonKernelLogging=!1;this.jupyterCommandLineArguments=[];this.widgetScriptSources=[];this.interactiveWindowMode="multiple";this.pythonCellFolding=!0;this.interactiveWindowViewColumn="secondGroup";this.disableZMQSupport=!1;this.forceIPyKernelDebugger=!1;this.verboseLogging=!1;this.showVariableViewWhenDebugging=!0;this.newCellOnRunLast=!0;this.logKernelOutputSeparately=!1;this.development=!1;this.poetryPath="";this.excludeUserSitePackages=!1;this.enableExtendedPythonKernelCompletions=!1;this.formatStackTraces=!1;this._changeEmitter=new Ci.EventEmitter;this._disposables=[];this._workspaceRoot=e,this.initialize(),Ci.workspace.isTrusted===!1&&(this.disableJupyterAutoStart=!0)}get onDidChange(){return this._changeEmitter.event}static getInstance(e,t,n){let i=Da.getSettingsUriAndTarget(e).uri,o=i?i.path:"",s=Da.jupyterSettings.get(o);return s?s._type==="web"&&n==="node"&&(s._systemVariablesCtor=t,s._type=n):(s=new Da(i,t,n),Da.jupyterSettings.set(o,s)),s}static getSettingsUriAndTarget(e){let t=e?Ci.workspace.getWorkspaceFolder(e):void 0,n=t?t.uri:void 0;!n&&Array.isArray(Ci.workspace.workspaceFolders)&&Ci.workspace.workspaceFolders.length>0&&(n=Ci.workspace.workspaceFolders[0].uri);let i=n?Ci.ConfigurationTarget.WorkspaceFolder:Ci.ConfigurationTarget.Global;return{uri:n,target:i}}static dispose(){if(!vn())throw new Error("Dispose can only be called from unit tests");Da.jupyterSettings.forEach(e=>e&&e.dispose()),Da.jupyterSettings.clear()}dispose(){this._disposables.forEach(e=>e&&e.dispose()),this._disposables=[]}createSystemVariables(e){return new this._systemVariablesCtor(e,this._workspaceRoot)}toJSON(){let e={};return this.getSerializableKeys().forEach(n=>e[n]=this[n]),e}update(e,t){let n=this.createSystemVariables(void 0),i=n.resolveAny(e.get("experiments"));this.experiments?Object.assign(this.experiments,i):this.experiments=i,this.experiments=this.experiments?this.experiments:{enabled:!0,optInto:[],optOutFrom:[]};let o=(a,l)=>{let c=Wx.fullSettingIds[a],d=c&&l.get(c)!==void 0?l.get(c):l.get(a),p=n.resolveAny(d);p!==void 0&&(this[a]=p)};this.getSerializableKeys().filter(a=>a!=="experiments"&&a!=="logging"&&a!=="kernelPickerType").forEach(a=>o(a,e)),t&&o("poetryPath",t)}onWorkspaceFoldersChanged(){let e=(Ci.workspace.workspaceFolders||[]).map(i=>i.uri.path),n=Array.from(Da.jupyterSettings.keys()).filter(i=>e.indexOf(i)<0);if(n.length>0)for(let i of n)Da.jupyterSettings.delete(i)}initialize(){let e=()=>{let i=Ci.workspace.getConfiguration("jupyter",this._workspaceRoot),o=Ci.workspace.getConfiguration("python",this._workspaceRoot);this.update(i,o),this.debounceChangeNotification()};this._disposables.push(Ci.workspace.onDidChangeWorkspaceFolders(this.onWorkspaceFoldersChanged,this)),this._disposables.push(Ci.workspace.onDidChangeConfiguration(i=>{i.affectsConfiguration("jupyter")&&e(),i.affectsConfiguration("python.poetryPath")&&e()}));let t=Ci.workspace.getConfiguration("jupyter",this._workspaceRoot),n=Ci.workspace.getConfiguration("python",this._workspaceRoot);t&&(this.update(t,n),this.migrateSettings(t).catch(y))}async migrateSettings(e){await new Wx(e).migrateSettings()}debounceChangeNotification(){this._changeEmitter.fire()}fireChangeNotification(){this._changeEmitter.fire()}getSerializableKeys(){return Object.getOwnPropertyNames(this).filter(e=>!e.startsWith("_"))}};Da.jupyterSettings=new Map,E([t1(1)],Da.prototype,"debounceChangeNotification",1);var kI=Da;u();var eu=require("vscode");u();u();var wV={number:"number",string:"string",undefined:"undefined",object:"object",function:"function"};function xV(r){return Array.isArray?Array.isArray(r):!!(r&&typeof r.length===wV.number&&r.constructor===Array)}function r1(r){return typeof r===wV.string||r instanceof String}function DV(r){return typeof r===wV.object&&r!==null&&!Array.isArray(r)&&!(r instanceof RegExp)&&!(r instanceof Date)}var n1=class{resolve(e){return r1(e)?this.__resolveString(e):xV(e)?this.__resolveArray(e):DV(e)?this.__resolveLiteral(e):e}resolveAny(e){return r1(e)?this.__resolveString(e):xV(e)?this.__resolveAnyArray(e):DV(e)?this.__resolveAnyLiteral(e):e}__resolveString(e){let t=/\$\{(.*?)\}/g;return e.replace(t,(n,i)=>{let o=this[i];return r1(o)?o:n&&(n.indexOf("env.")>0||n.indexOf("env:")>0)?"":n})}__resolveLiteral(e){let t=Object.create(null);return Object.keys(e).forEach(n=>{let i=e[n];t[n]=this.resolve(i)}),t}__resolveAnyLiteral(e){let t=Object.create(null);return Object.keys(e).forEach(n=>{let i=e[n];t[n]=this.resolveAny(i)}),t}__resolveArray(e){return e.map(t=>this.__resolveString(t))}__resolveAnyArray(e){return e.map(t=>this.resolveAny(t))}};var i1=class extends n1{constructor(t,n){super();let i=t?eu.workspace.getWorkspaceFolder(t):void 0;this._workspaceFolder=i?i.uri.path:n||"",this._filePath=t?t.path:void 0,eu.window.activeTextEditor&&(this._lineNumber=eu.window.activeTextEditor.selection.anchor.line+1,this._selectedText=eu.window.activeTextEditor.document.getText(new eu.Range(eu.window.activeTextEditor.selection.start,eu.window.activeTextEditor.selection.end)))}get cwd(){return this.workspaceFolder}get workspaceRoot(){return this._workspaceFolder}get workspaceFolder(){return this._workspaceFolder}get file(){return this._filePath}get lineNumber(){return this._lineNumber}get selectedText(){return this._selectedText}};u();var tu=require("vscode");var o1=class{async updateSectionSetting(e,t,n,i,o){let a={uri:i,target:o||tu.ConfigurationTarget.WorkspaceFolder};e==="jupyter"&&o!==tu.ConfigurationTarget.Global&&(a=kI.getSettingsUriAndTarget(i));let l=tu.workspace.getConfiguration(e,a.uri),c=l.inspect(t);c!==void 0&&(o===tu.ConfigurationTarget.Global&&c.globalValue===n||o===tu.ConfigurationTarget.Workspace&&c.workspaceValue===n||o===tu.ConfigurationTarget.WorkspaceFolder&&c.workspaceFolderValue===n)||(await l.update(t,n,o),o&&await this.verifySetting(l,o,t,n))}async updateSetting(e,t,n,i){return this.updateSectionSetting("jupyter",e,t,n,i)}async verifySetting(e,t,n,i){if(vn()&&!PE()){let o=0;do{let s=e.inspect(n);if(!s&&i===void 0||s&&i!==void 0&&(t===tu.ConfigurationTarget.Global?s.globalValue:t===tu.ConfigurationTarget.Workspace?s.workspaceValue:s.workspaceFolderValue)===i)break;await new Promise(a=>setTimeout(a,250)),o+=1}while(o<20)}}};var NI=class extends o1{getSettings(e){return kI.getInstance(e,i1,"web")}};NI=E([(0,yz.injectable)()],NI);u();function bz(r){r.addSingleton(uy,sI),r.addSingleton(Io,kf)}u();u();var Qf=$(te()),Kz=require("vscode"),Vx=$(Lz());u();var v1=class{setSharedProperty(e,t){Jb(e,t)}postEvent(e,t){let n={};t.forEach((i,o)=>{n[o]=i}),J(e,void 0,n)}};u();var BV=$(require("vscode")),y1=$(te());var OI=class{constructor(e){this.extensionContext=e}get extensionVersion(){return this.extensionContext.extension.packageJSON.version}};OI=E([(0,y1.injectable)(),I(0,(0,y1.inject)(ot))],OI);function Kd(){return BV.env.appName.indexOf("Insider")>0||BV.env.appName.indexOf("Code - OSS Dev")>=0?"insiders":"stable"}var Gbe="VSCode.ABExp.FeatureData",HV="vscode",LI=class{constructor(e,t,n){this.configurationService=e;this.appEnvironment=t;this.globalState=n;this._optInto=[];this._optOutFrom=[];this.settings=e.getSettings(void 0);let i=this.settings.experiments.optInto,o=this.settings.experiments.optOutFrom;if(this._optInto=i.filter(l=>!l.endsWith("control")),this._optOutFrom=o.filter(l=>!l.endsWith("control")),!this.enabled)return;let s;Kd()==="insiders"?s=Vx.TargetPopulation.Insiders:s=Vx.TargetPopulation.Public;let a=new v1;this.experimentationService=(0,Vx.getExperimentationService)(Ge,this.appEnvironment.extensionVersion,s,a,this.globalState)}get enabled(){return this.settings.experiments.enabled&&!this.settings.experiments.optOutFrom.includes("All")}async activate(){this.experimentationService&&this.enabled&&(await this.experimentationService.initializePromise,this.getFeatures().length===0&&await this.experimentationService.initialFetch,this.logExperiments())}inExperiment(e){return!this.experimentationService||!this.enabled||this._optOutFrom.includes(e.toString())?!1:this._optInto.includes(e.toString())||this._optInto.includes("All")?(this.experimentationService.getTreatmentVariable(HV,e),!0):e==="DoNotWaitForZmqPortsToBeUsed"&&(Kd()==="insiders"||Mv())||e==="DataViewerContribution"&&(Kd()==="insiders"||Mv())?!0:this.experimentationService.getTreatmentVariable(HV,e)===!0}async getExperimentValue(e){if(!(!this.experimentationService||!this.enabled||this._optOutFrom.includes(e)))return this.experimentationService.getTreatmentVariable(HV,e)}getFeatures(){return this.globalState.get(Gbe,{features:[]}).features}logExperiments(){let e=Kz.workspace.getConfiguration("telemetry"),t=!1;if(e&&e.get("enableTelemetry")===!1&&(b.info("Telemetry is disabled"),t=!0),e&&e.get("telemetryLevel")==="off"&&(b.info("Telemetry level is off"),t=!0),t&&b.info("Experiments are disabled, only manually opted experiments are active."),this._optOutFrom.includes("All"))return;if(this._optInto.includes("All")){b.info(wp.inGroup("All"));return}let n=new Set(this._optInto),i=new Set;this._optOutFrom.filter(o=>o!=="All").forEach(o=>{b.info(wp.notInGroup(o))}),this._optInto.filter(o=>o!=="All").forEach(o=>{i.add(o),b.info(wp.inGroup(o))}),t&&!i.has("DoNotWaitForZmqPortsToBeUsed")&&(Kd()==="insiders"||Mv())&&b.info(wp.inGroup("DoNotWaitForZmqPortsToBeUsed")),t||this.getFeatures().forEach(o=>{o.toLowerCase().startsWith("jupyter")&&!this._optOutFrom.includes(o)&&!this._optInto.includes(o)&&(n.add(o),b.info(wp.inGroup(o)))})}};LI=E([(0,Qf.injectable)(),I(0,(0,Qf.inject)(Ae)),I(1,(0,Qf.inject)(DI)),I(2,(0,Qf.inject)(St)),I(2,(0,Qf.named)(ir))],LI);u();var I1=$(te()),Us=require("vscode");u();var b1=require("vscode");function KI(r){b1.env.openExternal(typeof r=="string"?b1.Uri.parse(r):r).then(y,y)}var Ybe=[{doNotDisplayPromptStateKey:"SHOW_DEPRECATED_FEATURE_PROMPT_FORMAT_ON_SAVE",message:iy.SHOW_DEPRECATED_FEATURE_PROMPT_FORMAT_ON_SAVE,moreInfoUrl:"https://github.com/Microsoft/vscode-python/issues/309",setting:{setting:"formatting.formatOnSave",values:["true",!0]}},{doNotDisplayPromptStateKey:"SHOW_DEPRECATED_FEATURE_PROMPT_LINT_ON_TEXT_CHANGE",message:iy.SHOW_DEPRECATED_FEATURE_PROMPT_LINT_ON_TEXT_CHANGE,moreInfoUrl:"https://github.com/Microsoft/vscode-python/issues/313",setting:{setting:"linting.lintOnTextChange",values:["true",!0]}},{doNotDisplayPromptStateKey:"SHOW_DEPRECATED_FEATURE_PROMPT_FOR_AUTO_COMPLETE_PRELOAD_MODULES",message:iy.SHOW_DEPRECATED_FEATURE_PROMPT_FOR_AUTO_COMPLETE_PRELOAD_MODULES,moreInfoUrl:"https://github.com/Microsoft/vscode-python/issues/1704",setting:{setting:"autoComplete.preloadModules"}}],FI=class{constructor(e){this.persistentStateFactory=e;this._onDidChangeFeatures=new Us.EventEmitter;this.onDidChangeFeatures=this._onDidChangeFeatures.event;this._features={};this.disposables=[];this._updateFeatures(),this.disposables.push(Us.workspace.onDidChangeConfiguration(()=>{this._updateFeatures()}))}get features(){return this._features}set features(e){this._features=e,this._onDidChangeFeatures.fire()}_updateFeatures(){this.features={}}dispose(){this.disposables.forEach(e=>e.dispose())}initialize(){Ybe.forEach(this.registerDeprecation.bind(this))}registerDeprecation(e){Array.isArray(e.commands)&&e.commands.forEach(t=>{this.disposables.push(Us.commands.registerCommand(t,()=>this.notifyDeprecation(e),this))}),e.setting&&this.checkAndNotifyDeprecatedSetting(e)}async notifyDeprecation(e){let t=this.persistentStateFactory.createGlobalPersistentState(e.doNotDisplayPromptStateKey,!0);if(!t.value)return;let n="Learn more",i="Never show again",o=await Us.window.showInformationMessage(e.message,n,i);if(o)switch(o){case n:{KI(e.moreInfoUrl);break}case i:{await t.updateValue(!1);break}default:throw new Error("Selected option not supported.")}}checkAndNotifyDeprecatedSetting(e){let t=!1;Array.isArray(Us.workspace.workspaceFolders)&&Us.workspace.workspaceFolders.length>0?Us.workspace.workspaceFolders.forEach(n=>{t||(t=this.isDeprecatedSettingAndValueUsed(Us.workspace.getConfiguration("jupyter",n.uri),e.setting))}):t=this.isDeprecatedSettingAndValueUsed(Us.workspace.getConfiguration("jupyter"),e.setting),t&&this.notifyDeprecation(e).catch(n=>b.debug("Jupyter Extension: notifyDeprecation",n))}isDeprecatedSettingAndValueUsed(e,t){if(!e.has(t.setting))return!1;let n=e.get(t.setting);return!Array.isArray(t.values)||t.values.length===0?Array.isArray(n)?n.length>0:!0:!Array.isArray(t.values)||t.values.length===0?n===void 0?!1:Array.isArray(n)?n.length>0:!0:t.values.indexOf(e.get(t.setting))>=0}};FI=E([(0,I1.injectable)(),I(0,(0,I1.inject)(rT))],FI);u();var Xf=$(te());var S1=class{constructor(e,t,n,i){this.storage=e;this.key=t;this.defaultValue=n;this.expiryDurationMs=i}get value(){if(this.expiryDurationMs){let e=this.storage.get(this.key,{data:this.defaultValue});return!e||!e.expiry||e.expiry<Date.now()?this.defaultValue:e.data}else return this.storage.get(this.key,this.defaultValue)}async updateValue(e){this.expiryDurationMs?await this.storage.update(this.key,{data:e,expiry:Date.now()+this.expiryDurationMs}):await this.storage.update(this.key,e)}},UI=class{constructor(e,t){this.globalState=e;this.workspaceState=t}createGlobalPersistentState(e,t,n){return new S1(this.globalState,e,t,n)}createWorkspacePersistentState(e,t,n){return new S1(this.workspaceState,e,t,n)}};UI=E([(0,Xf.injectable)(),I(0,(0,Xf.inject)(St)),I(0,(0,Xf.named)(ir)),I(1,(0,Xf.inject)(St)),I(1,(0,Xf.named)(Es))],UI);u();u();var Fz=$(te());var WI=class{constructor(){this.osType="Unknown"}get tempDir(){}get homeDir(){}get pathVariableName(){return""}get isWindows(){return this.osType==="Windows"}get isMac(){return this.osType==="OSX"}get isLinux(){return this.osType==="Linux"}};WI=E([(0,Fz.injectable)()],WI);u();var ps=Symbol("IPlatformService"),wt=Symbol("IFileSystem");function Uz(r){r.addSingleton(ps,WI)}u();var Wz=$(te()),qV=require("vscode");var VI=class{determineExtensionFromCallStack(e){if(e=e||new Error().stack,e){let t=qV.extensions.getExtension(Ge).extensionUri.toString().toLowerCase(),n=e.split(`
`).map(i=>{let o=/\((.*)\)/.exec(i);if(o)return o[1]}).filter(i=>i&&i.toLowerCase().startsWith("http")).filter(i=>i&&!i.toLowerCase().startsWith(t));kL(new Error("Ex")).forEach(i=>{let o=i.getFileName();o&&!o.toLowerCase().startsWith(t)&&n.push(o)});for(let i of n){let o=qV.extensions.all.find(s=>s.id!==Ge&&i.startsWith(s.extensionUri.toString()));if(o)return{extensionId:o.id,displayName:o.packageJSON.displayName}}b.error("Unable to determine the caller of the extension API for trace stack.",e)}return{extensionId:QD,displayName:C.unknownPackage}}};VI=E([(0,Wz.injectable)()],VI);u();var _1=$(te()),GV=require("vscode");var jI=class{constructor(e){this.extensionContext=e;this.testingState=new Map}async store(e,t,n){if(ji&&this.extensionContext.extensionMode!==GV.ExtensionMode.Production){this.testingState.set(`${e}#${t}`,n||"");return}if(n)await this.extensionContext.secrets.store(`${e}.${t}`,n);else try{await this.extensionContext.secrets.delete(`${e}.${t}`)}catch(i){b.error(i)}}async retrieve(e,t){if(ji&&this.extensionContext.extensionMode!==GV.ExtensionMode.Production)return this.testingState.get(`${e}#${t}`);try{return await this.extensionContext.secrets.get(`${e}.${t}`)}catch(n){try{await this.extensionContext.secrets.delete(`${e}.${t}`);return}catch(i){b.error(i)}}}};jI=E([(0,_1.injectable)(),I(0,(0,_1.inject)(ot))],jI);u();var Vz=$(te());var BI=class{constructor(){this._list=[]}async dispose(){let e=this._list.map(t=>t.dispose());await Promise.all(e),this._list=[]}push(e){e&&this._list.push(e)}get list(){return this._list}};BI=E([(0,Vz.injectable)()],BI);u();var jz=$(te()),nu=require("vscode");var Zf=class Zf extends Error{};Zf.back=new Zf("back"),Zf.cancel=new Zf("cancel"),Zf.resume=new Zf("resume");var Ye=Zf,jx=class{constructor(){this.steps=[]}run(e,t){return this.stepThrough(e,t)}async showQuickPick(e){return this.showLazyLoadQuickPick(e).selection}showLazyLoadQuickPick({title:e,step:t,totalSteps:n,items:i,activeItem:o,placeholder:s,buttons:a,shouldResume:l,matchOnDescription:c,matchOnDetail:d,acceptFilterBoxTextAsSelection:p,startBusy:f,stopBusy:m,validate:g,onDidTriggerItemButton:h,onDidTriggerButton:v,supportBackInFirstStep:S,onDidChangeItems:_,ignoreFocusOut:D}){let P=[],M=Te(),x=nu.window.createQuickPick();return x.title=e,x.step=t,x.totalSteps=n,x.placeholder=s,x.ignoreFocusOut=D!=null?D:!0,x.items=i,m&&(x.busy=f!=null?f:!1,m(()=>{x.enabled&&(x.busy=!1)},this,P)),_&&(x.keepScrollPosition=!0,_(A=>{x.items=A},this,P)),h&&x.onDidTriggerItemButton(A=>h(A),void 0,P),x.matchOnDescription=c||!1,x.matchOnDetail=d||!1,o?x.activeItems=[o]:x.activeItems=[],x.buttons=[...this.steps.length>1||S?[nu.QuickInputButtons.Back]:[],...a||[]],P.push(x.onDidTriggerButton(A=>{A===nu.QuickInputButtons.Back?M.reject(Ye.back):v?v(A):M.resolve(A)}),x.onDidChangeSelection(async A=>{let j=A.length?A[0].label:"",re=!!j;if(j&&g&&A.length){x.enabled=!1,x.busy=!0;let R=await g(A[0]);R&&(re=!1,await nu.window.showErrorMessage(R,{modal:!0})),x.enabled=!0,x.busy=!1}re&&M.resolve(A[0])}),x.onDidHide(()=>{(async()=>{M.reject(l&&await l()?Ye.resume:Ye.cancel)})().catch(M.reject)})),p&&P.push(x.onDidAccept(async()=>{if(!x.busy){let A=g?await g(x):void 0;A?(x.enabled=!1,x.busy=!0,await nu.window.showErrorMessage(A),x.enabled=!0,x.busy=!1):M.resolve(x.value)}})),this.current&&this.current.dispose(),this.current=x,this.current.show(),M.promise.finally(()=>fe(P)).catch(y),{quickPick:x,selection:M.promise}}async showInputBox({title:e,step:t,totalSteps:n,value:i,prompt:o,validate:s,password:a,buttons:l,shouldResume:c,validationMessage:d}){let p=[];try{return await new Promise((f,m)=>{let g=nu.window.createInputBox();g.title=e,g.step=t,g.totalSteps=n,g.password=!!a,g.value=i||"",g.prompt=o,g.validationMessage=d||"",g.ignoreFocusOut=!0,g.validationMessage=d||"",g.buttons=[...this.steps.length>1?[nu.QuickInputButtons.Back]:[],...l||[]],p.push(g.onDidTriggerButton(h=>{h===nu.QuickInputButtons.Back?m(Ye.back):f(h)}),g.onDidAccept(async()=>{let h=g.value;g.enabled=!1,g.busy=!0;let v=await s(h);v?(g.validationMessage=v,g.show()):(g.validationMessage="",f(h)),g.enabled=!0,g.busy=!1}),g.onDidChangeValue(async()=>{g.validationMessage=""}),g.onDidHide(()=>{(async()=>{g.busy||m(c&&await c()?Ye.resume:Ye.cancel)})().catch(m)})),this.current&&this.current.dispose(),this.current=g,this.current.show()})}finally{p.forEach(f=>f.dispose())}}async stepThrough(e,t){let n=e;for(;n;){this.steps.push(n),this.current&&(this.current.enabled=!1,this.current.busy=!0);try{n=await n(this,t)}catch(i){if(i===Ye.back)this.steps.pop(),n=this.steps.pop();else if(i===Ye.resume)n=this.steps.pop();else if(i===Ye.cancel)n=void 0;else throw i;if(!n)return i}}this.current&&this.current.dispose()}},E1=Symbol("IMultiStepInputFactory"),HI=class{create(){return new jx}};HI=E([(0,jz.injectable)()],HI);u();var Bz=$(te()),Lo=require("vscode");var Fd=class{get activeDebugConsole(){return Lo.debug.activeDebugConsole}get activeDebugSession(){var e;return b.ci(`Getting active debug session, ${(e=Lo.debug.activeDebugSession)==null?void 0:e.name}`),Lo.debug.activeDebugSession}get breakpoints(){return Lo.debug.breakpoints}get onDidChangeActiveDebugSession(){return Lo.debug.onDidChangeActiveDebugSession}get onDidStartDebugSession(){return Lo.debug.onDidStartDebugSession}get onDidReceiveDebugSessionCustomEvent(){return Lo.debug.onDidReceiveDebugSessionCustomEvent}get onDidTerminateDebugSession(){return Lo.debug.onDidTerminateDebugSession}get onDidChangeBreakpoints(){return Lo.debug.onDidChangeBreakpoints}registerDebugConfigurationProvider(e,t){return Lo.debug.registerDebugConfigurationProvider(e,t)}registerDebugAdapterTrackerFactory(e,t){return Lo.debug.registerDebugAdapterTrackerFactory(e,t)}startDebugging(e,t,n){return Lo.debug.startDebugging(e,t,n)}addBreakpoints(e){Lo.debug.addBreakpoints(e)}removeBreakpoints(e){Lo.debug.removeBreakpoints(e)}};Fd.instance=new Fd,Fd=E([(0,Bz.injectable)()],Fd);u();var Bx=$(te());var Jz=$(C1());var Hz="_VSCODE_getDataFrame",w1=Jz.default`
                            try:
                                del _VSCODE_getDataFrame
                            except:
                                pass
                            `,iu=class{constructor(e,t){this.fs=e;this.context=t}async generateCodeToGetDataFrameInfo(e){let t=await this.getContentsOfDataFrameScript(),n=e.isDebugging?"True":"False",i=`${Hz}("info", ${n}, ${e.variableName})`;return e.isDebugging?{initializeCode:t,code:i,cleanupCode:w1}:{code:`${t}

${i}

${w1}`}}async generateCodeToGetDataFrameRows(e){let t=await this.getContentsOfDataFrameScript(),n=e.isDebugging?"True":"False",i=`${Hz}("rows", ${n}, ${e.variableName}, ${e.startIndex}, ${e.endIndex})`;return e.isDebugging?{initializeCode:t,code:i,cleanupCode:w1}:{code:`${t}

${i}

${w1}`}}async getContentsOfDataFrameScript(){if(iu.contentsOfDataFrameScript)return iu.contentsOfDataFrameScript;let e=Hi(this.context.extensionUri,"pythonFiles","vscode_datascience_helpers","dataframes","vscodeDataFrame.py"),t=await this.fs.readFile(e);return iu.contentsOfDataFrameScript=t,t}};iu=E([(0,Bx.injectable)(),I(0,(0,Bx.inject)(wt)),I(1,(0,Bx.inject)(ot))],iu);u();var Hx=$(te());var zV=$(C1());var $V="_VSCODE_getVariable",JI=zV.default`
                            try:
                                del _VSCODE_getVariable
                            except:
                                pass
                            `,Ws=class{constructor(e,t){this.fs=e;this.context=t}async generateCodeToGetVariableInfo(e){let t=await this.getContentsOfScript(),n=e.isDebugging?"True":"False",i=`${$V}("info", ${n}, ${e.variableName})`;return e.isDebugging?{initializeCode:t,code:i,cleanupCode:JI}:{code:`${t}

${i}

${JI}`}}async generateCodeToGetVariableProperties(e){let t=await this.getContentsOfScript(),n=e.isDebugging?"True":"False",i=`${$V}("properties", ${n}, ${e.variableName}, ${e.stringifiedAttributeNameList})`;return e.isDebugging?{initializeCode:t,code:i,cleanupCode:JI}:{code:`${t}

${i}

${JI}`}}async generateCodeToGetAllVariableDescriptions(e){let t=await this.getContentsOfVariablesScript();return e?t=t+`

return _VSCODE_getAllChildrenDescriptions('${e.root}', ${JSON.stringify(e.propertyChain)}, ${e.startIndex})`:t=t+`

variables= %who_ls
return _VSCODE_getVariableDescriptions(variables)`,t}async generateCodeToGetVariableTypes(e){let n=`${await this.getContentsOfScript()}

_VSCODE_rwho_ls = %who_ls
`,i=e.isDebugging?"True":"False",o=zV.default`
        try:
            del _VSCODE_rwho_ls
        except:
            pass
        `,s=`${$V}("types", ${i}, _VSCODE_rwho_ls)`;return e.isDebugging?{initializeCode:n,code:s,cleanupCode:`${JI}
${o}`}:{code:`${n}${s}

${JI}
${o}`}}async generateCodeToGetVariableValueSummary(e){let t=await this.getContentsOfVariablesScript();return t=t+`

variables= %who_ls
return _VSCODE_getVariableSummary(${e})`,t}async getContentsOfScript(){if(Ws.contentsOfScript)return Ws.contentsOfScript;let e=Hi(this.context.extensionUri,"pythonFiles","vscode_datascience_helpers","getVariableInfo","vscodeGetVariableInfo.py"),t=await this.fs.readFile(e);return Ws.contentsOfScript=t,t}async getContentsOfVariablesScript(){if(Ws.contentsOfVariablesScript)return Ws.contentsOfVariablesScript;let e=Hi(this.context.extensionUri,"pythonFiles","vscode_datascience_helpers","getVariableInfo","vscodeGetVariablesForProvider.py"),t=await this.fs.readFile(e);return Ws.contentsOfVariablesScript=t,t}};Ws=E([(0,Hx.injectable)(),I(0,(0,Hx.inject)(wt)),I(1,(0,Hx.inject)(ot))],Ws);u();var x1=Symbol("IExtensionActivationManager"),Ue=Symbol("IExtensionSyncActivationService");u();var Jx=require("vscode");var ou=$(te());var qz=["currentServerHash","connectToLocalKernelsOnly","JUPYTER_LOCAL_KERNELSPECS","JUPYTER_LOCAL_KERNELSPECS_V1","JUPYTER_LOCAL_KERNELSPECS_V2","JUPYTER_LOCAL_KERNELSPECS_V3","JUPYTER_REMOTE_KERNELSPECS","JUPYTER_REMOTE_KERNELSPECS_V1","JUPYTER_REMOTE_KERNELSPECS_V2","JUPYTER_REMOTE_KERNELSPECS_V3","JUPYTER_LOCAL_KERNELSPECS_V4","JUPYTER_REMOTE_KERNELSPECS_V4-","LOCAL_KERNEL_SPECS_CACHE_KEY_V_2022_10","LOCAL_KERNEL_PYTHON_AND_RELATED_SPECS_CACHE_KEY_V_2022_10","user-jupyter-server-uri-list-v2","REGISTRATION_ID_EXTENSION_OWNER_MEMENTO_KEY","jupyter.jupyterServer.uriList"],qI=class{constructor(e,t,n,i){this.globalState=e;this.crypto=t;this.workspaceState=n;this.extensionContext=i}activate(){this.removeOldCachedItems().then(y,y)}async removeOldCachedItems(){await Promise.all([await this.getUriAccountKey()].concat(qz).filter(t=>this.globalState.get(t,void 0)!==void 0).map(t=>this.globalState.update(t,void 0).then(y,y)));let e=this.workspaceState.keys().filter(t=>t.startsWith("LAST_EXECUTED_CELL_")&&!t.startsWith("LAST_EXECUTED_CELL_V2_"));await Promise.all(e.map(t=>this.workspaceState.update(t,void 0))),await Promise.all(qz.map(t=>this.globalState.keys().filter(n=>n.startsWith(t)).map(n=>this.globalState.update(n,void 0).then(y,y))).flat()),await this.extensionContext.secrets.delete(`${pi.JupyterServerRemoteLaunchService}.remote-uri-list`).then(y,y)}async getUriAccountKey(){let e=tI();return e?this.crypto.createHash(at(e),"SHA-512"):Jx.workspace.workspaceFile?this.crypto.createHash(at(Jx.workspace.workspaceFile),"SHA-512"):Jx.env.machineId}};qI=E([(0,ou.injectable)(),I(0,(0,ou.inject)(St)),I(0,(0,ou.named)(ir)),I(1,(0,ou.inject)(oy)),I(2,(0,ou.inject)(St)),I(2,(0,ou.named)(Es)),I(3,(0,ou.inject)(ot))],qI);function Gz(r){r.addSingletonInstance(e7,!1),r.addSingleton(Sc,LI),r.addSingleton(nT,FI),r.addSingleton(rT,UI),r.addSingleton(Ba,VI),r.addSingleton(oy,ty),r.addSingleton(Ux,jI),r.addSingleton(uo,Fd),r.addSingleton(Ha,BI),r.addSingleton(E1,HI),r.addSingleton(ly,iu),r.addSingleton(ay,Ws),r.addSingleton(Ue,qI),Uz(r)}u();u();var D1=$(te()),Ud=require("vscode");var Wd=class{constructor(e){this.disposables=[];this._onDidChange=new Ud.EventEmitter;e.push(this),xn()||Ud.workspace.onDidChangeConfiguration(t=>{t.affectsConfiguration("jupyter.kernels.excludePythonEnvironments")&&this._onDidChange.fire()},this,this.disposables)}get onDidChange(){return this._onDidChange.event}dispose(){this._onDidChange.dispose(),fe(this.disposables)}isPythonEnvironmentExcluded(e){if(xn())return!1;let t=this.getExcludedPythonEnvironments(),n=zbe(e,t),i="uri"in e?e.uri:e.executable.uri;return n&&(J("DATASCIENCE.JUPYTER_KERNEL_HIDDEN_VIA_FILTER"),b.debug(`Python Env hidden via filter: ${ve(i)}`)),n}getExcludedPythonEnvironments(){if(!Ud.workspace.workspaceFolders||Ud.workspace.workspaceFolders.length===0)return Ud.workspace.getConfiguration("jupyter",void 0).get("kernels.excludePythonEnvironments",[]);let e=[];return Ud.workspace.workspaceFolders.forEach(t=>{e.push(...Ud.workspace.getConfiguration("jupyter",t.uri).get("kernels.excludePythonEnvironments",[]))}),e}};Wd=E([(0,D1.injectable)(),I(0,(0,D1.inject)(ie))],Wd);function zbe(r,e){var o;let t="uri"in r?r.envPath:(o=r.environment)==null?void 0:o.folderUri,n="uri"in r?r.uri:r.executable.uri;return!n&&!t?!1:e.some(s=>{let a=ve(s.trim()).toLowerCase().replace(/\\/g,"/");if(s=s.trim().toLowerCase().replace(/\\/g,"/"),s.length===0||a.length===0)return!1;let l=ve(n).toLowerCase().replace(/\\/g,"/"),c=n?n.fsPath.toLowerCase().replace(/\\/g,"/"):"";if(s===l||a===l||s===c||a===c)return!0;let d=ve(t||"").toLowerCase().replace(/\\/g,"/"),p=ve(t||"").toLowerCase().replace(/\\/g,"/");return s===d||a===d||s===p||a===p})}u();var Yz=$(te()),po=require("vscode");var GI=class{activate(){this.migrateFilters().catch(y)}async migrateFilters(){let e=Array.isArray(po.workspace.workspaceFolders)?po.workspace.workspaceFolders:[];await this.migrateWorkspaceFilters(po.workspace.getConfiguration("jupyter",void 0),po.ConfigurationTarget.Global),e.length===0?await this.migrateWorkspaceFilters(po.workspace.getConfiguration("jupyter",void 0),po.ConfigurationTarget.Global):e.length===1?await this.migrateWorkspaceFilters(po.workspace.getConfiguration("jupyter",e[0].uri),po.ConfigurationTarget.WorkspaceFolder):(await this.migrateWorkspaceFilters(po.workspace.getConfiguration("jupyter",void 0),po.ConfigurationTarget.Workspace),await Promise.all(e.map(t=>this.migrateWorkspaceFilters(po.workspace.getConfiguration("jupyter",t.uri),po.ConfigurationTarget.WorkspaceFolder))))}async migrateWorkspaceFilters(e,t){let n=e.inspect("kernels.filter"),i=[];switch(t){case po.ConfigurationTarget.Global:i=(n==null?void 0:n.globalValue)||[];break;case po.ConfigurationTarget.Workspace:i=(n==null?void 0:n.workspaceValue)||[];break;default:i=(n==null?void 0:n.workspaceFolderValue)||[]}let o=i.filter(s=>s.type==="pythonEnvironment").map(s=>s.path);i.length&&await e.update("kernels.filter",void 0,t),o.length&&await e.update("kernels.excludePythonEnvironments",Array.from(new Set(o)),t)}};GI=E([(0,Yz.injectable)()],GI);u();var P1=$(te());var QV=require("vscode");var YI=class{constructor(e){this.disposables=e}activate(){this.disposables.push(QV.commands.registerCommand("jupyter.filterKernels",()=>QV.commands.executeCommand("workbench.action.openSettings","jupyter.kernels.excludePythonEnvironments").then(y,y),this))}};YI=E([(0,P1.injectable)(),I(0,(0,P1.inject)(ie))],YI);function $z(r){r.addSingleton(Ue,GI),r.addSingleton(Ue,YI),r.addSingleton(Wd,Wd)}u();var eQ=$(te()),$I=require("vscode");u();var Qz=new Set;function Xz(r){Qz.add(r)}function zz(r){try{Qz.forEach(e=>e.report(r))}catch(e){b.error("Failed to report progress",e)}}function Zz(r){return function(e,t,n){let i=n.value;n.value=async function(...o){return zz({action:r,phase:"started"}),i.apply(this,o).finally(()=>{zz({action:r,phase:"completed"})})}}}u();u();var Xbe={JupyterSessionWaitForIdleSession:C.waitingForJupyterSessionToBeIdle,KernelsGetKernelForRemoteConnection:C.gettingListOfKernelsForRemoteConnection,KernelsGetKernelSpecs:C.gettingListOfKernelSpecs,KernelsRegisterKernel:C.registeringKernel,NotebookConnect:C.connectingToJupyter,NotebookStart:C.startingJupyterNotebook,InstallingMissingDependencies:C.installingMissingDependencies,ExportNotebookToPython:C.exportNotebookToPython,PerformingExport:C.performingExport};function T1(r){return Xbe[r]}var Ul=class{constructor(){this.progressReporters=[];this.actionPhases=new Map;this.currentActions=[];Xz(this)}get currentAction(){return this.currentActions.length===0?void 0:this.currentActions[this.currentActions.length-1]}createProgressIndicator(e,t=!1){let n=new $I.CancellationTokenSource,i=Te(),o={location:$I.ProgressLocation.Notification,cancellable:t,title:e};return $I.window.withProgress(o,async(s,a)=>{a.onCancellationRequested(()=>{a.isCancellationRequested&&n.cancel(),i.resolve()}),n.token.onCancellationRequested(()=>{i.resolve()}),this.progressReporters.push(s),await i.promise}).then(y,y),{token:n.token,dispose:()=>i.resolve()}}report(e){if(this.progressReporters.length!==0&&(this.actionPhases.set(e.action,e.phase),e.phase==="started"&&this.currentActions.push(e.action),!!this.currentAction)){for(;this.actionPhases.get(this.currentAction)&&this.actionPhases.get(this.currentAction)!=="started";)this.actionPhases.delete(this.currentAction),this.currentActions.pop();this.updateProgressMessage()}}updateProgressMessage(){if(!this.currentAction||this.progressReporters.length===0)return;let e=T1(this.currentAction);e&&this.progressReporters.forEach(t=>t.report({message:e}))}};Ul=E([(0,eQ.injectable)()],Ul);u();var tQ=$(te());var rQ=require("vscode");var zI=class extends T0{async computeWorkingDirectory(e){var t;if(e){let n=at(e);return n.includes(".")?at(qv(e)):n}return e=(e?(t=rQ.workspace.getWorkspaceFolder(e))==null?void 0:t.uri:void 0)||tI(),e?at(e):"."}};zI=E([(0,tQ.injectable)()],zI);u();var qh=$(te());var nQ=require("vscode");var QI=class{constructor(e,t){this.jupyterOutput=e;this.disposableRegistry=t}register(){this.disposableRegistry.push(nQ.commands.registerCommand(Q.ViewJupyterOutput,this.viewJupyterOutput,this))}viewJupyterOutput(){this.jupyterOutput.show(!0)}};QI=E([(0,qh.injectable)(),I(0,(0,qh.inject)(Lm)),I(0,(0,qh.named)(Lv)),I(1,(0,qh.inject)(ie))],QI);u();var uQ=$(te()),em=$(require("vscode"));u();var XI=$(require("vscode")),XV;(l=>{let r=XI.FileSystemError.FileNotFound().name,e=XI.FileSystemError.FileExists().name,t=XI.FileSystemError.FileIsADirectory().name,n=XI.FileSystemError.FileNotADirectory().name,i=XI.FileSystemError.NoPermissions().name,o=[r,e,t,n,i];function s(c,d){if(o.includes(c.name))return c.name===d}function a(c){return s(c,r)}l.isFileNotFound=a})(XV||(XV={}));function Zbe(r,e){let t=r.code;if(t)return t===e}function iQ(r){let e=XV.isFileNotFound(r);return e!==void 0?e:Zbe(r,"ENOENT")}u();var lQ=$(aQ()),cQ=require("vscode"),su=class{constructor(e=lQ.fetch){this.fetchImplementation=e;this.requestOptions={};let t=cQ.workspace.getConfiguration("http").get("proxy","");t&&(this.requestOptions={headers:{proxy:t}})}async downloadFile(e){return this.fetchImplementation(e,this.requestOptions)}async exists(e){try{return(await this.downloadFile(e)).status===200}catch(t){return b.debug(`HttpClient - Failure checking for file ${e}: ${t}`),!1}}};var eS=class{constructor(){this.vscfs=em.workspace.fs}arePathsSame(e,t){return ea(e,t)}async getFiles(e){return(await this.vscfs.readDirectory(e)).filter(n=>n[1]===em.FileType.File).map(n=>em.Uri.file(n[0]))}async copy(e,t,n){await this.vscfs.copy(e,t,n)}async createDirectory(e){await this.vscfs.createDirectory(e)}async delete(e){await this.vscfs.delete(e)}async readFile(e){let t=await this.vscfs.readFile(e);return new TextDecoder().decode(t)}async stat(e){return this.vscfs.stat(e)}async writeFile(e,t){return this.vscfs.writeFile(e,typeof t=="string"?new TextEncoder().encode(t):t)}async exists(e,t){if(e.scheme.toLowerCase()==="http"||e.scheme.toLowerCase()==="https")return new su().exists(e.toString());let n;try{n=await this.stat(e)}catch(i){return iQ(i)||b.error(`stat() failed for "${e}"`,i),!1}return t===void 0?!0:t===em.FileType.Unknown?n.type===em.FileType.Unknown:(n.type&t)===t}async getFileHash(e){let t=await this.stat(e),n=`${t.ctime}-${t.mtime}`;return ja(n,"SHA-512")}};eS=E([(0,uQ.injectable)()],eS);u();var N1=$(te()),au=require("vscode");var Wt=class{constructor(e){this.kernelResourceProgressReporter=new Map;e.push(this),Wt.instance=this}activate(){}dispose(){fe(Array.from(Wt.disposables))}static createProgressReporter(e,t,n){if(!Wt.instance)return new au.Disposable(y);let i=e?Fa(e):"";return Wt.instance.kernelResourceProgressReporter.has(i)?Wt.reportProgress(e,t):Wt.createProgressReporterInternal(i,t,n)}static wrapAndReportProgress(e,t,n){let i=e?Fa(e):"";if(!Wt.instance)return n();let o=Wt.reportProgressInternal(i,t);return n().finally(()=>o==null?void 0:o.dispose())}static reportProgress(e,t){let n=T1(t)||t,i=e?Fa(e):"";return n?Wt.reportProgressInternal(i,n||""):new au.Disposable(()=>y)}static reportProgressInternal(e,t){if(!Wt.instance)return new au.Disposable(y);let n=Wt.instance.kernelResourceProgressReporter.get(e);if(n||(n={title:t,pendingProgress:[],progressList:[],dispose:y},Wt.instance.kernelResourceProgressReporter.set(e,n)),n.reporter)n.progressList.push(t),n.reporter.report({message:t});else{if(n.progressList.includes(t))return new au.Disposable(y);n.pendingProgress.push(t)}return{dispose:()=>{try{if(!n)return;let i=n.progressList.findIndex(o=>o===t);if(i>=0&&n.progressList.splice(i),n.progressList.length>0){let o=n.progressList[n.progressList.length-1];n.reporter&&n.reporter.report({message:o===n.title&&n.reporter?"":o})}else Wt.instance.kernelResourceProgressReporter.delete(e),n.dispose()}catch(i){b.error(`Failed to dispose Progress reporter for ${e}`,i)}}}}static createProgressReporterInternal(e,t,n){let i=Te(),o=new au.Disposable(()=>i.resolve()),s=Wt.instance.kernelResourceProgressReporter.get(e)||{title:t,pendingProgress:[],progressList:[],tokenSources:[],dispose:()=>{o.dispose()}},a=!1,l=()=>{a||(a=!0,au.window.withProgress({location:au.ProgressLocation.Notification,title:t},async(c,d)=>{let p=Wt.instance.kernelResourceProgressReporter.get(e);if(p){for(p.reporter=c;p.pendingProgress.length>0;){let f=p.pendingProgress.shift();f===t?p.progressList.push(f):f!==t&&f&&(p.progressList.push(f),c.report({message:f}))}await Fs(d,i.promise),Wt.instance.kernelResourceProgressReporter.get(e)===p&&Wt.instance.kernelResourceProgressReporter.delete(e),Wt.disposables.delete(o)}}).then(y,y))};return Wt.instance.kernelResourceProgressReporter.set(e,{...s,dispose:()=>o.dispose(),show:l}),Wt.disposables.add(o),s.pendingProgress.push(t),n||l(),{dispose:()=>o.dispose(),show:l}}};Wt.disposables=new Set,Wt=E([(0,N1.injectable)(),I(0,(0,N1.inject)(ie))],Wt);u();var nS=$(te()),R1=require("vscode");u();var dQ=require("vscode");var tS=class{constructor(e,t,n,i=[]){this.fs=e;this.disposableRegistry=t;this.options=n;this.loadFailedEmitter=new dQ.EventEmitter;let o={enableScripts:!0,localResourceRoots:[this.options.rootPath,this.options.cwd,...i]};n.webviewHost?(this.webviewHost=n.webviewHost,this.webviewHost.webview.options=o):this.webviewHost=this.createWebview(o),this.loadPromise=this.load()}get loadFailed(){return this.loadFailedEmitter.event}asWebviewUri(e){var t;if(!((t=this.webviewHost)!=null&&t.webview))throw new Error("WebView not initialized, too early to get a Uri");return this.webviewHost.webview.asWebviewUri(e)}postMessage(e){var t,n;(t=this.webviewHost)!=null&&t.webview&&((n=this.webviewHost)==null||n.webview.postMessage(e))}async generateLocalReactHtml(){var o;if(!((o=this.webviewHost)!=null&&o.webview))throw new Error("WebView not initialized, too early to get a Uri");let e=this.webviewHost.webview.asWebviewUri(this.options.cwd).toString(),t=this.options.scripts.map(s=>this.webviewHost.webview.asWebviewUri(s)),n=this.webviewHost.webview.asWebviewUri(this.options.rootPath).toString(),i="false";return`<!doctype html>
        <html lang="en">
            <head>
                <meta charset="utf-8">
                <meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no">
                <meta http-equiv="Content-Security-Policy" content="img-src 'self' data: https: http: blob: ${this.webviewHost.webview.cspSource}; default-src 'unsafe-inline' 'unsafe-eval' data: https: http: blob: ${this.webviewHost.webview.cspSource};">
                <meta name="theme-color" content="#000000">
                <meta name="theme" content="${tt.GeneratedThemeName}"/>
                <title>VS Code Python React UI</title>
                <base href="${e}${e.endsWith("/")?"":"/"}"/>
                </head>
            <body>
                <noscript>You need to enable JavaScript to run this app.</noscript>
                <div id="root"></div>
                <script type="text/javascript">
                    // Public path that will be used by webpack.
                    window.__PVSC_Public_Path = "${n}/";
                    function resolvePath(relativePath) {
                        if (relativePath && relativePath[0] == '.' && relativePath[1] != '.') {
                            return "${e}" + relativePath.substring(1);
                        }

                        return "${e}" + relativePath;
                    }
                    function forceTestMiddleware() {
                        return ${i};
                    }
                <\/script>
                ${t.map(s=>`<script type="text/javascript" src="${s}"><\/script>`).join(`
`)}
            </body>
        </html>`}async load(){var e;try{(e=this.webviewHost)!=null&&e.webview&&((await Promise.all(this.options.scripts.map(n=>this.fs.exists(n)))).every(n=>n===!0)?(this.webviewHost.webview.html=await this.generateLocalReactHtml(),this.postLoad(this.webviewHost)):this.webviewHost.webview.html=C.badWebPanelFormatString(this.options.scripts.join(", ")))}catch(t){b.error(`Error Loading WebviewPanel: ${t}`),this.loadFailedEmitter.fire()}}};var ZV=class extends tS{get panel(){return this.webviewHost}get panelOptions(){return this.options}constructor(e,t,n,i=[]){super(e,t,n,i)}async show(e){await this.loadPromise,this.panel&&(e?this.panel.visible||this.panel.reveal(this.panel.viewColumn,e):this.panel.active||this.panel.reveal(this.panel.viewColumn,e))}close(){this.panel&&this.panel.dispose()}get viewColumn(){var e;return(e=this.panel)==null?void 0:e.viewColumn}isVisible(){return this.panel?this.panel.visible:!1}isActive(){return this.panel?this.panel.active:!1}setTitle(e){this.panelOptions.title=e,this.panel&&(this.panel.title=e)}createWebview(e){return R1.window.createWebviewPanel(this.panelOptions.title.toLowerCase().replace(" ",""),this.panelOptions.title,{viewColumn:this.panelOptions.viewColumn,preserveFocus:!0},{retainContextWhenHidden:!0,enableFindWidget:!0,...e})}postLoad(e){this.disposableRegistry.push(e.onDidDispose(()=>{this.webviewHost=void 0,this.panelOptions.listener.dispose()})),this.disposableRegistry.push(e.webview.onDidReceiveMessage(t=>{this.panelOptions.listener.onMessage(t.type,t.payload)})),this.disposableRegistry.push(e.onDidChangeViewState(t=>{this.panelOptions.listener.onChangeViewState(this)})),this.panelOptions.listener.onChangeViewState(this)}},rS=class{constructor(e,t,n){this.disposableRegistry=e;this.fs=t;this.context=n}async create(e){let t=[R1.Uri.file(AE(this.context.extensionPath,"temp"))];return Array.isArray(e.additionalPaths)&&t.push(...e.additionalPaths),new ZV(this.fs,this.disposableRegistry,e,t)}};rS=E([(0,nS.injectable)(),I(0,(0,nS.inject)(ie)),I(1,(0,nS.inject)(wt)),I(2,(0,nS.inject)(ot))],rS);u();var qx=$(te()),pQ=require("vscode");var ej=class extends tS{constructor(t,n,i,o=[]){super(t,n,i,o);this.panelOptions=i;this._onDidChangeVisibility=new pQ.EventEmitter}get visible(){return this.webviewHost?this.webviewHost.visible:!1}get onDidChangeVisibility(){return this._onDidChangeVisibility.event}createWebview(t){throw new Error("Webview Views must be passed in an initial view")}postLoad(t){this.disposableRegistry.push(t.onDidDispose(()=>{this.webviewHost=void 0,this.panelOptions.listener.dispose()})),this.disposableRegistry.push(t.webview.onDidReceiveMessage(n=>{this.panelOptions.listener.onMessage(n.type,n.payload)})),this.disposableRegistry.push(t.onDidChangeVisibility(()=>{this._onDidChangeVisibility.fire()})),this._onDidChangeVisibility.fire()}},iS=class{constructor(e,t){this.disposableRegistry=e;this.fs=t}async create(e){return new ej(this.fs,this.disposableRegistry,e)}};iS=E([(0,qx.injectable)(),I(0,(0,qx.inject)(ie)),I(1,(0,qx.inject)(wt))],iS);u();var oS=$(te());u();var Ett=Symbol("IReservedPythonNamedProvider"),Ctt=Symbol("IInterpreterPackages"),fQ=Symbol("IWorkspaceInterpreterTracker");var Wl=class{constructor(e){this.workspaceInterpreterTracker=e;Wl.isActiveWorkspaceInterpreter=this.isActiveWorkspaceInterpreterImpl.bind(this)}activate(){var e;(e=this.workspaceInterpreterTracker)==null||e.activate()}isActiveWorkspaceInterpreterImpl(e,t){var n,i;return(i=(n=this.workspaceInterpreterTracker)==null?void 0:n.isActiveWorkspaceInterpreter(e,t))!=null?i:!1}};Wl.isActiveWorkspaceInterpreter=()=>!1,Wl=E([(0,oS.injectable)(),I(0,(0,oS.inject)(fQ)),I(0,(0,oS.optional)())],Wl);function mQ(r){r.addSingleton(wt,eS),r.addSingleton(ZR,zI),r.addSingleton(DI,OI),r.addSingleton(Ae,NI),r.addSingleton(sy,QI),r.addSingleton(Ul,Ul),Gz(r),bz(r),$z(r),r.addSingleton(Ue,Wt),r.addSingleton(Ue,Wl),r.add(e1,iS),r.add(PI,rS)}u();u();var ztt=Symbol("IKernelLauncher"),jd=Symbol("IRawNotebookSupportedService"),gQ=Symbol("IRawKernelSessionFactory");u();var Gx=$(te()),tj=require("vscode");u();var A1=require("vscode");var Mr;(n=>{let r=Au(new A1.EventEmitter);n.onDidChangeNotebookCellExecutionState=r.event;function t(i,o,s){if(o!==1||!s){r.fire({cell:i,state:o});return}let a=Au(A1.workspace.onDidChangeNotebookDocument(l=>{var d,p;if(l.notebook!==i.notebook)return;let c=l.cellChanges.find(f=>f.cell===i);((p=(d=c==null?void 0:c.cell)==null?void 0:d.executionSummary)==null?void 0:p.executionOrder)===s&&(a.dispose(),r.fire({cell:i,state:1}))}))}n.changeCellState=t})(Mr||(Mr={}));var Gh=class{constructor(e,t){this.disposableRegistry=e;this.kernelProvider=t;this.lastExecutedCellPerKernel=new WeakMap;this.kernelsStartedSuccessfully=new WeakSet}activate(){this.kernelProvider.onKernelStatusChanged(this.onKernelStatusChanged,this,this.disposableRegistry),this.kernelProvider.onDidStartKernel(this.onDidStartKernel,this,this.disposableRegistry)}onDidStartKernel(e){this.kernelsStartedSuccessfully.add(e),Mr.onDidChangeNotebookCellExecutionState(t=>{t.cell.notebook===e.notebook&&this.kernelProvider.get(t.cell.notebook)===e&&this.lastExecutedCellPerKernel.set(e,t.cell)})}async onKernelStatusChanged({kernel:e}){this.kernelsStartedSuccessfully.has(e)&&(e.disposed||e.disposing||!e.session||(e.session.kind==="localRaw"&&e.status==="dead"&&(tj.window.showErrorMessage(C.kernelDiedWithoutError(ct(e.kernelConnectionMetadata))).then(y,y),await this.endCellAndDisplayErrorsInCell(e)),e.session.kind!=="localRaw"&&e.status==="autorestarting"&&(tj.window.showErrorMessage(C.kernelDiedWithoutErrorAndAutoRestarting(ct(e.kernelConnectionMetadata))).then(y,y),await this.endCellAndDisplayErrorsInCell(e))))}async endCellAndDisplayErrorsInCell(e){let t=this.lastExecutedCellPerKernel.get(e);if(Jr(e.resourceUri,"DATASCIENCE.KERNEL_CRASH"),!!t)return Vf(t,e.controller,C.kernelCrashedDueToCodeInCurrentOrPreviousCell,!1)}};E([yn()],Gh.prototype,"onKernelStatusChanged",1),Gh=E([(0,Gx.injectable)(),I(0,(0,Gx.inject)(ie)),I(1,(0,Gx.inject)(He))],Gh);u();u();var IQ=$(te());u();var Pa=$(te());u();var tm=class extends it{constructor(e){super("jupyterinstall",e)}};var Or=require("vscode");u();var M1=class extends _i{constructor(e){super("timeout",C.rawKernelStartFailedDueToTimeout(ct(e)),e)}};u();var sS=class extends Qc{constructor(t,n,i,o){super(t,i,o);this.stdErr=n}};u();var O1=class extends _i{constructor(e){super("timeout",C.rawKernelStartFailedDueToTimeoutWaitingForPort(ct(e)),e)}};u();var aS=class extends _i{constructor(t=-1,n,i){super("kerneldied",C.kernelDied(n.trim()),i);this.exitCode=t;this.stdErr=n}};u();u();var Krt=Symbol("IModuleInstaller"),Frt=Symbol("IPythonInstallation"),Urt=Symbol("IInstallationChannelManager"),Wrt=Symbol("IProductService"),Vrt=Symbol("IProductPathService");var jrt=Symbol("IInstaller");function rj(r){switch(r){case 18:return"jupyter";case 20:return"notebook";case 23:return"pandas";case 19:return"ipykernel";case 22:return"nbconvert";case 21:return"kernelspec";case 27:return"pip";case 28:return"ensurepip";default:throw new Error(`Product ${r} cannot be installed as a Python Module.`)}}u();var wi=new Map;wi.set(18,"jupyter");wi.set(20,"notebook");wi.set(19,"ipykernel");wi.set(22,"nbconvert");wi.set(21,"kernelspec");wi.set(23,"pandas");wi.set(27,"pip");wi.set(28,"ensurepip");u();var Yx=class extends _i{constructor(t,n){super("noipykernel",C.kernelInvalid(ct(n)),n);this.reason=t}};u();var rm=class extends Qc{constructor(e){super(C.kernelDiedWithoutError(ct(e)),void 0,e)}};u();var hQ=require("vscode"),vr=class{constructor(e){this._event=new hQ.EventEmitter;this._disableUI=e}get disableUI(){return this._disableUI}set disableUI(e){let t=this._disableUI!==e;this._disableUI=e,t&&this._event.fire()}get onDidChangeDisableUI(){return this._event.event}dispose(){this._event.dispose()}};u();var K1=class extends it{constructor(e){super("jupyterexpiredcert",e)}};u();var nm=class extends it{constructor(t){super("invalidremotejupyterserverurihandle","Server handle not in list of known handles");this.serverProviderHandle=t}};u();var im=Symbol("IInterpreterService");u();var F1=class extends it{constructor(t,n,i){super("windowsLongPathNotEnabled",i);this.product=t;this.interpreter=n;this.originalMessage=i}};u();var $x=class extends it{constructor(t,n,i){super("jupyternotebooknotinstalled",t+(n?`
${n}`:""));this.interpreter=i}};u();var vQ=new Map;function U1(r,e){vQ.set(Jt(r),e)}function lS(r,e,t){let n=e.jupyterCollections.find(i=>i.extensionId===r.extensionId&&i.id===r.id);return vQ.get(Jt(r))||(n==null?void 0:n.label)||t||`${r.id}:${r.handle}`}var uS=class{constructor(e,t,n,i,o,s,a){this.dependencyManager=e;this.configuration=t;this.kernelDependency=n;this.serverUriStorage=i;this.jupyterUriProviderRegistration=o;this.fs=s;this.interpreterService=a;this.handledErrors=new WeakSet;this.handledKernelErrors=new WeakSet}async handleError(e){var t;if(b.warn("DataScience Error",e),e=Xn.unwrap(e),!this.handledErrors.has(e)){if(this.handledErrors.add(e),e instanceof tm)await((t=this.dependencyManager)==null?void 0:t.installMissingDependencies(e));else if(e instanceof Ks)await DR(this.configuration,e.message);else if(e instanceof K1)await PR(this.configuration,e.message);else if(!Ei(e))if(e instanceof M1||e instanceof O1)Or.window.showErrorMessage(e.message).then(y,y);else if(e instanceof sS||e instanceof aS||e instanceof $x||e instanceof Pp)Or.window.showErrorMessage(cS(e)).then(y,y);else if(e instanceof co&&xn())Or.window.showErrorMessage(C.jupyterNotebookRemoteConnectFailedWeb(e.baseUrl)).then(y,y);else if(e instanceof co){let n=await this.handleJupyterServerConnectionError(e,void 0);Or.window.showErrorMessage(n).then(y,y)}else if(e instanceof Hf){let n=await this.handleJupyterServerUriProviderError(e,void 0);Or.window.showErrorMessage(n).then(y,y)}else{let n=bQ(e.message||e.toString());Or.window.showErrorMessage(n).then(y,y)}}}async getErrorMessageForDisplayInCell(e,t,n){var i;if(e=Xn.unwrap(e),Ei(e)||b.error("Error in execution (get message for cell)",e),e instanceof rm)return"";if(e instanceof Yx)return nj(e.kernelConnectionMetadata)||e.message;if(e instanceof tm)return rIe(e)||e.message;if(e instanceof co&&!xn())return e.message;if(e instanceof co&&xn())return C.jupyterNotebookRemoteConnectFailedWeb(e.baseUrl);if(Ei(e))return"";if(e instanceof F1){let o=typeof e.product=="string"?e.product:wi.get(e.product)||`${e.product}`,s=Lu(e.interpreter)||e.interpreter.id||"",a=zi(e.interpreter),l=ve(a==null?void 0:a.executable.uri),c=s?` ${s} (${l})`:l;return C.packageNotInstalledWindowsLongPathNotEnabledError(o,c)}else{if((e instanceof sS||e instanceof aS)&&(e.kernelConnectionMetadata.kind==="startUsingLocalKernelSpec"||e.kernelConnectionMetadata.kind==="startUsingPythonInterpreter")&&e.kernelConnectionMetadata.interpreter&&!await this.fs.exists(e.kernelConnectionMetadata.interpreter.uri))return C.failedToStartKernelDueToMissingPythonEnv(Lu(e.kernelConnectionMetadata.interpreter)||_s(e.kernelConnectionMetadata.interpreter)||ve(e.kernelConnectionMetadata.interpreter.uri));if((e instanceof sS||e instanceof aS)&&(e.kernelConnectionMetadata.kind==="startUsingLocalKernelSpec"||e.kernelConnectionMetadata.kind==="startUsingPythonInterpreter")&&e.kernelConnectionMetadata.interpreter&&this.kernelDependency&&!await this.kernelDependency.areDependenciesInstalled(e.kernelConnectionMetadata,void 0,!0))return nj(e.kernelConnectionMetadata)||e.message;if(e instanceof _i||e instanceof Qc){let[o,s]=await Promise.all([this.getFilesInWorkingDirectoryThatCouldPotentiallyOverridePythonModules(n),SL(e.kernelConnectionMetadata.interpreter)]),a=Km(Or.workspace.workspaceFolders||[],e,ct(e.kernelConnectionMetadata),s,o.map(l=>l.uri));if(a){if(a.reason==="moduleNotFound"&&["ipykernel_launcher","ipykernel"].includes(a.moduleName))return nj(e.kernelConnectionMetadata)||e.message;let l=[a.message];return a.moreInfoLink&&l.push(Fe.clickHereForMoreInfoWithHtml(a.moreInfoLink)),er(e.kernelConnectionMetadata)&&a.reason==="moduleNotFound"&&!["ipykernel_launcher","ipykernel"].includes(a.moduleName)&&await this.addErrorMessageIfPythonArePossiblyOverridingPythonModules(l,n),l.join(`
`)}}else{if(e instanceof co)return this.handleJupyterServerConnectionError(e,t);if(e instanceof Hf)return this.handleJupyterServerUriProviderError(e,t);if(e instanceof nm){let o=((i=Or.extensions.getExtension(e.serverProviderHandle.extensionId))==null?void 0:i.packageJSON.displayName)||e.serverProviderHandle.extensionId;return cS(C.remoteJupyterServerProvidedBy3rdPartyExtensionNoLongerValid(o),t)}}}return cS(e,t)}async handleJupyterServerUriProviderError(e,t){var o;let n=await lS(e.serverProviderHandle,this.jupyterUriProviderRegistration),i=((o=e.originalError)==null?void 0:o.message)||e.message;return cS(C.remoteJupyterConnectionFailedWithServerWithError(n,i),t)}async handleJupyterServerConnectionError(e,t){let n=await lS(e.serverProviderHandle,this.jupyterUriProviderRegistration,e.baseUrl),i=e.originalError.message||"";return cS(C.remoteJupyterConnectionFailedWithServerWithError(n,i),t)}async handleJupyterServerProviderConnectionError(e,t){let n=new Or.CancellationTokenSource;try{let i=await Promise.resolve(t.serverProvider.provideJupyterServers(n.token));return i&&(i.find(o=>o.id===e.handle)||await this.serverUriStorage.remove(e).catch(y)),!0}catch(i){return!1}finally{n.dispose()}}async handleKernelError(e,t,n,i,o){var s,a;if(Ei(e)||b.warn(`Kernel Error, context = ${t}`,e),e=Xn.unwrap(e),Ei(e))return this.sendKernelTelemetry(e,t,i,"cancelled"),1;if(e instanceof Yx)if(b.warn(`Jupyter Kernel Dependency Error, reason=${e.reason}`,e),this.sendKernelTelemetry(e,t,i,e.category),e.reason===4&&this.kernelDependency){let l=new Or.CancellationTokenSource;try{let c=o==="3rdPartyExtension";return this.kernelDependency.installMissingDependencies({resource:i,kernelConnection:n,ui:new vr(!1),token:l.token,ignoreCache:!0,cannotChangeKernels:c})}finally{l.dispose()}}else return e.reason;else{if((t==="start"||t==="restart")&&e instanceof tm)return this.sendKernelTelemetry(e,t,i,e.category),(this.dependencyManager?await this.dependencyManager.installMissingDependencies(e):2)===0?0:1;if(e instanceof co||e instanceof Hf||e instanceof nm){this.sendKernelTelemetry(e,t,i,e.category);let l=e instanceof nm?"":e instanceof co?e.originalError.message||"":((s=e.originalError)==null?void 0:s.message)||e.message,c=e.serverProviderHandle.extensionId,d=e.serverProviderHandle.id,p=this.jupyterUriProviderRegistration.jupyterCollections.find(S=>S.extensionId===c&&S.id==d);if(!p||await this.handleJupyterServerProviderConnectionError(e.serverProviderHandle,p))return 3;let f=e instanceof co?e.baseUrl:"",m=lS(e.serverProviderHandle,this.jupyterUriProviderRegistration,f),g=e instanceof nm?((a=Or.extensions.getExtension(e.serverProviderHandle.extensionId))==null?void 0:a.packageJSON.displayName)||e.serverProviderHandle.extensionId:"",h=o==="jupyterExtension"?[C.selectDifferentKernel]:[];switch(await Or.window.showErrorMessage(e instanceof nm?C.remoteJupyterServerProvidedBy3rdPartyExtensionNoLongerValid(g):C.remoteJupyterConnectionFailedWithServer(m),{detail:l,modal:!0},C.removeRemoteJupyterConnectionButtonText,C.changeRemoteJupyterConnectionButtonText,...h)){case C.removeRemoteJupyterConnectionButtonText:return await this.serverUriStorage.remove(e.serverProviderHandle).catch(y),1;case C.changeRemoteJupyterConnectionButtonText:return 1;case C.selectDifferentKernel:return 3}return 1}else if(e instanceof Ks){this.sendKernelTelemetry(e,t,i,e.category);let l=C.jupyterSelfCertEnable,c=C.jupyterSelfCertClose;return Or.window.showErrorMessage(C.jupyterSelfCertFail(e.message),l,c).then(d=>{d===l?(J("DATASCIENCE.SELFCERTSMESSAGEENABLED"),this.configuration.updateSetting("allowUnauthorizedRemoteConnection",!0,void 0,Or.ConfigurationTarget.Workspace).catch(y)):d===c&&J("DATASCIENCE.SELFCERTSMESSAGECLOSE")}).then(y,y),2}else{if((t==="start"||t==="restart")&&n.kind==="startUsingPythonInterpreter"&&this.interpreterService&&!await this.fs.exists(n.interpreter.uri))return this.sendKernelTelemetry(e,t,i,"pythonEnvironmentMissing"),Or.window.showErrorMessage(C.failedToStartKernelDueToMissingPythonEnv(Lu(n.interpreter)||_s(n.interpreter)||ve(n.interpreter.uri))).then(y,y),this.interpreterService.refreshInterpreters(!0).catch(y),2;if((t==="start"||t==="restart")&&this.kernelDependency&&!await this.kernelDependency.areDependenciesInstalled(n,void 0,!0)){this.sendKernelTelemetry(e,t,i,"noipykernel");let l=new Or.CancellationTokenSource;try{let c=o==="3rdPartyExtension";return this.kernelDependency.installMissingDependencies({resource:i,kernelConnection:n,ui:new vr(!1),token:l.token,ignoreCache:!0,cannotChangeKernels:c})}finally{l.dispose()}}else{let[l,c]=await Promise.all([this.getFilesInWorkingDirectoryThatCouldPotentiallyOverridePythonModules(i),SL(n.interpreter)]),d=Km(Or.workspace.workspaceFolders||[],e,ct(n),c,l.map(p=>p.uri));return this.sendKernelTelemetry(e,t,i,d==null?void 0:d.reason),d?this.showMessageWithMoreInfo(d.message,d==null?void 0:d.moreInfoLink).catch(y):this.showMessageWithMoreInfo(cS(e,t)).catch(y),2}}}}sendKernelTelemetry(e,t,n,i){this.handledKernelErrors.has(e)||(this.handledKernelErrors.add(e),t==="start"&&Jr(n,"DATASCIENCE.NOTEBOOK_START",void 0,{disableUI:!1,failureCategory:i},e))}async showMessageWithMoreInfo(e,t){e.includes(Q.ViewJupyterOutput)||(e=`${e} 
${C.viewJupyterLogForFurtherInfo}`);let n=t?[Fe.learnMore]:[];await Or.window.showErrorMessage(e,...n).then(i=>{i===Fe.learnMore&&t&&Or.env.openExternal(Or.Uri.parse(t))})}};uS=E([I(0,(0,Pa.inject)(Z$)),I(0,(0,Pa.optional)()),I(1,(0,Pa.inject)(Ae)),I(2,(0,Pa.inject)(hI)),I(2,(0,Pa.optional)()),I(3,(0,Pa.inject)(fr)),I(4,(0,Pa.inject)(lr)),I(5,(0,Pa.inject)(wt)),I(6,(0,Pa.inject)(im)),I(6,(0,Pa.optional)())],uS);var eIe={restart:C.failedToRestartKernel,start:C.failedToStartKernel,interrupt:C.failedToInterruptKernel,execution:""};function cS(r,e){r=typeof r=="string"?r:Xn.unwrap(r);let t=e?eIe[e]:"",n="";return r instanceof $x?n=C.jupyterNotebookNotInstalledOrNotFound(r.interpreter):r instanceof it?n=v7(r.stdErr)||r.stdErr||r.message:n=typeof r=="string"?r:r.message,bQ(t,n)}function tIe(r){var t,n;return((n=(t=new RegExp(/\[([^\[]+)\]\((.*)\)/).exec(r))==null?void 0:t.length)!=null?n:0)>0}function bQ(r="",e=""){r&&e.startsWith(r.substring(0,r.length-1))&&(r="");let t=[r,e].map(n=>n.trim()).filter(n=>n.length>0).join(` 
`);return!tIe(t)&&t.length&&t.indexOf("command:jupyter.viewOutput")===-1?`${t.endsWith(".")?t:t+"."} 
${C.viewJupyterLogForFurtherInfo}`:t}function nj(r){var a,l,c,d;if(r.kind==="connectToLiveRemoteKernel"||r.kind==="startUsingRemoteKernelSpec"||!r.interpreter)return;let e=Lu(r.interpreter)||at(r.interpreter.uri),t=wi.get(19),n=rj(19),i=`${kO(at(r.interpreter.uri))} -m pip install ${n} -U --force-reinstall`;if(r.interpreter&&zr(r.interpreter)==="Conda"){let p=zi(r.interpreter);(a=p==null?void 0:p.environment)!=null&&a.name?i=`conda install -n ${(l=p==null?void 0:p.environment)==null?void 0:l.name} ${n} --update-deps --force-reinstall`:(c=p==null?void 0:p.environment)!=null&&c.folderUri&&(i=`conda install -p ${at((d=p==null?void 0:p.environment)==null?void 0:d.folderUri)} ${n} --update-deps --force-reinstall`)}else r.interpreter&&zr(r.interpreter)==="Unknown"&&(i=`${kO(at(r.interpreter.uri))} -m pip install ${n} -U --user --force-reinstall`);let o=C.libraryRequiredToLaunchJupyterKernelNotInstalledInterpreter(e,wi.get(19)),s=C.installPackageInstructions(t,i);return o+`
`+s}function rIe(r){let e=`${wi.get(18)} ${Fe.and} ${wi.get(20)}`,t=[18,20].map(rj).join(" "),n=`python -m pip install ${t} -U
or
conda install ${t} -U`,i=C.installPackageInstructions(e,n);return r.message+`
`+i+`
`+Fe.clickHereForMoreInfoWithHtml("https://aka.ms/installJupyterForVSCode")}var dS=class extends uS{async addErrorMessageIfPythonArePossiblyOverridingPythonModules(e,t){}async getFilesInWorkingDirectoryThatCouldPotentiallyOverridePythonModules(e){return[]}};dS=E([(0,IQ.injectable)()],dS);u();var SQ=$(te());var Yh=class{async ensureKernelIsUsable(e,t,n,i,o){b.debug("Check if a kernel is usable")}};E([I(1,wL("id")),I(2,wL("disableUI")),I(3,XH())],Yh.prototype,"ensureKernelIsUsable",1),Yh=E([(0,SQ.injectable)()],Yh);u();var zx=$(te());var _Q=require("vscode");var pS=class{constructor(e,t){this.liveKernelConnectionTracker=e;this.providerRegistration=t}async isValid(e){if(!this.liveKernelConnectionTracker.wasKernelUsed(e))return!1;let t=await this.providerRegistration.jupyterCollections.find(i=>i.extensionId===e.serverProviderHandle.extensionId&&i.id===e.serverProviderHandle.id);if(!t)return b.warn(`Extension ${e.serverProviderHandle.extensionId} may have been uninstalled for provider ${e.serverProviderHandle.id}, handle ${e.serverProviderHandle.handle}`),!1;let n=new _Q.CancellationTokenSource;try{let i=await Promise.resolve(t.serverProvider.provideJupyterServers(n.token));return i?i.map(o=>o.id).includes(e.serverProviderHandle.handle)?!0:(b.warn(`Hiding remote kernel ${e.id} for ${t.id} as the remote Jupyter Server ${e.serverProviderHandle.extensionId}:${e.serverProviderHandle.id}:${e.serverProviderHandle.handle} is no longer available`),!1):!1}catch(i){return b.warn(`Failed to fetch remote servers from ${e.serverProviderHandle.extensionId}:${e.serverProviderHandle.id}`,i),!1}finally{n.dispose()}}};pS=E([(0,zx.injectable)(),I(0,(0,zx.inject)(Hh)),I(1,(0,zx.inject)(lr))],pS);u();var EQ=$(te());var fS=class{async getOrStartServer(e){throw new Error("Invalid Operation in Web")}};fS=E([(0,EQ.injectable)()],fS);u();var lu=require("vscode"),$h=$(te());var mS=class extends Fr{constructor(t,n){super();this._onDidLoad=this._register(new lu.EventEmitter);this._onDidChangeUri=this._register(new lu.EventEmitter);this._onDidRemoveUris=this._register(new lu.EventEmitter);this._onDidAddUri=this._register(new lu.EventEmitter);this._all=[];n.push(this),this.newStorage=this._register(new ij(t))}get onDidLoad(){return this._onDidLoad.event}get onDidChange(){return this._onDidChangeUri.event}get onDidRemove(){return this._onDidRemoveUris.event}get onDidAdd(){return this._onDidAddUri.event}get all(){return this.updateStore(),this._all}hookupStorageEvents(){this.storageEventsHooked||(this.storageEventsHooked=!0,this._register(this.newStorage.onDidAdd(t=>this._onDidAddUri.fire(t),this)),this._register(this.newStorage.onDidChange(t=>this._onDidChangeUri.fire(t),this)),this._register(this.newStorage.onDidRemove(t=>this._onDidRemoveUris.fire(t),this)))}updateStore(){this.hookupStorageEvents();let t=this._all;return this._all=this.newStorage.getAll(),(t.length!==this._all.length||JSON.stringify(this._all)!==JSON.stringify(t))&&this._onDidLoad.fire(),this._all}async clear(){this.hookupStorageEvents(),await this.newStorage.clear(),this._all=[],this._onDidLoad.fire()}async add(t,n){var o;this.hookupStorageEvents(),b.ci(`setUri: ${t.id}.${t.handle}`);let i={time:(o=n==null?void 0:n.time)!=null?o:Date.now(),displayName:"",provider:t};await this.newStorage.add(i),this.updateStore()}async update(t){this.hookupStorageEvents(),await this.newStorage.update(t),this.updateStore()}async remove(t){this.hookupStorageEvents(),await this.newStorage.remove(t),this.updateStore()}};mS=E([(0,$h.injectable)(),I(0,(0,$h.inject)(St)),I(0,(0,$h.named)(ir)),I(1,(0,$h.inject)(ie))],mS);var ij=class{constructor(e){this.memento=e;this._onDidChangeUri=new lu.EventEmitter;this._onDidRemoveUris=new lu.EventEmitter;this._onDidAddUri=new lu.EventEmitter;this.updatePromise=Promise.resolve();this.mementoKey=`MEMENTO_KEY_FOR_STORING_USED_JUPYTER_PROVIDERS_${lu.env.machineId}`}get onDidChange(){return this._onDidChangeUri.event}get onDidRemove(){return this._onDidRemoveUris.event}get onDidAdd(){return this._onDidAddUri.event}dispose(){this._onDidAddUri.dispose(),this._onDidChangeUri.dispose(),this._onDidRemoveUris.dispose()}async add(e){return this.updatePromise=this.updatePromise.then(async()=>{let t=this.getAll(),n=t.find(a=>Jt(a.provider)===Jt(e.provider)),o=[{displayName:e.displayName||(n==null?void 0:n.displayName)||Jt(e.provider),serverHandle:e.provider,time:e.time}].concat(t.sort((a,l)=>l.time-a.time).filter(a=>Jt(a.provider)!==Jt(e.provider)).map(a=>({displayName:a.displayName,serverHandle:a.provider,time:a.time}))),s=o.splice(pi.JupyterServerUriListMax);if(await this.memento.update(this.mementoKey,o),n||this._onDidAddUri.fire(e),s.length){let a=s.map(l=>({provider:l.serverHandle,time:l.time,displayName:l.displayName||""}));this._onDidRemoveUris.fire(a.map(l=>l.provider))}this._onDidChangeUri.fire()}).catch(y)}async update(e){let n=this.getAll().find(o=>o.provider.id===e.id&&o.provider.handle===e.handle),i={provider:e,time:Date.now(),displayName:(n==null?void 0:n.displayName)||""};await this.add(i)}async remove(e){await(this.updatePromise=this.updatePromise.then(async()=>{let t=!1;try{let n=this.getAll();if(n.length===0)return;let i=n.filter(s=>s.provider.id!==e.id||s.provider.handle!==e.handle),o=n.filter(s=>s.provider.id===e.id&&s.provider.handle===e.handle);if(i.length===0)await this.clear();else if(o.length){let s=i.map(a=>({displayName:a.displayName,serverHandle:a.provider,time:a.time}));t=!0,await this.memento.update(this.mementoKey,s),this._onDidRemoveUris.fire(o.map(a=>a.provider))}}finally{t||this._onDidRemoveUris.fire([e])}}).catch(t=>b.error(`Failed to remove Server handle ${JSON.stringify(e)}`,t)))}getAll(){let e=this.memento.get(this.mementoKey,[]),t=[];return e.forEach(async n=>{let i=Jt(n.serverHandle),o={time:n.time,displayName:n.displayName||i,provider:n.serverHandle};t.push(o)}),t}async clear(){let e=this.getAll();await this.memento.update(this.mementoKey,[]),e.length&&this._onDidRemoveUris.fire(e.map(t=>t.provider))}};u();var om=$(te());var W1="removeKernelUrisAndSessionsUsedByResources",gS=class{constructor(e,t,n){this.disposables=e;this.uriStorage=t;this.memento=n;this.usedRemoteKernelServerIdsAndSessions={}}activate(){this.usedRemoteKernelServerIdsAndSessions=this.memento.get(W1,{}),this.uriStorage.onDidRemove(this.onDidRemoveServers,this,this.disposables)}wasKernelUsed(e){let t=Jt(e.serverProviderHandle);return t in this.usedRemoteKernelServerIdsAndSessions&&typeof e.kernelModel.id=="string"&&e.kernelModel.id in this.usedRemoteKernelServerIdsAndSessions[t]}trackKernelIdAsUsed(e,t,n){let i=Jt(t);this.usedRemoteKernelServerIdsAndSessions[i]=this.usedRemoteKernelServerIdsAndSessions[i]||{},this.usedRemoteKernelServerIdsAndSessions[i][n]=this.usedRemoteKernelServerIdsAndSessions[i][n]||[];let o=this.usedRemoteKernelServerIdsAndSessions[i][n];o.includes(e.toString())||(o.push(e.toString()),this.memento.update(W1,this.usedRemoteKernelServerIdsAndSessions).then(y,y))}trackKernelIdAsNotUsed(e,t,n){let i=Jt(t);if(!(i in this.usedRemoteKernelServerIdsAndSessions)||!(n in this.usedRemoteKernelServerIdsAndSessions[i]))return;let o=this.usedRemoteKernelServerIdsAndSessions[i][n];!Array.isArray(o)||!o.includes(e.toString())||(o.splice(o.indexOf(e.toString()),1),o.length===0&&delete this.usedRemoteKernelServerIdsAndSessions[i][n],Object.keys(this.usedRemoteKernelServerIdsAndSessions[i]).length===0&&delete this.usedRemoteKernelServerIdsAndSessions[i],this.memento.update(W1,this.usedRemoteKernelServerIdsAndSessions).then(y,y))}onDidRemoveServers(e){e.forEach(t=>{let n=Jt(t);delete this.usedRemoteKernelServerIdsAndSessions[n],this.memento.update(W1,this.usedRemoteKernelServerIdsAndSessions).then(y,y)})}};gS=E([(0,om.injectable)(),I(0,(0,om.inject)(ie)),I(1,(0,om.inject)(fr)),I(2,(0,om.inject)(St)),I(2,(0,om.named)(ir))],gS);u();var DQ=$(te()),PQ=$(wQ());u();var xQ=require("vscode");function oj(r){return class extends r{constructor(...n){super(...n);this._onAnyMessage=new xQ.EventEmitter;this.onAnyMessage=this._onAnyMessage.event;this.msgChain=Promise.resolve(),this.sendChain=Promise.resolve(),this.receiveHooks=[],this.sendHooks=[]}patchSuperEmit(n){super.emit=n}send(n,i){this.sendHooks?this.sendChain=this.sendChain.then(()=>Promise.all(this.sendHooks.map(o=>o(n,i)))).then(()=>super.send(n,i)):super.send(n,i)}handleEvent(n,i,...o){return i==="message"&&this.receiveHooks.length?(this.msgChain=this.msgChain.then(()=>Promise.all(this.receiveHooks.map(s=>s(o[0])))).then(()=>n(i,...o)).catch(s=>b.error(`Exception while handling messages: ${s}`)),!0):n(i,...o)}emit(n,...i){return this.handleEvent((o,...s)=>super.emit(o,...s),n,...i)}addReceiveHook(n){this.receiveHooks.push(n)}removeReceiveHook(n){this.receiveHooks=this.receiveHooks.filter(i=>i!==n)}addSendHook(n){this.sendHooks.push(n)}removeSendHook(n){this.sendHooks=this.sendHooks.filter(i=>i!==n)}}}u();var Vs=new Map;var vS=class{getRequestCtor(e,t,n){class i extends Request{constructor(s,a){super(s,a);let l=this.headers;if(n){let c=n();Object.keys(c).forEach(f=>l.append(f,c[f].toString())),l.set("Content-Type","application/json");let p=l.append.bind(l);l.append=(f,m)=>{f.toLowerCase()!=="authorization"&&p(f,m)}}e&&this.headers.append("Cookie",e)}}return i}wrapWebSocketCtor(e){class t extends oj(e){constructor(o,s){super(o,s);this.timer=0;this.boundOpenHandler=this.openHandler.bind(this);let a,l=/.*\/kernels\/(.*)\/.*/.exec(o);l&&l.length>1&&(this.kernelId=l[1]),this.kernelId?(Vs.set(this.kernelId,this),this.onclose=()=>{a&&this.timer!==a&&clearInterval(a),Vs.get(this.kernelId)===this&&Vs.delete(this.kernelId)}):b.error("KernelId not extracted from Kernel WebSocket URL"),this.addEventListener&&this.addEventListener("open",this.boundOpenHandler)}openHandler(){let o=this.onmessage;this.onmessage=s=>{this.handleEvent((a,...l)=>{let c={data:l[0],type:a.toString(),target:this};return o(c),!0},"message",s.data)},this.removeEventListener("open",this.boundOpenHandler)}}return t}getWebsocketCtor(e,t,n){class i extends oj(PQ.default){constructor(a,l){super(a,l);this.timer=0;this.boundOpenHandler=this.openHandler.bind(this);let c,d=/.*\/kernels\/(.*)\/.*/.exec(a);d&&d.length>1&&(this.kernelId=d[1]),this.kernelId?(Vs.set(this.kernelId,this),this.onclose=()=>{c&&this.timer!==c&&clearInterval(c),Vs.get(this.kernelId)===this&&Vs.delete(this.kernelId)}):b.error("KernelId not extracted from Kernel WebSocket URL"),this.addEventListener("open",this.boundOpenHandler)}openHandler(){let a=this.onmessage;this.onmessage=l=>{this.handleEvent((c,...d)=>{let p={data:d[0],type:c.toString(),target:this};return a(p),!0},"message",l.data)},this.removeEventListener("open",this.boundOpenHandler)}}return i}getFetchMethod(){return fetch}getHeadersCtor(){return Headers}getRequestInit(){return{cache:"no-store"}}};vS=E([(0,DQ.injectable)()],vS);u();var Bs=$(te());u();var js=require("vscode");u();var nIe=["/bin/sh","/bin/bash","/bin/zsh"];function TQ(r,e){let t=(r.argv||[]).some(n=>(n=n.toLowerCase(),nIe.some(i=>n.includes(i))));J("DATASCIENCE.KERNEL_SPEC_LANGUAGE",void 0,{language:r.language,kind:e,usesShell:t})}u();u();var yS="remoteKernelSpecCache.json";var iIe=2e3,j1=class extends ic{constructor(t,n,i,o,s,a,l,c,d,p){super();this.id=t;this.displayName=n;this.env=i;this.cachedRemoteKernelValidator=o;this.kernelProvider=a;this.serverProviderHandle=l;this.jupyterConnection=c;this.fs=d;this.context=p;this._status="idle";this._onDidChangeStatus=new js.EventEmitter;this.onDidChangeStatus=this._onDidChangeStatus.event;this.promiseMonitor=new Gb;this.kernelIdsToHide=new Set;this.kind="remote";this.cache=[];this._onDidChangeKernels=new js.EventEmitter;this.onDidChangeKernels=this._onDidChangeKernels.event;this._onDidChange=new js.EventEmitter;this.onDidChange=this._onDidChange.event;this.cacheFile=js.Uri.joinPath(p.globalStorageUri,yS),this.cacheKey=Jt(l),this._register(s.registerKernelFinder(this)),this._register(this._onDidChangeKernels.event(()=>this._onDidChange.fire(),this)),this._register(this._onDidChangeKernels),this._register(this._onDidChange),this._register(this._onDidChangeStatus),this._register(this.promiseMonitor)}get status(){return this._status}set status(t){this._status!==t&&(this._status=t,this._onDidChangeStatus.fire())}get lastError(){return this._lastError}get kernels(){return this.cache}get items(){return this.kernels}get title(){return this.displayName}dispose(){var t,n;super.dispose(),(t=this._cacheUpdateCancelTokenSource)==null||t.dispose(),(n=this.kernelDisposeDelayTimer)==null||n.dispose()}async activate(){this.promiseMonitor.onStateChange(()=>{this.status=this.promiseMonitor.isComplete?"idle":"discovering"}),this.loadCache().then(y,y),this._register(this.kernelProvider.onDidStartKernel(t=>{Mt(t.kernelConnectionMetadata)&&this.updateCache().then(y,y)},this)),this._register(this.kernelProvider.onDidDisposeKernel(t=>{var n;if(t&&Mt(t.kernelConnectionMetadata)){(n=this.kernelDisposeDelayTimer)==null||n.dispose();let i=setTimeout(()=>{this.updateCache().then(y,y)},iIe);return this.kernelDisposeDelayTimer=new js.Disposable(()=>clearTimeout(i)),i}},this))}async refresh(){await this.loadCache(!0,!0)}getListOfKernelsWithCachedConnection(t,n=!1){return(!this.cachedConnection||n)&&(this.cachedConnection=this.getRemoteConnectionInfo(t)),this.cachedConnection.then(i=>i?(this.cachedConnection=Promise.resolve(i),this.listKernelsFromConnection(i)):Promise.resolve([])).catch(i=>this.isDisposed?Promise.reject(i):n?(this.cachedConnection=void 0,Promise.reject(i)):this.getListOfKernelsWithCachedConnection(t,!0))}async loadCache(t=!1,n=!1){b.ci(`Remote Kernel Finder load cache Server: ${this.id}`);let i=(async()=>{let o=t?[]:await this.getFromCache(),s=[];if(!t&&Array.isArray(o)&&o.length>0)s=o,this.updateCache().then(y,y),this.loadCache(!0).then(y,y);else try{s=await this.getListOfKernelsWithCachedConnection(n),this._lastError=void 0}catch(a){a instanceof js.CancellationError||(b.error("UniversalRemoteKernelFinder: Failed to get kernels without cache",a),this._lastError=a,this._onDidChange.fire())}await this.writeToCache(s)})();this.promiseMonitor.push(i),await i}async updateCache(){let t=(async()=>{var o;let n=[];(o=this._cacheUpdateCancelTokenSource)==null||o.dispose();let i=new js.CancellationTokenSource;this._cacheUpdateCancelTokenSource=i;try{n=await this.getListOfKernelsWithCachedConnection(!1)}catch(s){b.warn(`Could not fetch kernels from the ${this.kind} server, falling back to cache: ${s}`),n=await this.getFromCache(i.token),n=n.filter(a=>a.kind==="connectToLiveRemoteKernel")}i.token.isCancellationRequested||await this.writeToCache(n)})();this.promiseMonitor.push(t),await t}async getRemoteConnectionInfo(t=!0){let n=[];return t&&n.push(Wt.createProgressReporter(void 0,C.connectingToJupyter)),this.jupyterConnection.createConnectionInfo(this.serverProviderHandle).finally(()=>fe(n))}async getFromCache(t){try{if(t!=null&&t.isCancellationRequested)throw new js.CancellationError;let n=this.cache;(!n||n.length===0)&&(n=await this.getCacheContents());let i=[],o=Promise.all(n.map(async s=>{await this.isValidCachedKernel(s)&&i.push(s)}));return await Fs(t,o),i}catch(n){b.error("UniversalRemoteKernelFinder: Failed to get from cache",n)}return[]}async getCacheContents(){try{let t=await this.fs.readFile(this.cacheFile),n=JSON.parse(t);if(n.extensionVersion!==this.env.extensionVersion)return[];let i=n.data[this.cacheKey]||[];return Array.isArray(i)?i.map(o=>Yc.fromJSON(o)):[]}catch(t){return[]}}async listKernelsFromConnection(t){let n=[];try{let i=Jf.create(t.settings);n.push({dispose:()=>Th(i)});let[o,s,a,l]=await Promise.all([i.getRunningKernels(),i.getKernelSpecs(),i.getRunningSessions(),h$(t.serverProviderHandle)]),c=s.map(f=>(TQ(f,"remote"),Tx.create({kernelSpec:f,id:KR(f,void 0,l),baseUrl:t.baseUrl,serverProviderHandle:t.serverProviderHandle})));return[...a.map(f=>{var D,P;let m=f.kernel,g=m.last_activity?new Date(Date.parse(m.last_activity.toString())):new Date,h=m.connections?parseInt(m.connections.toString(),10):0,v=o.find(M=>{var x;return M.id===((x=f.kernel)==null?void 0:x.id)})||{},S=s.find(M=>{var x;return M.name===((x=f.kernel)==null?void 0:x.name)})||{};return Px.create({kernelModel:{...f.kernel,...S,...v,name:((D=f.kernel)==null?void 0:D.name)||"",lastActivityTime:g,numberOfConnections:h,model:f},baseUrl:t.baseUrl,id:((P=f.kernel)==null?void 0:P.id)||"",serverProviderHandle:t.serverProviderHandle})}).filter(f=>!this.kernelIdsToHide.has(f.kernelModel.id||"")),...c]}catch(i){throw b.error(`Error fetching kernels from ${t.baseUrl} (${t.displayName}):`,i),i}finally{await Promise.all(n.map(i=>i.dispose().catch(y)))}}async writeToCache(t){try{b.trace(`UniversalRemoteKernelFinder: Writing ${t.length} remote kernel connection metadata to cache`);let n=this.cache,i=new Map(n.map(f=>[f.id,f])),o=new Map(t.map(f=>[f.id,f])),s=t.filter(f=>!i.has(f.id)),a=t.filter(f=>i.has(f.id)&&!T9(f,i.get(f.id))),l=n.filter(f=>!o.has(f.id)),c=this.cacheKey;this.cache=n.filter(f=>o.has(f.id)).concat(s),this.cache.forEach(f=>{let m=o.get(f.id);f!==m&&m.kind==="connectToLiveRemoteKernel"&&f.kind==="connectToLiveRemoteKernel"&&f.updateModel(m.kernelModel)});let d=t.map(f=>f.toJSON()),p={extensionVersion:this.env.extensionVersion,data:{}};try{let f=await this.fs.readFile(this.cacheFile),m=JSON.parse(f);m.extensionVersion===this.env.extensionVersion&&(p=m)}catch(f){}p.data[c]=d,await this.fs.createDirectory(this.context.globalStorageUri).then(()=>this.fs.writeFile(this.cacheFile,JSON.stringify(p))).catch(f=>{b.error("Failed to cache the remote kernels.",f)}),(s.length||a.length||l.length)&&this._onDidChangeKernels.fire({removed:l})}catch(n){b.error("UniversalRemoteKernelFinder: Failed to write to cache",n)}}async isValidCachedKernel(t){switch(t.kind){case"startUsingRemoteKernelSpec":return!1;case"connectToLiveRemoteKernel":return this.cachedRemoteKernelValidator.isValid(t)}}};var B1=require("vscode");var Bd=class{constructor(e,t,n,i,o,s,a,l,c,d){this.serverUriStorage=e;this.env=t;this.cachedRemoteKernelValidator=n;this.kernelFinder=i;this.kernelProvider=o;this.jupyterConnection=s;this.disposables=a;this.fs=l;this.context=c;this.jupyterServerProviderRegistry=d;this.serverFinderMapping=new Map;this.handledProviders=new WeakSet;this.mappedProviders=new WeakSet;this.mappedServers=new Set}activate(){this.serverUriStorage.onDidAdd(e=>this.validateAndCreateFinder(e),this,this.disposables),this.serverUriStorage.onDidChange(this.buildListOfFinders,this,this.disposables),this.serverUriStorage.onDidLoad(this.handleProviderChanges,this,this.disposables),this.serverUriStorage.onDidLoad(this.buildListOfFinders,this,this.disposables),this.jupyterServerProviderRegistry.onDidChangeCollections(this.handleProviderHandleChanges,this,this.disposables),this.serverUriStorage.onDidRemove(this.urisRemoved,this,this.disposables),this.jupyterServerProviderRegistry.onDidChangeCollections(this.handleProviderChanges,this,this.disposables),this.buildListOfFinders(),this.handleProviderChanges().catch(y)}buildListOfFinders(){this.serverUriStorage.all.map(e=>this.validateAndCreateFinder(e).catch(y))}handleProviderHandleChanges(){this.jupyterServerProviderRegistry.jupyterCollections.forEach(e=>{this.handledProviders.has(e)||(this.handledProviders.add(e),e.serverProvider.onDidChangeServers&&e.serverProvider.onDidChangeServers(this.buildListOfFinders,this,this.disposables))}),this.buildListOfFinders()}async handleProviderChanges(){if(!this.serverUriStorage.all.length)return;let e=new B1.CancellationTokenSource;this.disposables.push(e),await Promise.all(this.jupyterServerProviderRegistry.jupyterCollections.map(t=>{let n=t.serverProvider;if(!(!n||this.mappedProviders.has(n)))return this.mappedProviders.add(n),n!=null&&n.onDidChangeServers&&(n==null||n.onDidChangeServers(()=>this.lookForServersInCollectionAndRemoveOldServers(t),this,this.disposables)),this.serverUriStorage.onDidLoad(()=>this.lookForServersInCollectionAndRemoveOldServers(t),this,this.disposables),this.lookForServersInCollectionAndRemoveOldServers(t).catch(y)})),e.dispose()}async lookForServersInCollectionAndRemoveOldServers(e){if(!this.serverUriStorage.all.length)return;let t=new Set(this.serverUriStorage.all.map(o=>Jt(o.provider))),n=e.serverProvider;if(!n)return;let i=new B1.CancellationTokenSource;try{let o=await Promise.resolve(n.provideJupyterServers(i.token)),s=new Set;(o||[]).forEach(a=>{let l={extensionId:e.extensionId,handle:a.id,id:e.id},c=Jt(l);s.add(c),U1(l,a.label),!(this.mappedServers.has(c)||!t.has(c))&&(this.mappedServers.add(c),this.createRemoteKernelFinder(l,a.label))}),this.serverFinderMapping.forEach((a,l)=>{a.serverProviderHandle.extensionId===e.extensionId&&a.serverProviderHandle.id===e.id&&!s.has(Jt(a.serverProviderHandle))&&(a.dispose(),this.serverFinderMapping.delete(l))})}catch(o){b.error(`Failed to get servers for Collection ${e.id} in ${e.extensionId}`,o)}finally{i.dispose()}}async validateAndCreateFinder(e){let t=Jt(e.provider);if(this.serverFinderMapping.has(t))return;let n=new B1.CancellationTokenSource,i=async()=>{var c;let s=this.jupyterServerProviderRegistry.jupyterCollections.find(d=>d.extensionId===e.provider.extensionId&&d.id===e.provider.id);if(!s||!s.serverProvider)return;let a=await Promise.resolve(s.serverProvider.provideJupyterServers(n.token)),l=(c=a==null?void 0:a.find(d=>d.id===e.provider.handle))==null?void 0:c.label;l&&this.createRemoteKernelFinder(e.provider,l)},o=async()=>{var a;let s=await((a=this.jupyterServerProviderRegistry.jupyterCollections.find(l=>l.extensionId===e.provider.extensionId&&l.extensionId===Zl&&l.id===e.provider.id))==null?void 0:a.label);s&&this.createRemoteKernelFinder(e.provider,s)};await Promise.all([i().catch(y),o().catch(y)]),n.dispose()}getOrCreateRemoteKernelFinder(e,t){let n=Jt(e);if(!this.serverFinderMapping.has(n)){let i=new j1(`remote-${n}`,t,this.env,this.cachedRemoteKernelValidator,this.kernelFinder,this.kernelProvider,e,this.jupyterConnection,this.fs,this.context);this.disposables.push(i),this.serverFinderMapping.set(n,i),i.activate().then(y,y)}return this.serverFinderMapping.get(n)}createRemoteKernelFinder(e,t){this.getOrCreateRemoteKernelFinder(e,t)}urisRemoved(e){e.forEach(t=>{let n=Jt(t),i=this.serverFinderMapping.get(n);i&&i.dispose(),this.serverFinderMapping.delete(n)})}dispose(){this.serverFinderMapping.forEach(e=>e.dispose())}};E([yn("Handle Jupyter Provider Changes")],Bd.prototype,"handleProviderChanges",1),E([yn("Check Servers in Jupyter Server Provider")],Bd.prototype,"lookForServersInCollectionAndRemoveOldServers",1),E([yn("Failed to create a Remote Kernel Finder")],Bd.prototype,"validateAndCreateFinder",1),Bd=E([(0,Bs.injectable)(),I(0,(0,Bs.inject)(fr)),I(1,(0,Bs.inject)(DI)),I(2,(0,Bs.inject)(zR)),I(3,(0,Bs.inject)(ai)),I(4,(0,Bs.inject)(He)),I(5,(0,Bs.inject)(gn)),I(6,(0,Bs.inject)(ie)),I(7,(0,Bs.inject)(wt)),I(8,(0,Bs.inject)(ot)),I(9,(0,Bs.inject)(lr))],Bd);u();var sm=$(te());u();var z1=require("vscode");var Q1=$(zh());var uu=$(te());u();var H1=class extends it{constructor(t){super("localjupyterserverconnection",C.jupyterNotebookFailure(t.message||t.toString()));this.originalError=t}};u();function LQ(r){if(vn()){let e=r;if(e&&e._futures){let t=e._futures;t.forEach&&t.forEach(n=>{n._status!==void 0&&(n._status|=4)})}e&&e._reconnectLimit&&(e._reconnectLimit=0)}}var bS=class extends Xn{constructor(e){super(e.message,e)}};u();var Zx=require("vscode");u();var Qh=class extends _i{constructor(e){super("invalidkernel",C.kernelInvalid(ct(e)),e)}};u();var J1=class extends _i{constructor(e){super("timeout",C.jupyterLaunchTimedOut,e)}};async function q1(r,e,t,n,i){var a;if(!t.kernel)throw new Qh(r);let o=Wt.reportProgress(e,C.waitingForJupyterSessionToBeIdle),s=[];o&&s.push(o);try{b.trace(`Waiting for idle on (kernel): ${t.kernel.id} -> ${t.kernel.status}`);let l=Te();i.onCancellationRequested(()=>l.reject(new Zx.CancellationError),void 0,s);let c=(m,g)=>{b.trace(`Got status ${g} in waitForIdleOnSession`),g=="idle"&&l.resolve(g)};(a=t.kernel.statusChanged)==null||a.connect(c),s.push(new Zx.Disposable(()=>Xs(()=>{var m,g;return(g=(m=t.kernel)==null?void 0:m.statusChanged)==null?void 0:g.disconnect(c)}))),t.kernel.status=="idle"&&l.resolve(t.kernel.status);let d=Te(),p=()=>d.resolve("");t.disposed.connect(p,d),s.push(new Zx.Disposable(()=>Xs(()=>t.disposed.disconnect(p,d)))),d.promise.catch(y),l.promise.catch(y);let f=await ho(n,"",l.promise,d.promise);if(t.isDisposed)throw b.error("Session disposed while waiting for session to be idle."),new Qh(r);if(b.trace(`Finished waiting for idle on (kernel): ${t.kernel.id} -> ${t.kernel.status}`),f=="idle")return;throw b.error(`Shutting down after failing to wait for idle on (kernel): ${t.kernel.id} -> ${t.kernel.status}`),new J1(r)}catch(l){throw b.ci("Error waiting for idle",l),l}finally{fe(s)}}u();var $1=require("vscode");u();var cu=$(Mi()),cj=require("vscode");var G1=class extends ic{constructor(t,n){super();this.kind=t;this.session=n;this.propertyChanged=new cu.Signal(this);this.kernelChanged=new cu.Signal(this);this.statusChanged=new cu.Signal(this);this.connectionStatusChanged=new cu.Signal(this);this.iopubMessage=new cu.Signal(this);this.unhandledMessage=new cu.Signal(this);this.anyMessage=new cu.Signal(this);this.disposed=new cu.Signal(this);this.didShutdown=this._register(new cj.EventEmitter);this._onDidKernelSocketChange=this._register(new cj.EventEmitter);n.propertyChanged.connect(this.onPropertyChanged,this),n.kernelChanged.connect(this.onKernelChanged,this),n.statusChanged.connect(this.onStatusChanged,this),n.connectionStatusChanged.connect(this.onConnectionStatusChanged,this),n.iopubMessage.connect(this.onIOPubMessage,this),n.unhandledMessage.connect(this.onUnhandledMessage,this),n.anyMessage.connect(this.onAnyMessage,this),this._register({dispose:()=>{this.session.propertyChanged.disconnect(this.onPropertyChanged,this),this.session.kernelChanged.disconnect(this.onKernelChanged,this),this.session.statusChanged.disconnect(this.onStatusChanged,this),this.session.connectionStatusChanged.disconnect(this.onConnectionStatusChanged,this),this.session.iopubMessage.disconnect(this.onIOPubMessage,this),this.session.unhandledMessage.disconnect(this.onUnhandledMessage,this),this.session.anyMessage.disconnect(this.onAnyMessage,this)}})}get id(){return this.session.id}get path(){return this.session.path}get name(){return this.session.name}get type(){return this.session.type}get serverSettings(){return this.session.serverSettings}get model(){return this.session.model}get kernel(){return this.isDisposed||!this.session.kernel?null:this.session.kernel}get onDidShutdown(){return this.didShutdown.event}get kernelId(){var t,n;return((n=(t=this.session)==null?void 0:t.kernel)==null?void 0:n.id)||""}get onDidKernelSocketChange(){return this._onDidKernelSocketChange.event}dispose(){this.isDisposed||(super.dispose(),this.statusChanged.emit("dead"),this.disposed.emit(),cu.Signal.disconnectAll(this))}async restart(){var t,n,i;await((t=this.session.kernel)==null?void 0:t.restart()),this.initializeKernelSocket(),b.info(`Restarted ${(i=(n=this.session)==null?void 0:n.kernel)==null?void 0:i.id}`)}initializeKernelSocket(){var n,i,o,s,a,l;if(!this.session.kernel)throw new Error("Kernel not initialized in Session");let t={kernel:this.session.kernel,options:{clientId:this.session.kernel.clientId,id:this.session.kernel.id,model:{...this.session.kernel.model},userName:this.session.kernel.username},socket:Vs.get(this.session.kernel.id)};JSON.stringify((n=this.previousKernelSocketInformation)==null?void 0:n.kernel.model)===JSON.stringify(t.kernel.model)&&((i=this.previousKernelSocketInformation)==null?void 0:i.kernel)===t.kernel&&((o=this.previousKernelSocketInformation)==null?void 0:o.kernel.id)===t.kernel.id&&((s=this.previousKernelSocketInformation)==null?void 0:s.socket)===t.socket||(this.previousKernelSocketInformation=t,(a=this.session.kernel)==null||a.connectionStatusChanged.disconnect(this.onKernelConnectionStatusHandler,this),(l=this.session.kernel)==null||l.connectionStatusChanged.connect(this.onKernelConnectionStatusHandler,this),this._onDidKernelSocketChange.fire())}onPropertyChanged(t,n){this.propertyChanged.emit(n)}onKernelChanged(t,n){this.kernelChanged.emit(n)}onStatusChanged(t,n){this.statusChanged.emit(n);let i=this.status;b.ci(`Server Status = ${i}`)}onConnectionStatusChanged(t,n){this.connectionStatusChanged.emit(n)}onIOPubMessage(t,n){this.iopubMessage.emit(n)}onUnhandledMessage(t,n){b.warn(`Unhandled message found: ${n.header.msg_type}`),this.unhandledMessage.emit(n)}onAnyMessage(t,n){this.anyMessage.emit(n)}setPath(t){return this.session.setPath(t)}setName(t){return this.session.setName(t)}setType(t){return this.session.setType(t)}changeKernel(t){return this.session.changeKernel(t)}onKernelConnectionStatusHandler(t,n){b.ci(`Server Kernel Status = ${n}`)}};var Y1=class extends G1{constructor(t,n,i,o,s){super(er(i)?"localJupyter":"remoteJupyter",t);this.resource=n;this.kernelConnectionMetadata=i;this.kernelService=o;this.creator=s;this.isShuttingDown=!1;this.initializeKernelSocket()}get status(){var t,n;return this.isDisposed?"dead":(t=this.session)!=null&&t.kernel?this.session.kernel.status:(b.ci(`Kernel status not started because real session is ${this.session?"defined":"undefined"} & real kernel is ${(n=this.session)!=null&&n.kernel?"defined":"undefined"}`),"unknown")}dispose(){var t,n;(t=this.restartToken)==null||t.cancel(),(n=this.restartToken)==null||n.dispose(),this.shutdownImplementation(!1).finally(()=>super.dispose())}async waitForIdle(t,n){try{await q1(this.kernelConnectionMetadata,this.resource,this.session,t,n)}catch(i){throw b.ci("Error waiting for idle",i),await this.shutdown().catch(y),i}}async restart(){let t=[],n=new $1.CancellationTokenSource;this.restartToken=n;let i=new vr(!1);t.push(i),t.push(n);try{await this.validateLocalKernelDependencies(n.token,i),await super.restart()}finally{fe(t)}}async validateLocalKernelDependencies(t,n){var i;if(!(!((i=this.kernelConnectionMetadata)!=null&&i.interpreter)||!er(this.kernelConnectionMetadata)||!this.kernelService)){if(t.isCancellationRequested)throw new $1.CancellationError;await this.kernelService.ensureKernelIsUsable(this.resource,this.kernelConnectionMetadata,n,t,this.creator==="3rdPartyExtension")}}async shutdown(){var t,n;return(t=this.restartToken)==null||t.cancel(),(n=this.restartToken)==null||n.dispose(),this.shutdownImplementation(!0)}async shutdownImplementation(t){var o;if(this.isDisposed||this.isShuttingDown)return;this.isShuttingDown=!0;let n=(new Error().stack||"").split(`
`).filter(s=>s.includes(Ge));b.trace(`Shutdown session - current session, called from 
 ${n.map(s=>`    ${s}`).join(`
`)}`);let i=`${(o=this.session.kernel)==null?void 0:o.id}, ${this.kernelConnectionMetadata.id}`;b.debug(`shutdownSession ${i} - start`);try{if(t||this.canShutdownSession())try{b.debug(`Session can be shutdown ${this.kernelConnectionMetadata.id}`),LQ(this.session.kernel),this.session.isDisposed||await ho(1e3,this.session.shutdown().catch(y))}catch(s){try{this.session.isDisposed||this.session.dispose()}catch(a){b.warn("Failures in disposing the session",a)}}finally{this.didShutdown.fire()}else b.debug(`Session cannot be shutdown ${this.kernelConnectionMetadata.id}`);try{this.session.isDisposed||this.session.dispose()}catch(s){b.warn("Failures in disposing the session",s)}super.dispose(),b.trace("Shutdown session -- complete")}catch(s){b.warn("Failures in disposing the session",s)}b.debug(`shutdownSession ${i} - shutdown complete`)}canShutdownSession(){return er(this.kernelConnectionMetadata)?!0:this.kernelConnectionMetadata.kind==="connectToLiveRemoteKernel"?!1:this.resource&&Al(this.resource)==="interactive"?!0:!(this.resource&&Al(this.resource)==="notebook"&&Mt(this.kernelConnectionMetadata))}};var Hd=class{constructor(e,t,n,i,o){this.jupyterNotebookProvider=e;this.jupyterConnection=t;this.asyncDisposables=n;this.kernelService=i;this.configService=o}async create(e){let t=[],n,i=()=>{e.ui.disableUI||n||(n=Wt.createProgressReporter(e.resource,Mt(e.kernelConnection)?C.connectingToJupyter:C.startingJupyter),t.push(n))};e.ui.disableUI&&e.ui.onDidChangeDisableUI(i,this,t),i();let o,s=[],a=this.configService.getSettings(e.resource).jupyterLaunchTimeout;try{o=Mt(e.kernelConnection)?await ds(e.token,this.jupyterConnection.createConnectionInfo(e.kernelConnection.serverProviderHandle)):await this.jupyterNotebookProvider.getOrStartServer({resource:e.resource,token:e.token,ui:e.ui}),await ds(e.token,this.validateLocalKernelDependencies(e));let l=Jf.create(o.settings);this.asyncDisposables.push({dispose:()=>Th(l)}),s.push(l),await ds(e.token,this.validateRemoteServer(e,l));let c=await this.connectToOrCreateSession({...e,contentsManager:l.contentsManager,sessionManager:l.sessionManager,kernelManager:l.kernelManager,kernelSpecManager:l.kernelSpecManager,idleTimeout:a,connection:o});e.token.isCancellationRequested&&(await c.shutdown().catch(y),Xs(()=>c.dispose())),Od.throwIfCanceled(e.token),b.info(`Started session for kernel ${e.kernelConnection.kind}:${e.kernelConnection.id}`);let d=new Y1(c,e.resource,e.kernelConnection,this.kernelService,e.creator),p=c.disposed,f=()=>{l.dispose(),p.disconnect(f)};this.asyncDisposables.push({dispose:()=>d.shutdown().finally(()=>d.dispose())}),c.disposed.connect(f);let m=d.onDidDispose(f);return this.asyncDisposables.push(m),d}catch(l){throw fe(s),Mt(e.kernelConnection)?o?Ks.isSelfCertsError(l)?new Ks(o.baseUrl):zc.isSelfCertsExpiredError(l)?new zc(o.baseUrl):new co(o.baseUrl,e.kernelConnection.serverProviderHandle,l):l:l instanceof it?l:new H1(l)}finally{fe(t)}}async validateRemoteServer(e,t){if(t.isDisposed)throw new tn;if(!er(e.kernelConnection))try{await Promise.all([t.getRunningKernels(),t.getKernelSpecs()])}catch(n){throw b.error("Failed to fetch running kernels from remote server, connection may be outdated or remote server may be unreachable",n),new co(e.kernelConnection.baseUrl,e.kernelConnection.serverProviderHandle,n)}}async validateLocalKernelDependencies(e){var t;if(e.token.isCancellationRequested)throw new z1.CancellationError;(t=e.kernelConnection)!=null&&t.interpreter&&er(e.kernelConnection)&&this.kernelService&&await this.kernelService.ensureKernelIsUsable(e.resource,e.kernelConnection,e.ui,e.token,e.creator==="3rdPartyExtension")}async connectToOrCreateSession(e){var n;if(e.token.isCancellationRequested)throw new z1.CancellationError;let t;try{if(e.kernelConnection&&e.kernelConnection.kind==="connectToLiveRemoteKernel"&&e.kernelConnection.kernelModel.id&&e.kernelConnection.kernelModel.model){if(!e.kernelConnection.kernelModel.model)throw new Error("Kernel model not defined when connecting to an existing session");t=e.sessionManager.connectTo({...e.kernelConnection.kernelModel,model:e.kernelConnection.kernelModel.model}),await ds(e.token,ZD(async()=>{var i;return((i=t.kernel)==null?void 0:i.connectionStatus)==="connected"||e.token.isCancellationRequested},e.idleTimeout,100))}else b.trace(`createNewKernelSession ${(n=e.kernelConnection)==null?void 0:n.id}`),t=await this.createNewSession(e),await q1(e.kernelConnection,e.resource,t,e.idleTimeout,e.token).catch(y);if(e.token.isCancellationRequested)throw new z1.CancellationError;return t}catch(i){let o=e.ui.disableUI?b.debug:b.error;throw i instanceof it?(o("Failed to change kernel, re-throwing",i),i):(o("Failed to change kernel",i),new Qh(e.kernelConnection))}}async createNewSession(e){var a,l,c,d,p,f;let t=(e.connection,e.resource,void 0),n=t==null?void 0:t.path,i=(d=(c=k$(e.kernelConnection))!=null?c:(l=(a=e.kernelSpecManager)==null?void 0:a.specs)==null?void 0:l.default)!=null?d:"",o;if(t!=null&&t.name)o=t.name;else{let m=e.resource?Jv(e.resource):"";o=`${e.resource?mi(e.resource,m):""}-${(0,Q1.default)()}${m}`}let s={path:n||dIe(e.resource),kernel:{name:i},name:o,type:(((p=e.resource)==null?void 0:p.path)||"").toLowerCase().endsWith(".ipynb")?"notebook":"console"};try{let m=await ds(e.token,e.sessionManager.startNew(s,{kernelConnectionOptions:{handleComms:!0}}));if(!m.kernel)throw new bS(new Error("No kernel created"));return b.info(C.createdNewKernel(e.connection.baseUrl,((f=m==null?void 0:m.kernel)==null?void 0:f.id)||"")),m}catch(m){throw m instanceof bS?m:new bS(m)}}};Hd=E([(0,uu.injectable)(),I(0,(0,uu.inject)(GR)),I(1,(0,uu.inject)(gn)),I(2,(0,uu.inject)(Ha)),I(3,(0,uu.inject)(YR)),I(3,(0,uu.optional)()),I(4,(0,uu.inject)(Ae))],Hd);function uIe(){return`${jf}${(0,Q1.default)()}`}function dIe(r){let e=`${uIe()}${(0,Q1.default)()}.ipynb`;return r?`${mi(r,".ipynb")}${e}`:`${C.defaultNotebookName}${e}`}var IS=class{constructor(e,t,n){this.rawKernelSupported=e;this.newRawKernelSessionFactory=t;this.newJupyterSessionFactory=n}async create(e){let t=e.kernelConnection;return this.rawKernelSupported.isSupported&&er(t)&&this.newRawKernelSessionFactory?this.newRawKernelSessionFactory.create({...e,kernelConnection:t}):this.newJupyterSessionFactory.create(e)}};IS=E([(0,sm.injectable)(),I(0,(0,sm.inject)(jd)),I(1,(0,sm.inject)(gQ)),I(1,(0,sm.optional)()),I(2,(0,sm.inject)(Hd))],IS);u();var eD=Symbol("RemoteKernelFinderController");function KQ(r,e){r.addSingleton(Fl,Fl),r.addSingleton(YR,Yh),r.addSingleton(fr,mS),r.addSingleton(Nx,IS),r.addSingleton(Hd,Hd),r.addSingleton(GR,fS),r.addSingleton(Bh,vS),r.addSingleton(gn,gn),r.addSingleton(Hh,gS),r.addBinding(Hh,Ue),r.addSingleton(zR,pS),r.addSingleton(Cn,dS),r.addSingleton(eD,Bd),r.addBinding(eD,Ue),r.addSingleton(lr,xI)}var XQ=$(te());u();var hn=$(te());u();var Ui=require("vscode");var X1=class{constructor(e,t){this.asyncDisposables=e;this.disposables=t;this.executions=new WeakMap;this.kernelsByNotebook=new WeakMap;this.kernelsById=new Map;this.pendingDisposables=new Set;this._onDidRestartKernel=new Ui.EventEmitter;this._onDidStartKernel=new Ui.EventEmitter;this._onDidCreateKernel=new Ui.EventEmitter;this._onDidDisposeKernel=new Ui.EventEmitter;this._onKernelStatusChanged=new Ui.EventEmitter;this.onKernelStatusChanged=this._onKernelStatusChanged.event;this.asyncDisposables.push(this),Ui.workspace.onDidCloseNotebookDocument(n=>this.disposeOldKernel(n),this,t),t.push(this._onDidDisposeKernel),t.push(this._onDidRestartKernel),t.push(this._onKernelStatusChanged),t.push(this._onDidStartKernel),t.push(this._onDidCreateKernel)}get kernels(){let e=new Set;return Ui.workspace.notebookDocuments.forEach(t=>{let n=this.get(t);n&&e.add(n)}),Array.from(e)}get onDidDisposeKernel(){return this._onDidDisposeKernel.event}get onDidRestartKernel(){return this._onDidRestartKernel.event}get onDidStartKernel(){return this._onDidStartKernel.event}get onDidCreateKernel(){return this._onDidCreateKernel.event}get(e){var t,n;if(Dn(e)){let i=Ui.workspace.notebookDocuments.find(o=>o.uri.toString()===e.toString());return i?this.get(i):void 0}else return typeof e=="string"?(t=this.kernelsById.get(e))==null?void 0:t.kernel:(n=this.kernelsByNotebook.get(e))==null?void 0:n.kernel}getKernelExecution(e){return this.executions.get(e)}getInternal(e){return this.kernelsByNotebook.get(e)}async dispose(){b.ci("Disposing all kernels from kernel provider");let e=Array.from(this.pendingDisposables.values());this.pendingDisposables.clear(),await Promise.all(e),await Promise.all(this.kernels.map(t=>t.dispose()))}storeKernel(e,t,n){this.kernelsByNotebook.set(e,{options:t,kernel:n}),this.kernelsById.set(n.id,{options:t,kernel:n}),this._onDidCreateKernel.fire(n)}deleteMappingIfKernelIsDisposed(e){e.onDisposed(()=>{this.get(e.notebook)===e&&(this.kernelsByNotebook.delete(e.notebook),this.kernelsById.delete(e.id),b.debug(`Kernel got disposed, hence there is no longer a kernel associated with ${ve(e.uri)}`)),this.pendingDisposables.delete(e)},this,this.disposables)}disposeOldKernel(e){let t=this.kernelsByNotebook.get(e);t&&(b.debug(`Disposing kernel associated with ${ve(e.uri)}, isClosed=${e.isClosed}`),this.kernelsById.delete(t.kernel.id),this.pendingDisposables.add(t.kernel),t.kernel.dispose().catch(n=>b.warn("Failed to dispose old kernel",n)).finally(()=>this.pendingDisposables.delete(t.kernel)).catch(y)),this.kernelsByNotebook.delete(e)}handleServerRemoval(e){Ui.workspace.notebookDocuments.forEach(t=>{let n=this.kernelsByNotebook.get(t);if(n){let i=n.options.metadata;(i.kind==="connectToLiveRemoteKernel"||i.kind==="startUsingRemoteKernelSpec")&&e.find(s=>s.id===i.serverProviderHandle.id&&s.handle===i.serverProviderHandle.handle)&&(this.kernelsByNotebook.delete(t),this.kernelsById.delete(n.kernel.id))}})}},Z1=class{constructor(e,t){this.asyncDisposables=e;this.disposables=t;this.kernelsByUri=new Map;this.kernelsById=new Map;this.pendingDisposables=new Set;this._onDidRestartKernel=new Ui.EventEmitter;this._onDidStartKernel=new Ui.EventEmitter;this._onDidCreateKernel=new Ui.EventEmitter;this._onDidDisposeKernel=new Ui.EventEmitter;this._onKernelStatusChanged=new Ui.EventEmitter;this.onKernelStatusChanged=this._onKernelStatusChanged.event;this.asyncDisposables.push(this),Ui.workspace.onDidCloseNotebookDocument(n=>{b.debug(`Notebook document ${ve(n.uri)} got closed`),this.disposeOldKernel(n.uri)},this,t),t.push(this._onDidDisposeKernel),t.push(this._onDidRestartKernel),t.push(this._onKernelStatusChanged),t.push(this._onDidStartKernel),t.push(this._onDidCreateKernel)}get kernels(){return Array.from(this.kernelsByUri.values()).map(e=>e.kernel)}get onDidDisposeKernel(){return this._onDidDisposeKernel.event}get onDidRestartKernel(){return this._onDidRestartKernel.event}get onDidStartKernel(){return this._onDidStartKernel.event}get onDidCreateKernel(){return this._onDidCreateKernel.event}get(e){var t,n;return((t=this.kernelsByUri.get(e.toString()))==null?void 0:t.kernel)||((n=this.kernelsById.get(e.toString()))==null?void 0:n.kernel)}getInternal(e){return this.kernelsByUri.get(e.toString())}async dispose(){b.ci("Disposing all kernels from kernel provider");let e=Array.from(this.pendingDisposables.values());this.pendingDisposables.clear(),await Promise.all(e),await Promise.all(this.kernels.map(t=>t.dispose()))}storeKernel(e,t,n){this.kernelsByUri.set(e.toString(),{options:t,kernel:n}),this.kernelsById.set(n.id,{options:t,kernel:n}),this._onDidCreateKernel.fire(n)}deleteMappingIfKernelIsDisposed(e,t){t.onDisposed(()=>{this.get(e)===t&&(this.kernelsByUri.delete(e.toString()),this.kernelsById.delete(t.id),b.debug(`Kernel got disposed, hence there is no longer a kernel associated with ${ve(e)}`)),this.pendingDisposables.delete(t)},this,this.disposables)}disposeOldKernel(e){let t=this.kernelsByUri.get(e.toString());t&&(b.ci(`Disposing kernel associated with ${ve(e)}`),this.kernelsById.delete(t.kernel.id),this.pendingDisposables.add(t.kernel),t.kernel.dispose().catch(n=>b.warn("Failed to dispose old kernel",n)).finally(()=>this.pendingDisposables.delete(t.kernel)).catch(y)),this.kernelsByUri.delete(e.toString())}};u();var dj=$(zh()),Lr=require("vscode");u();async function tD(r,e){if(!r)return;let t=Fa(r),[n,i]=A0.get(t)||[{resourceType:Al(r),resourceHash:r?await Nt(r.toString()):void 0,kernelSessionId:await Nt(Date.now().toString()),capturedEnvVars:void 0,userExecutedCell:void 0,disableUI:void 0,kernelLanguage:void 0,kernelId:void 0,kernelSpecHash:void 0,isUsingActiveInterpreter:void 0,pythonEnvironmentType:void 0,pythonEnvironmentPath:void 0,pythonEnvironmentVersion:void 0,kernelConnectionType:void 0},{previouslySelectedKernelConnectionId:""}];typeof e.capturedEnvVars=="boolean"&&(n.capturedEnvVars=e.capturedEnvVars),e.userExecutedCell&&(n.userExecutedCell=!0),typeof e.disableUI=="boolean"&&(n.disableUI=e.disableUI);let o=e.kernelConnection;if(o){let s=o.id;i.previouslySelectedKernelConnectionId!==s&&(n.userExecutedCell=e.userExecutedCell,n.disableUI=e.disableUI),i.previouslySelectedKernelConnectionId&&i.previouslySelectedKernelConnectionId!==s&&(n.kernelSessionId=await Nt(Date.now().toString()));let a;switch(o.kind){case"connectToLiveRemoteKernel":a=o.kernelModel.language;break;case"startUsingRemoteKernelSpec":case"startUsingLocalKernelSpec":a=o.kernelSpec.language;break;case"startUsingPythonInterpreter":a=Je;break;default:break}let l="kernelSpec"in o&&o.kernelSpec.specFile?Nt(o.kernelSpec.specFile):Promise.resolve("");n.kernelLanguage=a,[n.kernelId,n.kernelSpecHash]=await Promise.all([Nt(o.id),l]),i.previouslySelectedKernelConnectionId=o.id;let c=o.interpreter;if(c){n.isUsingActiveInterpreter=Wl.isActiveWorkspaceInterpreter(r,c),n.pythonEnvironmentType=zr(c);let[d,p]=await Promise.all([Nt(at(Oc(c.uri))),Cp(c)]);n.pythonEnvironmentPath=d,iW.set(n.pythonEnvironmentPath,c),p?n.pythonEnvironmentVersion=`${p.major}.${p.minor}.${p.micro}`:n.pythonEnvironmentVersion=void 0,oW(n)}n.kernelConnectionType=n.kernelConnectionType||(o==null?void 0:o.kind)}else i.previouslySelectedKernelConnectionId="";A0.set(t,[n,i])}async function Ta(r,e){await tD(r,{kernelConnection:e,userExecutedCell:!0})}var WQ=$(C1());u();var uj="KERNEL_INFO",pIe=1e3*60*60*24*2;async function UQ(r,e,t){var a;let n=[],i={banner:"",help_links:[],implementation:"",implementation_version:"",language_info:{name:"",version:""},protocol_version:"",status:"ok"};if(!r.kernel)return;(a=r.kernel)!=null&&a.info&&(n.push(r.kernel.info),r.kernel.info.then(l=>FQ(t,e,l)).catch(y));let o=r.kernel.requestKernelInfo().then(l=>l==null?void 0:l.content);if(n.push(o),o.then(l=>FQ(t,e,l)).catch(y),e.kind==="connectToLiveRemoteKernel"){let l=fIe(t,e);l?n.push(Promise.resolve(l)):n.push(tc(5e3).then(()=>i))}let s=await Promise.race(n);return s===i?b.warn("Failed to Kernel info in a timely manner, defaulting to empty info!"):b.trace("Got Kernel info"),s}async function FQ(r,e,t){if(!t||!Mt(e))return;let n=r.get(uj,[]).filter(i=>Date.now()-i.age<pIe).filter(i=>i.id!==e.id);n.push({id:e.id,age:Date.now(),info:t}),await r.update(uj,n)}function fIe(r,e){var t;if(Mt(e))return(t=r.get(uj,[]).find(n=>n.id===e.id))==null?void 0:t.info}u();var eA=class extends _i{constructor(e){super("kernelpromisetimeout",C.interruptingKernelFailed,e)}};var tA="e976ee50-99ed-4aba-9b6b-9dcd5634d07d:IPyWidgets:";function oA(r){let e=typeof r=="string"?r:"";return typeof r!="string"&&"content"in r&&"code"in r.content&&typeof r.content.code=="string"&&(e=r.content.code),!e.includes(tA)}function sA(r){var e,t,n,i;return r.status==="dead"||r.status==="terminating"&&!r.disposed&&!r.disposing||!r.disposed&&!r.disposing&&(((e=r.session)==null?void 0:e.status)=="unknown"||((n=(t=r.session)==null?void 0:t.kernel)==null?void 0:n.status)=="unknown")&&(((i=r.session.kernel)==null?void 0:i.isDisposed)||r.session.isDisposed)}function VQ(r){var e,t;return r.status==="dead"||r.status==="terminating"&&!r.isDisposed||!r.isDisposed&&(r.status=="unknown"||((e=r.kernel)==null?void 0:e.status)=="unknown")&&(((t=r.kernel)==null?void 0:t.isDisposed)||r.isDisposed)}var rA=class{constructor(e,t,n,i,o,s,a,l,c){this.id=e;this.uri=t;this.resourceUri=n;this.kernelConnectionMetadata=i;this.sessionCreator=o;this.kernelSettings=s;this.startupCodeProviders=a;this._creator=l;this.workspaceMemento=c;this.disposables=[];this._onIPyWidgetVersionResolved=new Lr.EventEmitter;this._onDidKernelSocketChange=new Lr.EventEmitter;this._onStatusChanged=new Lr.EventEmitter;this._onRestarted=new Lr.EventEmitter;this._onStarted=new Lr.EventEmitter;this._onDisposed=new Lr.EventEmitter;this.hookedSessionForEvents=new WeakSet;this.hooks=new Map;this.startCancellation=new Lr.CancellationTokenSource;this.startupUI=new vr(!0);this.disposables.push(this._onStatusChanged),this.disposables.push(this._onRestarted),this.disposables.push(this._onStarted),this.disposables.push(this._onDisposed),this.disposables.push(this._onIPyWidgetVersionResolved),this.disposables.push(this._onDidKernelSocketChange),tD(this.resourceUri,{kernelConnection:this.kernelConnectionMetadata,actionSource:this.creator,disableUI:this.startupUI.disableUI}).catch(y),this.startupUI.onDidChangeDisableUI(()=>{this.startupUI.disableUI||tD(this.resourceUri,{disableUI:!1}).catch(y)},this.disposables)}get ipywidgetsVersion(){return this._ipywidgetsVersion}get onIPyWidgetVersionResolved(){return this._onIPyWidgetVersionResolved.event}get onStatusChanged(){return this._onStatusChanged.event}get onRestarted(){return this._onRestarted.event}get onStarted(){return this._onStarted.event}get onDisposed(){return this._onDisposed.event}get creator(){return this._creator}get startedAtLeastOnce(){return this._startedAtLeastOnce}get info(){return this._info}get status(){var e,t;return this._jupyterSessionPromise&&!this._session?"starting":(t=(e=this._session)==null?void 0:e.status)!=null?t:this.isKernelDead?"dead":"unknown"}get disposed(){var e;return this._disposed===!0||((e=this._session)==null?void 0:e.isDisposed)===!0}get disposing(){return this._disposing===!0}get onDidKernelSocketChange(){return this._onDidKernelSocketChange.event}get session(){return this._session}get restarting(){return this._restartPromise||Promise.resolve()}addHook(e,t,n,i){let o=this.hooks.get(e)||new Set;this.hooks.set(e,o),t=n?t.bind(n):t,o.add(t);let s={dispose:()=>{o.delete(t)}};return i&&i.push(s),s}async start(e){return this.startCancellation.token.isCancellationRequested&&(this.startCancellation.dispose(),this.startCancellation=new Lr.CancellationTokenSource),this.startJupyterSession(e)}async interrupt(){let e=Promise.all(Array.from(this.hooks.get("willInterrupt")||new Set).map(n=>n()));b.info(`Interrupt requested ${ve(this.resourceUri||this.uri)}`);let t;try{let n=this._jupyterSessionPromise?await this._jupyterSessionPromise.catch(()=>{}):void 0;b.info("Interrupt kernel execution"),n?(t=this._interruptPromise?await this._interruptPromise:await(this._interruptPromise=this.interruptExecution(n,e)),this._interruptPromise=void 0):(b.info("No kernel session to interrupt"),this._interruptPromise=void 0,t="success")}finally{await Promise.all(Array.from(this.hooks.get("interruptCompleted")||new Set).map(n=>n())).catch(y)}if(b.info(`Interrupt requested & sent for ${ve(this.uri)} in notebookEditor.`),t==="timeout"){let n=C.restartKernelAfterInterruptMessage(ct(this.kernelConnectionMetadata)),i=C.restartKernelMessageYes;await Lr.window.showInformationMessage(n,{modal:!0},i)===i&&await this.restart()}}async dispose(){if(b.info(`Dispose Kernel '${ve(this.uri)}' associated with '${ve(this.resourceUri)}'`),this._disposing=!0,this.disposingPromise)return this.disposingPromise;this._ignoreJupyterSessionDisposedErrors=!0,this.startCancellation.cancel();let e=async()=>{let t=[];t.push(Promise.all(Array.from(this.hooks.get("willCancel")||new Set).map(n=>n())).then(y).catch(y)),this._session=this._session?this._session:this._jupyterSessionPromise?await this._jupyterSessionPromise.catch(()=>{}):void 0,this._jupyterSessionPromise=void 0,this._session&&(t.push(Th(this._session,this.disposables)),this._session=void 0),this._disposed=!0,this._onDisposed.fire(),this._onStatusChanged.fire("dead");try{await Promise.all(t)}finally{this.startCancellation.dispose(),fe(this.disposables)}};this.disposingPromise=e(),await this.disposingPromise}async restart(){try{let e=Al(this.resourceUri);b.info(`Restart requested ${ve(this.uri)}`),await Promise.all(Array.from(this.hooks.get("willRestart")||new Set).map(n=>n(this._jupyterSessionPromise))),this.startCancellation.cancel(),this.startCancellation.dispose();let t=new It;try{let n=this._jupyterSessionPromise?await this._jupyterSessionPromise.catch(()=>{}):void 0;n?(this._restartPromise||(this._restartPromise=n.restart(),this._restartPromise.finally(()=>this._restartPromise=void 0).catch(y)),await this._restartPromise,this.startCancellation=new Lr.CancellationTokenSource):await this.start(new vr(!1)),Jr(this.resourceUri,"DATASCIENCE.NOTEBOOK_RESTART",{duration:t.elapsedTime},{resourceType:e})}catch(n){b.error(`Restart failed ${ve(this.uri)}`,n),this._ignoreJupyterSessionDisposedErrors=!0;let i=this._session;throw this._session=void 0,this._jupyterSessionPromise=void 0,Jr(this.resourceUri,"DATASCIENCE.NOTEBOOK_RESTART",{duration:t.elapsedTime},void 0,n),i&&await Th(i,this.disposables),this._ignoreJupyterSessionDisposedErrors=!1,n}await this.initializeAfterStart(this._session),this._onRestarted.fire()}catch(e){throw b.error(`Failed to restart kernel ${ve(this.uri)}`,e),e}finally{Promise.all(Array.from(this.hooks.get("restartCompleted")||new Set).map(e=>e())).catch(y)}}async startJupyterSession(e=new vr(!1)){if(this._startedAtLeastOnce=!0,e.disableUI||(this.startupUI.disableUI=!1),e.onDidChangeDisableUI(()=>{!e.disableUI&&this.startupUI.disableUI&&(this.startupUI.disableUI=!1)},this.disposables),this.startupUI.disableUI&&this.startupUI.onDidChangeDisableUI(()=>{this.disposing||this.disposed||this.startupUI.disableUI||Ta(this.resourceUri,this.kernelConnectionMetadata).catch(y)},this,this.disposables),this.disposing)throw new Lr.CancellationError;if(Od.throwIfCanceled(this.startCancellation.token),!this._jupyterSessionPromise){let t=new It;this._jupyterSessionPromise=this.createJupyterSession();try{let n=await this._jupyterSessionPromise;return Jr(this.resourceUri,"DS_INTERNAL.PERCEIVED_JUPYTER_STARTUP_NOTEBOOK",{duration:t.elapsedTime}),n}catch(n){throw b.ci(`Failed to create Jupyter Session in Kernel.startNotebook for ${ve(this.uri)}`),this.startCancellation.cancel(),this._jupyterSessionPromise=void 0,n}}return this._jupyterSessionPromise}async interruptExecution(e,t){let n=Te(),i=new It,o=[],s=c=>{(c==="restarting"||c==="autorestarting")&&(b.warn("Kernel restarting during interrupt"),n.resolve(!0))},a=(c,d)=>s(d);return e.statusChanged.connect(a),o.push(new Lr.Disposable(()=>Xs(()=>e.statusChanged.disconnect(a)))),e&&e.kernel&&(b.info(`Interrupting kernel: ${e.kernel.name}`),await Uv(this.kernelSettings.interruptTimeout,new eA(this.kernelConnectionMetadata),e.kernel.interrupt()).catch(c=>{b.warn(`Error during interrupt: ${c}`),n.resolve(!0)})),(async()=>{let c=Te();this.status==="busy"&&(this.onDisposed(()=>c.resolve("dead"),this,o),this.onStatusChanged(()=>this.status==="dead"?c.resolve("dead"):void 0,this,o));try{return await ho(this.kernelSettings.interruptTimeout,"timeout",t.then(()=>"success"),n.promise.then(()=>"restart"),c.promise)}catch(d){if(n.completed)return"restart";throw Jr(this.resourceUri,"DATASCIENCE.NOTEBOOK_INTERRUPT",{duration:i.elapsedTime},void 0,d),d}finally{fe(o)}})().then(c=>(Jr(this.resourceUri,"DATASCIENCE.NOTEBOOK_INTERRUPT",{duration:i.elapsedTime},{result:c}),c))}async createJupyterSession(){var i;let e=Lr.workspace.notebookDocuments.find(o=>o.uri.toString()===this.uri.toString()),t=e?(i=Uc(e))==null?void 0:i.jupyterSessionTelemetry():void 0;if(await tD(this.resourceUri,{kernelConnection:this.kernelConnectionMetadata,actionSource:this.creator,userExecutedCell:!this.startupUI.disableUI}),t==null||t.stop(),this.disposing)throw new Lr.CancellationError;Od.throwIfCanceled(this.startCancellation.token);let n=[];try{b.info(`Starting Kernel ${gIe(this,this.startupUI)}`),this.createProgressIndicator(n),this.isKernelDead=!1,this._onStatusChanged.fire("starting");let o=await this.sessionCreator.create({resource:this.resourceUri,ui:this.startupUI,kernelConnection:this.kernelConnectionMetadata,token:this.startCancellation.token,creator:this.creator});if(this.disposing)throw new Lr.CancellationError;if(Od.throwIfCanceled(this.startCancellation.token),await this.initializeAfterStart(o),this.disposing)throw new Lr.CancellationError;return this.sendKernelStartedTelemetry(),this._session=o,this._onStarted.fire(),b.info("Kernel successfully started"),o}catch(o){if(this.startupUI.disableUI?b.trace(`failed to create IJupyterKernelConnectionSession in kernel, UI Disabled = ${this.startupUI.disableUI}`,o):!this.startCancellation.token&&!Ei(o)&&b.error(`failed to create IJupyterKernelConnectionSession in kernel, UI Disabled = ${this.startupUI.disableUI}`,o),Od.throwIfCanceled(this.startCancellation.token),o instanceof Pp)throw o;let s=C.sessionStartFailedWithKernel(ct(this.kernelConnectionMetadata));throw Xn.from(s+" "+("message"in o?o.message:o.toString()),o)}finally{fe(n)}}sendKernelStartedTelemetry(){this.uiWasDisabledWhenKernelStartupTelemetryWasLastSent&&this.uiWasDisabledWhenKernelStartupTelemetryWasLastSent===this.startupUI.disableUI||this.startTelemetrySent&&!this.startupUI.disableUI||(this.uiWasDisabledWhenKernelStartupTelemetryWasLastSent=this.startupUI.disableUI===!0,this.startTelemetrySent=!0,Jr(this.resourceUri,"DATASCIENCE.NOTEBOOK_START",void 0,{disableUI:this.startupUI.disableUI}))}createProgressIndicator(e){let t=Wt.createProgressReporter(this.resourceUri,C.connectingToKernel(ct(this.kernelConnectionMetadata)),this.startupUI.disableUI);e.push(t),this.startupUI.disableUI&&this.startupUI.onDidChangeDisableUI(()=>{this.disposing||this.disposed||this.startupUI.disableUI||t.show&&t.show()},this,e)}async initializeAfterStart(e){var o;let t=Lr.workspace.notebookDocuments.find(s=>s.uri.toString()===this.uri.toString()),n=Uc(t),i=t?n==null?void 0:n.postKernelStartup():void 0;try{if(await Promise.all(Array.from(this.hooks.get("didStart")||new Set).map(l=>l(e,this.startCancellation.token).catch(y))),b.trace(`Started running kernel initialization for ${ve(this.uri)}`),!e){b.trace("Not running kernel initialization");return}if(!this.hookedSessionForEvents.has(e)){this.hookedSessionForEvents.add(e),e.onDidKernelSocketChange(c=>this._onDidKernelSocketChange.fire(c)),e.onDidDispose(()=>{if(b.ci(`Kernel got disposed as a result of session.onDisposed (1) ${ve(this.resourceUri||this.uri)}`),!this._ignoreJupyterSessionDisposedErrors){b.info(`Kernel got disposed as a result of session.onDisposed ${ve(this.resourceUri||this.uri)} & _ignoreJupyterSessionDisposedErrors = false.`);let c=this._session===e;this._jupyterSessionPromise=void 0,this._session=void 0,c&&(this.isKernelDead=!0,this._onStatusChanged.fire("dead"))}});let l=(c,d)=>this._onStatusChanged.fire(d);e.statusChanged.connect(l),this.disposables.push(new Lr.Disposable(()=>Xs(()=>e.statusChanged.disconnect(l))))}if((o=e.kernel)==null||o.registerCommTarget(tt.DefaultCommTarget,y),this.kernelConnectionMetadata.kind==="connectToLiveRemoteKernel")this.determineVersionOfIPyWidgets(e).catch(l=>b.error("Failed to determine IPyWidget version",l)),this.gatherInternalStartupCode().then(l=>this.executeSilently(e,l,{traceErrors:!0,traceErrorsMessage:"Error executing jupyter extension internal startup code"})).catch(l=>b.error("Failed to execute internal startup code",l));else{await this.determineVersionOfIPyWidgets(e);let l=await this.gatherInternalStartupCode();await this.executeSilently(e,l,{traceErrors:!0,traceErrorsMessage:"Error executing jupyter extension internal startup code"}),await this.executeSilently(e,this.getUserStartupCommands(),{traceErrors:!1})}i==null||i.stop();let s=n==null?void 0:n.kernelInfo();try{b.debug("Requesting Kernel info"),this._info=await UQ(e,this.kernelConnectionMetadata,this.workspaceMemento)}catch(l){b.warn("Failed to request KernelInfo",l)}s==null||s.stop();let a=n==null?void 0:n.kernelIdle();this.kernelConnectionMetadata.kind!=="connectToLiveRemoteKernel"&&(b.trace("End running kernel initialization, now waiting for idle"),await e.waitForIdle(this.kernelSettings.launchTimeout,this.startCancellation.token),b.trace("End running kernel initialization, session is idle")),a==null||a.stop()}finally{i==null||i.stop()}}async determineVersionOfIPyWidgets(e){var n;if(!qt(this.kernelConnectionMetadata)){this._ipywidgetsVersion==TE,this._onIPyWidgetVersionResolved.fire(TE);return}let t=async()=>{let i=WQ.default`
        try:
            import ipywidgets as _VSCODE_ipywidgets
            print("${tA}" + _VSCODE_ipywidgets.__version__)
            del _VSCODE_ipywidgets
        except:
            pass
        `,o=await this.executeSilently(e,[i]).catch(s=>b.error("Failed to determine version of IPyWidgets",s));if(Array.isArray(o)){let s=o.some(c=>{var d;return(d=c.text||"")==null?void 0:d.toString().includes(`${tA}8.`)}),a=o.some(c=>{var d;return(d=c.text||"")==null?void 0:d.toString().includes(`${tA}7.`)}),l=this._ipywidgetsVersion=a?7:s?8:void 0;b.trace(`Determined IPyWidgets Version as ${l}`),this._ipywidgetsVersion==l,this._onIPyWidgetVersionResolved.fire(l)}else b.warn("Failed to determine IPyKernel Version",JSON.stringify(o))};if(await t(),!this._ipywidgetsVersion&&((n=this.session)!=null&&n.kernel)){let i=(o,s)=>{var l;if(s.direction==="send")return;let a=s.msg;a.content&&"data"in a.content&&a.content.data&&(a.content.data[go]||"target_name"in a.content&&a.content.target_name===tt.DefaultCommTarget)&&(this._ipywidgetsVersion||(t().catch(y),(l=this.session)!=null&&l.kernel&&this.session.kernel.anyMessage.disconnect(i,this)))};this.session.kernel.anyMessage.connect(i,this)}}async gatherInternalStartupCode(){let e=[],t=await Promise.all(this.startupCodeProviders.sort((n,i)=>i.priority-n.priority).map(n=>n.getCode(this)));for(let n of t)e.push(...n);if(qt(this.kernelConnectionMetadata)&&this.kernelConnectionMetadata.kind!=="connectToLiveRemoteKernel"){let n=at(this.resourceUri);n&&e.push(`__vsc_ipynb_file__ = "${n.replace(/\\/g,"\\\\")}"`),this.kernelSettings.enableExtendedPythonKernelCompletions||e.push(wE.DisableJedi),e.push(...mIe(this.getMatplotLibInitializeCode(),"Failed to initialize matplotlib startup code. Matplotlib might be missing."))}return e}getMatplotLibInitializeCode(){let e=[];if(this.kernelSettings.themeMatplotlibPlots){b.ci(`Initialize config for plots for ${ve(this.resourceUri||this.uri)}`);let t=wE.MatplotLibInit;b.trace(`Initialize matplotlib for ${ve(this.resourceUri||this.uri)}`),e.push(...st(t,{trim:!1}));let n=Lr.window.activeColorTheme.kind===Lr.ColorThemeKind.Dark;e.push(n?"matplotlib.style.use('dark_background')":`matplotlib.rcParams.update(${tt.MatplotLibDefaultParams})`)}return e}getUserStartupCommands(){let e=this.kernelSettings.runStartupCommands;if(Array.isArray(e)&&(e=e.join(`
`)),e){let t=e.replace(/\\n/g,`
`);return st(t,{trim:!1})}return[]}async executeSilently(e,t,n){if(t.join("").trim().length!==0){if(!e.kernel){b.trace(`Not executing startup as there is no session, code: ${t}`);return}return Fi(e.kernel,t.join(`
`),n)}}},nA=class extends rA{get creator(){return"3rdPartyExtension"}constructor(e,t,n,i,o,s,a){super(`3rdPartyKernel_${(0,dj.default)()}`,e,t,n,i,o,s,"3rdPartyExtension",a)}},iA=class extends rA{constructor(t,n,i,o,s,a,l,c){super((0,dj.default)(),n.uri,t,i,o,s,l,"jupyterExtension",c);this.notebook=n;this.controller=a}get creator(){return"jupyterExtension"}};function mIe(r,e){return!r||r.length===0||(r=r.map(t=>`    ${t}`),r.unshift("try:"),r.push("except:",`    print('${e}')`)),r}function gIe(r,e){let t=r.kernelConnectionMetadata.interpreter,n=[];if(t){n.push(`Python Path: ${ve(t.uri)}`),n.push(t?zr(t):"");let i=Ku(t);i&&n.push(`${i.major}.${i.minor}.${i.micro}`)}else(r.kernelConnectionMetadata.kind==="startUsingLocalKernelSpec"||r.kernelConnectionMetadata.kind==="startUsingRemoteKernelSpec")&&n.push(r.kernelConnectionMetadata.kernelSpec.display_name);return`(${n.filter(i=>i).join(", ")}) for '${ve(r.uri)}' (disableUI=${e.disableUI})`}u();function pj(r,e){return{get enableExtendedPythonKernelCompletions(){return r.getSettings(e).enableExtendedPythonKernelCompletions},get interruptTimeout(){return r.getSettings(e).jupyterInterruptTimeout},get launchTimeout(){return r.getSettings(e).jupyterLaunchTimeout},get runStartupCommands(){return r.getSettings(e).runStartupCommands},get themeMatplotlibPlots(){return r.getSettings(e).themeMatplotlibPlots}}}u();var Xh=require("vscode");u();var mj=require("vscode");u();var fj=$(pV()),Rr=require("vscode");u();var aA=$(te()),jQ=require("vscode");var ln=class{static dispose(){fe(ln.disposables)}constructor(e){e.push({dispose:()=>{ln.dispose()}})}activate(){jQ.workspace.onDidChangeNotebookDocument(e=>{hr(e.notebook)&&e.cellChanges.filter(t=>{var n;return((n=t.outputs)==null?void 0:n.length)===0}).map(t=>{var i;let n=ln.cellToDisplayIdMapping.get(t.cell);n&&(ln.cellToDisplayIdMapping.delete(t.cell),(i=ln.displayIdCellOutputMappingPerDocument.get(e.notebook))==null||i.delete(n))})})}static trackOutputByDisplayId(e,t,n,i){let o=ln.displayIdCellOutputMappingPerDocument.get(e.notebook);o||(o=new Map,ln.displayIdCellOutputMappingPerDocument.set(e.notebook,o)),o.set(t,{outputContainer:n,cell:e,outputItems:i}),ln.cellToDisplayIdMapping.set(e,t)}static getMappedOutput(e,t){let n=ln.displayIdCellOutputMappingPerDocument.get(e);if(!n)return;let i=n.get(t);return i!=null&&i.cell.document.isClosed?void 0:i}};ln.displayIdCellOutputMappingPerDocument=new WeakMap,ln.cellToDisplayIdMapping=new WeakMap,ln.disposables=[],ln=E([(0,aA.injectable)(),I(0,(0,aA.inject)(ie))],ln);var SS=new WeakMap;function Jd(r){if(r.parent_header&&"msg_id"in r.parent_header)return r.parent_header.msg_id}var du=class du{constructor(e,t,n,i,o,s,a,l){this.cell=e;this.controller=t;this.context=n;this.formatters=i;this.kernel=o;this.request=s;this._onErrorHandlingIOPubMessage=new Rr.EventEmitter;this.onErrorHandlingExecuteRequestIOPubMessage=this._onErrorHandlingIOPubMessage.event;this.outputsAreSpecificToAWidget=[];this.commIdsMappedToParentWidgetModel=new Map;this.disposables=[];this.prompts=new Set;this.ownedCommIds=new Set;this.commIdsMappedToWidgetOutputModels=new Set;this.ownedRequestMsgIds=new Set;this._completed=Te();this.gotIdleIOPubStatus=!1;this.gotShellReply=!1;this.streamsReAttachedToExecutingCell=!1;this._completed.promise.catch(y),this.executeRequestMessageId=l,this.ownedRequestMsgIds.add(l),Rr.workspace.onDidChangeNotebookDocument(c=>{var p;if(!hr(c.notebook))return;let d=c.cellChanges.find(({cell:f})=>f===this.cell);d&&((p=d.outputs)==null?void 0:p.length)===0&&(this.clearLastUsedStreamOutput(),this.cellHasErrorsInOutput=!1)},this,this.disposables),this.execution=a,this.kernel.anyMessage.connect(this.onKernelAnyMessage,this),this.kernel.iopubMessage.connect(this.onKernelIOPubMessage,this),s&&(s.onIOPub=()=>{this.cell.document.isClosed&&!this.completedExecution&&s.dispose()},s.onReply=c=>{if(this.cell.document.isClosed){s.dispose();return}this.handleReply(c)},s.onStdin=this.handleInputRequest.bind(this),s.done.finally(()=>{this.completedExecution=!0,this.endCellExecution()}).catch(y))}get hasErrorOutput(){return this.cellHasErrorsInOutput===!0}get completed(){return this._completed.promise}dispose(){this.disposed||(this.disposed=!0,nt(this.cell,"Execution Message Handler disposed"),fe(this.disposables),this.prompts.forEach(e=>e.dispose()),this.prompts.clear(),this.request&&this.clearLastUsedStreamOutput(),this.execution=void 0,this.kernel.anyMessage.disconnect(this.onKernelAnyMessage,this),this.kernel.iopubMessage.disconnect(this.onKernelIOPubMessage,this),this._onErrorHandlingIOPubMessage.dispose())}endCellExecution(){this.prompts.forEach(e=>e.dispose()),this.prompts.clear(),this.request&&this.clearLastUsedStreamOutput(),this.execution=void 0,this._completed.resolve()}onKernelAnyMessage(e,{direction:t,msg:n}){if(this.cell.document.isClosed)return this.endCellExecution();let i=oi();if(!this.request&&t==="recv"){let o=Jd(n);i.KernelMessage.isStatusMsg(n)&&n.content.execution_state==="idle"&&o===this.executeRequestMessageId&&(this.gotIdleIOPubStatus=!0),n.channel==="shell"&&o===this.executeRequestMessageId&&(this.gotShellReply=!0);let s=i.KernelMessage.isStatusMsg(n)&&n.content.execution_state!=="idle"&&o!==this.executeRequestMessageId;typeof n.parent_header=="object"&&n.parent_header&&"msg_type"in n.parent_header&&n.parent_header.msg_type;let a=o?o!==this.executeRequestMessageId&&!s:!1,l=typeof n.parent_header=="object"&&n.parent_header&&"msg_type"in n.parent_header&&n.parent_header.msg_type==="interrupt_request",c=this.gotIdleIOPubStatus&&this.gotShellReply,d=["kernel_info_reply","execute_input","execute_reply"],p="msg_type"in n&&typeof n.msg_type=="string"&&d.includes(n.msg_type);if(!this.completedExecution&&c)return this.completedExecution=!0,this.endAbnormallyTimeout&&clearTimeout(this.endAbnormallyTimeout),this.endCellExecution();if(!this.completedExecution&&(p||a)){this.endAbnormallyTimeout&&clearTimeout(this.endAbnormallyTimeout),this.endAbnormallyTimeout=setTimeout(()=>(this.completedExecution=!0,this.endAbnormallyTimeout=void 0,this.endCellExecution()),l?1e3:100),this.disposables.push(new Rr.Disposable(()=>{clearTimeout(this.endAbnormallyTimeout),this.endAbnormallyTimeout=void 0}));return}}t!=="send"||!this.completedExecution||i.KernelMessage.isCommMsgMsg(n)&&this.ownedCommIds.has(n.content.comm_id)&&this.ownedRequestMsgIds.add(n.header.msg_id)}onKernelIOPubMessage(e,t){if(this.cell.document.isClosed)return this.endCellExecution();if(!(!t.parent_header||!("msg_id"in t.parent_header)||!this.ownedRequestMsgIds.has(t.parent_header.msg_id)||t.channel!=="iopub"))try{this.handleIOPub(t)}catch(n){b.error("Failed to handle iopub message as a result of some comm message",t,n),!this.completedExecution&&!this.cell.document.isClosed&&this._onErrorHandlingIOPubMessage.fire(n)}}clearLastUsedStreamOutput(){this.lastUsedStreamOutput=void 0}createTemporaryTask(){var t,n;if(this.cell.document.isClosed)return;let e=SS.get(this.cell.notebook);return e||(this.previousResultsToRestore={...this.cell.executionSummary||{}},this.temporaryExecution=lo.getOrCreate(this.cell,this.controller),(t=this.temporaryExecution)==null||t.start(),(n=this.previousResultsToRestore)!=null&&n.executionOrder&&this.temporaryExecution&&(this.temporaryExecution.executionOrder=this.previousResultsToRestore.executionOrder),this.temporaryExecution)}endTemporaryTask(){var e,t,n;(e=this.previousResultsToRestore)!=null&&e.executionOrder&&this.execution&&(this.execution.executionOrder=this.previousResultsToRestore.executionOrder),this.previousResultsToRestore&&this.temporaryExecution?(this.previousResultsToRestore.executionOrder&&(this.temporaryExecution.executionOrder=this.previousResultsToRestore.executionOrder),this.temporaryExecution.end(this.previousResultsToRestore.success,(t=this.previousResultsToRestore.timing)==null?void 0:t.endTime)):(n=this.temporaryExecution)==null||n.end(void 0),this.previousResultsToRestore=void 0,this.temporaryExecution=void 0}handleIOPub(e){var n;this.startTime||(this.startTime=new Date().getTime(),(n=this.execution)==null||n.start(this.startTime),b.debug(`Kernel acknowledged execution of cell ${this.cell.index} @ ${this.startTime}`));let t=oi();if(t.KernelMessage.isCommOpenMsg(e))this.handleCommOpen(e);else if(t.KernelMessage.isExecuteResultMsg(e))this.handleExecuteResult(e);else if(t.KernelMessage.isExecuteInputMsg(e))this.handleExecuteInput(e);else if(t.KernelMessage.isStatusMsg(e)){let i=e;this.handleStatusMessage(i)}else t.KernelMessage.isStreamMsg(e)?this.handleStreamMessage(e):t.KernelMessage.isDisplayDataMsg(e)?this.handleDisplayData(e):t.KernelMessage.isUpdateDisplayDataMsg(e)?this.handleUpdateDisplayDataMessage(e):t.KernelMessage.isClearOutputMsg(e)?this.handleClearOutput(e):t.KernelMessage.isErrorMsg(e)?this.handleError(e):t.KernelMessage.isCommOpenMsg(e)||(t.KernelMessage.isCommMsgMsg(e)?this.handleCommMsg(e):t.KernelMessage.isCommCloseMsg(e)||b.warn(`Unknown message ${e.header.msg_type} : hasData=${"data"in e.content}`));"execution_count"in e.content&&typeof e.content.execution_count=="number"&&this.execution&&(this.execution.executionOrder=e.content.execution_count)}handleCommOpen(e){var n;this.ownedCommIds.add(e.content.comm_id);let t=((n=e.content.data)==null?void 0:n.state)||void 0;e.content.target_name===tt.DefaultCommTarget&&t&&t._model_module==="@jupyter-widgets/output"&&this.commIdsMappedToWidgetOutputModels.add(e.content.comm_id)}handleCommMsg(e){let t=e.content.data;if(!(!t||t.method!=="update"||typeof t.state!="object")){if("msg_id"in t.state&&typeof t.state.msg_id=="string"){let n="msg_id"in e.parent_header?e.parent_header:void 0;(this.ownedRequestMsgIds.has(e.content.comm_id)||n&&this.ownedRequestMsgIds.has(n.msg_id))&&(t.state.msg_id?this.outputsAreSpecificToAWidget.push({handlingCommId:e.content.comm_id,msgIdsToSwallow:t.state.msg_id}):this.outputsAreSpecificToAWidget.length&&this.outputsAreSpecificToAWidget[this.outputsAreSpecificToAWidget.length-1].handlingCommId===e.content.comm_id&&this.outputsAreSpecificToAWidget.pop())}else if("children"in t.state&&Array.isArray(t.state.children)&&this.ownedCommIds.has(e.content.comm_id)){let n="IPY_MODEL_";t.state.children.forEach(i=>{if(typeof i!="string")return b.warn("Came across a comm update message a child that isn't a string",i);if(!i.startsWith(n))return b.warn(`Came across a comm update message a child that start start with ${n}`,i);let o=i.substring(n.length);this.ownedCommIds.add(o),this.commIdsMappedToParentWidgetModel.set(o,e.content.comm_id)})}}}clearOutputIfNecessary(e){return this.clearOutputOnNextUpdateToOutput?(nt(this.cell,"Clear cell output"),this.clearLastUsedStreamOutput(),e==null||e.clearOutput().then(y,y),this.clearOutputOnNextUpdateToOutput=!1,{previousValueOfClearOutputOnNextUpdateToOutput:!0}):{previousValueOfClearOutputOnNextUpdateToOutput:!1}}addToCellData(e,t){var l,c;if(e.data&&typeof e.data=="object"&&go in e.data){let d=e.data[go];if(d&&this.context.extensionMode===Rr.ExtensionMode.Test&&(d._vsc_test_cellIndex=this.cell.index),d&&"model_id"in d){let p=du.modelIdsOwnedByCells.get(this.cell)||new Set;p.add(d.model_id),du.modelIdsOwnedByCells.set(this.cell,p)}}let n=us(e),i="transient"in e&&typeof e.transient=="object"&&e.transient&&"display_id"in e.transient&&typeof((l=e.transient)==null?void 0:l.display_id)=="string"?(c=e.transient)==null?void 0:c.display_id:void 0;if(this.cell.document.isClosed)return;nt(this.cell,()=>`Update output with mimes ${n.items.map(d=>d.mime).toString()}`);let o=this.execution||this.createTemporaryTask();this.clearOutputIfNecessary(o),i&&ln.trackOutputByDisplayId(this.cell,i,n,n.items),this.clearLastUsedStreamOutput(),nt(this.cell,"Append output in addToCellData");let s=!0,a=Jd(t);if(this.outputsAreSpecificToAWidget.length&&this.outputsAreSpecificToAWidget[this.outputsAreSpecificToAWidget.length-1].msgIdsToSwallow===a&&n.items.every(d=>this.canMimeTypeBeRenderedByWidgetManager(d)))s=!1;else if(this.outputsAreSpecificToAWidget.length&&this.outputsAreSpecificToAWidget[this.outputsAreSpecificToAWidget.length-1].msgIdsToSwallow===a){let d=this.updateJupyterOutputWidgetWithOutput({commId:this.outputsAreSpecificToAWidget[this.outputsAreSpecificToAWidget.length-1].handlingCommId,outputToAppend:n},o);d!=null&&d.outputAdded&&(s=!1)}s&&(o==null||o.appendOutput([n]).then(y,y)),this.endTemporaryTask()}canMimeTypeBeRenderedByWidgetManager(e){let t=e.mime;if(t=="application/vnd.code.notebook.stderr"||t=="application/vnd.code.notebook.stdout"||t=="application/vnd.code.notebook.error")return!0;if(t===go){let n=JSON.parse(new TextDecoder().decode(e.data));return!(typeof n.model_id=="string"&&this.commIdsMappedToWidgetOutputModels.has(n.model_id))}return!t.startsWith("application/vnd")}updateJupyterOutputWidgetWithOutput(e,t){let n=this.outputsAreSpecificToAWidget.length?this.outputsAreSpecificToAWidget[this.outputsAreSpecificToAWidget.length-1].handlingCommId:void 0,i="commId"in e?e.commId:n;if(!i)return;let o="outputToAppend"in e?e.outputToAppend:void 0,s=this.commIdsMappedToParentWidgetModel.get(i)||i,a=this.cell.notebook.getCells().find(v=>{var S;return(S=du.modelIdsOwnedByCells.get(v))==null?void 0:S.has(s)});if(!a){b.warn(`Unable to find a cell that owns the model ${s}`);return}let l=a.outputs.find(v=>v.items.find(S=>{if(S.mime!==go)return!1;try{return JSON.parse(new TextDecoder().decode(S.data)).model_id===s}catch(_){b.warn("Failed to deserialize the widget data",_)}return!1}));if(!l)return;let c=du.outputsOwnedByWidgetModel.get(s)||new Set,p=("clearOutput"in e?e.clearOutput:!1)||(this.outputsAreSpecificToAWidget.length?this.outputsAreSpecificToAWidget[this.outputsAreSpecificToAWidget.length-1].clearOutputOnNextUpdateToOutput===!0:!1);this.outputsAreSpecificToAWidget.length&&(this.outputsAreSpecificToAWidget[this.outputsAreSpecificToAWidget.length-1].clearOutputOnNextUpdateToOutput=!1);let f=a.outputs.slice().filter(v=>p?!c.has(v.id):!0),m=f.slice(0,f.indexOf(l)+1),g=f.slice(f.indexOf(l)+1);du.outputsOwnedByWidgetModel.set(s,c),o&&c.add(o.id);let h=o?m.concat(o).concat(g):m.concat(g);return g.length===0&&o?t==null||t.appendOutput(o,a).then(y,y):p&&!o&&g.length===0||t==null||t.replaceOutput(h,a).then(y,y),{outputAdded:!0}}async handleInputRequest(e){if(e.content&&"prompt"in e.content){let t=new Rr.CancellationTokenSource;this.prompts.add(t);let n=e.content.password!==null&&e.content.password;await Rr.window.showInputBox({prompt:e.content.prompt?e.content.prompt.toString():"",ignoreFocusOut:!0,password:n},t.token).then(i=>{this.kernel.sendInputReply({value:i||"",status:"ok"})},y),this.prompts.delete(t)}}handleExecuteResult(e){this.addToCellData({output_type:"execute_result",data:e.content.data,metadata:e.content.metadata,transient:e.content.transient,execution_count:e.content.execution_count},e)}handleExecuteReply(e){let t=e.content;t.payload&&t.payload.forEach(n=>{n.source&&n.source==="set_next_input"&&"text"in n&&"replace"in n&&this.handleSetNextInput(n),n.data&&n.data.hasOwnProperty("text/plain")&&this.addToCellData({output_type:"stream",text:n.data["text/plain"].toString(),name:"stdout",metadata:{},execution_count:t.execution_count},e)})}handleSetNextInput(e){let t=new Rr.WorkspaceEdit;if(e.replace)t.replace(this.cell.document.uri,new Rr.Range(this.cell.document.lineAt(0).range.start,this.cell.document.lineAt(this.cell.document.lineCount-1).range.end),e.text);else{nt(this.cell,"Create new cell after current");let n=new Rr.NotebookCellData(Rr.NotebookCellKind.Code,e.text,this.cell.document.languageId);n.outputs=[],n.metadata={};let i=Rr.NotebookEdit.insertCells(this.cell.index+1,[n]);t.set(this.cell.notebook.uri,[i])}Rr.workspace.applyEdit(t).then(y,y)}handleExecuteInput(e){e.content.execution_count&&this.execution&&(this.execution.executionOrder=e.content.execution_count)}handleStatusMessage(e){nt(this.cell,`Kernel switching to ${e.content.execution_state}`)}handleStreamMessage(e){var o;if(Jd(e)&&this.outputsAreSpecificToAWidget.length&&this.outputsAreSpecificToAWidget[this.outputsAreSpecificToAWidget.length-1].msgIdsToSwallow==Jd(e))return;nt(this.cell,`Update streamed output, new output '${e.content.text.substring(0,100)}'`);let t=this.execution||this.createTemporaryTask(),n=e.content.name==="stdout"?Rr.NotebookCellOutputItem.stdout("").mime:Rr.NotebookCellOutputItem.stderr("").mime;!this.request&&!this.streamsReAttachedToExecutingCell&&!this.lastUsedStreamOutput&&this.cell.outputs.length&&this.cell.outputs[this.cell.outputs.length-1].items.length>=1&&this.cell.outputs[this.cell.outputs.length-1].items.every(s=>s.mime===n)&&(this.lastUsedStreamOutput={output:this.cell.outputs[0],stream:e.content.name}),this.streamsReAttachedToExecutingCell=!0;let{previousValueOfClearOutputOnNextUpdateToOutput:i}=this.clearOutputIfNecessary(t);if(((o=this.lastUsedStreamOutput)==null?void 0:o.stream)===e.content.name){let s=us({output_type:"stream",name:e.content.name,text:e.content.text});nt(this.cell,`Append output items '${e.content.text.substring(0,100)}`),t==null||t.appendOutputItems(s.items,this.lastUsedStreamOutput.output).then(y,y)}else if(i){let s=Fc(e.content.text),a=us({output_type:"stream",name:e.content.name,text:s});this.lastUsedStreamOutput={output:a,stream:e.content.name},nt(this.cell,`Replace output with '${s.substring(0,100)}'`),t==null||t.replaceOutput([a]).then(y,y)}else{let s=gG(Fc(e.content.text)),a=us({output_type:"stream",name:e.content.name,text:s});this.lastUsedStreamOutput={output:a,stream:e.content.name},nt(this.cell,`Append new output '${s.substring(0,100)}'`),t==null||t.appendOutput([a]).then(y,y)}this.endTemporaryTask()}handleDisplayData(e){let t={output_type:"display_data",data:Rx(e.content.data),metadata:e.content.metadata,transient:e.content.transient};this.addToCellData(t,e)}handleClearOutput(e){if(this.outputsAreSpecificToAWidget.length&&this.outputsAreSpecificToAWidget[this.outputsAreSpecificToAWidget.length-1].msgIdsToSwallow===Jd(e)){if(e.content.wait)this.outputsAreSpecificToAWidget.length&&(this.outputsAreSpecificToAWidget[this.outputsAreSpecificToAWidget.length-1].clearOutputOnNextUpdateToOutput=!0);else{let t=this.execution||this.createTemporaryTask();this.updateJupyterOutputWidgetWithOutput({clearOutput:!0},t),this.endTemporaryTask()}return}if(e.content.wait)this.clearOutputOnNextUpdateToOutput=!0;else{let t=this.execution||this.createTemporaryTask();this.clearLastUsedStreamOutput(),t==null||t.clearOutput().then(y,y),this.endTemporaryTask()}}handleError(e){let t=e.content.traceback;b.ci(`Traceback for error ${t}`),this.formatters.forEach(i=>{t=i.format(this.cell,t)}),b.ci(`Traceback for error after formatting ${t}`);let n={output_type:"error",ename:e.content.ename,evalue:e.content.evalue,traceback:t};if(this.cell.notebook.notebookType!=="interactive"){let i=lo.get(this.cell);i&&e.content.ename!=="KeyboardInterrupt"&&(i.errorInfo={message:`${e.content.ename}: ${e.content.evalue}`,location:P$(e.content.traceback,this.cell),uri:this.cell.document.uri,stack:e.content.traceback.join(`
`)})}this.addToCellData(n,e),this.cellHasErrorsInOutput=!0}handleReply(e){oi().KernelMessage.isExecuteReplyMsg(e)&&(this.handleExecuteReply(e),"execution_count"in e.content&&typeof e.content.execution_count=="number"&&this.execution&&(this.execution.executionOrder=e.content.execution_count))}handleUpdateDisplayDataMessage(e){let t=e.content.transient.display_id;if(!t){b.warn("Update display data message received, but no display id",e.content);return}let n=ln.getMappedOutput(this.cell.notebook,t);if(!n){b.trace("Update display data message received, but no output found to update",e.content);return}if(n.cell.document.isClosed){b.warn("Update display data message received, but output cell is closed",e.content);return}let i=gV(new Rr.NotebookCellOutput(n.outputItems,n.outputContainer.metadata)),o=us({...i,data:e.content.data,metadata:e.content.metadata});if(n.outputItems.length===0&&o.items.length===0){b.trace("Update display data message received, but no output to update",e.content);return}let s=!1;if(n.outputItems.length===o.items.length){let l=!0;if((0,fj.default)(n.outputContainer.metadata||{},o.metadata||{})||(s=!0,l=!1),l){for(let c=0;c<n.outputItems.length;c++)if(!(0,fj.default)(n.outputItems[c],o.items[c])){l=!1;break}}if(l){b.trace("Update display data message received, but no output to update (data is the same)",e.content);return}}let a=this.execution||this.createTemporaryTask();if(nt(this.cell,`Replace output items in display data ${o.items.length}`),s){let l=n.cell.outputs.map(c=>{let d=gV(c);return d.output_type==="display_data"&&"transient"in d&&d.transient&&typeof d.transient=="object"&&"display_id"in d.transient&&typeof d.transient.display_id=="string"&&d.transient.display_id===t?o:c});a==null||a.replaceOutput(l,n.cell).then(y,y),ln.trackOutputByDisplayId(n.cell,t,o,o.items)}else a==null||a.replaceOutputItems(o.items,n.outputContainer).then(y,y),ln.trackOutputByDisplayId(n.cell,t,n.outputContainer,o.items);this.endTemporaryTask()}};du.modelIdsOwnedByCells=new WeakMap,du.outputsOwnedByWidgetModel=new Map,E([yn()],du.prototype,"handleReply",1);var rD=du;u();var am=class extends Error{constructor(t){super(t.evalue||t.ename);this.ename=t.ename,this.evalue=t.evalue,this.traceback=t.traceback}};var lA=class{constructor(e,t){this.controller=e;this.requestListener=t}create(e,t,n,i){return gj.fromCell(e,t,n,this.controller,this.requestListener,i)}},gj=class r{constructor(e,t,n,i,o,s){this.cell=e;this.codeOverride=t;this.kernelConnection=n;this.controller=i;this.requestListener=o;this.resumeExecution=s;this.type="cell";this._result=Te();this.cancelHandled=!1;this.disposables=[];if(mj.workspace.onDidCloseTextDocument(a=>{var l;if(a===this.cell.document){b.info(`Disposing request as the cell (${this.cell.index}) was deleted ${ve(this.cell.notebook.uri)}`);try{(l=this.request)==null||l.dispose()}catch(c){b.error(`Error during cell execution dispose: ${c}`)}this.started&&!this._completed&&this.completedDueToCancellation()}},this,this.disposables),this.canExecuteCell())this.execution=lo.getOrCreate(e,this.controller,!(s!=null&&s.msg_id)),Wf.setCellState(e,2);else{let a=lo.get(e);a&&(a.start(),a.end(void 0))}}get result(){return this._result.promise}get executionOrder(){return this._executionOrder}static fromCell(e,t,n,i,o,s){return new r(e,t,n,i,o,s)}async start(e){var t,n,i,o;if(this.session=e,(t=this.resumeExecution)!=null&&t.msg_id)return this.resume(e,this.resumeExecution);if(this.cancelHandled){nt(this.cell,"Not starting as it was cancelled");return}if(nt(this.cell,"Start execution"),b.ci(`Cell Exec contents ${this.cell.document.getText().substring(0,50)}...`),!this.canExecuteCell()){(n=this.execution)==null||n.end(void 0),this.execution=void 0,this._result.resolve();return}return e.kind==="remoteJupyter"&&e.status==="unknown"&&(!e.kernel||e.kernel.isDisposed||e.isDisposed)?((i=this.execution)==null||i.start(),(o=this.execution)==null||o.clearOutput().then(y,y),this.completedWithErrors(new tn),this.result):this.started?(nt(this.cell,"Cell has already been started yet CellExecution.Start invoked again"),b.error(`Cell has already been started yet CellExecution.Start invoked again ${this.cell.index}`),this.result):(this.started=!0,SS.set(this.cell.notebook,this.execution),Wf.setCellState(this.cell,3),this.execute(this.codeOverride||this.cell.document.getText().replace(/\r\n/g,`
`),e).catch(s=>this.completedWithErrors(s)).catch(y),this.result)}async resume(e,t){var n,i;if(this.cancelHandled){nt(this.cell,"Not resuming as it was cancelled");return}if(!e.kernel)throw new Error("Kernel not available to resume execution");if(nt(this.cell,"Start resuming execution"),b.ci(`Cell Exec (resuming) contents ${this.cell.document.getText().substring(0,50)}...`),!this.canExecuteCell()){(n=this.execution)==null||n.end(void 0),this.execution=void 0,this._result.resolve();return}return this.started?(b.error(`Cell has already been started yet CellExecution.resume invoked again ${this.cell.index}`),this.result):(this.started=!0,SS.set(this.cell.notebook,this.execution),(i=this.execution)==null||i.start(t.startTime),t.executionCount&&this.execution&&(this.execution.executionOrder=t.executionCount),Wf.setCellState(this.cell,3),this.cellExecutionHandler=this.requestListener.registerListenerForResumingExecution(this.cell,{kernel:e.kernel,cellExecution:this.execution,msg_id:t.msg_id}),this.cellExecutionHandler.onErrorHandlingExecuteRequestIOPubMessage(o=>{b.error(`Cell (index = ${this.cell.index}) execution completed with errors (2).`,o),this.completedWithErrors(o.error)},this,this.disposables),this.cellExecutionHandler.completed.finally(()=>this.completedSuccessfully()).catch(y),this.result)}async cancel(e=!1){var t;if(!this.cancelHandled){if(this.cancelRequested=!0,this.started&&!e&&((t=this.execution)!=null&&t.started)){nt(this.cell,"Cell is already running, waiting for it to finish or kernel to start"),await this.result.catch(y);return}this.cancelHandled||this._completed||(nt(this.cell,"Execution cancelled"),this.cancelHandled=!0,this.completedDueToCancellation(),this.dispose())}}dispose(){this.disposed||(this.disposed=!0,nt(this.cell,"Execution disposed"),fe(this.disposables))}completedWithErrors(e,t,n=!0){var i,o;if(!this.cancelHandled){if(!this.disposed&&!this.cancelRequested?b.warn("Cell completed with errors",e):b.warn(`Cell completed with errors (${this.disposed?"disposed":"cancelled"})`),nt(this.cell,"Completed with errors"),n){let s,a;if(e&&!(e instanceof it)&&((i=e.message)!=null&&i.includes("Canceled future for execute_request message before replies were done"))&&this.session&&VQ(this.session)&&(e=new tn),e)if(!(e instanceof it))s=e.message||e.name||e.stack;else{let l=Km(mj.workspace.workspaceFolders||[],e,ct(this.kernelConnection),MH(this.kernelConnection.interpreter));s=l==null?void 0:l.message}a=fy(s||""),a&&((o=this.execution)==null||o.appendOutput(a).then(y,y))}this.endCellTask("failed",t),nt(this.cell,"Completed with errors, & resolving"),this._result.reject(e)}}get isEmptyCodeCell(){return this.cell.document.getText().trim().length===0}completedSuccessfully(e){nt(this.cell,"Completed successfully");let t="success";this.endCellTask("success",e),nt(this.cell,`Completed successfully & resolving with status = ${t}`),this._result.resolve()}endCellTask(e,t=new Date().getTime()){var n,i,o,s,a;if(!this._completed){if(this._completed=!0,this.isEmptyCodeCell)this.execution&&(this.execution.executionOrder=void 0),(n=this.execution)==null||n.end(void 0);else if(e==="success"||e==="failed")this.endTime=t,(i=this.execution)==null||i.end(e==="success",this.endTime);else{try{(o=this.request)==null||o.dispose()}catch(l){}(s=this.execution)==null||s.end(void 0)}SS.get(this.cell.notebook)===this.execution&&SS.set(this.cell.notebook,void 0),this._executionOrder=(a=this.execution)==null?void 0:a.executionOrder,Wf.setCellState(this.cell,1),this.execution=void 0}}completedDueToCancellation(){nt(this.cell,"Completed due to cancellation"),this.endCellTask("cancelled"),nt(this.cell,"Cell cancelled & resolving"),this._result.resolve()}canExecuteCell(){return this.cell.document.languageId==="raw"?!1:!this.cell.document.isClosed}async execute(e,t){var o,s,a,l;if(!t.kernel)throw new Error("No kernel available to execute code");if(nt(this.cell,"Send code for execution"),e.trim().length===0||this.cell.document.isClosed)return e.trim().length===0&&((s=this.execution)==null||s.start((o=this.resumeExecution)==null?void 0:o.startTime),(l=(a=this.execution)==null?void 0:a.clearOutput())==null||l.then(y,y)),nt(this.cell,"Empty cell execution"),this.completedSuccessfully();let n={cellId:this.cell.document.uri.toString(),...Tf(this.cell).metadata},i=t.kernel;try{Mr.changeCellState(this.cell,3),b.trace(`Cell Index:${this.cell.index} sent to kernel`),this.request=i.requestExecute({code:e,silent:!1,stop_on_error:!1,allow_stdin:!0,store_history:!0},!1,n),this.request.done.then(y,y)}catch(c){return b.error(`Cell execution failed without request, for cell Index ${this.cell.index}`,c),this.completedWithErrors(c)}this.cellExecutionHandler=this.requestListener.registerListenerForExecution(this.cell,{kernel:i,cellExecution:this.execution,request:this.request}),this.cellExecutionHandler.onErrorHandlingExecuteRequestIOPubMessage(c=>{b.error(`Cell (index = ${this.cell.index}) execution completed with errors (2).`,c),this.completedWithErrors(c.error)},this,this.disposables);try{nt(this.cell,"Wait for jupyter execution");let c=await this.request.done,d=new Date().getTime();nt(this.cell,"Jupyter execution completed"),c.content.status==="error"?this.completedWithErrors(new am(c.content),d,!1):this.completedSuccessfully(d),nt(this.cell,"Executed successfully in executeCell")}catch(c){if(this.cancelHandled)return;!this.disposed&&!this.cancelRequested&&b.error("Error in waiting for cell to complete",c),nt(this.cell,"Some other execution error"),c&&c instanceof Error&&Ei(c,!0)?this.completedWithErrors({message:c.message}):this.completedWithErrors(c)}}};u();var BQ=require("vscode");var cA=class{constructor(e,t,n,i){this.controller=e;this.context=t;this.formatters=n;this.notebook=i;this.disposables=[];this.messageHandlers=new WeakMap;BQ.workspace.onDidChangeNotebookDocument(o=>{o.notebook===this.notebook&&o.contentChanges.forEach(s=>s.removedCells.forEach(a=>{var l;return(l=this.messageHandlers.get(a))==null?void 0:l.dispose()}))},this,this.disposables)}dispose(){fe(this.disposables),this.notebook&&this.notebook.getCells().forEach(e=>{var t;return(t=this.messageHandlers.get(e))==null?void 0:t.dispose()})}registerListenerForExecution(e,t){var i;(i=this.messageHandlers.get(e))==null||i.dispose();let n=new rD(e,this.controller,this.context,this.formatters,t.kernel,t.request,t.cellExecution,t.request.msg.header.msg_id);return this.messageHandlers.set(e,n),n}registerListenerForResumingExecution(e,t){var i;(i=this.messageHandlers.get(e))==null||i.dispose();let n=new rD(e,this.controller,this.context,this.formatters,t.kernel,void 0,t.cellExecution,t.msg_id);return this.messageHandlers.set(e,n),n}};u();u();var uA=require("vscode");function pu(r,e,t){r!==Ge&&b.trace(`Execution Id:${e}. ${t}.`)}var HQ=new Map,_S=class r{constructor(e,t){this.code=e;this.extensionId=t;this.type="code";this._onDidEmitOutput=new uA.EventEmitter;this.onDidEmitOutput=this._onDidEmitOutput.event;this._onRequestSent=new uA.EventEmitter;this.onRequestSent=this._onRequestSent.event;this._onRequestAcknowledge=new uA.EventEmitter;this.onRequestAcknowledged=this._onRequestAcknowledge.event;this._done=Te();this.cancelHandled=!1;this.disposables=[];let n=HQ.get(t)||0;n+=1,HQ.set(t,n),this.executionId=`${t}-${n}`,this.disposables.push(this._onDidEmitOutput)}get done(){return this._done.promise}get result(){return this._done.promise}static fromCode(e,t){return new r(e,t)}async start(e){if(this.session=e,this.cancelHandled){pu(this.extensionId,this.executionId,"Not starting as it was cancelled");return}if(pu(this.extensionId,this.executionId,"Start Code execution"),b.ci(`Code Exec contents ${this.code.substring(0,50)}...`),!e.kernel||e.kernel.isDisposed||e.isDisposed){this._done.reject(new tn);return}if(this.started)return pu(this.extensionId,this.executionId,"Code has already been started yet CodeExecution.Start invoked again"),b.error(`Code has already been started yet CodeExecution.Start invoked again ${this.executionId}`),this.done;await this.execute(this.code.replace(/\r\n/g,`
`),e).catch(y)}async cancel(){var e,t,n;if(!(this.cancelHandled||this._completed)){if(this.cancelRequested=!0,this.started){pu(this.extensionId,this.executionId,"Code is already running, interrupting and waiting for it to finish or kernel to start");let i=(e=this.session)==null?void 0:e.kernel;i&&this.extensionId!==Ge&&await i.interrupt().catch(y),(t=this.request)==null||t.dispose(),await((n=this.request)==null?void 0:n.done.catch(y))}this.cancelHandled||this._completed||(pu(this.extensionId,this.executionId,"Execution cancelled"),this.cancelHandled=!0,this._done.resolve(),this.dispose())}}dispose(){this.disposed||(this.disposed=!0,this._completed||pu(this.extensionId,this.executionId,"Execution disposed"),fe(this.disposables))}async execute(e,t){if(!t.kernel){let i=new Error("No kernel available to execute code");throw this._done.resolve(),i}pu(this.extensionId,this.executionId,"Send code for execution");let n=t.kernel;try{this.started=!0,this._onRequestSent.fire(),pu(this.extensionId,this.executionId,"Execution Request Sent to Kernel"),this.request=L$(n,e,()=>this._onRequestAcknowledge.fire(),i=>this._onDidEmitOutput.fire(i)),this.request.done.then(y,y)}catch(i){b.error(`Code execution failed without request, for exec ${this.executionId}`,i),this._completed=!0,this._done.reject(i);return}try{let i=await this.request.done;this._completed=!0,i.content.status==="error"?(pu(this.extensionId,this.executionId,"Executed with errors"),this._done.reject(new am(i.content))):(pu(this.extensionId,this.executionId,"Executed successfully"),this._done.resolve())}catch(i){if(this._completed=!0,this.cancelHandled)return;!this.disposed&&!this.cancelRequested&&b.error(`Error in waiting for code ${this.executionId} to complete`,i),this._done.reject(i)}}};var dA=class{constructor(e,t,n,i){this.session=e;this.executionFactory=t;this.metadata=n;this.resourceUri=i;this.queueOfItemsToExecute=[];this.cancelledOrCompletedWithErrors=!1;this.startedRunningCells=!1;this.disposables=[]}get queueOfCellsToExecute(){return this.queueOfItemsToExecute.filter(e=>e.type==="cell").map(e=>e)}get isEmpty(){return this.queueOfItemsToExecute.length===0}get failed(){return this.cancelledOrCompletedWithErrors}get queue(){return this.queueOfCellsToExecute.map(e=>e.cell)}dispose(){var e;this.disposables.forEach(t=>t.dispose()),(e=this.lastCellExecution)==null||e.dispose()}queueCell(e,t){this.enqueue({cell:e,codeOverride:t})}queueCode(e,t,n){return this.enqueue({code:e,extensionId:t,token:n})}enqueue(e){let t;if("cell"in e){let{cell:n,codeOverride:i}=e,o=this.queueOfCellsToExecute.find(a=>a.cell===n);if(o)return nt(n,"Use existing cell execution"),o;let s=this.executionFactory.create(n,i,this.metadata);t=s,this.disposables.push(s),this.queueOfItemsToExecute.push(s),nt(n,"User queued cell for execution")}else{let{code:n,extensionId:i,token:o}=e,s=_S.fromCode(n,i);t=s,this.disposables.push(s),this.queueOfItemsToExecute.push(s),this.disposables.push(xh(o.onCancellationRequested)(()=>s.cancel()))}return this.startExecutingCells(),t}resumeCell(e,t){if(this.queueOfCellsToExecute.find(o=>o.cell===e)){nt(e,"Use existing cell execution");return}let i=this.executionFactory.create(e,"",this.metadata,t);this.disposables.push(i),this.queueOfItemsToExecute.push(i),nt(e,"User queued cell for execution"),this.startExecutingCells()}async cancel(e){var t;this.cancelledOrCompletedWithErrors=!0,b.debug("Cancel pending cells"),await Promise.all(this.queueOfItemsToExecute.map(n=>n.cancel(e))),(t=this.lastCellExecution)==null||t.dispose(),this.queueOfItemsToExecute.splice(0,this.queueOfItemsToExecute.length)}async cancelQueuedCells(){var e,t;this.cancelledOrCompletedWithErrors=!0,b.debug("Cancel pending cells"),await Promise.all(this.queueOfCellsToExecute.map(n=>n.cancel())),((e=this.lastCellExecution)==null?void 0:e.type)==="cell"&&((t=this.lastCellExecution)==null||t.dispose()),this.queueOfItemsToExecute.push(...this.queueOfItemsToExecute.filter(n=>n.type==="code"))}async waitForCompletion(e){let t=e?this.queueOfCellsToExecute.filter(n=>e===n.cell):this.queueOfItemsToExecute;await Promise.all(t.map(n=>n.result))}startExecutingCells(){this.startedRunningCells||this.start().catch(y),this.startedRunningCells=!0}async start(){try{await this.executeQueuedCells()}catch(e){b.error("Failed to execute cells in CellExecutionQueue",e),this.cancelledOrCompletedWithErrors=!0,await this.cancelQueuedCells()}}async executeQueuedCells(){var n,i,o;let e,t=await this.session;for(this.queueOfItemsToExecute.forEach(s=>s.type==="cell"&&nt(s.cell,"Ready to execute"));this.queueOfItemsToExecute.length;){(n=this.lastCellExecution)==null||n.dispose();let s=this.queueOfItemsToExecute[0];this.lastCellExecution=s,s.type==="cell"&&nt(s.cell,"Before Execute individual cell");let a=!0;try{s.type==="cell"&&s.cell.notebook.isClosed?e=!0:s.type==="cell"&&this.cancelledOrCompletedWithErrors||(a=await s.start(t).then(()=>!0).catch(()=>!1))}finally{s.type==="cell"&&nt(s.cell,`After Execute individual cell ${a}`);let c=this.queueOfItemsToExecute.indexOf(s);c>=0&&this.queueOfItemsToExecute.splice(c,1),s.type==="cell"&&Mr.changeCellState(s.cell,1,s.executionOrder)}let l=!1;if(s.type==="cell"&&((o=(i=Tf(s.cell).metadata)==null?void 0:i.tags)!=null&&o.includes("raises-exception"))&&(l=!0),e||this.cancelledOrCompletedWithErrors||!a&&!l){this.cancelledOrCompletedWithErrors=!0;let c=[];if(this.cancelledOrCompletedWithErrors&&c.push("cancellation or failure in execution"),e&&c.push("Notebook being closed"),typeof a=="number"&&!a&&c.push("failure in cell execution"),c.length===0&&c.push("an unknown reason"),this.queueOfCellsToExecute.length>0&&this.queueOfCellsToExecute.length===this.queueOfItemsToExecute.length){b.warn(`Cancel all remaining cells due to ${c.join(" or ")}`),await this.cancel();break}else if(this.queueOfCellsToExecute.length>0&&this.queueOfCellsToExecute.length!==this.queueOfItemsToExecute.length)b.warn(`Cancel all remaining cells due to ${c.join(" or ")}`),await this.cancelQueuedCells();else if(e){b.warn(`Cancel all remaining cells due to ${c.join(" or ")}`),await this.cancel();break}}if(t.status==="dead"||t.status==="terminating"){this.cancelledOrCompletedWithErrors=!0,b.warn("Cancel all remaining cells due to dead kernel"),await this.cancel();break}}}};var pA=class{constructor(e,t,n,i){this.kernel=e;this.notebook=i;this.disposables=[];this._visibleExecutionCount=0;this.documentExecutions=new WeakMap;this._onDidReceiveDisplayUpdate=new Xh.EventEmitter;this.onDidReceiveDisplayUpdate=this._onDidReceiveDisplayUpdate.event;this.hookedSesions=new WeakSet;let o=new cA(e.controller,t,n,i);this.disposables.push(o),this.executionFactory=new lA(e.controller,o),Mr.onDidChangeNotebookCellExecutionState(s=>{var a;s.cell.notebook===e.notebook&&s.state===1&&((a=s.cell.executionSummary)!=null&&a.executionOrder)&&(this._visibleExecutionCount=Math.max(this._visibleExecutionCount,s.cell.executionSummary.executionOrder))}),e.onRestarted(()=>this._visibleExecutionCount=0,this,this.disposables),e.onStarted(()=>this._visibleExecutionCount=0,this,this.disposables),e.addHook("willInterrupt",this.onWillInterrupt,this,this.disposables),e.addHook("willCancel",this.onWillCancel,this,this.disposables),e.addHook("willRestart",s=>this.onWillRestart(s),this,this.disposables),e.onStatusChanged(this.hookupIOPubHandler,this,this.disposables),e.onRestarted(this.hookupIOPubHandler,this,this.disposables),this.hookupIOPubHandler()}get executionCount(){return this._visibleExecutionCount}hookupIOPubHandler(){let e=this.kernel.session;if(!e||this.hookedSesions.has(e))return;this.hookedSesions.add(e);let t=(n,i)=>{var l;if(i.header.msg_type!=="update_display_data"&&i.header.msg_type!=="display_data")return;let o=i,s=(l=o.content.transient)==null?void 0:l.display_id;if(!s||!U$(e,s))return;let a=us({output_type:"display_data",data:o.content.data,metadata:o.content.metadata,transient:o.content.transient});this._onDidReceiveDisplayUpdate.fire(a)};e.iopubMessage.connect(t),this.disposables.push({dispose:()=>{e==null||e.iopubMessage.disconnect(t)}})}get pendingCells(){var e;return((e=this.documentExecutions.get(this.notebook))==null?void 0:e.queue)||[]}async resumeCellExecution(e,t){if(nt(e,`NotebookKernelExecution.resumeCellExecution (start), ${ve(e.notebook.uri)}`),e.kind==Xh.NotebookCellKind.Markup)return;await Ta(this.kernel.resourceUri,this.kernel.kernelConnectionMetadata),Jr(this.kernel.resourceUri,"DATASCIENCE.RESUME_EXECUTE_CELL");let n=this.kernel.start(new vr(!1)),i=this.getOrCreateCellExecutionQueue(e.notebook,n);i.resumeCell(e,t);let o=await i.waitForCompletion(e).then(()=>!0).catch(()=>!1);nt(e,`NotebookKernelExecution.resumeCellExecution (completed), ${ve(e.notebook.uri)}`),b.trace(`Cell ${e.index} executed ${o?"successfully":"with an error"}`)}async executeCell(e,t){nt(e,`NotebookKernelExecution.executeCell (1), ${ve(e.notebook.uri)}`);let n=new It;if(e.kind==Xh.NotebookCellKind.Markup)return;nt(e,`NotebookKernelExecution.executeCell, ${ve(e.notebook.uri)}`),await Ta(this.kernel.resourceUri,this.kernel.kernelConnectionMetadata);let i=this.kernel.start(new vr(!1));await this.kernel.restarting,nt(e,`NotebookKernelExecution.executeCell (2), ${ve(e.notebook.uri)}`);let o=this.getOrCreateCellExecutionQueue(e.notebook,i);o.queueCell(e,t);let s=!0;try{await o.waitForCompletion(e)}catch(a){throw s=!1,a}finally{nt(e,`NotebookKernelExecution.executeCell completed (3), ${ve(e.notebook.uri)}`),b.trace(`Cell ${e.index} executed ${s?"successfully":"with an error"}`),Jr(this.kernel.resourceUri,"DATASCIENCE.EXECUTE_CELL",{duration:n.elapsedTime})}}async*executeCode(e,t,n,i){let o=new It;await Ta(this.kernel.resourceUri,this.kernel.kernelConnectionMetadata);let s=this.kernel.start(new vr(!1));await this.kernel.restarting;let a=this.getOrCreateCellExecutionQueue(this.notebook,s),l;t===Ge?(l=_S.fromCode(e,t),s.then(g=>l.start(g))):l=a.queueCode(e,t,i),t!==Ge&&b.trace(`Queue code ${l.executionId} from ${t} after ${o.elapsedTime}ms:
${e}`);let c=!1,d=[];l.result.finally(()=>{c=!0,!i.isCancellationRequested&&b.debug(`Execution of code ${l.executionId} completed in ${o.elapsedTime}ms`),t!==Ge&&Jr(this.kernel.resourceUri,"DATASCIENCE.EXECUTE_CODE",{duration:o.elapsedTime},{extensionId:t}),fe(d)}).catch(y);let p=Ru(l.result),f=[],m=Te();for(d.push(l.onRequestSent(()=>n.started.fire())),d.push(l.onRequestAcknowledged(()=>n.executionAcknowledged.fire())),l.onDidEmitOutput(g=>{f.push(g),m.resolve(),m=Te()},this,d),i.onCancellationRequested(()=>{c||b.debug(`Code execution cancelled by extension ${t}`)},this,d);;){await Promise.race([m.promise,p.promise]),c&&(m=Te());let g=this.kernel.session;for(;f.length;){let h=f.shift();g&&UR(t,g,h),yield h}if(p.completed)break}}executeHidden(e){return this.kernel.start().then(n=>n.kernel?Fi(n.kernel,e):Promise.reject(new tn))}async onWillInterrupt(){let e=this.documentExecutions.get(this.notebook);!e&&this.kernel.kernelConnectionMetadata.kind!=="connectToLiveRemoteKernel"||(b.info("Interrupt kernel execution"),e&&(await e.cancel(),await e.waitForCompletion().catch(y)))}async onWillCancel(){let e=this.documentExecutions.get(this.notebook);e&&await e.cancel(!0)}async onWillRestart(e){let t=this.documentExecutions.get(this.notebook),n=e?await e.catch(()=>{}):void 0,i=t?t.cancel(!0).then(()=>t.waitForCompletion().catch(y)):Promise.resolve();n||(b.info("No kernel session to interrupt"),await i)}getOrCreateCellExecutionQueue(e,t){let n=this.documentExecutions.get(e);if(n&&!n.isEmpty&&!n.failed)return n;let i=new dA(t,this.executionFactory,this.kernel.kernelConnectionMetadata,this.kernel.resourceUri);return this.disposables.push(i),Xh.workspace.onDidCloseNotebookDocument(async o=>{o===e&&(b.debug(`Cancel executions after closing notebook ${ve(o.uri)}`),(!i.failed||!i.isEmpty)&&await i.cancel(!0))},this,this.disposables),this.documentExecutions.set(e,i),i}};var ES=class extends X1{constructor(t,n,i,o,s,a,l,c,d){super(t,n);this.sessionCreator=i;this.configService=o;this.context=s;this.formatters=l;this.startupCodeProviders=c;this.workspaceStorage=d;n.push(a.onDidRemove(this.handleServerRemoval.bind(this)))}getOrCreate(t,n){var c;let i=this.getInternal(t);if(i&&i.options.metadata.id===n.metadata.id)return i.kernel;this.disposeOldKernel(t);let o=(t==null?void 0:t.notebookType)===ht?n.resourceUri:t.uri,s=pj(this.configService,o),a=t.uri.path.endsWith(".interactive")||(c=n.resourceUri)!=null&&c.path.endsWith(".interactive")?ht:bt,l=new iA(o,t,n.metadata,this.sessionCreator,s,n.controller,this.startupCodeProviders.getProviders(a),this.workspaceStorage);return l.onRestarted(()=>this._onDidRestartKernel.fire(l),this,this.disposables),l.onDisposed(()=>this._onDidDisposeKernel.fire(l),this,this.disposables),l.onStarted(()=>this._onDidStartKernel.fire(l),this,this.disposables),l.onStatusChanged(d=>this._onKernelStatusChanged.fire({kernel:l,status:d}),this,this.disposables),this.executions.set(l,new pA(l,this.context,this.formatters,t)),this.asyncDisposables.push(l),this.storeKernel(t,n,l),this.deleteMappingIfKernelIsDisposed(l),l}};ES=E([(0,hn.injectable)(),I(0,(0,hn.inject)(Ha)),I(1,(0,hn.inject)(ie)),I(2,(0,hn.inject)(Nx)),I(3,(0,hn.inject)(Ae)),I(4,(0,hn.inject)(ot)),I(5,(0,hn.inject)(fr)),I(6,(0,hn.multiInject)(vI)),I(7,(0,hn.inject)(Ad)),I(8,(0,hn.inject)(St)),I(8,(0,hn.named)(Es))],ES);var CS=class extends Z1{constructor(t,n,i,o,s,a){super(t,n);this.sessionCreator=i;this.configService=o;this.startupCodeProviders=s;this.workspaceStorage=a}getOrCreate(t,n){var c;let i=this.getInternal(t);if(i&&i.options.metadata.id===n.metadata.id)return i.kernel;this.disposeOldKernel(t);let o=t,s=pj(this.configService,o),a=t.path.endsWith(".interactive")||(c=n.resourceUri)!=null&&c.path.endsWith(".interactive")?ht:bt,l=new nA(t,o,n.metadata,this.sessionCreator,s,this.startupCodeProviders.getProviders(a),this.workspaceStorage);return l.onRestarted(()=>this._onDidRestartKernel.fire(l),this,this.disposables),l.onDisposed(()=>this._onDidDisposeKernel.fire(l),this,this.disposables),l.onStarted(()=>this._onDidStartKernel.fire(l),this,this.disposables),l.onStatusChanged(d=>this._onKernelStatusChanged.fire({kernel:l,status:d}),this,this.disposables),this.asyncDisposables.push(l),this.storeKernel(t,n,l),this.deleteMappingIfKernelIsDisposed(t,l),l}};CS=E([(0,hn.injectable)(),I(0,(0,hn.inject)(Ha)),I(1,(0,hn.inject)(ie)),I(2,(0,hn.inject)(Nx)),I(3,(0,hn.inject)(Ae)),I(4,(0,hn.inject)(Ad)),I(5,(0,hn.inject)(St)),I(5,(0,hn.named)(Es))],CS);u();var fA=$(te()),xS=require("vscode");var wS=class extends Fr{constructor(t){super();this._onDidChangeRegistrations=this._register(new xS.EventEmitter);this.onDidChangeRegistrations=this._onDidChangeRegistrations.event;this._finders=[];this.connectionFinderMapping=new Map;this._onDidChangeKernels=this._register(new xS.EventEmitter);this.onDidChangeKernels=this._onDidChangeKernels.event;this._status="idle";this._onDidChangeStatus=this._register(new xS.EventEmitter);t.push(this),this._register(this._onDidChangeStatus),this._register(this._onDidChangeRegistrations)}get status(){return this._status}set status(t){this._status!=t&&(this._status=t,this._onDidChangeStatus.fire())}get onDidChangeStatus(){return this._onDidChangeStatus.event}registerKernelFinder(t){this._finders.push(t);let n=()=>{this.status=this._finders.every(s=>s.status==="idle")?"idle":"discovering"};n();let i=this._register(new Pn),o=()=>{let s=this._finders.findIndex(a=>a===t);s>=0&&this._finders.splice(s,1),i.dispose(),n(),this._onDidChangeKernels.fire(),this._onDidChangeRegistrations.fire({added:[],removed:[t]})};return i.add(t.onDidChangeStatus(n,this)),i.add(t.onDidChangeKernels(()=>this._onDidChangeKernels.fire())),i.add(t.onDidDispose(()=>o())),this._onDidChangeKernels.fire(),this._onDidChangeRegistrations.fire({added:[t],removed:[]}),new xS.Disposable(()=>o())}get kernels(){let t=[];this.connectionFinderMapping.clear();let n=new Set;this._finders.filter(o=>o.kind==="localPythonEnvironment").forEach(o=>{o.kernels.forEach(s=>{(s.kind==="startUsingLocalKernelSpec"||s.kind==="startUsingPythonInterpreter")&&s.kernelSpec.specFile&&n.add(s.kernelSpec.specFile),t.push(s),this.connectionFinderMapping.set(s.id,o)})}),this._finders.filter(o=>o.kind==="localKernelSpec").forEach(o=>{o.kernels.forEach(s=>{(s.kind==="startUsingLocalKernelSpec"||s.kind==="startUsingPythonInterpreter")&&s.kernelSpec.specFile&&n.has(s.kernelSpec.specFile)||(t.push(s),this.connectionFinderMapping.set(s.id,o))})});let i=this._finders.filter(o=>o.kind==="remote");for(let o of i){let s=o.kernels;s.forEach(a=>{this.connectionFinderMapping.set(a.id,o)}),t.push(...s)}return t}getFinderForConnection(t){return this.connectionFinderMapping.get(t.id)}get registered(){return this._finders}};wS=E([(0,fA.injectable)(),I(0,(0,fA.inject)(ie))],wS);u();var Zh=$(te());var hj="Active_Kernel_Id_List",hIe=100,Hs=class{constructor(e,t){this.globalMemento=e;this.crypto=t}async getPreferredRemoteKernelId(e){let t=this.globalMemento.get(hj,[]);if(t.length){let n=e.uri,i=await this.crypto.createHash(n.toString()),o=t.find(s=>s.fileHash===i);return b.trace(`Preferred Remote kernel for ${ve(n)} is ${o==null?void 0:o.kernelId}`),o==null?void 0:o.kernelId}}async clearPreferredRemoteKernelId(e){await this.updatePreferredRemoteKernelIdInternal(e)}async storePreferredRemoteKernelId(e,t){await this.updatePreferredRemoteKernelIdInternal(e,t)}async updatePreferredRemoteKernelIdInternal(e,t){let n=!1,i=JSON.parse(JSON.stringify(this.globalMemento.get(hj,[]))),o=await this.crypto.createHash(e.toString()),s=i.findIndex(a=>a.fileHash===o);for(s>=0&&(n=!0,i.splice(s,1)),t&&(n=!0,i.push({fileHash:o,kernelId:t}),b.trace(`Storing Preferred remote kernel for ${ve(e)} is ${t}`));i.length>hIe;)n=!0,i.shift();n&&await this.globalMemento.update(hj,i)}};Hs=E([(0,Zh.injectable)(),I(0,(0,Zh.inject)(St)),I(0,(0,Zh.named)(ir)),I(1,(0,Zh.inject)(oy))],Hs);u();var Wi=Symbol("IJupyterVariables"),mA=Symbol("IKernelVariableRequester"),gA=Symbol("IJupyterVariablesProvider");u();var Gd=$(te()),JQ=require("vscode");var ev=class{constructor(e,t,n){this.kernelVariables=t;this.debuggerVariables=n;this.refreshEventEmitter=new JQ.EventEmitter;e.push(n.refreshRequired(this.fireRefresh.bind(this))),e.push(t.refreshRequired(this.fireRefresh.bind(this)))}get refreshRequired(){return this.refreshEventEmitter.event}getAllVariableDiscriptions(e,t,n,i){return this.variableHandler.getAllVariableDiscriptions(e,t,n,i)}async getVariables(e,t){return this.variableHandler.getVariables(e,t)}async getFullVariable(e,t){return this.variableHandler.getFullVariable(e,t)}async getMatchingVariable(e,t,n){return this.variableHandler.getMatchingVariable(e,t,n)}async getDataFrameInfo(e,t,n,i){return this.variableHandler.getDataFrameInfo(e,t,n,i)}async getVariableValueSummary(e,t,n){return this.variableHandler.getVariableValueSummary(e,t,n)}async getDataFrameRows(e,t,n,i,o){return this.variableHandler.getDataFrameRows(e,t,n,i,o)}get variableHandler(){return this.debuggerVariables.active?this.debuggerVariables:this.kernelVariables}fireRefresh(){this.refreshEventEmitter.fire()}};E([Nr("DS_INTERNAL.VARIABLE_EXPLORER_FETCH_TIME")],ev.prototype,"getVariables",1),ev=E([(0,Gd.injectable)(),I(0,(0,Gd.inject)(ie)),I(1,(0,Gd.inject)(Wi)),I(1,(0,Gd.named)(tt.KERNEL_VARIABLES)),I(2,(0,Gd.inject)(Wi)),I(2,(0,Gd.named)(tt.DEBUGGER_VARIABLES))],ev);u();var tv=$(te()),Yd=require("vscode");var DS=class{constructor(e,t,n,i){this.disposableRegistry=e;this.kernelProvider=t;this.serverUriStorage=n;this.jupyterUriProviderRegistration=i;this.kernelsStartedSuccessfully=new WeakSet;this.kernelDisposables=new WeakMap;this.kernelConnectionToKernelMapping=new WeakMap;this.kernelsRestarting=new WeakSet;this.kernelReconnectProgress=new WeakMap;this.lastExecutedCellPerKernel=new WeakMap}activate(){this.kernelProvider.onDidStartKernel(this.onDidStartKernel,this,this.disposableRegistry),this.disposableRegistry.push(this.kernelProvider.onDidDisposeKernel(e=>{var t,n;(t=this.kernelDisposables.get(e))==null||t.dispose(),this.kernelDisposables.delete(e),(n=this.kernelReconnectProgress.get(e))==null||n.dispose(),this.kernelReconnectProgress.delete(e)},this)),this.disposableRegistry.push(this.kernelProvider.onDidRestartKernel(e=>{var t;(t=this.kernelReconnectProgress.get(e))==null||t.dispose(),this.kernelReconnectProgress.delete(e)},this)),this.disposableRegistry.push(Mr.onDidChangeNotebookCellExecutionState(e=>{if(!hr(e.cell.notebook)||e.state!==1)return;let t=this.kernelProvider.get(e.cell.notebook);!t||this.lastExecutedCellPerKernel.get(t)!==e.cell||this.lastExecutedCellPerKernel.delete(t)}))}getKernelSpecificDisposables(e){let t=this.kernelDisposables.get(e)||new Pn;return this.disposableRegistry.push(t),this.kernelDisposables.set(e,t),t}onDidStartKernel(e){var n,i,o;if(this.kernelsStartedSuccessfully.has(e)||!((n=e.session)!=null&&n.kernel))return;let t=this.getKernelSpecificDisposables(e);t.add(Mr.onDidChangeNotebookCellExecutionState(s=>{s.cell.notebook===e.notebook&&this.kernelProvider.get(s.cell.notebook)===e&&s.state===3&&this.lastExecutedCellPerKernel.set(e,s.cell)},this)),this.kernelsStartedSuccessfully.add(e),this.kernelConnectionToKernelMapping.set(e.session.kernel,e),(o=(i=e.session)==null?void 0:i.kernel)==null||o.connectionStatusChanged.connect(this.onKernelStatusChanged,this),t.add(e.addHook("willRestart",async()=>{var s;(s=this.kernelReconnectProgress.get(e))==null||s.dispose(),this.kernelReconnectProgress.delete(e),this.kernelsRestarting.add(e)},this)),t.add(e.onRestarted(()=>this.kernelsRestarting.delete(e),this))}onKernelStatusChanged(e,t){var i,o,s,a;let n=this.kernelConnectionToKernelMapping.get(e);if(n&&!this.kernelsRestarting.has(n))switch(t){case"connected":{(i=this.kernelReconnectProgress.get(n))==null||i.dispose(),this.kernelReconnectProgress.delete(n);return}case"disconnected":{this.kernelReconnectProgress.has(n)&&((o=this.kernelReconnectProgress.get(n))==null||o.dispose(),this.kernelReconnectProgress.delete(n),(s=this.onKernelDisconnected(n))==null||s.catch(y));return}case"connecting":this.kernelReconnectProgress.has(n)||(a=this.onKernelConnecting(n))==null||a.catch(y);return;default:return}}async onKernelConnecting(e){let t=this.getKernelSpecificDisposables(e),n=Te(),i=new Yd.Disposable(()=>n.resolve());if(this.kernelReconnectProgress.set(e,i),Mt(e.kernelConnectionMetadata)&&await this.handleRemoteServerShutdown(e,e.kernelConnectionMetadata))return;let o=C.automaticallyReconnectingToAKernelProgressMessage(ct(e.kernelConnectionMetadata));Yd.window.withProgress({location:Yd.ProgressLocation.Notification,title:o},async()=>n.promise).then(y,y),t.add(i)}async onKernelDisconnected(e){var n;if(e.disposed||e.disposing||(Jr(e.resourceUri,"DATASCIENCE.KERNEL_CRASH"),Mt(e.kernelConnectionMetadata)&&await this.handleRemoteServerShutdown(e,e.kernelConnectionMetadata)))return;let t=er(e.kernelConnectionMetadata)?C.kernelDisconnected(ct(e.kernelConnectionMetadata)):C.remoteJupyterConnectionFailedWithServer(e.kernelConnectionMetadata.baseUrl);Yd.window.showErrorMessage(t).then(y,y);try{let i=this.lastExecutedCellPerKernel.get(e);if(!i||i.document.isClosed||i.notebook.isClosed||((n=i.executionSummary)==null?void 0:n.success)===!1)return;await Vf(i,e.controller,t,!1)}finally{await e.dispose()}}async handleRemoteServerShutdown(e,t){var o;let n=this.jupyterUriProviderRegistration.jupyterCollections.find(s=>s.extensionId===t.serverProviderHandle.extensionId&&s.id===t.serverProviderHandle.id);if(!n)return!1;let i=new Yd.CancellationTokenSource;try{return(await Promise.resolve(n.serverProvider.provideJupyterServers(i.token))||[]).map(l=>l.id).includes(t.serverProviderHandle.handle)?!1:(await this.serverUriStorage.remove(t.serverProviderHandle),(o=this.kernelReconnectProgress.get(e))==null||o.dispose(),this.kernelReconnectProgress.delete(e),!0)}catch(s){return!1}finally{i.dispose()}}};DS=E([(0,tv.injectable)(),I(0,(0,tv.inject)(ie)),I(1,(0,tv.inject)(He)),I(2,(0,tv.inject)(fr)),I(3,(0,tv.inject)(lr))],DS);u();var qQ=$(te());var PS=class{isTrusted(e){return!0}};PS=E([(0,qQ.injectable)()],PS);u();var TS=Symbol("ITrustedKernelPaths");u();var nD=$(te());var GQ=require("vscode");var kS=class{constructor(e,t){this.kernelProvider=e;this.disposables=[];this.restartProgress=new WeakMap;this.interruptProgress=new WeakMap;t.push(this)}dispose(){fe(this.disposables)}activate(){this.kernelProvider.onDidCreateKernel(this.onDidCreateKernel,this,this.disposables),this.kernelProvider.onDidDisposeKernel(e=>{var t,n;(t=this.restartProgress.get(e))==null||t.dispose(),(n=this.interruptProgress.get(e))==null||n.dispose()},this,this.disposables)}onDidCreateKernel(e){e.addHook("willRestart",async()=>{var n;(n=this.restartProgress.get(e))==null||n.dispose();let t=Wt.createProgressReporter(e.resourceUri,C.restartingKernelStatus(`: ${ct(e.kernelConnectionMetadata)}`));this.restartProgress.set(e,t)},this,this.disposables),e.addHook("restartCompleted",async()=>{var t,n;(t=this.restartProgress.get(e))==null||t.dispose(),(n=this.interruptProgress.get(e))==null||n.dispose()},this,this.disposables),e.addHook("willInterrupt",async()=>{let t=new Pn,n=setTimeout(()=>{t.isDisposed||t.add(Wt.createProgressReporter(e.resourceUri,C.interruptKernelStatus(ct(e.kernelConnectionMetadata))))},1e3);t.add(new GQ.Disposable(()=>clearTimeout(n))),this.interruptProgress.set(e,t)},this,this.disposables),e.addHook("interruptCompleted",async()=>{var t;return(t=this.interruptProgress.get(e))==null?void 0:t.dispose()},this,this.disposables)}};kS=E([(0,nD.injectable)(),I(0,(0,nD.inject)(He)),I(1,(0,nD.inject)(ie))],kS);u();var iD=$(te()),vj=require("vscode");var NS=class{constructor(e,t){this.kernelFinder=t;this.disposables=[];e.push(this)}dispose(){fe(this.disposables)}activate(){this.startRefresh()}startRefresh(){if(!this.refreshedOnceBefore){if(this.kernelFinder.status==="discovering")return this.displayProgressIndicator();this.kernelFinder.onDidChangeStatus(()=>{this.kernelFinder.status==="discovering"&&this.displayProgressIndicator()},this,this.disposables)}}displayProgressIndicator(){let e=Date.now().toString();b.debug(`Start refreshing Kernel Picker (${e})`);let t=vj.notebooks.createNotebookControllerDetectionTask(bt),n=vj.notebooks.createNotebookControllerDetectionTask(ht);this.disposables.push(t),this.disposables.push(n),this.kernelFinder.onDidChangeStatus(()=>{this.kernelFinder.status==="idle"&&(b.debug(`End refreshing Kernel Picker (${e})`),t.dispose(),n.dispose())},this,this.disposables)}};NS=E([(0,iD.injectable)(),I(0,(0,iD.inject)(ie)),I(1,(0,iD.inject)(ai))],NS);u();var AS=$(te());var vIe=1e3,RS=class{constructor(e,t,n){this.serverStorage=e;this.kernelProvider=t;this.disposables=[];this.timeouts=new Set;this.kernelSpecificUpdates=new WeakMap;n.push(this)}dispose(){fe(this.disposables),fe(Array.from(this.timeouts.values()))}activate(){this.disposables.push(Mr.onDidChangeNotebookCellExecutionState(this.onDidChangeNotebookCellExecutionState,this))}onDidChangeNotebookCellExecutionState(e){let t=this.kernelProvider.get(e.cell.notebook);if(!t)return;let n=t.kernelConnectionMetadata;if(!Mt(n))return;let i=this.kernelSpecificUpdates.get(t)||new ec(vIe);this.kernelSpecificUpdates.set(t,i),i.trigger(()=>{t.disposed||t.disposing||this.serverStorage.update(n.serverProviderHandle).catch(y)})}};RS=E([(0,AS.injectable)(),I(0,(0,AS.inject)(fr)),I(1,(0,AS.inject)(He)),I(2,(0,AS.inject)(ie))],RS);u();var YQ=$(te());var MS=class{async installMissingDependencies(e){return 1}async areDependenciesInstalled(e,t,n){return!1}};MS=E([(0,YQ.injectable)()],MS);u();var $Q=$(te());var OS=class{constructor(){this.providers=new Map}getProviders(e){return(this.providers.get(e)||[]).slice()}register(e,t){this.providers.set(t,this.providers.get(t)||[]),this.providers.get(t).push(e)}};OS=E([(0,$Q.injectable)()],OS);u();var rv=$(te());var QQ=require("vscode");var zQ=1e3*60*60*24*2,Vl=class extends Fr{constructor(t,n,i,o){super();this.serverStorage=n;this.context=i;this.fs=o;this.executedCells=new WeakMap;this.chainedPromises=Promise.resolve();i.globalStorageUri,t.push(this),this.storageFile=QQ.Uri.joinPath(this.context.globalStorageUri,"lastExecutedRemoteCell.json")}activate(){this._register(this.serverStorage.onDidRemove(this.onDidRemoveServers,this))}async getLastTrackedCellExecution(t,n){var s;if(t.isUntitled||!Mt(n.kernelConnectionMetadata)||!((s=n.session)!=null&&s.id))return;if(this.staleState&&this.staleState[t.uri.toString()])return this.staleState[t.uri.toString()];let i=await this.getStorageFile(),o={};try{let a=await this.fs.readFile(i);o=JSON.parse(a.toString()),this.staleState=o}catch(a){return}return o[t.uri.toString()]}trackCellExecution(t,n){if(!Mt(n.kernelConnectionMetadata)||t.document.isUntitled)return;this.executedCells.delete(t);let i=[],o=(a,l)=>{var c,d;if(l.direction==="send"){let p=l.msg;if(p.header.msg_type==="execute_request"&&p.metadata&&typeof p.metadata=="object"&&p.metadata&&"cellId"in p.metadata&&typeof p.metadata.cellId=="string"&&p.metadata.cellId===t.document.uri.toString()){let f=p.header.msg_id;this.executedCells.set(t,{msg_id:f,kernelId:((d=(c=n.session)==null?void 0:c.kernel)==null?void 0:d.id)||"",cellIndex:t.index})}}else if(l.direction==="recv"){let p=l.msg,f=this.executedCells.get(t);if(f!=null&&f.msg_id&&Jd(p)===f.msg_id){if(!f.startTime){f.startTime=new Date().getTime();try{f.startTime=new Date(p.header.date).getTime()}catch(m){}this.executedCells.set(t,f)}"execution_count"in p.content&&typeof p.content.execution_count=="number"&&!f.executionCount&&f.executionCount!==p.content.execution_count&&(f.executionCount=p.content.execution_count,this.executedCells.set(t,f),this.trackLastExecution(t,n,f),fe(i))}}},s=()=>{let a=n.session;a&&(a.anyMessage.connect(o),i.push({dispose:()=>Xs(()=>{var l;return(l=a.anyMessage)==null?void 0:l.disconnect(o)})}))};n.onStarted(()=>s(),i),n.session&&s()}deleteTrackedCellExecution(t,n){var i;t.notebook.isUntitled||!Mt(n.kernelConnectionMetadata)||!((i=n.session)!=null&&i.id)||(this.chainedPromises=this.chainedPromises.finally(async()=>{let o={};try{let a=await this.getStorageFile().then(()=>this.fs.readFile(this.storageFile));o=JSON.parse(a.toString())}catch(a){return}let s=t.notebook.uri.toString();o[s].cellIndex===t.index&&(delete o[s],this.staleState=o,await this.fs.writeFile(this.storageFile,JSON.stringify(o)))}))}getStorageFile(){return this.ensureStorageExistsPromise=this.ensureStorageExistsPromise||(async()=>(await this.fs.createDirectory(this.context.globalStorageUri),this.storageFile))(),this.ensureStorageExistsPromise}trackLastExecution(t,n,i){var s,a,l,c;if(!i.executionCount||!i.msg_id||!i.startTime||!Mt(n.kernelConnectionMetadata)||!((s=n.session)!=null&&s.id))return;let o={cellIndex:t.index,executionCount:i.executionCount,kernelId:((l=(a=n.session)==null?void 0:a.kernel)==null?void 0:l.id)||"",msg_id:i.msg_id,serverId:Jt(n.kernelConnectionMetadata.serverProviderHandle),sessionId:(c=n.session)==null?void 0:c.id,startTime:i.startTime};this.chainedPromises=this.chainedPromises.finally(async()=>{let d={};try{let f=await this.getStorageFile().then(()=>this.fs.readFile(this.storageFile));d=JSON.parse(f.toString())}catch(f){}let p=t.notebook.uri.toString();d[p]=o,this.removeOldItems(d),this.staleState=d,await this.fs.writeFile(this.storageFile,JSON.stringify(d))})}onDidRemoveServers(t){t.length!==0&&(this.chainedPromises=this.chainedPromises.finally(async()=>{await this.getStorageFile();let n={};try{let s=await this.fs.readFile(this.storageFile);n=JSON.parse(s.toString())}catch(s){}let i=!1,o=new Set(t.map(s=>Jt(s)));Object.keys(n).forEach(s=>{let a=n[s];(o.has(a.serverId)||Date.now()-a.startTime>zQ)&&(delete n[s],i=!0)}),i&&(this.removeOldItems(n),this.staleState=n,await this.fs.writeFile(this.storageFile,JSON.stringify(n)))}))}removeOldItems(t){Object.keys(t).forEach(n=>{let i=t[n];i&&Date.now()-i.startTime>zQ&&delete t[n]})}};Vl=E([(0,rv.injectable)(),I(0,(0,rv.inject)(ie)),I(1,(0,rv.inject)(fr)),I(2,(0,rv.inject)(ot)),I(3,(0,rv.inject)(wt))],Vl);u();var KS=$(te());var oD=require("vscode");var LS=class{constructor(e,t,n){this.serverUriStorage=e;this.registrations=t;this.disposables=n}activate(){this.disposables.push(oD.commands.registerCommand(Q.ClearSavedJupyterUris,async()=>{await this.serverUriStorage.clear().catch(y),await Promise.all(this.registrations.jupyterCollections.filter(e=>e.id.startsWith("_builtin")||e.extensionId===Ge).map(async e=>{if(!e.serverProvider||!e.serverProvider.removeJupyterServer)return;let t=new oD.CancellationTokenSource,n=await Promise.resolve(e.serverProvider.provideJupyterServers(t.token));await Promise.all((n||[]).map(i=>e.serverProvider.removeJupyterServer(i).catch(y)))})).catch(y),await oD.commands.executeCommand("dataScience.ClearUserProviderJupyterServerCache").then(y,y)},this))}};LS=E([(0,KS.injectable)(),I(0,(0,KS.inject)(fr)),I(1,(0,KS.inject)(lr)),I(2,(0,KS.inject)(ie))],LS);u();var hA=$(te());var FS=class{constructor(e){this.registry=e;this.priority=0}activate(){this.registry.register(this,bt),this.registry.register(this,ht)}async getCode(e){return qt(e.kernelConnectionMetadata)?[K$]:[]}};FS=E([(0,hA.injectable)(),I(0,(0,hA.inject)(Ad))],FS);var sD=class{constructor(){this.isSupported=!1}};sD=E([(0,XQ.injectable)()],sD);function ZQ(r,e){r.addSingleton(jd,sD),Jb("isInsiderExtension",Mv()?"true":"false");let t=r.get(Io);Jb("isPythonExtensionInstalled",t.isPythonExtensionInstalled?"true":"false");let n=r.get(jd);Jb("rawKernelSupported",n.isSupported?"true":"false"),r.addSingleton(Ad,OS),r.addSingleton(Wi,ev,tt.ALL_VARIABLES),r.addSingleton(Ue,Gh),r.addSingleton(Ue,NS),r.addSingleton(Ue,kS),r.addSingleton(Ue,DS),r.addSingleton(Ue,RS),r.addSingleton(He,ES),r.addSingleton(TS,PS),r.addSingleton(Wh,CS),r.addSingleton(Hs,Hs),r.addSingleton(ai,wS),r.addSingleton(hI,MS),r.addSingleton(Ue,LS),r.addSingleton(Vl,Vl),r.addBinding(Vl,Ue),KQ(r,e),r.addSingleton(Ue,ln),r.addSingleton(Ue,FS)}u();u();var US=$(te()),iv=require("vscode");var nv=class{constructor(e,t,n){this.disposables=e;this.controllerRegistration=t;this.preferredRemoteKernelIdProvider=n}activate(){iv.workspace.onDidOpenNotebookDocument(this.onDidOpenNotebook,this,this.disposables),iv.workspace.notebookDocuments.forEach(e=>this.onDidOpenNotebook(e))}async onDidOpenNotebook(e){if(!hr(e))return;let t=await this.preferredRemoteKernelIdProvider.getPreferredRemoteKernelId(e);if(!t)return;let n=()=>{let o=this.controllerRegistration.getSelected(e),s=this.controllerRegistration.registered.find(a=>a.id===t);return s&&(o==null?void 0:o.id)!==s.id?(this.switchKernel(e,s.connection).catch(y),!0):!1};if(n())return;let i=this.controllerRegistration.onDidChange(o=>{o.added.length&&n()&&i.dispose()},this,this.disposables);this.controllerRegistration.onControllerSelected(o=>{o.notebook===e&&i.dispose()},this,this.disposables)}async switchKernel(e,t){b.debug(`Using notebook.selectKernel to force remote kernel for ${ve(e.uri)} to ${t.id}`),await iv.commands.executeCommand("notebook.selectKernel",{id:t.id,extension:Ge}),await ZD(async()=>{var i;if(((i=iv.window.activeNotebookEditor)==null?void 0:i.notebook)===e){let o=this.controllerRegistration.getSelected(e);if((o==null?void 0:o.connection.id)===t.id)return o.restoreConnection(e).catch(y),!0}return!1},2e3,100)?b.debug(`Successfully switched remote kernel for ${ve(e.uri)} to ${t.id}`):b.warn(`Failed to switch remote kernel for ${ve(e.uri)} to ${t.id}`)}};E([yn()],nv.prototype,"onDidOpenNotebook",1),nv=E([(0,US.injectable)(),I(0,(0,US.inject)(ie)),I(1,(0,US.inject)(Tt)),I(2,(0,US.inject)(Hs))],nv);u();var WS=$(te()),cm=require("vscode");u();var eX=Symbol("IServiceManager"),Kr=Symbol("IServiceContainer");u();var ms=require("vscode");u();function fu(r){if(typeof r!="string")throw new TypeError(`Expected a \`string\`, got \`${typeof r}\``);var e=rX();let t=e;return t.default&&(t=t.default),r.replace(t(),"")}u();u();var lD=$(te()),lX=require("vscode");u();var yj=$(zh()),oX=require("vscode");u();function nX(r){if(!r||!Array.isArray(r)||r.length===0)return;let e=[];for(let t=0;t<r.length;t+=1){let n=r[t];if("buffer"in n&&"byteOffset"in n){let i=Array.apply(null,new Uint8Array(n.buffer));e.push({...n,byteLength:n.byteLength,byteOffset:n.byteOffset,buffer:i})}else e.push([...new Uint8Array(n)])}return e}function iX(r){if(!Array.isArray(r)||r.length===0)return r;let e=[];for(let t=0;t<r.length;t+=1){let n=r[t];if("buffer"in n&&"byteOffset"in n){let i=new Uint8Array(n.buffer).buffer,o=new DataView(i,n.byteOffset,n.byteLength);e.push(o)}else{let i=new Uint8Array(n).buffer;e.push(i)}}return e}var aD=new WeakMap;function sX(r,e){let t=aD.get(r);t&&(t.targets.add(e),t.registerCommTarget(e))}function aX(r,e){var t,n,i;(i=(n=(t=aD.get(r))==null?void 0:t.targets)==null?void 0:n.delete)==null||i.call(n,e)}var vA=class{constructor(e,t){this.kernelProvider=e;this.document=t;this.commTargetsRegistered=new Set;this.pendingTargetNames=new Set;this._postMessageEmitter=new oX.EventEmitter;this.messageHooks=new Map;this.pendingHookRemovals=new Map;this.messageHookRequests=new Map;this.disposables=[];this.disposed=!1;this.pendingMessages=[];this.subscribedToKernelSocket=!1;this.waitingMessageIds=new Map;this.outputWidgetIds=new Set;this.isUsingIPyWidgets=!1;this.pendingTargetNames.add("jupyter.widget"),e.onDidStartKernel(i=>{i.notebook===t&&this.initialize()},this,this.disposables),this.mirrorSend=this.mirrorSend.bind(this),this.onKernelSocketMessage=this.onKernelSocketMessage.bind(this);let n=MW();this.deserialize=n.deserialize}get postMessage(){return this._postMessageEmitter.event}dispose(){for(this.disposed=!0;this.disposables.length;){let e=this.disposables.shift();e==null||e.dispose()}}receiveMessage(e){switch(e.message){case"IPyWidgets_logMessage":{let t=e.payload;t.category==="error"?b.error(`Widget Error: ${t.message}`):b.trace(`Widget Message: ${t.message}`);break}case"IPyWidgets_Ready":this.sendKernelOptions(),this.initialize();break;case"IPyWidgets_msg":this.sendRawPayloadToKernelSocket(e.payload);break;case"IPyWidgets_binary_msg":this.sendRawPayloadToKernelSocket(iX(e.payload)[0]);break;case"IPyWidgets_msg_received":this.onKernelSocketResponse(e.payload);break;case"IPyWidgets_registerCommTarget":this.registerCommTarget(e.payload);break;case"IPyWidgets_RegisterMessageHook":this.registerMessageHook(e.payload);break;case"IPyWidgets_RemoveMessageHook":this.possiblyRemoveMessageHook(e.payload);break;case"IPyWidgets_MessageHookResult":this.handleMessageHookResponse(e.payload);break;case"IPyWidgets_iopub_msg_handled":this.iopubMessageHandled(e.payload);break;default:break}}sendRawPayloadToKernelSocket(e){this.pendingMessages.push(e),this.sendPendingMessages()}registerCommTarget(e){this.pendingTargetNames.add(e),this.initialize()}initialize(){this.jupyterLab||(this.jupyterLab=oi());let e=this.getKernel();e&&(this.subscribeToKernelSocket(e),this.registerCommTargets(e))}raisePostMessage(e,t){this._postMessageEmitter.fire({message:e,payload:t})}subscribeToKernelSocket(e){var n;if(this.subscribedToKernelSocket||!e.session)return;this.subscribedToKernelSocket=!0,this.subscribeToKernelSocketImpl(e);let t=(n=e.session.kernel)==null?void 0:n.id;e.session.onDidKernelSocketChange(()=>{var i,o;this.subscribeToKernelSocketImpl(e,t),t=((o=(i=e.session)==null?void 0:i.kernel)==null?void 0:o.id)||""})}subscribeToKernelSocketImpl(e,t){var s,a,l,c,d;let n=t?Vs.get(t):void 0;if(n==null||n.removeReceiveHook(this.onKernelSocketMessage),n==null||n.removeSendHook(this.mirrorSend),this.kernelWasConnectedAtLeastOnce){for(;this.pendingMessages.length;)this.pendingMessages.shift();this.waitingMessageIds.forEach(p=>p.resultPromise.resolve()),this.waitingMessageIds.clear(),this.messageHookRequests.forEach(p=>p.resolve(!1)),this.messageHookRequests.clear(),this.messageHooks.clear(),this.sendRestartKernel()}if(!((a=(s=e.session)==null?void 0:s.kernel)!=null&&a.id)||!Vs.get((c=(l=e.session)==null?void 0:l.kernel)==null?void 0:c.id))return;aD.has(e.session.kernel)||aD.set(e.session.kernel,{targets:new Set,registerCommTarget:p=>{this.raisePostMessage("IPyWidgets_registerCommTarget",p)}}),this.kernelWasConnectedAtLeastOnce=!0;let i=(d=e.session.kernel)==null?void 0:d.id,o=i?Vs.get(i):void 0;o==null||o.addReceiveHook(this.onKernelSocketMessage),o==null||o.addSendHook(this.mirrorSend),this.sendKernelOptions(),this.registerCommTargets(e),this.sendPendingMessages()}sendKernelOptions(){var e,t,n,i,o,s,a,l,c,d,p,f,m,g;(t=(e=this.kernel)==null?void 0:e.session)!=null&&t.kernel&&this.raisePostMessage("IPyWidgets_kernelOptions",{id:((o=(i=(n=this.kernel)==null?void 0:n.session)==null?void 0:i.kernel)==null?void 0:o.id)||"",clientId:((l=(a=(s=this.kernel)==null?void 0:s.session)==null?void 0:a.kernel)==null?void 0:l.clientId)||"",userName:((p=(d=(c=this.kernel)==null?void 0:c.session)==null?void 0:d.kernel)==null?void 0:p.username)||"",model:((g=(m=(f=this.kernel)==null?void 0:f.session)==null?void 0:m.kernel)==null?void 0:g.model)||{id:"",name:""}})}async mirrorSend(e,t){if(typeof e=="string"&&e.includes("shell")&&e.includes("execute_request")){let n=this.deserialize(e);if(n.channel==="shell"&&n.header.msg_type==="execute_request"){if(!oA(n))return;let i=this.mirrorExecuteRequest(n);this.isUsingIPyWidgets&&await i}}}sendRestartKernel(){this.raisePostMessage("IPyWidgets_onRestartKernel",void 0)}mirrorExecuteRequest(e){let t=Te();return this.waitingMessageIds.set(e.header.msg_id,{startTime:Date.now(),resultPromise:t}),this.raisePostMessage("IPyWidgets_mirror_execute",{id:e.header.msg_id,msg:e}),t.promise}messageNeedsFullHandle(e){var t,n,i,o;return e.channel==="iopub"&&((t=e.header)==null?void 0:t.msg_type)==="comm_msg"&&((i=(n=e.content)==null?void 0:n.data)==null?void 0:i.method)==="update"&&this.outputWidgetIds.has((o=e.content)==null?void 0:o.comm_id)}iopubMessageHandled(e){let t=e.id;this.fullHandleMessage&&this.fullHandleMessage.id===t&&(this.fullHandleMessage.promise.resolve(),this.fullHandleMessage=void 0)}async onKernelSocketMessage(e){var o,s,a,l,c,d,p,f,m;let t=(0,yj.default)(),n=Te();if(this.waitingMessageIds.set(t,{startTime:Date.now(),resultPromise:n}),typeof e=="string"?oA(e)&&this.raisePostMessage("IPyWidgets_msg",{id:t,data:e}):this.raisePostMessage("IPyWidgets_binary_msg",{id:t,data:nX([e])}),typeof e!="string"||e.includes(go)||e.includes(tt.DefaultCommTarget)||e.includes("comm_open")||e.includes("comm_close")||e.includes("comm_msg")){let g=this.deserialize(e);if(!oA(g))return;g&&g.content&&g.content.data&&(g.content.data[go]||g.content.target_name===tt.DefaultCommTarget)&&(this.isUsingIPyWidgets=!0);let h=((o=g.header)==null?void 0:o.msg_type)==="comm_open"&&((l=(a=(s=g.content)==null?void 0:s.data)==null?void 0:a.state)==null?void 0:l._model_module)==="@jupyter-widgets/output"&&((p=(d=(c=g.content)==null?void 0:c.data)==null?void 0:d.state)==null?void 0:p._model_name)==="OutputModel",v=((f=g.header)==null?void 0:f.msg_type)==="comm_close"&&this.outputWidgetIds.has((m=g.content)==null?void 0:m.comm_id);h?this.outputWidgetIds.add(g.content.comm_id):v?this.outputWidgetIds.delete(g.content.comm_id):this.messageNeedsFullHandle(g)&&(this.fullHandleMessage={id:g.header.msg_id,promise:Te()},await n.promise,await this.fullHandleMessage.promise.promise,this.fullHandleMessage=void 0)}}onKernelSocketResponse(e){let t=this.waitingMessageIds.get(e.id);t&&(this.waitingMessageIds.delete(e.id),t.resultPromise.resolve())}sendPendingMessages(){var e,t,n;if((t=(e=this.kernel)==null?void 0:e.session)!=null&&t.kernel)for(;this.pendingMessages.length;)try{let i=this.pendingMessages[0],o=typeof i=="string"?JSON.parse(i):this.deserialize(i);(n=o.buffers)!=null&&n.length&&(o.buffers=o.buffers.map(s=>s instanceof DataView?s.buffer:s)),o.channel==="control"?this.kernel.session.kernel.sendControlMessage(o):this.kernel.session.kernel.sendShellMessage(o),this.pendingMessages.shift()}catch(i){b.error("Failed to send message to Kernel",i);return}}registerCommTargets(e){var t,n,i;for(;this.pendingTargetNames.size>0;){let s=Array.from([...this.pendingTargetNames.values()]).shift();if(s){if(this.commTargetsRegistered.has(s))return;b.trace(`Registering commtarget ${s}`),this.commTargetsRegistered.add(s),this.pendingTargetNames.delete(s),(t=e.session)!=null&&t.kernel&&s!==tt.DefaultCommTarget&&!((i=(n=aD.get(e.session.kernel))==null?void 0:n.targets)!=null&&i.has(s))&&e.session.kernel.registerCommTarget(s,y)}}}getKernel(){var e,t;return this.document&&!((e=this.kernel)!=null&&e.session)&&(this.kernel=this.kernelProvider.get(this.document),(t=this.kernel)==null||t.onDisposed(()=>this.kernel=void 0)),this.kernel&&!this.kernelRestartHandlerAttached&&(this.kernelRestartHandlerAttached=!0,this.disposables.push(this.kernel.onRestarted(this.handleKernelRestarts,this))),this.kernel}async handleKernelRestarts(){var e;this.disposed||this.commTargetsRegistered.size===0||!((e=this.kernel)!=null&&e.session)||(Array.from(this.commTargetsRegistered.keys()).forEach(t=>{this.commTargetsRegistered.delete(t),this.pendingTargetNames.add(t)}),this.subscribeToKernelSocket(this.kernel),this.registerCommTargets(this.kernel))}registerMessageHook(e){var t,n;try{if((n=(t=this.kernel)==null?void 0:t.session)!=null&&n.kernel&&!this.messageHooks.has(e)){let i=this.messageHookCallback.bind(this);this.messageHooks.set(e,i),this.kernel.session.kernel.registerMessageHook(e,i)}}finally{this.raisePostMessage("IPyWidgets_ExtensionOperationHandled",{id:e,type:"IPyWidgets_RegisterMessageHook"})}}possiblyRemoveMessageHook(e){try{e.lastHookedMsgId?this.pendingHookRemovals.set(e.lastHookedMsgId,e.hookMsgId):this.removeMessageHook(e.hookMsgId)}finally{this.raisePostMessage("IPyWidgets_ExtensionOperationHandled",{id:e.hookMsgId,type:"IPyWidgets_RemoveMessageHook"})}}removeMessageHook(e){var t,n;if((n=(t=this.kernel)==null?void 0:t.session)!=null&&n.kernel&&this.messageHooks.has(e)){let i=this.messageHooks.get(e);this.messageHooks.delete(e),this.kernel.session.kernel.removeMessageHook(e,i)}}async messageHookCallback(e){let t=Te(),n=(0,yj.default)(),i=e.parent_header.msg_id;if(this.messageHooks.has(i)?(this.messageHookRequests.set(n,t),this.raisePostMessage("IPyWidgets_MessageHookCall",{requestId:n,parentId:i,msg:e})):t.resolve(!0),this.pendingHookRemovals.has(e.header.msg_id)){let o=this.pendingHookRemovals.get(e.header.msg_id);this.pendingHookRemovals.delete(e.header.msg_id),this.removeMessageHook(o)}return t.promise}handleMessageHookResponse(e){let t=this.messageHookRequests.get(e.requestId);t&&(this.messageHookRequests.delete(e.requestId),t.resolve(e.msgType.includes("comm")?!0:e.result))}};var bj=class{constructor(e,t){this.baseMulticaster=e;this.oldMessages=t;this._postMessageEmitter=new lX.EventEmitter;this.disposables=[];e.postMessage(this.raisePostMessage,this,this.disposables)}get postMessage(){return this._postMessageEmitter.event}dispose(){for(;this.disposables.length;){let e=this.disposables.shift();e==null||e.dispose()}}initialize(){return this.baseMulticaster.initialize()}receiveMessage(e){this.baseMulticaster.receiveMessage(e)}raisePostMessage(e){this.oldMessages.forEach(t=>{this._postMessageEmitter.fire(t)}),this.oldMessages=[],this._postMessageEmitter.fire(e)}},$d=class{constructor(e,t){this.kernelProvider=t;this.messageDispatchers=new WeakMap;this.messagesPerNotebook=new WeakMap;this.disposed=!1;this.disposables=[];e.push(this),t.onDidDisposeKernel(this.trackDisposingOfKernels,this,e)}dispose(){var e;for(this.disposed=!0;this.disposables.length;)(e=this.disposables.shift())==null||e.dispose()}create(e){let t=this.messageDispatchers.get(e);t||(t=new vA(this.kernelProvider,e),this.messageDispatchers.set(e,t),this.disposables.push(t.postMessage(o=>this.onMessage(o,e),this)));let n=[];e&&this.messagesPerNotebook.get(e)&&(n=this.messagesPerNotebook.get(e)||[]);let i=new bj(t,n);return this.disposables.push(i),i}trackDisposingOfKernels(e){if(this.disposed)return;let t=e.notebook,n=this.messageDispatchers.get(t);this.messageDispatchers.delete(t),n==null||n.dispose()}onMessage(e,t){t&&(this.messagesPerNotebook.set(t,this.messagesPerNotebook.get(t)||[]),(e.message==="IPyWidgets_kernelOptions"||e.message==="IPyWidgets_registerCommTarget")&&this.messagesPerNotebook.get(t).push(e))}};$d=E([(0,lD.injectable)(),I(0,(0,lD.inject)(ie)),I(1,(0,lD.inject)(He))],$d);u();var dX=require("vscode");u();var cX=require("vscode");var ov=class ov extends Fr{constructor(t,n,i,o,s,a){super();this.kernel=t;this.localResourceUriConverter=n;this.configurationSettings=i;this.sourceProviderFactory=o;this.isWebViewOnline=s;this.cdnScriptProvider=a;this.id="all";this.scriptProviders=this.sourceProviderFactory.getProviders(this.kernel,this.localResourceUriConverter),this.scriptProviders.forEach(l=>this._register(l)),this.monitorKernel()}get configuredScriptSources(){return this.configurationSettings.getSettings(void 0).widgetScriptSources}async getBaseUrl(){let t=this.scriptProviders.find(n=>n.getBaseUrl);if(t)return t.getBaseUrl()}async getWidgetScriptSources(){let t=[];return await Promise.all(this.scriptProviders.map(async n=>{n.getWidgetScriptSources&&t.push(...await n.getWidgetScriptSources())})),t}async getWidgetScriptSource(t,n){let i=await this.isWebViewOnline,o=this.scriptProviders.slice(),s={moduleName:t};for(;o.length;){let a=o.shift();if(!a)continue;let l=await a.getWidgetScriptSource(t,n,i);if(l.scriptUri){s=l;break}else b.warn(`Widget Script Source not found for ${t}@${n} from ${a.id}`)}return this.sendTelemetryForWidgetModule(t,n,"",s.source).catch(y),s.scriptUri?b.trace(`Script source for Widget ${t}@${n} was found from source ${s.source} and ${s.scriptUri}`):b.error(`Script source for Widget ${t}@${n} not found in ${this.scriptProviders.map(a=>a.id).join(", ")}`),s}async sendTelemetryForWidgetModule(t,n,i,o){let s=`${t}.${t}@${n}`;if(ov.trackedWidgetModuleNames.has(s))return;ov.trackedWidgetModuleNames.add(s);let a=t.toLowerCase().startsWith("@jupyter-widgets"),l=o==="cdn"||a||await this.cdnScriptProvider.isOnCDN(t),c=l?t.replace(/\//g,"_").replace(/\\/g,"_").replace(/@/g,"_at_"):void 0,d=l?i.replace(/\//g,"_").replace(/\\/g,"_").replace(/@/g,"_at_"):void 0;J("DS_INTERNAL.IPYWIDGET_USED_BY_USER",void 0,{hashedName:await Nt(t),moduleName:c,modelName:d,source:o,moduleVersion:l?n:void 0,cdnSearched:this.configuredScriptSources.length>0})}monitorKernel(){this.hookKernelEvents(),this._register(this.kernel.onStarted(this.hookKernelEvents,this)),this._register(this.kernel.onRestarted(this.hookKernelEvents,this)),this._register(this.kernel.onDidKernelSocketChange(()=>this.hookKernelEvents(),this))}hookKernelEvents(){var n;let t=(n=this.kernel.session)==null?void 0:n.kernel;t&&(t.anyMessage.connect(this.onAnyMessage,this),this._register(new cX.Disposable(()=>t.anyMessage.disconnect(this.onAnyMessage,this))))}onAnyMessage(t,n){var i,o,s,a;if(n.direction==="recv"&&n.msg.header.msg_type==="comm_open"){let c=n.msg.content.data;(i=c.state)!=null&&i._model_module&&c.state._model_name&&this.sendTelemetryForWidgetModule((o=c.state)==null?void 0:o._model_module,((s=c.state)==null?void 0:s._model_module_version)||"",(a=c.state)==null?void 0:a._model_name).catch(y)}}};ov.trackedWidgetModuleNames=new Set,E([yn()],ov.prototype,"sendTelemetryForWidgetModule",1),E([yn()],ov.prototype,"onAnyMessage",1);var bA=ov;u();var IA=class{constructor(e,t){this.isWebExtension=e;this.converter=t}async asWebviewUri(e){return this.isWebExtension?e:this.converter(e)}};u();var Ij=class{constructor(e,t){this.uri=e;this.value=t}};function bIe(r){return Array.isArray(r)}var IIe,sv=class sv{constructor(e,t){this[IIe]="ResourceMap";if(e instanceof sv)this.map=new Map(e.map),this.toKey=t!=null?t:sv.defaultToKey;else if(bIe(e)){this.map=new Map,this.toKey=t!=null?t:sv.defaultToKey;for(let[n,i]of e)this.set(n,i)}else this.map=new Map,this.toKey=e!=null?e:sv.defaultToKey}set(e,t){return this.map.set(this.toKey(e),new Ij(e,t)),this}get(e){var t;return(t=this.map.get(this.toKey(e)))==null?void 0:t.value}has(e){return this.map.has(this.toKey(e))}get size(){return this.map.size}clear(){this.map.clear()}delete(e){return this.map.delete(this.toKey(e))}forEach(e,t){typeof t!="undefined"&&(e=e.bind(t));for(let[,n]of this.map)e(n.value,n.uri,this)}*values(){for(let e of this.map.values())yield e.value}*keys(){for(let e of this.map.values())yield e.uri}*entries(){for(let e of this.map.values())yield[e.uri,e.value]}*[(IIe=Symbol.toStringTag,Symbol.iterator)](){for(let[,e]of this.map)yield[e.uri,e.value]}};sv.defaultToKey=e=>e.toString();var mu=sv,SIe,SA=class{constructor(e,t){this[SIe]="ResourceSet";!e||typeof e=="function"?this._map=new mu(e):(this._map=new mu(t),e.forEach(this.add,this))}get size(){return this._map.size}add(e){return this._map.set(e,e),this}clear(){this._map.clear()}delete(e){return this._map.delete(e)}forEach(e,t){this._map.forEach((n,i)=>e.call(t,i,i,this))}has(e){return this._map.has(e)}entries(){return this._map.entries()}keys(){return this._map.keys()}values(){return this._map.keys()}[(SIe=Symbol.toStringTag,Symbol.iterator)](){return this.keys()}};var _Ie,uX=class{constructor(){this[_Ie]="LinkedMap";this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){var e;return(e=this._head)==null?void 0:e.value}get last(){var e;return(e=this._tail)==null?void 0:e.value}has(e){return this._map.has(e)}get(e,t=0){let n=this._map.get(e);if(n)return t!==0&&this.touch(n,t),n.value}set(e,t,n=0){let i=this._map.get(e);if(i)i.value=t,n!==0&&this.touch(i,n);else{switch(i={key:e,value:t,next:void 0,previous:void 0},n){case 0:this.addItemLast(i);break;case 1:this.addItemFirst(i);break;case 2:this.addItemLast(i);break;default:this.addItemLast(i);break}this._map.set(e,i),this._size++}return this}delete(e){return!!this.remove(e)}remove(e){let t=this._map.get(e);if(t)return this._map.delete(e),this.removeItem(t),this._size--,t.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");let e=this._head;return this._map.delete(e.key),this.removeItem(e),this._size--,e.value}forEach(e,t){let n=this._state,i=this._head;for(;i;){if(t?e.bind(t)(i.value,i.key,this):e(i.value,i.key,this),this._state!==n)throw new Error("LinkedMap got modified during iteration.");i=i.next}}keys(){let e=this,t=this._state,n=this._head,i={[Symbol.iterator](){return i},next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(n){let o={value:n.key,done:!1};return n=n.next,o}else return{value:void 0,done:!0}}};return i}values(){let e=this,t=this._state,n=this._head,i={[Symbol.iterator](){return i},next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(n){let o={value:n.value,done:!1};return n=n.next,o}else return{value:void 0,done:!0}}};return i}entries(){let e=this,t=this._state,n=this._head,i={[Symbol.iterator](){return i},next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(n){let o={value:[n.key,n.value],done:!1};return n=n.next,o}else return{value:void 0,done:!0}}};return i}[(_Ie=Symbol.toStringTag,Symbol.iterator)](){return this.entries()}trimOld(e){if(e>=this.size)return;if(e===0){this.clear();return}let t=this._head,n=this.size;for(;t&&n>e;)this._map.delete(t.key),t=t.next,n--;this._head=t,this._size=n,t&&(t.previous=void 0),this._state++}addItemFirst(e){if(!this._head&&!this._tail)this._tail=e;else if(this._head)e.next=this._head,this._head.previous=e;else throw new Error("Invalid list");this._head=e,this._state++}addItemLast(e){if(!this._head&&!this._tail)this._head=e;else if(this._tail)e.previous=this._tail,this._tail.next=e;else throw new Error("Invalid list");this._tail=e,this._state++}removeItem(e){if(e===this._head&&e===this._tail)this._head=void 0,this._tail=void 0;else if(e===this._head){if(!e.next)throw new Error("Invalid list");e.next.previous=void 0,this._head=e.next}else if(e===this._tail){if(!e.previous)throw new Error("Invalid list");e.previous.next=void 0,this._tail=e.previous}else{let t=e.next,n=e.previous;if(!t||!n)throw new Error("Invalid list");t.previous=n,n.next=t}e.next=void 0,e.previous=void 0,this._state++}touch(e,t){if(!this._head||!this._tail)throw new Error("Invalid list");if(!(t!==1&&t!==2)){if(t===1){if(e===this._head)return;let n=e.next,i=e.previous;e===this._tail?(i.next=void 0,this._tail=i):(n.previous=i,i.next=n),e.previous=void 0,e.next=this._head,this._head.previous=e,this._head=e,this._state++}else if(t===2){if(e===this._tail)return;let n=e.next,i=e.previous;e===this._head?(n.previous=void 0,this._head=n):(n.previous=i,i.next=n),e.next=void 0,e.previous=this._tail,this._tail.next=e,this._tail=e,this._state++}}}toJSON(){let e=[];return this.forEach((t,n)=>{e.push([n,t])}),e}fromJSON(e){this.clear();for(let[t,n]of e)this.set(t,n)}};var _A=class{constructor(e,t,n,i,o,s){this.document=e;this.kernelProvider=t;this.configurationSettings=i;this.sourceProviderFactory=o;this.cdnScriptProvider=s;this.postEmitter=new dX.EventEmitter;this.disposables=[];this.isWebViewOnline=Te();this.widgetSources=new Map;this.pendingModuleRequests=new Map;this.uriTranslationRequests=new mu;this.uriConverter=new IA(xn(),a=>(this.uriTranslationRequests.has(a)||this.uriTranslationRequests.set(a,Te()),this.postEmitter.fire({message:"ConvertUriForUseInWebViewRequest",payload:a}),this.uriTranslationRequests.get(a).promise)),this.isWebViewOnline.promise.catch(y),n.push(this),this.kernelProvider.onDidStartKernel(a=>{a.notebook===this.document&&this.initialize()},this,this.disposables)}get postMessage(){return this.postEmitter.event}dispose(){var e;for(;this.disposables.length;)(e=this.disposables.shift())==null||e.dispose()}onMessage(e,t){if(e==="ConvertUriForUseInWebViewResponse"){let n=t;n&&this.uriTranslationRequests.has(n.request)&&this.uriTranslationRequests.get(n.request).resolve(n.response)}else if(e==="IPyWidgets_Ready")this.sendBaseUrl(),this.sendWidgetScriptSources().catch(y);else if(e==="IPyWidgets_IsOnline"){let n=t.isOnline;this.isWebViewOnline.resolve(n)}else e==="IPyWidgets_WidgetScriptSourceRequest"&&t&&this.onRequestWidgetScript(t).catch(y)}initialize(){var e;this.jupyterLab||(this.jupyterLab=oi()),this.kernel||(this.kernel=this.kernelProvider.get(this.document)),(e=this.kernel)!=null&&e.session&&(this.scriptProvider&&!this.scriptProvider.isDisposed||(this.scriptProvider=new bA(this.kernel,this.uriConverter,this.configurationSettings,this.sourceProviderFactory,this.isWebViewOnline.promise,this.cdnScriptProvider),this.kernel.onDisposed(()=>this.dispose()),this.handlePendingRequests(),this.sendBaseUrl(),b.trace("IPyWidgetScriptSource.initialize")))}sendBaseUrl(){this.scriptProvider&&this.scriptProvider.getBaseUrl().then(e=>{e&&this.postEmitter.fire({message:"IPyWidgets_BaseUrl_Response",payload:e.toString()})}).catch(e=>b.error("Failed to get baseUrl",e))}async sendWidgetScriptSources(){if(this.scriptProvider&&!this.allWidgetScriptsSent)try{(await this.scriptProvider.getWidgetScriptSources()).forEach(t=>{var n;((n=this.widgetSources.get(t.moduleName))==null?void 0:n.source)!=="cdn"&&this.widgetSources.set(t.moduleName,t),this.postEmitter.fire({message:"IPyWidgets_WidgetScriptSource_Response",payload:t})})}catch(e){b.warn("Failed to fetch script sources",e)}finally{this.allWidgetScriptsSent=!0}}async onRequestWidgetScript(e){let{moduleName:t,moduleVersion:n,requestId:i}=e;if(b.trace(`\x1B[32mFetch Script for ${JSON.stringify(e)}`),await this.sendWidgetSource(t,n,i).catch(o=>b.error("Failed to send widget sources upon ready",o)),this.scriptProvider&&!this.allWidgetScriptsSent)try{await this.sendWidgetScriptSources()}finally{this.sendWidgetSource(t,n,i).catch(o=>b.error("Failed to send widget sources upon ready",o))}}async sendWidgetSource(e,t="*",n){var o;if(!e||e.startsWith("@jupyter"))return;if(!this.kernel||!this.scriptProvider){this.pendingModuleRequests.set(e,{moduleVersion:t,requestId:n});return}let i={moduleName:e,requestId:n};try{b.trace(`\x1B[32mFetch Script for ${e}`),i=await this.scriptProvider.getWidgetScriptSource(e,t),((o=this.widgetSources.get(i.moduleName))==null?void 0:o.source)!=="cdn"&&this.widgetSources.set(i.moduleName,i)}catch(s){b.error("Failed to get widget source due to an error",s),J("DS_INTERNAL.IPYWIDGET_DISCOVERY_ERRORED")}finally{b.trace(`\x1B[32mScript for ${e}, is ${i.scriptUri} from ${i.source}`),this.postEmitter.fire({message:"IPyWidgets_WidgetScriptSource_Response",payload:i})}}handlePendingRequests(){let e=Array.from(this.pendingModuleRequests.keys());for(;e.length;){let t=e.shift();if(t){let{moduleVersion:n,requestId:i}=this.pendingModuleRequests.get(t);this.pendingModuleRequests.delete(t),this.sendWidgetSource(t,n,i).catch(o=>b.error(`Failed to send WidgetScript for ${t}`,o))}}}};u();var CA=Symbol("IWidgetScriptSourceProviderFactory"),pX=Symbol("INbExtensionsPathProvider"),wA=Symbol("IIPyWidgetScriptManagerFactory"),Vht=Symbol("IIPyWidgetScriptManager");u();var av=$(te()),fs=require("vscode");var gX="https://unpkg.com/",_j="https://cdn.jsdelivr.net/npm/",xA="IPYWidgetCDNConfigured",fX="IPYWidgetNotFoundOnCDN",mX="IPYWidgetNoNetWorkAccess";function EIe(r,e,t){let n=e,i="index",o=e.indexOf("/");return o!==-1&&e[0]==="@"&&(o=e.indexOf("/",o+1)),o!==-1&&(i=e.substr(o+1),n=e.substr(0,o)),r===_j&&(t.startsWith("^")&&(t=t.slice(1)),i.endsWith(".js")||(i=i.concat(".js"))),`${r}${n}@${t}/dist/${i}`}function CIe(r){switch(r){case"unpkg.com":return gX;case"jsdelivr.com":return _j;default:break}}var jl=class{constructor(e,t){this.globalMemento=e;this.configurationSettings=t;this.id="cdn";this.cache=new Map;this.isOnCDNCache=new Map;this.notifiedUserAboutWidgetScriptNotFound=new Set}get cdnProviders(){return this.configurationSettings.getSettings(void 0).widgetScriptSources}dispose(){this.cache.clear()}async isOnCDN(e){let t=`MODULE_VERSION_ON_CDN_${e}`;if(this.isOnCDNCache.has(t))return this.isOnCDNCache.get(t);if(this.globalMemento.get(t,!1))return!0;let n=(async()=>{let i=new su,o=Ru(i.exists(`${gX}${e}`)),s=Ru(i.exists(`${_j}${e}`));return await Promise.race([o.promise,s.promise]),o.value||s.value?!0:(await Promise.all([o.promise,s.promise]),!!(o.value||s.value))})();return n.then(i=>{if(i)return this.globalMemento.update(t,!0)}).then(y,y),this.isOnCDNCache.set(t,n),n}async getWidgetScriptSource(e,t,n){if(n===!1)return b.ci(`Webview is offline, cannot use CDN for ${e}`),this.warnIfNoAccessToInternetFromWebView(e).catch(y),{moduleName:e};if(this.cdnProviders.length===0&&this.globalMemento.get(xA,!1))return b.ci("No CDN providers and user configured CDN"),{moduleName:e};let i=this.getModuleKey(e,t);return this.cache.get(i)||this.cache.set(i,this.getWidgetScriptSourceImplementation(e,t)),this.cache.get(i)}async generateDownloadUri(e,t,n){let i=CIe(n);if(i)return EIe(i,e,t)}getModuleKey(e,t){return`${e}${t}`}async getWidgetScriptSourceImplementation(e,t){if(b.trace(`\x1B[32mSearching for Widget Script ${e}#${t} using cdns ${this.cdnProviders.join(" ")}`),await this.configureWidgets(),this.cdnProviders.length===0)return{moduleName:e};let i=(await Promise.all(this.cdnProviders.map(o=>this.getValidUri(e,t,o)))).find(o=>o);return i?(b.trace(`\x1B[32mWidget Script ${e}#${t} found at URI: ${i}`),{moduleName:e,scriptUri:i,source:"cdn"}):(b.error(`Widget Script ${e}#${t} was not found on on any cdn`),this.handleWidgetSourceNotFound(e,t).catch(y),{moduleName:e})}async getValidUri(e,t,n){try{let i=await this.generateDownloadUri(e,t,n),o=new su;if(i&&await o.exists(i))return i}catch(i){b.trace(`Failed downloading ${e}:${t} from ${n}`);return}}async warnIfNoAccessToInternetFromWebView(e){if(this.globalMemento.get(mX,!1)||this.notifiedUserAboutWidgetScriptNotFound.has(e)||this.cdnProviders.length===0)return;switch(this.notifiedUserAboutWidgetScriptNotFound.add(e),await fs.window.showWarningMessage(C.cdnWidgetScriptNotAccessibleWarningMessage(e,JSON.stringify(this.cdnProviders)),Fe.ok,Fe.doNotShowAgain,Fe.moreInfo)){case Fe.doNotShowAgain:return this.globalMemento.update(mX,!0);case Fe.moreInfo:return fs.env.openExternal(fs.Uri.parse("https://aka.ms/PVSCIPyWidgets"));default:}}async configureWidgets(){if(this.cdnProviders.length!==0||this.globalMemento.get(xA,!1))return;if(this.configurationPromise)return this.configurationPromise.promise;this.configurationPromise=Te(),J("DS_INTERNAL.IPYWIDGET_PROMPT_TO_USE_CDN");let e=await fs.window.showInformationMessage(C.useCDNForWidgetsNoInformation,{modal:!0},Fe.ok,Fe.doNotShowAgain,Fe.moreInfo),t="dismissed";switch(e){case Fe.ok:{t="ok",await Promise.all([this.updateScriptSources(["jsdelivr.com","unpkg.com"]),this.globalMemento.update(xA,!0)]);break}case Fe.doNotShowAgain:{t="doNotShowAgain",await Promise.all([this.updateScriptSources([]),this.globalMemento.update(xA,!0)]);break}case Fe.moreInfo:{fs.env.openExternal(fs.Uri.parse("https://aka.ms/PVSCIPyWidgets"));break}default:t=e===Fe.cancel?"cancel":"dismissed";break}J("DS_INTERNAL.IPYWIDGET_PROMPT_TO_USE_CDN_SELECTION",void 0,{selection:t}),this.configurationPromise.resolve()}async updateScriptSources(e){let t="widgetScriptSources";await this.configurationSettings.updateSetting(t,e,void 0,fs.ConfigurationTarget.Global)}async handleWidgetSourceNotFound(e,t){if(this.globalMemento.get(fX,!1)||this.notifiedUserAboutWidgetScriptNotFound.has(e)||this.cdnProviders.length===0)return;switch(this.notifiedUserAboutWidgetScriptNotFound.add(e),await fs.window.showWarningMessage(C.widgetScriptNotFoundOnCDNWidgetMightNotWork(e,t,JSON.stringify(this.cdnProviders)),Fe.ok,Fe.doNotShowAgain,Fe.reportThisIssue)){case Fe.doNotShowAgain:return this.globalMemento.update(fX,!0);case Fe.reportThisIssue:return fs.env.openExternal(fs.Uri.parse("https://aka.ms/CreatePVSCDataScienceIssue"));default:}}};jl=E([(0,av.injectable)(),I(0,(0,av.inject)(St)),I(0,(0,av.named)(ir)),I(1,(0,av.inject)(Ae))],jl);var cD=class{constructor(e,t){this.document=e;this.serviceContainer=t;this.cachedMessages=[];this.postEmitter=new ms.EventEmitter;this.attachedWebviews=new WeakSet;this.modulesForWhichWeHaveDisplayedWidgetErrorMessage=new Set;this.queuedMessages=[];this.disposables=this.serviceContainer.get(ie),this.jupyterOutput=this.serviceContainer.get(Lm,Lv),this.configService=this.serviceContainer.get(Ae),this.initialize()}get postMessage(){return this.listeningToPostMessageEvent=!0,this.postEmitter.event}dispose(){var e,t;this.cachedMessages=[],(e=this.ipyWidgetMessageDispatcher)==null||e.dispose(),(t=this.ipyWidgetScriptSource)==null||t.dispose()}attach(e){if(this.attachedWebviews.has(e))return;this.attachedWebviews.add(e),this.postMessage(i=>{if(b.ci(`\x1B[32mWidget Coordinator sent ${i.message}`),i.message==="ConvertUriForUseInWebViewRequest")this.onMessage(e,"ConvertUriForUseInWebViewResponse",{request:i.payload,response:e.asWebviewUri(i.payload)});else{if(!this.readyMessageReceived){this.queuedMessages.push({type:i.message,payload:i.payload});return}this.sendPendingWebViewMessages(e),e.postMessage({type:i.message,payload:i.payload}).then(y,y)}},this,this.disposables);let t=Te(),n=async()=>{let i=new It;if(!t.completed){let s=[],a=this.serviceContainer.get(He),l=Te();a.get(this.document)?l.resolve(a.get(this.document)):a.onDidCreateKernel(d=>{d.notebook===this.document&&l.resolve(d)},this,s);let c=await l.promise;c&&(qt(c.kernelConnectionMetadata)?c.ipywidgetsVersion?t.completed||t.resolve(c.ipywidgetsVersion):c.onIPyWidgetVersionResolved(()=>{c.ipywidgetsVersion&&(t.completed||t.resolve(c.ipywidgetsVersion),fe(s))},this,s):t.completed||t.resolve(TE)),s.length&&this.disposables.push(...s)}let o=await t.promise;b.trace(`Version of IPyWidgets ${o} determined after ${i.elapsedTime/1e3}s`),e.postMessage({type:"IPyWidgets_Reply_Widget_Version",payload:o}).then(y,y)};e.onDidReceiveMessage(async i=>{b.ci(`\x1B[32mWidget Coordinator received ${i.type}`),this.onMessage(e,i.type,i.payload),i.type==="IPyWidgets_Request_Widget_Version"&&await n(),i.type==="IPyWidgets_Window_Alert"&&ms.window.showInformationMessage(i.message),i.type==="IPyWidgets_Window_Open"&&ms.env.openExternal(ms.Uri.parse(i.url)),i.type==="IPyWidgets_Ready"&&(b.trace("Web view is ready to receive widget messages"),this.readyMessageReceived=!0,this.sendPendingWebViewMessages(e))},this,this.disposables),e.postMessage({type:"IPyWidgets_IsReadyRequest",payload:void 0}).then(y,y),n().catch(y)}onMessage(e,t,n){t==="ipywidget_load_success"?this.sendLoadSucceededTelemetry(n).catch(y):t==="ipywidget_load_failure"?this.handleWidgetLoadFailure(e,n).catch(y):t==="ipywidget_widget_version_not_supported"?this.sendUnsupportedWidgetVersionFailureTelemetry(n).catch(y):t==="ipywidget_render_failure"?this.sendRenderFailureTelemetry(n):t==="ipywidget_unhandled_kernel_message"&&this.handleUnhandledMessage(n),this.getIPyWidgetMessageDispatcher().receiveMessage({message:t,payload:n}),this.getIPyWidgetScriptSource().onMessage(t,n)}sendPendingWebViewMessages(e){if(this.readyMessageReceived)for(;this.queuedMessages.length;)e.postMessage(this.queuedMessages.shift()).then(y,y)}initialize(){this.getIPyWidgetScriptSource().initialize(),this.getIPyWidgetMessageDispatcher().initialize()}async sendLoadSucceededTelemetry(e){try{J("DS_INTERNAL.IPYWIDGET_LOAD_SUCCESS",0,{moduleHash:await Nt(e.moduleName),moduleVersion:e.moduleVersion})}catch(t){}}async handleWidgetLoadFailure(e,t){try{let n=t.error.toString(),i=this.configService.getSettings(void 0).widgetScriptSources,o=i.length>0,s=`${t.moduleName}:${t.moduleVersion}`;if(!t.isOnline)n=C.loadClassFailedWithNoInternet(t.moduleName,t.moduleVersion),ms.window.showErrorMessage(n).then(y,y);else if(!o&&!this.modulesForWhichWeHaveDisplayedWidgetErrorMessage.has(s)){this.modulesForWhichWeHaveDisplayedWidgetErrorMessage.add(s);let a=Fe.moreInfo,l=C.enableCDNForWidgetsButton;n=C.enableCDNForWidgetsSetting(t.moduleName,t.moduleVersion),ms.window.showErrorMessage(n,{modal:!0},l,a).then(c=>{switch(c){case a:ms.env.openExternal(ms.Uri.parse("https://aka.ms/PVSCIPyWidgets"));break;case l:this.enableCDNForWidgets(e).catch(y);break;default:break}},y)}b.error(`Widget load failure ${n}`,i,t),J("DS_INTERNAL.IPYWIDGET_LOAD_FAILURE",0,{isOnline:t.isOnline,moduleHash:await Nt(t.moduleName),moduleVersion:t.moduleVersion,timedout:t.timedout})}catch(n){}}async enableCDNForWidgets(e){await ms.commands.executeCommand(Q.EnableLoadingWidgetsFrom3rdPartySource),await e.postMessage({type:"IPyWidgets_AttemptToDownloadFailedWidgetsAgain"})}async sendUnsupportedWidgetVersionFailureTelemetry(e){try{J("DS_INTERNAL.IPYWIDGET_WIDGET_VERSION_NOT_SUPPORTED_LOAD_FAILURE",0,{moduleHash:await Nt(e.moduleName),moduleVersion:e.moduleVersion})}catch(t){}}sendRenderFailureTelemetry(e){try{b.error("Error rendering a widget: ",e),J("DS_INTERNAL.IPYWIDGET_RENDER_FAILURE")}catch(t){}}handleUnhandledMessage(e){if(e.header.msg_type!=="status")try{if(e.header.msg_type==="error"){let t=e;t.content.traceback=t.content.traceback.map(fu)}b.trace(`Unhandled widget kernel message: ${e.header.msg_type} ${e.content}`),this.jupyterOutput.appendLine(C.unhandledMessage(e.header.msg_type,JSON.stringify(e.content))),J("DS_INTERNAL.IPYWIDGET_UNHANDLED_MESSAGE",void 0,{msg_type:e.header.msg_type})}catch(t){}}getIPyWidgetMessageDispatcher(){return this.ipyWidgetMessageDispatcher||(this.ipyWidgetMessageDispatcher=this.serviceContainer.get($d).create(this.document),this.disposables.push(this.ipyWidgetMessageDispatcher.postMessage(this.cacheOrSend,this))),this.ipyWidgetMessageDispatcher}getIPyWidgetScriptSource(){return this.ipyWidgetScriptSource||(this.ipyWidgetScriptSource=new _A(this.document,this.serviceContainer.get(He),this.serviceContainer.get(ie),this.serviceContainer.get(Ae),this.serviceContainer.get(CA),this.serviceContainer.get(jl)),this.disposables.push(this.ipyWidgetScriptSource.postMessage(this.cacheOrSend,this))),this.ipyWidgetScriptSource}cacheOrSend(e){if(!this.listeningToPostMessageEvent){b.ci("\x1B[32mQueuing messages (no listeners)"),this.cachedMessages.push(e);return}this.cachedMessages.forEach(t=>this.postEmitter.fire(t)),this.cachedMessages=[],this.postEmitter.fire(e)}};E([yn()],cD.prototype,"enableCDNForWidgets",1);var Ej=class{constructor(e,t){this.editor=e;this.pendingMessages=[];this.disposables=[];this._onDidReceiveMessage=new cm.EventEmitter;this.changeController(t)}get controller(){if(!this._controller)throw new Error("No controller defined");return this._controller.controller}changeController(e){var t,n;((t=this._controller)==null?void 0:t.id)!==e.id&&((n=this.controllerMessageHandler)==null||n.dispose(),this._controller=e,this.controllerMessageHandler=e.onDidReceiveMessage(i=>{var o;i.editor===this.editor&&((o=this.controller)==null?void 0:o.id)===e.id&&(this.eventHandlerListening?(this.sendPendingMessages(),this._onDidReceiveMessage.fire(i.message)):this.pendingMessages.push(i.message))},this,this.disposables))}dispose(){fe(this.disposables)}get onDidReceiveMessage(){return this.eventHandlerListening=!0,setTimeout(()=>this.sendPendingMessages(),0),this._onDidReceiveMessage.event}postMessage(e){return this.controller.postMessage(e,this.editor)}asWebviewUri(e){return this.controller.asWebviewUri(e)}sendPendingMessages(){if(this.pendingMessages.length){let e=this.pendingMessages.shift();for(;e;)this._onDidReceiveMessage.fire(e),e=this.pendingMessages.shift()}}},lm=class{constructor(e,t,n){this.serviceContainer=e;this.disposableRegistry=t;this.controllerManager=n;this.messageCoordinators=new WeakMap;this.notebookDisposables=new WeakMap;this.notebookCommunications=new WeakMap;this.notebookEditors=new WeakMap}activate(){cm.window.onDidChangeVisibleNotebookEditors(this.onDidChangeVisibleNotebookEditors,this,this.disposableRegistry),cm.workspace.onDidCloseNotebookDocument(this.onDidCloseNotebookDocument,this,this.disposableRegistry),this.controllerManager.onControllerSelected(this.onDidSelectController,this,this.disposableRegistry)}onDidSelectController(e){let t=this.messageCoordinators.get(e.notebook);t&&(this.messageCoordinators.delete(e.notebook),cm.window.visibleNotebookEditors.filter(n=>n.notebook===e.notebook).forEach(n=>{let i=this.notebookCommunications.get(n);this.notebookCommunications.delete(n),i&&i.controller!==e.controller.controller&&(this.notebookCommunications.delete(n),i&&i.dispose())}),t==null||t.dispose()),cm.window.visibleNotebookEditors.filter(n=>n.notebook===e.notebook).forEach(n=>this.initializeNotebookCommunication(n,e.controller))}initializeNotebookCommunication(e,t){if(e.notebook.isClosed||!hr(e.notebook))return;let n=e.notebook;if(!t){b.trace(`No controller, hence notebook communications cannot be initialized for editor ${ve(e.notebook.uri)}`);return}if(this.notebookCommunications.has(e))return;let i=new Ej(e,t);this.addNotebookDisposables(n,[i]),this.notebookCommunications.set(e,i);let o=this.messageCoordinators.get(n);o||(o=new cD(n,this.serviceContainer),this.messageCoordinators.set(n,o)),o.attach(i)}addNotebookDisposables(e,t){let n=this.notebookDisposables.get(e)||[];n.push(...t),this.notebookDisposables.set(e,n)}async onDidChangeVisibleNotebookEditors(e){e.forEach(t=>{let n=this.controllerManager.getSelected(t.notebook);this.initializeNotebookCommunication(t,n)})}onDidCloseNotebookDocument(e){var n;let t=this.notebookEditors.get(e)||[];fe(this.notebookDisposables.get(e)||[]),t.forEach(i=>{var o;return(o=this.notebookCommunications.get(i))==null?void 0:o.dispose()}),(n=this.messageCoordinators.get(e))==null||n.dispose(),this.messageCoordinators.delete(e)}};lm=E([(0,WS.injectable)(),I(0,(0,WS.inject)(Kr)),I(1,(0,WS.inject)(ie)),I(2,(0,WS.inject)(Tt))],lm);u();var um=$(te());var VS=class{constructor(e,t,n,i,o){this.disposables=e;this.kernelProvider=t;this.controllers=n;this.liveKernelTracker=i;this.preferredRemoteKernelIdProvider=o}activate(){this.kernelProvider.onDidStartKernel(this.onDidStartKernel,this,this.disposables),this.controllers.onControllerSelectionChanged(this.onNotebookControllerSelectionChanged,this,this.disposables)}onNotebookControllerSelectionChanged({selected:e,notebook:t,controller:n}){t.isClosed||(n.connection.kind==="connectToLiveRemoteKernel"&&n.connection.kernelModel.id&&(e?this.liveKernelTracker.trackKernelIdAsUsed(t.uri,n.connection.serverProviderHandle,n.connection.kernelModel.id):this.liveKernelTracker.trackKernelIdAsNotUsed(t.uri,n.connection.serverProviderHandle,n.connection.kernelModel.id)),er(n.connection)&&this.preferredRemoteKernelIdProvider.clearPreferredRemoteKernelId(t.uri).catch(y))}onDidStartKernel(e){if(!e.resourceUri)return;let t=e.resourceUri;if(e.kernelConnectionMetadata.kind!=="startUsingRemoteKernelSpec")return;let n=e.kernelConnectionMetadata.serverProviderHandle,i=()=>{var s,a;let o=(a=(s=e.session)==null?void 0:s.kernel)==null?void 0:a.id;!e.disposed&&!e.disposing&&o&&(b.debug(`Updating preferred kernel for remote notebook ${o}`),this.preferredRemoteKernelIdProvider.storePreferredRemoteKernelId(t,o).catch(y),this.liveKernelTracker.trackKernelIdAsUsed(t,n,o))};i(),e.onDidKernelSocketChange(i,this,this.disposables)}};VS=E([(0,um.injectable)(),I(0,(0,um.inject)(ie)),I(1,(0,um.inject)(He)),I(2,(0,um.inject)(Tt)),I(3,(0,um.inject)(Hh)),I(4,(0,um.inject)(Hs))],VS);u();var cv=$(te());var hX=require("vscode");var lv=class{constructor(e,t,n,i){this.disposables=e;this.uriStorage=t;this.controllers=n;this.serverProviderRegistry=i;this.handledServerProviderChanges=new WeakSet}activate(){this.serverProviderRegistry.jupyterCollections.forEach(e=>this.checkExpiredServersInJupyterCollection(e)),this.serverProviderRegistry.onDidChangeCollections(({added:e,removed:t})=>{e.forEach(n=>this.checkExpiredServersInJupyterCollection(n)),t.forEach(n=>this.removeControllersBelongingToDisposedProvider(n.extensionId,n.id))},this,this.disposables)}async checkExpiredServersInJupyterCollection(e){!this.handledServerProviderChanges.has(e.serverProvider)&&e.serverProvider.onDidChangeServers&&(this.handledServerProviderChanges.add(e.serverProvider),e.serverProvider.onDidChangeServers(()=>this.checkExpiredServersInJupyterCollection(e).catch(y),this,this.disposables));let t=new hX.CancellationTokenSource;this.disposables.push(t);try{let n=await Promise.resolve(e.serverProvider.provideJupyterServers(t.token));await this.removeControllersAndUriStorageBelongingToInvalidServers(e.extensionId,e.id,(n||[]).map(i=>i.id))}finally{t.dispose()}}async removeControllersAndUriStorageBelongingToInvalidServers(e,t,n){let i=this.uriStorage.all;await Promise.all(i.filter(o=>o.provider.extensionId===e&&o.provider.id===t).map(async o=>{n.includes(o.provider.handle)||await this.uriStorage.remove(o.provider)})),this.controllers.registered.forEach(o=>{let s=o.connection;er(s)||s.serverProviderHandle.extensionId!==e||s.serverProviderHandle.id!==t||n.includes(s.serverProviderHandle.handle)||(b.warn(`Deleting controller ${o.id} as it is associated with a server Id that has been removed`),o.dispose())})}removeControllersBelongingToDisposedProvider(e,t){this.controllers.registered.forEach(n=>{let i=n.connection;er(i)||i.serverProviderHandle.extensionId!==e||i.serverProviderHandle.id!==t||(b.warn(`Deleting controller ${n.id} as it is associated with a Provider Id that has been removed`),n.dispose())})}};E([yn("Failed to check what servers were shutdown in Controller Watcher")],lv.prototype,"checkExpiredServersInJupyterCollection",1),lv=E([(0,cv.injectable)(),I(0,(0,cv.inject)(ie)),I(1,(0,cv.inject)(fr)),I(2,(0,cv.inject)(Tt)),I(3,(0,cv.inject)(lr))],lv);u();u();var BS=$(te());u();var vX=require("vscode");var DA=class{constructor(e,t,n,i,o,s){this.label=e;this._description=t;this.detail=n;this.category=i;this.serverDisplayName=o;this.getDescription=s;this._onDidChange=new vX.EventEmitter;this.onDidChange=this._onDidChange.event}get description(){var e;return((e=this.getDescription)==null?void 0:e.call(this))||this._description}set description(e){this._description=e}dispose(){this._onDidChange.dispose()}triggerChange(){this._onDidChange.fire(this)}};function yX(r){switch(r.kind){case"connectToLiveRemoteKernel":return C.kernelCategoryForJupyterSession;case"startUsingRemoteKernelSpec":return C.kernelCategoryForRemoteJupyterKernel;default:return Cj(r)}}function Cj(r){switch(r.kind){case"startUsingLocalKernelSpec":return C.kernelCategoryForJupyterKernel;case"startUsingPythonInterpreter":{if(jh(r.kernelSpec)==="registeredByNewVersionOfExtForCustomKernelSpec")return C.kernelCategoryForJupyterKernel;switch(zr(r.interpreter)){case"Conda":return Ep(r.interpreter)?C.kernelCategoryForCondaWithoutPython:C.kernelCategoryForConda;case"PipEnv":return C.kernelCategoryForPipEnv;case"Poetry":return C.kernelCategoryForPoetry;case"Pyenv":return C.kernelCategoryForPyEnv;case"Venv":case"VirtualEnv":case"VirtualEnvWrapper":return C.kernelCategoryForVirtual;default:return C.kernelCategoryForGlobal}}default:return""}}var jS=class{constructor(e,t,n){this.platform=e;this.jupyterUriProviderRegistration=t;this.disposables=n;this.details=new Map}getDisplayData(e){if(!this.details.get(e.id)){let i=ct(e),o=N$(e,this.platform);e.kind==="connectToLiveRemoteKernel"&&(o=vV(e));let s=e.kind==="connectToLiveRemoteKernel"?()=>vV(e):void 0,a=Cj(e),l=new DA(i,o,"",a,void 0,s);this.disposables.push(l),this.details.set(e.id,l)}let t=this.details.get(e.id);if(this.details.set(e.id,t),e.kind==="connectToLiveRemoteKernel"||e.kind==="startUsingRemoteKernelSpec"){let i=lS(e.serverProviderHandle,this.jupyterUriProviderRegistration,C.kernelDefaultRemoteDisplayName);t.serverDisplayName!==i&&(t.serverDisplayName=i,t.triggerChange())}let n=yX(e);return t.category!==n&&(t.category=n,t.triggerChange()),t}};jS=E([(0,BS.injectable)(),I(0,(0,BS.inject)(ps)),I(1,(0,BS.inject)(lr)),I(2,(0,BS.inject)(ie))],jS);u();var zd=$(te()),Qd=require("vscode");u();var dm=$(te()),SX=require("vscode");u();var bX=require("vscode");function PA(r){var e;try{return A$(Ca(r))||((e=r.getCells().find(n=>n.kind===bX.NotebookCellKind.Code))==null?void 0:e.document.languageId)}catch(t){b.warn("Failed to determine language of first cell",t)}}var IX="DATASCIENCE.LAST_SAVED_CELL_LANGUAGE",Js=class{constructor(e,t,n){this.disposables=e;this.globalMemento=t;this.pythonExtensionChecker=n}getPreferredLanguage(e){var i,o;let t=((i=e==null?void 0:e.language_info)==null?void 0:i.name)||((o=e==null?void 0:e.kernelspec)==null?void 0:o.language)||this.lastSavedNotebookCellLanguage,n=this.pythonExtensionChecker.isPythonExtensionInstalled?Je:"plaintext";return Kc(t||n)}activate(){SX.workspace.onDidSaveNotebookDocument(this.onDidSaveNotebookDocument,this,this.disposables)}getSupportedLanguages(e){if(qt(e))return _9;{let t=Kc($c(e)||"");return t&&C9.includes(t.toLowerCase())?[t,"raw"]:[]}}get lastSavedNotebookCellLanguage(){return this.globalMemento.get(IX)}async onDidSaveNotebookDocument(e){if(!hr(e))return;let t=PA(e);t&&t!==this.lastSavedNotebookCellLanguage&&await this.globalMemento.update(IX,t)}};E([yn("Saving last saved cell language")],Js.prototype,"onDidSaveNotebookDocument",1),Js=E([(0,dm.injectable)(),I(0,(0,dm.inject)(ie)),I(1,(0,dm.inject)(St)),I(1,(0,dm.named)(ir)),I(2,(0,dm.inject)(Io))],Js);u();function _X(r){let e={kernelSpecCount:0,localKernelSpecCount:0,remoteKernelSpecCount:0,kernelInterpreterCount:0,kernelLiveCount:0};r.forEach(t=>{switch(t.kind){case"connectToLiveRemoteKernel":e.kernelLiveCount+=1;break;case"startUsingRemoteKernelSpec":e.localKernelSpecCount+=1,e.kernelSpecCount+=1;break;case"startUsingLocalKernelSpec":e.remoteKernelSpecCount+=1,e.kernelSpecCount+=1;break;case"startUsingPythonInterpreter":{e.kernelInterpreterCount+=1;break}default:break}}),J("DS_INTERNAL.KERNEL_COUNT",{...e})}u();var Vt=require("vscode");u();var gu=require("vscode");u();async function EX(r,e,t){let n=`${await qb({uri:t})}#${wi.get(e)}`;await r.update(n,void 0)}u();var Ko=Symbol("INotebookEditorProvider");u();var CX=require("vscode");async function wX(r,e){let t=e==null?void 0:e.findNotebookEditor(r);return t?CX.commands.executeCommand("notebook.selectKernel",{notebookEditor:t}):(b.error("Unable to select kernel as the Notebook document could not be identified"),!1)}u();var xX=require("vscode");var TA=class extends Qc{constructor(e){super(C.failedToStartAnUntrustedKernelSpec(ct(e),e.kernelSpec.specFile?ve(xX.Uri.file(e.kernelSpec.specFile)):""),void 0,e)}};var qr=class qr{static async switchController(e,t){let i=t.get(Ko).findNotebookEditor(e),o=t.get(Tt),s,a=Te(),l=o.onControllerSelected(d=>a.resolve(d.controller));return await wX(e,t.get(Ko))&&i&&(s=await a.promise),l.dispose(),s?{controller:s.controller,metadata:s.connection}:void 0}static async notifyAndRestartDeadKernel(e){let t=await gu.window.showErrorMessage(C.cannotRunCellKernelIsDead(ct(e.kernelConnectionMetadata)),{modal:!0},C.showJupyterLogs,C.restartKernel),n=!1;switch(t){case C.restartKernel:{await e.restart(),n=!0;break}case C.showJupyterLogs:gu.commands.executeCommand(Q.ViewJupyterOutput).then(y,y)}return n}static async handleKernelError(e,t,n,i,o,s,a,l){let c=e.get(St,ir),d=e.get(Cn);a.interpreter&&n==="start"&&EX(c,19,a.interpreter.uri).catch(y);let p=await d.handleKernelError(t,n,a,i,l),f=er(a),m=e.tryGet(jd);switch((m==null?void 0:m.isSupported)&&f&&n==="start"&&Jr(i,"DS_INTERNAL.RAWKERNEL_SESSION_NO_IPYKERNEL",{reason:p}),o.dispose().catch(y),p){case 1:case 2:throw t;case 3:{let h=await qr.switchController(i,e);if(!h)throw t;s=h.controller,a=h.metadata;break}}return{controller:s,metadata:a}}static convertContextToFunction(e,t){switch(e){case"start":case"execution":return n=>n.start(t);case"interrupt":return n=>n.interrupt();case"restart":return n=>n.restart()}}static async verifyKernelState(e,t,n,i,o,s,a){let{kernel:l,deadKernelAction:c}=await i;if(sA(l)){if(this.deleteKernelInfo(t,i),c==="deadKernelWasNoRestarted")throw new rm(l.kernelConnectionMetadata);return c==="deadKernelWasRestarted"?l:qr.wrapKernelMethod(l.kernelConnectionMetadata,"start",o,e,t,n,a,s)}return l}static async wrapKernelMethod(e,t,n,i,o,s,a,l=()=>void 0){var f,m,g,h;let c=this.getKernelInfo(o);if(!s.disableUI&&(c!=null&&c.options.disableUI)&&(c.options.disableUI=!1),!s.disableUI&&(c!=null&&c.kernel.resolved)&&((m=(f=c==null?void 0:c.kernel.value)==null?void 0:f.kernel)!=null&&m.disposed||(h=(g=c==null?void 0:c.kernel.value)==null?void 0:g.kernel)!=null&&h.disposing)&&(this.deleteKernelInfo(o),c=void 0),c&&t!=="restart"&&t!=="interrupt")return qr.verifyKernelState(i,o,s,c.kernel.promise,n,l,a);b.debug(`${t} the kernel, options.disableUI=${s.disableUI} for ${ve("notebook"in o?o.notebook.uri:o.resource)}`);let d=qr.wrapKernelMethodImpl(e,t,i,o,s,n,l),p=Ru(d);return p.promise.catch(y),d.then(v=>{v.kernel.onDisposed(()=>{this.deleteKernelInfo(o,p.promise)},void 0,a)}).catch(()=>{this.deleteKernelInfo(o,p.promise)}),this.setKernelInfo(o,p,s),qr.verifyKernelState(i,o,s,p.promise,n,l,a)}static getKernelInfo(e){return"notebook"in e?qr.connectionsByNotebook.get(e.notebook):qr.connectionsByUri.get(e.resource.toString())}static setKernelInfo(e,t,n){"notebook"in e?qr.connectionsByNotebook.set(e.notebook,{kernel:t,options:n}):qr.connectionsByUri.set(e.resource.toString(),{kernel:t,options:n})}static deleteKernelInfo(e,t){var n,i;if(!t){"notebook"in e?qr.connectionsByNotebook.delete(e.notebook):qr.connectionsByUri.delete(e.resource.toString());return}"notebook"in e&&((n=qr.connectionsByNotebook.get(e.notebook))==null?void 0:n.kernel.promise)===t?qr.connectionsByNotebook.delete(e.notebook):e.resource&&((i=qr.connectionsByUri.get(e.resource.toString()))==null?void 0:i.kernel.promise)===t&&qr.connectionsByUri.delete(e.resource.toString())}static verifyWeCanStartKernel(e,t){if(!er(e)||!e.kernelSpec.specFile)return;if(!t.get(TS).isTrusted(gu.Uri.file(e.kernelSpec.specFile)))throw new TA(e)}static async wrapKernelMethodImpl(e,t,n,i,o,s,a){let l=n.get(He),c=n.get(Wh),d,p=qr.convertContextToFunction(t,o),f=t,m="controller"in i?i.controller:void 0;for(t==="start"&&qr.verifyWeCanStartKernel(e,n);d===void 0;){if("notebook"in i&&i.notebook.isClosed)throw new gu.CancellationError;d="notebook"in i?l.getOrCreate(i.notebook,{metadata:e,controller:m||i.controller,resourceUri:i.resource}):c.getOrCreate(i.resource,{metadata:e,resourceUri:i.resource});try{if(t!=="restart"&&sA(d)&&!o.disableUI){let g=await qr.notifyAndRestartDeadKernel(d);return{kernel:d,deadKernelAction:g?"deadKernelWasRestarted":"deadKernelWasNoRestarted"}}else{if(a(f,d),await p(d),"notebook"in i&&i.notebook.isClosed)throw new gu.CancellationError;sA(d)&&!o.disableUI&&f!=="interrupt"&&await qr.notifyAndRestartDeadKernel(d)}}catch(g){if(Ei(g)||b.warn(`Error occurred while trying to ${f} the kernel, options.disableUI=${o.disableUI}`,g),o.disableUI)throw g;if("notebook"in i&&i.notebook.isClosed)throw new gu.CancellationError;let h=await qr.handleKernelError(n,g,f,i.resource,d,m,e,s);if(m=h.controller,e=h.metadata,p=v=>v.start(o),f="start",s==="3rdPartyExtension")throw g;d=void 0}}return{kernel:d}}static async connectToNotebookKernel(e,t,n,i,o,s="jupyterExtension",a=()=>void 0){return qr.wrapKernelMethod(e,"start",s,t,n,i,o,a)}static async connectToKernel(e,t,n,i,o,s="jupyterExtension",a=()=>void 0){return qr.wrapKernelMethod(e,"start",s,t,n,i,o,a)}};qr.connectionsByNotebook=new WeakMap,qr.connectionsByUri=new Map;var ka=qr;u();var uv=class{constructor(e){this.controller=e}get id(){return this.controller.id}createNotebookCellExecution(e){return this.controller.createNotebookCellExecution(e)}};u();var NA=require("vscode");var kA=class extends Fr{constructor(t,n,i){super();this.kernel=t;this.controller=n;this.notebook=i}initialize(){let t=this.kernel,n=this.controller,i=this.notebook;if(t.kernelConnectionMetadata.kind!=="connectToLiveRemoteKernel"||t.status!=="busy"&&t.status!=="unknown"||!n.createNotebookExecution)return;this._register(NA.workspace.onDidCloseNotebookDocument(s=>{s===i&&this.dispose()},this)),this._register(n.onDidChangeSelectedNotebooks(s=>{s.notebook===i&&s.selected===!1&&this.dispose()},this)),this._register(t.onStatusChanged(s=>{s!=="busy"&&s!=="unknown"&&this.dispose()},this));let o=n.createNotebookExecution(i);o.start(),this._register(new NA.Disposable(()=>o.end()))}};var RA=class r{constructor(e,t,n,i,o,s,a,l,c,d,p){this.kernelConnection=e;this._viewType=n;this.kernelProvider=i;this.context=o;this.languageService=a;this.configuration=l;this.extensionChecker=c;this.serviceContainer=d;this.displayDataProvider=p;this._onNotebookControllerSelectionChanged=new Vt.EventEmitter;this._onConnecting=new Vt.EventEmitter;this.pendingCellAdditions=new WeakMap;this._onDidDispose=new Vt.EventEmitter;this.disposables=[];this.notebookKernels=new WeakMap;this.isDisposed=!1;this.runningCellExecutions=new WeakMap;this.associatedDocuments=new WeakMap;this.restoredConnections=new WeakSet;var f;xG(e.id,(f=e.interpreter)==null?void 0:f.id),s.push(this),this._onNotebookControllerSelected=new Vt.EventEmitter,this.displayData=this.displayDataProvider.getDisplayData(this.connection),this.controller=Vt.notebooks.createNotebookController(t,n,this.displayData.label,this.handleExecution.bind(this),this.getRendererScripts()),this.displayData.onDidChange(this.updateDisplayData,this,this.disposables),this.updateDisplayData(),this.controller.interruptHandler=this.handleInterrupt.bind(this),this.controller.supportsExecutionOrder=!0,this.controller.supportedLanguages=this.languageService.getSupportedLanguages(e),this.controller.onDidChangeSelectedNotebooks(this.onDidChangeSelectedNotebooks,this,this.disposables),Vt.workspace.onDidCloseNotebookDocument(m=>{this.associatedDocuments.delete(m)},this,this.disposables)}get id(){return this.controller.id}get label(){return this.controller.label}get connection(){return this.kernelConnection}get viewType(){return this._viewType}get onNotebookControllerSelected(){return this._onNotebookControllerSelected.event}get onNotebookControllerSelectionChanged(){return this._onNotebookControllerSelectionChanged.event}get onConnecting(){return this._onConnecting.event}get onDidReceiveMessage(){return this.controller.onDidReceiveMessage}get onDidDispose(){return this._onDidDispose.event}isAssociatedWithDocument(e){return this.associatedDocuments.has(e)}static create(e,t,n,i,o,s,a,l,c,d,p,f){let m=new r(e,t,n,i,o,s,a,l,c,d,p);try{m.controller.variableProvider=f}catch(g){b.warn("Failed to attach variable provider",g)}return m}async restoreConnection(e){var d;if(this.restoredConnections.has(e))return;this.restoredConnections.add(e);let t=await this.connectToKernel(e,new vr(!0));if(this.kernelConnection.kind==="connectToLiveRemoteKernel"){let p=new kA(t,this.controller,e);this.disposables.push(p),p.initialize()}let n=this.kernelProvider.getKernelExecution(t),o=await this.serviceContainer.get(Vl).getLastTrackedCellExecution(e,t);if(!((d=t.session)!=null&&d.kernel)||n.pendingCells.length||!o||e.cellCount<o.cellIndex||e.cellAt(o.cellIndex).kind!==Vt.NotebookCellKind.Code)return;let s=!1,a=[],l,c=(p,f)=>{if(!(f.direction==="send"||s)&&Jd(f.msg)===o.msg_id){if("msg_type"in f.msg&&f.msg.msg_type==="status"&&"execution_state"in f.msg.content&&f.msg.content.execution_state==="idle")return;s=!0,n.resumeCellExecution(e.cellAt(o.cellIndex),{msg_id:o.msg_id,startTime:o.startTime,executionCount:o.executionCount}).catch(y),fe(a)}};t.session.kernel.anyMessage.connect(c),l=new Vt.Disposable(()=>{Xs(()=>{var p,f;return(f=(p=t.session)==null?void 0:p.kernel)==null?void 0:f.anyMessage.disconnect(c)})}),a.push(l),this.disposables.push(l)}updateConnection(e){e.kind!=="connectToLiveRemoteKernel"&&(this.controller.label=ct(e))}asWebviewUri(e){return this.controller.asWebviewUri(e)}postMessage(e,t){let n=e&&"message"in e?e.message:"";return b.ci(`\x1B[32mPosting message to Notebook UI ${n}`),this.controller.postMessage(e,t)}setPendingCellAddition(e,t){if(this.viewType!==ht)throw new Error("setPendingCellAddition only applies to the Interactive Window");this.pendingCellAdditions.set(e,t)}dispose(){if(this.isDisposed)return;let e=Vt.workspace.notebookDocuments.filter(t=>this.associatedDocuments.has(t)).map(t=>t.uri.toString());b.debug(`Disposing controller ${this.id} associated with connection ${this.connection.id} ${e.length?"and documents "+e.join(", "):""}`),b.ci(`Disposing controller ${this.id} associated with connection ${this.connection.id} ${e.length?"and documents "+e.join(", "):""} called from ${new Error("").stack}`),this.isDisposed=!0,this._onNotebookControllerSelected.dispose(),this._onNotebookControllerSelectionChanged.dispose(),this._onConnecting.dispose(),this.controller.dispose(),this._onDidDispose.fire(),this._onDidDispose.dispose(),fe(this.disposables)}updateDisplayData(){this.controller.label=this.displayData.label;let e=this.connection.kind==="connectToLiveRemoteKernel"?"":this.displayData.description;this.controller.description=e,this.displayData.serverDisplayName&&(this.controller.description=e?`${e} (${this.displayData.serverDisplayName})`:this.displayData.serverDisplayName)}async handleExecution(e,t){if(e.length<1)return;let n=Uc(t);n==null||n.cellExecutionCount(e.length);let i=n==null?void 0:n.preExecuteCellTelemetry();this.pendingCellAdditions.has(t)&&await this.pendingCellAdditions.get(t),e=e.filter(o=>o.index<0?(b.warn(`Attempting to run a cell with index ${o.index}, kind ${o.kind}, text = ${o.document.getText()}`),!1):!0),Vt.workspace.isTrusted&&(b.debug(`Handle Execution of Cells ${e.map(o=>o.index)} for ${ve(t.uri)}`),await Ta(t.uri,this.connection),i==null||i.stop(),await Promise.all(e.map(o=>this.executeCell(t,o))))}async onDidChangeSelectedNotebooks(e){var n,i;if(b.ci(`NotebookController selection event called for notebook ${e.notebook.uri.toString()} & controller ${this.connection.kind}:${this.id}. Selected ${e.selected} `),this.associatedDocuments.has(e.notebook)&&e.selected)return;if(!e.selected){let o=this.kernelProvider.get(e.notebook);(o==null?void 0:o.kernelConnectionMetadata.id)===this.kernelConnection.id&&(b.info(`Disposing kernel ${this.kernelConnection.id} for notebook ${ve(e.notebook.uri)} due to selection of another kernel or closing of the notebook`),o.dispose().catch(y)),this.associatedDocuments.delete(e.notebook),this._onNotebookControllerSelectionChanged.fire(e);return}if(!hr(e.notebook)&&e.notebook.notebookType!==ht||!Vt.workspace.isTrusted)return;(i=Uc(e.notebook))==null||i.kernelSelected(this.kernelConnection.id,(n=this.kernelConnection.interpreter)==null?void 0:n.id),wIe(this.kernelConnection);let t=Te();b.ci(`Controller ${this.connection.kind}:${this.id} associated with nb ${ve(e.notebook.uri)}`),this.associatedDocuments.set(e.notebook,t.promise),await this.onDidSelectController(e.notebook),await this.updateCellLanguages(e.notebook),this._onNotebookControllerSelected.fire({notebook:e.notebook,controller:this}),this._onNotebookControllerSelectionChanged.fire(e),b.debug("Controller selection change completed"),t.resolve()}async updateCellLanguages(e){let t=this.controller.supportedLanguages;if(!t||(t==null?void 0:t.length)===0)return;let i=qt(this.kernelConnection)?Je:t[0];await Promise.all(e.getCells().filter(o=>o.kind===Vt.NotebookCellKind.Code).map(async o=>{t.includes(o.document.languageId)||await Vt.languages.setTextDocumentLanguage(o.document,i).then(y,y)}))}getRendererScripts(){return this.context.extensionMode===Vt.ExtensionMode.Development||this.context.extensionMode===Vt.ExtensionMode.Test?[new Vt.NotebookRendererScript(Vt.Uri.joinPath(this.context.extensionUri,"dist","webviews","webview-side","widgetTester","widgetTester.js"))]:[]}handleInterrupt(e){b.debug(`VS Code interrupted kernel for ${ve(e.uri)}`),e.getCells().forEach(t=>nt(t,"Cell cancellation requested")),Vt.commands.executeCommand(Q.InterruptKernel,{notebookEditor:{notebookUri:e.uri}}).then(y,t=>b.error("Failed to interrupt",t))}createCellExecutionIfNecessary(e,t){let n=this.runningCellExecutions.get(e.notebook);if(!n||n.cell===e){n==null||n.end(void 0,void 0),n=lo.getOrCreate(e,t,!0),this.runningCellExecutions.set(e.notebook,n);let i=n.end.bind(n);n.end=(o,s)=>{this.runningCellExecutions.delete(e.notebook),i(o,s)}}return n}async executeCell(e,t,n){var f;let i=new Pn,o=i.add(new Vt.CancellationTokenSource);i.add(Vt.workspace.onDidCloseNotebookDocument(m=>m===e?o.cancel():void 0));let s=this.createCellExecutionIfNecessary(t,new uv(this.controller)),a="start",l,c=new uv(this.controller),d=!1,p=this.serviceContainer.get(Vl);try{if(l=await this.connectToKernel(e,new vr(!1)),l.disposing)throw new Vt.CancellationError;let m=(f=Uc(e))==null?void 0:f.executeCell();m&&i.add(new Vt.Disposable(()=>m.stop())),d=!0,l&&l.controller.id!==c.id&&(c=l.controller,s=this.createCellExecutionIfNecessary(t,l.controller)),a="execution",l.controller.id===this.id&&this.updateKernelInfoInNotebookWhenAvailable(l,e),p.trackCellExecution(t,l);let h=this.kernelProvider.getKernelExecution(l).executeCell(t,n);return h.then(()=>{if(l&&!CE.isExiting)return p.deleteTrackedCellExecution(t,l)}).catch(y),await h}catch(m){if(m instanceof am)return;Ei(m)||b.error("Error in execution",m),d||(s.start(),s.clearOutput(t).then(y,y));let g=this.serviceContainer.get(Cn);m=Xn.unwrap(m);let h=Ei(m)||m instanceof rm;await Vf(t,c,await g.getErrorMessageForDisplayInCell(m,a,e.uri),h)}finally{i.dispose()}}async connectToKernel(e,t){var i;let n=(i=Uc(e))==null?void 0:i.startKernel();return this._onConnecting.fire(),ka.connectToNotebookKernel(this.kernelConnection,this.serviceContainer,{resource:e.uri,notebook:e,controller:this.controller},t,this.disposables).finally(()=>n==null?void 0:n.stop())}updateKernelInfoInNotebookWhenAvailable(e,t){if(this.notebookKernels.get(t)===e)return;this.notebookKernels.set(t,e);let n=[];Vt.workspace.onDidCloseNotebookDocument(s=>{s===t&&fe(n)},this,n);let i=e.onDisposed(()=>fe(n)),o=e.onStatusChanged(async()=>{e.disposed||!e.info||this.associatedDocuments.has(t)&&(await DX(t,e.kernelConnectionMetadata,e.info),e.info.status==="ok"&&fe(n))});n.push({dispose:()=>o.dispose()}),n.push({dispose:()=>i==null?void 0:i.dispose()})}async onDidSelectController(e){let t=this.connection,n=this.kernelProvider.get(e);if(n&&O$(n.kernelConnectionMetadata,t)){b.info("Switch kernel did not change kernel.");return}if(Jr(e.uri,"DS_INTERNAL.SWITCH_KERNEL"),n&&Vt.window.visibleNotebookEditors.filter(s=>s.notebook===e).forEach(s=>this.postMessage({message:"IPyWidgets_onKernelChanged",payload:void 0},s)),await DX(e,t),e.notebookType===ht)return;let i=this.kernelProvider.getOrCreate(e,{metadata:t,controller:this.controller,resourceUri:e.uri});if(b.debug(`KernelProvider switched kernel to id = ${i.kernelConnectionMetadata.id}`),qt(this.kernelConnection)&&!this.extensionChecker.isPythonExtensionInstalled)return;let o=this.serviceContainer.get(TS);!this.configuration.getSettings(void 0).disableJupyterAutoStart&&er(this.kernelConnection)&&this.kernelConnection.kernelSpec.specFile&&o.isTrusted(Vt.Uri.file(this.kernelConnection.kernelSpec.specFile))&&this.connectToKernel(e,new vr(!0))}};async function DX(r,e,t){let n=Ca(r)||{},{changed:i}=await D$(n,e,t);i&&await mG(r,n)}async function wIe(r){let e=await Cp(r.interpreter,!0),t=(e==null?void 0:e.major)||0,n=(e==null?void 0:e.minor)||0;!e||t>=4||t<=0||n<=-1||r.kind!=="startUsingLocalKernelSpec"&&r.kind!=="startUsingPythonInterpreter"||(t<3||t===3&&n<=5)&&Vt.window.showWarningMessage(C.warnWhenSelectingKernelWithUnSupportedPythonVersion,Fe.learnMore).then(i=>{if(i===Fe.learnMore)return KI("https://aka.ms/jupyterUnSupportedPythonKernelVersions")},y)}var HS=class{constructor(e,t,n,i,o,s){this.disposables=e;this.pythonEnvFilter=t;this.extensionChecker=n;this.serviceContainer=i;this.serverUriStorage=o;this.kernelFinder=s;this.registeredControllers=new Map;this.changeEmitter=new Qd.EventEmitter;this.registeredMetadatas=new Map;this.selectedEmitter=new Qd.EventEmitter;this.selectionChangedEmitter=new Qd.EventEmitter;this.selectedControllers=new WeakMap;this._activeInterpreterControllerIds=new Set}get onDidChange(){return this.changeEmitter.event}get registered(){return[...this.registeredControllers.values()]}get all(){return this.metadatas}get metadatas(){return[...this.registeredMetadatas.values()]}get onControllerSelected(){return this.selectedEmitter.event}get onControllerSelectionChanged(){return this.selectionChangedEmitter.event}activate(){this.kernelFinder.onDidChangeKernels(()=>this.loadControllers(),this,this.disposables),this.kernelFinder.registered.forEach(e=>this.monitorDeletionOfConnections(e)),this.kernelFinder.onDidChangeRegistrations(e=>e.added.forEach(t=>this.monitorDeletionOfConnections(t)),this,this.disposables),this.pythonEnvFilter.onDidChange(this.onDidChangeFilter,this,this.disposables),this.serverUriStorage.onDidChange(this.onDidChangeFilter,this,this.disposables),this.serverUriStorage.onDidChange(this.onDidChangeUri,this,this.disposables),this.serverUriStorage.onDidRemove(this.onDidRemoveServers,this,this.disposables),this.onDidChange(({added:e})=>{e.forEach(t=>{t.onNotebookControllerSelectionChanged(n=>{!n.selected&&this.isFiltered(t.connection)&&this.canControllerBeDisposed(t)&&(b.warn(`Removing controller ${t.id} for ${t.connection.kind} from kernel list`),t.dispose())},this,this.disposables)})},this,this.disposables),Qd.workspace.onDidOpenNotebookDocument(this.onDidOpenNotebookDocument,this,this.disposables),Qd.workspace.notebookDocuments.forEach(e=>this.onDidOpenNotebookDocument(e).catch(y)),this.loadControllers()}loadControllers(){this.controllersPromise=this.loadControllersImpl(),_X(this.registered.map(e=>e.connection)),b.ci(`Providing notebook controllers with length ${this.registered.length}.`)}get loaded(){return this.controllersPromise}async onDidOpenNotebookDocument(e){e.notebookType!==bt&&e.notebookType!==ht||Qd.workspace.isTrusted}async loadControllersImpl(){let e=this.kernelFinder.kernels;this.createNotebookControllers(e),Array.from(this.registered).filter(n=>{let i=e.some(o=>o.id===n.connection.id)||ji&&this._activeInterpreterControllerIds.has(n.id);return!i&&n.connection.kind==="connectToLiveRemoteKernel"?!0:this.canControllerBeDisposed(n)?(i||b.debug(`Controller ${n.connection.kind}:'${n.id}' for view = '${n.viewType}' is no longer a valid`),!i):!1}).forEach(n=>{b.warn(`Disposing old controller ${n.connection.kind}:'${n.id}' for view = '${n.viewType}'`),n.dispose()})}createNotebookControllers(e){if(e.length!==0)try{this.batchAdd(e,[bt,ht])}catch(t){if(!Ei(t,!0))throw t}}async monitorDeletionOfConnections(e){let t=e.onDidChangeKernels(({removed:n})=>{let i=new Set((n||[]).map(o=>o.id));this.registered.filter(o=>i.has(o.connection.id)).forEach(o=>{b.warn(`Deleting controller ${o.id} as it is associated with a connection that has been deleted ${o.connection.kind}:${o.id}`),o.dispose()})},this,this.disposables);this.kernelFinder.onDidChangeRegistrations(n=>{n.removed.includes(e)&&t.dispose()})}onDidChangeUri(){this.onDidChangeFilter()}async onDidRemoveServers(e){e.forEach(t=>{this.registered.forEach(n=>{Mt(n.connection)&&n.connection.serverProviderHandle.id===t.id&&n.connection.serverProviderHandle.handle===t.handle&&(b.warn(`Deleting controller ${n.id} as it is associated with a connection that has been removed`),n.dispose())})}),this.onDidChangeFilter()}onDidChangeFilter(){this.all.filter(t=>!this.isFiltered(t)).forEach(t=>this.addOrUpdate(t,[bt,ht])),this.registered.forEach(t=>{this.isFiltered(t.connection)&&this.canControllerBeDisposed(t)&&(b.warn(`Deleting controller ${t.id} as it is associated with a connection that has been hidden`),t.dispose())})}batchAdd(e,t){let n=[];e.forEach(i=>{let{added:o}=this.addImpl(i,t,!1);n.push(...o)}),n.length&&this.changeEmitter.fire({added:n,removed:[]})}trackActiveInterpreterControllers(e){e.forEach(t=>this._activeInterpreterControllerIds.add(t.id))}canControllerBeDisposed(e){return!this._activeInterpreterControllerIds.has(e.id)&&!this.isControllerAttachedToADocument(e)}getSelected(e){return this.selectedControllers.get(e)}addOrUpdate(e,t){let{added:n,existing:i}=this.addImpl(e,t,!0);return n.concat(i)}addImpl(e,t,n){let i=[],o=[];b.ci(`Create Controller for ${e.kind} and id '${e.id}' for view ${t.join(", ")}`);try{t.map(s=>{let a=this.getControllerId(e,s);return this.registeredMetadatas.set(e.id,e),[a,s]}).filter(([s])=>{let a=this.registeredControllers.get(s);return a?(a.updateConnection(e),o.push(a),b.ci(`Found existing controller '${a.id}', not creating a new one just updating it`),!1):this.isFiltered(e)?(b.ci(`Existing controller '${s}' will be excluded as it is filtered`),!1):(b.ci(`Existing controller not found for '${s}', hence creating a new one`),!0)}).forEach(([s,a])=>{let l=RA.create(e,s,a,this.serviceContainer.get(He),this.serviceContainer.get(ot),this.disposables,this.serviceContainer.get(Js),this.serviceContainer.get(Ae),this.extensionChecker,this.serviceContainer,this.serviceContainer.get(EI),this.serviceContainer.get(gA)),c=[];l.onDidDispose(()=>{b.ci(`Deleting controller '${l.id}' associated with view ${a} from registration as it was disposed`),this.registeredControllers.delete(l.id),c.forEach(d=>d.dispose())},this,this.disposables),this.disposables.push(l),this.registeredControllers.set(l.id,l),i.push(l),l.onNotebookControllerSelected(d=>{var p;b.ci(`Controller ${(p=d.controller)==null?void 0:p.id} selected for ${d.notebook.uri.toString()}`),this.selectedControllers.set(d.notebook,d.controller),this.selectedEmitter.fire(d)},this,c),l.onNotebookControllerSelectionChanged(d=>this.selectionChangedEmitter.fire({...d,controller:l}),this,c)}),n&&i.length&&this.changeEmitter.fire({added:i,removed:[]})}catch(s){if(Ei(s,!0))return{added:i,existing:o};b.error(`Failed to create notebook controller for ${e.id}`,s)}return{added:i,existing:o}}get(e,t){let n=this.getControllerId(e,t);return this.registeredControllers.get(n)}isFiltered(e){return!1}getControllerId(e,t){return t===bt?e.id:`${e.id}${G$}`}isControllerAttachedToADocument(e){return Qd.workspace.notebookDocuments.some(t=>e.isAssociatedWithDocument(t))}};HS=E([(0,zd.injectable)(),I(0,(0,zd.inject)(ie)),I(1,(0,zd.inject)(Wd)),I(2,(0,zd.inject)(Io)),I(3,(0,zd.inject)(Kr)),I(4,(0,zd.inject)(fr)),I(5,(0,zd.inject)(ai))],HS);u();u();var pm=$(te());u();var PX=require("vscode"),uD=class{constructor(e,t){this.id="remote";if(e.kernelConnectionMetadata.kind!=="connectToLiveRemoteKernel"&&e.kernelConnectionMetadata.kind!=="startUsingRemoteKernelSpec")throw new Error("Invalid usage of this class, can only be used with remtoe kernels");this.kernelConnection=e.kernelConnectionMetadata,this.scriptManager=t.getOrCreate(e)}dispose(){}async getBaseUrl(){return PX.Uri.parse(this.kernelConnection.baseUrl)}async getWidgetScriptSource(e){let n=(await this.getWidgetScriptSources()).find(i=>i.moduleName.toLowerCase()===e.toLowerCase());if(!n&&e.includes("/")){let i=await this.getBaseUrl();return{moduleName:e,scriptUri:`${i.toString()}${e}`,source:"remote"}}return n||{moduleName:e}}async getWidgetScriptSources(){let e=await this.scriptManager.getWidgetModuleMappings();return e&&Object.keys(e).length?await Promise.all(Object.keys(e).map(async n=>({moduleName:n,scriptUri:e[n].toString(),source:"remote"}))):[]}};uD.validUrls=new Map;var JS=class{constructor(e,t,n){this.configurationSettings=e;this.globalMemento=t;this.widgetScriptManagerFactory=n}getProviders(e,t){let n=[];switch(n.push(new jl(this.globalMemento,this.configurationSettings)),e.kernelConnectionMetadata.kind){case"connectToLiveRemoteKernel":case"startUsingRemoteKernelSpec":n.push(new uD(e,this.widgetScriptManagerFactory));break}return n}};JS=E([(0,pm.injectable)(),I(0,(0,pm.inject)(Ae)),I(1,(0,pm.inject)(St)),I(1,(0,pm.named)(ir)),I(2,(0,pm.inject)(wA))],JS);u();var pv=$(te());u();var dv=require("vscode");u();var Dj=require("vscode");var VX=$(UX());var WX=["require.config({","requirejs?.config({","window.requirejs?.config({","requirejs.config({",'["require"].config({',"['require'].config({",'["requirejs"].config({',"['requirejs'].config({",'["require"]["config"]({',"['require']['config']({",'["requirejs"]["config"]({',"['requirejs']['config']({"];async function TIe(r,e,t){let n=[...WX],i=await Nt(e),o=0,s;for(;o<=0&&n.length&&(s=n.pop(),!!s);)o=t.indexOf(s);if(o<0){let f=[...WX].map(m=>m.substring(0,m.length-2));for(;o<=0&&f.length&&(s=f.pop(),!!s);)o=t.indexOf(s)}if(o<0){J("DS_INTERNAL.IPYWIDGET_EXTENSIONJS_INFO",void 0,{widgetFolderNameHash:i,failed:!0,patternUsedToRegisterRequireConfig:s,failure:"couldNotLocateRequireConfigStart"});return}let a=t.indexOf(")",o);if(a<=0||!s){J("DS_INTERNAL.IPYWIDGET_EXTENSIONJS_INFO",void 0,{widgetFolderNameHash:i,failed:!0,patternUsedToRegisterRequireConfig:s,failure:"couldNotLocateRequireConfigEnd"});return}let l=t.indexOf("{",o),c=t.substring(l,a);c=(0,VX.default)(c,{language:"javascript"}),c=st(c,{trim:!0,removeEmptyEntries:!0}).join("");let d=c.split("{")[c.split("{").length-1].split("}")[0].split(",").map(f=>f.trim()).filter(f=>f.length&&f.includes(":")),p={};if(d.forEach(f=>{let m=f.split(":"),g=kE(m[0].replace(/\\r/g,"").replace(/\\n/g,"").trim()).trim(),h=kE(f.substring(f.indexOf(":")+1).replace(/\\r/g,"").replace(/\\n/g,"").trim()).trim();p[g]=h.startsWith("http")?Dj.Uri.parse(h):Dj.Uri.joinPath(r,h)}),!p||!Object.keys(p).length){J("DS_INTERNAL.IPYWIDGET_EXTENSIONJS_INFO",void 0,{widgetFolderNameHash:i,failed:!0,patternUsedToRegisterRequireConfig:s,failure:"noRequireConfigEntries"});return}return J("DS_INTERNAL.IPYWIDGET_EXTENSIONJS_INFO",{requireEntryPointCount:Object.keys(p).length},{widgetFolderNameHash:i,patternUsedToRegisterRequireConfig:s}),p}var LA=class{constructor(e){this.kernel=e;this.disposables=[];e.onRestarted(this.onKernelRestarted,this,this.disposables)}dispose(){fe(this.disposables)}async getWidgetModuleMappings(){return this.widgetModuleMappings||(this.widgetModuleMappings=this.getWidgetModuleMappingsImpl()),this.widgetModuleMappings}onKernelRestarted(){this.widgetModuleMappings=void 0}async getConfigFromWidget(e,t,n){let i=await this.getWidgetScriptSource(t);try{let o=await TIe(e,n,i);if(!o){let s=`Failed to extract require.config from widget for ${n} from ${ve(t)}`;ji&&(s+=`with contents ${i}`),b.warn(s)}return o}catch(o){b.error(`Failed to extract require.config entry for ${n} from ${ve(t)}`,o)}}async getWidgetModuleMappingsImpl(){let e=new It,[t,n]=await Promise.all([this.getWidgetEntryPoints(),this.getNbExtensionsParentPath()]);if(!n)return;let o=(await Promise.all(t.map(s=>this.getConfigFromWidget(n,s.uri,s.widgetFolderName)))).reduce((s,a)=>Object.assign(s||{},a),{});return o&&Object.keys(o).length&&(delete o["jupyter-js-widgets"],delete o["@jupyter-widgets/base"],delete o["@jupyter-widgets/controls"],delete o["@jupyter-widgets/output"]),J("DS_INTERNAL.IPYWIDGET_DISCOVER_WIDGETS_NB_EXTENSIONS",{duration:e.elapsedTime},{type:er(this.kernel.kernelConnectionMetadata)?"local":"remote"}),o&&Object.keys(o).length?o:void 0}};var KA=class extends LA{constructor(t,n,i,o){super(t);this.context=n;this.fs=i;this.connection=o;if(t.kernelConnectionMetadata.kind!=="connectToLiveRemoteKernel"&&t.kernelConnectionMetadata.kind!=="startUsingRemoteKernelSpec")throw new Error("Invalid usage, can only be used for remote kernels");this.kernelConnection=t.kernelConnectionMetadata,this.getWidgetEntryPoints().catch(y)}getBaseUrl(){return this.getNbExtensionsParentPath()}async getNbExtensionsParentPath(){return dv.Uri.parse(this.kernelConnection.baseUrl)}onKernelRestarted(){this.widgetEntryPointsPromise=void 0,super.onKernelRestarted()}async getWidgetEntryPoints(){return this.widgetEntryPointsPromise||(this.widgetEntryPointsPromise=this.getWidgetEntryPointsImpl()),this.widgetEntryPointsPromise}getCodeToExecute(){return this.code||(this.code=this.fs.readFile(dv.Uri.joinPath(this.context.extensionUri,"pythonFiles","printJupyWidgetEntryPoints.py"))),this.code}async getWidgetEntryPointsImpl(){var s;if(!qt(this.kernelConnection))return[];let t=await this.getCodeToExecute();if(!((s=this.kernel.session)!=null&&s.kernel))return b.ci("No Kernel session to get list of widget entry points"),[];let n=[];n.push(Fi(this.kernel.session.kernel,t,{traceErrors:!0,traceErrorsMessage:"Failed to get widget entry points from remote kernel"})),!ji&&this.context.extensionMode===dv.ExtensionMode.Production&&n.push(tc(1e4).then(()=>[])),n.forEach(a=>a.catch(y));let i=await Promise.race(n);if(i.length===0)return b.ci("Unable to get widget entry points, no outputs after running the code"),[];let o=i[0];if(o.output_type!=="stream"||o.name!=="stdout")return b.ci("Unable to get widget entry points, no stream/stdout outputs after running the code"),[];try{return b.trace(`Widget Outputs include, ${o.text}`),o.text.trim().substring(1).slice(0,-1).split(",").map(l=>kE(l.trim()).replace(/\\\\/g,"/").replace(/\\/g,"/")).map(l=>({uri:dv.Uri.joinPath(dv.Uri.parse(this.kernelConnection.baseUrl),"nbextensions",l),widgetFolderName:Di(l)}))}catch(a){return b.error(`Failed to parse output to get list of IPyWidgets, output is ${o.text}`,a),[]}}async getWidgetScriptSource(t){let n=this.getWidgetScriptSourceUsingHttpClient(t),i=this.getWidgetScriptSourceUsingFetch(t),o=n.catch(()=>i);return o.catch(s=>{n.catch(a=>b.error(`Failed to download widget script source from ${t.toString(!0)}`,a)),b.error(`Failed to download widget script source from ${t.toString(!0)}`,s)}),o}async getWidgetScriptSourceUsingHttpClient(t){let n=t.toString(!0),o=await new su().downloadFile(n);if(o.status===200)return o.text();throw new Error(`Error downloading from ${n}: ${o.statusText}`)}async getWidgetScriptSourceUsingFetch(t){let n=await this.connection.createConnectionInfo(this.kernelConnection.serverProviderHandle),i=t.toString(!0),s=await new su(n.settings.fetch).downloadFile(i);if(s.status===200)return s.text();throw new Error(`Error downloading from ${i} using custom fetch: ${s.statusText}`)}};var qS=class{constructor(e,t,n,i){this.context=e;this.fs=t;this.disposables=n;this.connection=i;this.managers=new WeakMap}getOrCreate(e){if(!this.managers.has(e))if(e.kernelConnectionMetadata.kind==="connectToLiveRemoteKernel"||e.kernelConnectionMetadata.kind==="startUsingRemoteKernelSpec"){let t=new KA(e,this.context,this.fs,this.connection);this.managers.set(e,t),e.onDisposed(()=>t.dispose(),this,this.disposables)}else throw new Error("Cannot enumerate Widget Scripts using local kernels on the Web");return this.managers.get(e)}};qS=E([(0,pv.injectable)(),I(0,(0,pv.inject)(ot)),I(1,(0,pv.inject)(wt)),I(2,(0,pv.inject)(ie)),I(3,(0,pv.inject)(gn))],qS);u();var jX=$(te()),BX=require("vscode");var GS=class{async getNbExtensionsParentPath(e){switch(e.kernelConnectionMetadata.kind){case"connectToLiveRemoteKernel":case"startUsingRemoteKernelSpec":return BX.Uri.parse(e.kernelConnectionMetadata.baseUrl);default:return}}};GS=E([(0,jX.injectable)()],GS);u();var FA=$(te()),Bl=require("vscode");var Na=class{constructor(e){this.disposables=[];e.push(this)}dispose(){fe(this.disposables)}activate(){let e=new ec(1e3);this.disposables.push(e),Bl.workspace.onDidChangeNotebookDocument(t=>{e.trigger(()=>this.onDidChangeNotebookDocument(t))},this,this.disposables)}onDidChangeNotebookDocument(e){hr(e.notebook)&&e.cellChanges.some(t=>t.outputs&&t.outputs.some(n=>n.items&&n.items.some(i=>i.mime===go)))&&this.checkRendererExtensionVersion()}checkRendererExtensionVersion(){if(!Bl.workspace.isTrusted)return;let e=Bl.extensions.getExtension(Kv);if(!e){this.displayNotInstalledMessage();return}let t=e.packageJSON.version;if(!t){this.displayUpdateMessage();return}let n=t.split("."),i=parseInt(n[0],10),o=parseInt(n[1],10),s=parseInt(n[2],10);(i<1||i===1&&o===0&&s<15)&&this.displayUpdateMessage()}displayNotInstalledMessage(){Na.messageDisplayed||(Na.messageDisplayed=!0,Bl.window.showInformationMessage(C.rendererExtensionRequired,{modal:!0},Fe.bannerLabelYes).then(e=>{e===Fe.bannerLabelYes&&Bl.commands.executeCommand("extension.open",Kv).then(y,y)}).then(y,y))}displayUpdateMessage(){Na.messageDisplayed||(Na.messageDisplayed=!0,Bl.window.showInformationMessage(C.rendererExtension1015Required,{modal:!0},Fe.bannerLabelYes).then(e=>{e===Fe.bannerLabelYes&&Bl.commands.executeCommand("extension.open",Kv).then(y,y)}).then(y,y))}};Na.messageDisplayed=!1,Na=E([(0,FA.injectable)(),I(0,(0,FA.inject)(ie))],Na);function HX(r,e){r.addSingleton($d,$d),r.addSingleton(CA,JS),r.addSingleton(wA,qS),r.addSingleton(pX,GS),r.addSingleton(jl,jl),r.addSingleton(Ue,Na)}u();var mm=$(te()),Gr=require("vscode");var YS=class{constructor(e,t,n,i,o){this.controllerRegistration=e;this.kernelFinder=t;this.notebookEditorProvider=n;this.kernelDependency=i;this.localDisposables=[];this.providerMappings=new Map;this.kernelSpecsSourceRegistered=!1;o.push(this)}dispose(){fe(this.localDisposables)}activate(){if(!xn()){this.localDisposables.push(Gr.notebooks.registerKernelSourceActionProvider(bt,{provideNotebookKernelSourceActions:()=>[{label:C.localPythonEnvironments,documentation:Gr.Uri.parse("https://aka.ms/vscodeJupyterExtKernelPickerPythonEnv"),command:"jupyter.kernel.selectLocalPythonEnvironment"}]})),this.localDisposables.push(Gr.notebooks.registerKernelSourceActionProvider(ht,{provideNotebookKernelSourceActions:()=>[{label:C.localPythonEnvironments,documentation:Gr.Uri.parse("https://aka.ms/vscodeJupyterExtKernelPickerPythonEnv"),command:"jupyter.kernel.selectLocalPythonEnvironment"}]}));let t=[],n=new Gr.EventEmitter;this.localDisposables.push(Gr.notebooks.registerKernelSourceActionProvider(bt,{onDidChangeNotebookKernelSourceActions:n.event,provideNotebookKernelSourceActions:()=>t})),this.localDisposables.push(Gr.notebooks.registerKernelSourceActionProvider(ht,{onDidChangeNotebookKernelSourceActions:n.event,provideNotebookKernelSourceActions:()=>t}));let i=()=>{this.kernelSpecsSourceRegistered||this.kernelFinder.kernels.some(o=>R$(o))&&(this.kernelSpecsSourceRegistered=!0,t=[{label:C.localKernelSpecs,documentation:Gr.Uri.parse("https://aka.ms/vscodeJupyterExtKernelPickerJupyterKernels"),command:"jupyter.kernel.selectLocalKernelSpec"}],n.fire())};i(),this.kernelFinder.onDidChangeKernels(()=>i(),this,this.localDisposables),this.localDisposables.push(Gr.commands.registerCommand("jupyter.kernel.selectLocalKernelSpec",this.onSelectLocalKernel.bind(this,"localKernelSpec"),this)),this.localDisposables.push(Gr.commands.registerCommand("jupyter.kernel.selectLocalPythonEnvironment",this.onSelectLocalKernel.bind(this,"localPythonEnvironment"),this))}this.localDisposables.push(Gr.commands.registerCommand("jupyter.kernel.selectJupyterServerKernel",this.onSelectRemoteKernel,this)),rt.instance.get(lr).onDidChangeCollections(this.registerUriCommands,this,this.localDisposables),this.registerUriCommands()}registerUriCommands(){let e=rt.instance.get(lr),t=new Set;e.jupyterCollections.map(n=>{let i=`${n.extensionId}:${n.id}`;if(n.id===GD||(t.add(i),this.providerMappings.has(i)))return;let o=Gr.notebooks.registerKernelSourceActionProvider(bt,{provideNotebookKernelSourceActions:()=>[{get label(){return n.label},get documentation(){return n.documentation},command:{command:"jupyter.kernel.selectJupyterServerKernel",arguments:[n.extensionId,n.id],title:n.label}}]}),s=Gr.notebooks.registerKernelSourceActionProvider(ht,{provideNotebookKernelSourceActions:()=>[{get label(){return n.label},get documentation(){return n.documentation},command:{command:"jupyter.kernel.selectJupyterServerKernel",arguments:[n.extensionId,n.id],title:n.label}}]});this.localDisposables.push(o),this.localDisposables.push(s),this.providerMappings.set(i,{disposables:[o,s],provider:n})}),this.providerMappings.forEach(({disposables:n},i)=>{t.has(i)||(fe(n),this.providerMappings.delete(i))})}async onSelectLocalKernel(e,t){var n;if(t=t||((n=Gr.window.activeNotebookEditor)==null?void 0:n.notebook),!!t)if(e==="localPythonEnvironment"){let o=await rt.instance.get(HR).selectLocalKernel(t);return this.getSelectedController(t,o)}else{let o=await rt.instance.get(Y$).selectLocalKernel(t);return this.getSelectedController(t,o)}}async onSelectRemoteKernel(e,t,n){var l,c,d;if(n=n||((l=Gr.window.activeNotebookEditor)==null?void 0:l.notebook),!n&&Gr.window.activeTextEditor&&(n=(c=this.notebookEditorProvider.findNotebookEditor(Gr.window.activeTextEditor.document.uri))==null?void 0:c.notebook),!n)return;let i=`${e}:${t}`,o=(d=this.providerMappings.get(i))==null?void 0:d.provider;if(!o)return;let a=await rt.instance.get(BR).selectRemoteKernel(n,o);return this.getSelectedController(n,a)}async getSelectedController(e,t){var o;if(!t)return;let n=this.controllerRegistration.addOrUpdate(t,[e.notebookType]);if(!Array.isArray(n)||n.length===0){b.warn(`No controller created for selected kernel connection ${t.kind}:${t.id}`);return}Ta(e.uri,t).finally(()=>Jr(e.uri,"DS_INTERNAL.SWITCH_KERNEL",void 0,{newKernelPicker:!0})).catch(y),(o=n.find(s=>s.viewType===e.notebookType))==null||o.controller.updateNotebookAffinity(e,Gr.NotebookControllerAffinity.Preferred);let i=n[0];return await this.onControllerSelected(e,i),i.controller.id}async onControllerSelected(e,t){if(EG(e),er(t.connection)&&qt(t.connection)&&Ep(t.connection.interpreter)&&!xn()){let n=[];try{let i=new Gr.CancellationTokenSource;n.push(i);let o=new vr(!1);n.push(o),await this.kernelDependency.installMissingDependencies({resource:e.uri,kernelConnection:t.connection,token:i.token,ui:o,cannotChangeKernels:!0,ignoreCache:!0,installWithoutPrompting:!0})}catch(i){b.error(`Failed to install missing dependencies for Conda kernel ${t.connection.id}`,i)}finally{fe(n)}}}};YS=E([(0,mm.injectable)(),I(0,(0,mm.inject)(Tt)),I(1,(0,mm.inject)(ai)),I(2,(0,mm.inject)(Ko)),I(3,(0,mm.inject)(hI)),I(4,(0,mm.inject)(ie))],YS);u();var hu=$(te()),ci=require("vscode");u();var qs=require("vscode");var Pj=class{constructor(e){this.label=e}},UA=class extends Pj{constructor(t,n){super(t);this.sortKey=n;this.kind=qs.QuickPickItemKind.Separator}},WA=class extends Fr{constructor(t,n,i,o,s,a){super();this.provider=t;this.createQuickPickItem=n;this.getCategory=i;this.options=o;this.createErrorQuickPickItem=s;this._title=a;this.categories=new Map;this.quickPickItems=[];this.previouslyEnteredValue="";this.commands=new Set;this._placeholder="";this.quickPickItemMap=new WeakSet;this.errorQuickPickItemMap=new WeakSet}set recommended(t){var i;let n=((i=this._recommended)==null?void 0:i.id)!==(t==null?void 0:t.id);this._recommended=t,n&&this.quickPick&&this.rebuildQuickPickItems(this.quickPick)}get recommended(){return this._recommended}set placeholder(t){this.quickPick&&(this.quickPick.placeholder=t),this._placeholder=t}get placeholder(){return this._placeholder}set selected(t){let n=this._selected!==t;this._selected=t,n&&this.quickPick&&this.rebuildQuickPickItems(this.quickPick)}get selected(){return this._selected}createQuickPick(){let t=[],n={iconPath:new qs.ThemeIcon("refresh"),tooltip:Fe.refresh},i=this.quickPick=qs.window.createQuickPick();return t.push(i),this.quickPickItems=[],i.placeholder=this.placeholder,i.matchOnDescription=!0,i.buttons=this.options.supportsBack?[qs.QuickInputButtons.Back,n]:[n],i.ignoreFocusOut=!0,i.busy=!0,i.value=this.previouslyEnteredValue,i.onDidChangeValue(o=>this.previouslyEnteredValue=o,this,t),i.onDidHide(()=>fe(t),this,t),i.title=this._title||C.kernelPickerSelectKernelFromRemoteTitleWithoutName,this.provider.then(o=>{this.resolvedProvider=o,this._title||(i.title=C.kernelPickerSelectKernelFromRemoteTitle(o.title)),i.busy=o.status==="discovering",o.onDidChange(()=>this.updateQuickPickItems(i,o),this,t),i.onDidTriggerButton(async a=>{a===n&&(i.busy=!0,await o.refresh().catch(y),this.updateQuickPickItems(i,o),i.busy=!1)},this,t);let s;o.onDidChangeStatus(()=>{switch(s&&clearTimeout(s),o.status){case"discovering":i.busy=!0;break;case"idle":s=setTimeout(()=>i.busy=!1,500),t.push(new qs.Disposable(()=>s&&clearTimeout(s)));break}},this,t),JX(o.items.map(a=>this.toQuickPickItem(a)),(a,l)=>qX(this.getCategory(a.item,this),this.getCategory(l.item,this))).forEach(a=>{let l=this.connectionToCategory(a[0].item);this.quickPickItems.push(l),a.sort((c,d)=>c.label.localeCompare(d.label)),this.quickPickItems.push(...a),this.categories.set(l,new Set(a))}),this.updateQuickPickItems(i,o)}).catch(o=>b.error(`Failed to get quick pick items for ${i.title}`,o)),t.forEach(o=>this._register(o)),{quickPick:i,disposables:t}}isCommandQuickPickItem(t){return this.commands.has(t)}addCommand(t,n){let i=t;return i.execute=n,this.commands.add(i),this.quickPick&&this.rebuildQuickPickItems(this.quickPick),{dispose:()=>{this.commands.delete(i)}}}async selectItem(t){for(;!t.isCancellationRequested;){let{quickPick:n,disposables:i}=this.createQuickPick();n.show();try{this.previouslySelectedItem=void 0;let o=await new Promise((s,a)=>{n.onDidChangeSelection(l=>{if(l.length){let c=l[0];this.isSelectorQuickPickItem(c)?s(c.item):this.isCommandQuickPickItem(c)?s(c):this.isErrorQuickPickItem(c)}}),n.onDidTriggerButton(l=>l===qs.QuickInputButtons.Back?s(Ye.back):void 0,this,i),n.onDidHide(()=>s(void 0),this,i)});if(t.isCancellationRequested||!o)return;if(o instanceof Ye)return o===Ye.back?Ye.back:void 0;if(o&&"label"in o&&this.isCommandQuickPickItem(o)){this.previouslySelectedItem=o;let s=await o.execute();if(!s||s===Ye.back)continue;return s instanceof Ye,s}return o||void 0}finally{fe(i)}}}updateQuickPickItems(t,n){let i=new Map(t.items.filter(a=>this.isSelectorQuickPickItem(a)).map(a=>a).map(a=>[a.item.id,a.item])),o=new Map(n.items.map(a=>[a.id,a]));this.quickPickItems=this.quickPickItems.map(a=>{if(this.isSelectorQuickPickItem(a)){let l=i.get(a.item.id);if(l&&l!==a.item)return this.toQuickPickItem(l);let c=o.get(a.item.id);if(c){let d=this.toQuickPickItem(c);if(JSON.stringify({...a,item:""})!==JSON.stringify({...d,item:""}))return this.toQuickPickItem(c)}}return a});let s=n.items.filter(a=>!i.has(a.id)).map(a=>this.toQuickPickItem(a));this.removeOutdatedQuickPickItems(t,n),JX(s,(a,l)=>qX(this.getCategory(a.item,this),this.getCategory(l.item,this))).forEach(a=>{a.sort((d,p)=>d.label.localeCompare(p.label));let l=this.connectionToCategory(a[0].item),c=this.quickPickItems.find(d=>d.kind===qs.QuickPickItemKind.Separator&&d.label===l.label);if(c){let d=this.quickPickItems.indexOf(c),p=this.categories.get(c),f=new Map(Array.from(p).map(h=>[h.item.id,h])),m=p.size;a.forEach(h=>{let v=f.get(h.item.id);v&&p.delete(v),p.add(h)});let g=Array.from(p);g.sort((h,v)=>h.label.localeCompare(v.label)),this.quickPickItems.splice(d+1,m,...g)}else{let d=this.quickPickItems.filter(m=>m instanceof UA).map((m,g)=>[m,g]);d.push([l,-1]),d.sort((m,g)=>m[0].sortKey.localeCompare(g[0].sortKey));let p=d.findIndex(m=>m[1]===-1),f=0;p>0&&(f=d.length===p+1?this.quickPickItems.length:d[p+1][1]),a.sort((m,g)=>m.label.localeCompare(g.label)),this.quickPickItems.splice(f,0,l,...a),this.categories.set(l,new Set(a))}}),this.rebuildQuickPickItems(t)}rebuildQuickPickItems(t){var p;let n=this.recommended?this.toQuickPickItem(this.recommended):void 0,i=[];n&&i.push({label:C.recommendedItemCategoryInQuickPick,kind:qs.QuickPickItemKind.Separator},n);let o=n;o=this.selected?this.quickPickItems.filter(f=>this.isSelectorQuickPickItem(f)).map(f=>f).find(f=>{var m;return f.item.id===((m=this.selected)==null?void 0:m.id)}):o;let s=this.quickPickItems.filter(f=>{var m;return!this.isSelectorQuickPickItem(f)||f.item.id!==((m=n==null?void 0:n.item)==null?void 0:m.id)}),a=t.activeItems.length?t.activeItems[0]:void 0;o&&a&&(this.isSelectorQuickPickItem(a)?a.item.id!==o.item.id&&(o=void 0):o=void 0);let l=(p=this.resolvedProvider)!=null&&p.lastError?this.toErrorQuickPickItem(this.resolvedProvider.lastError):void 0,c=[].concat(Array.from(this.commands.values())).concat(i).concat(s).concat(l?[l]:[]),d=o?[o]:t.activeItems.length?[t.activeItems[0]]:[];if(d.length&&!c.includes(d[0])){let f=d[0],m=this.isSelectorQuickPickItem(f)&&c.find(g=>this.isSelectorQuickPickItem(g)&&g.item.id===f.item.id);m?d[0]=m:d.length=0}t.items=c,t.activeItems=d,!t.activeItems.length&&this.previouslySelectedItem&&c.includes(this.previouslySelectedItem)&&(t.activeItems=[this.previouslySelectedItem])}isErrorQuickPickItem(t){return this.errorQuickPickItemMap.has(t)}toErrorQuickPickItem(t){if(!this.createErrorQuickPickItem)return;let n=this.createErrorQuickPickItem(t,this);return this.errorQuickPickItemMap.add(n),n}isSelectorQuickPickItem(t){return this.quickPickItemMap.has(t)}toQuickPickItem(t){let n=this.createQuickPickItem(t,this);return n.item=t,this.quickPickItemMap.add(n),n}removeOutdatedQuickPickItems(t,n){let i=t.items.filter(a=>this.isSelectorQuickPickItem(a)).map(a=>a).map(a=>a.item.id),o=new Map(n.items.map(a=>[a.id,a])),s=i.filter(a=>!o.has(a));if(s.length){let a=[];this.categories.forEach((l,c)=>{l.forEach(d=>{s.includes(d.item.id)&&(l.delete(d),a.push(d))}),l.size||(a.push(c),this.categories.delete(c))}),this.quickPickItems=this.quickPickItems.filter(l=>!a.includes(l)),this.rebuildQuickPickItems(t)}}connectionToCategory(t){let n=this.getCategory(t,this);return new UA(n.label,n.sortKey||n.label)}};function JX(r,e){let t=[],n;for(let i of r.slice(0).sort(e))!n||e(n[0],i)!==0?(n=[i],t.push(n)):n.push(i);return t}function qX(r,e){return(r.sortKey||r.label).localeCompare(e.sortKey||e.label,void 0,{sensitivity:"accent"})}u();var VA=require("vscode");u();function GX(r){return Pi()==="Windows"?Ss(r).toUpperCase():Ss(r)}function YX(r,e){return e.endsWith(Bi)||(e+=Bi),r.endsWith(Bi)||(r+=Bi),GX(r).startsWith(GX(e))}var $S=class{constructor(e){this.jupyterConnection=e;this.disposables=[]}dispose(){fe(this.disposables)}async findPreferredRemoteKernelConnection(e,t,n){return this.findPreferredRemoteKernelConnectionImpl(e,t,n,!1)}async findPreferredRemoteKernelConnectionImpl(e,t,n,i){var l;let o=await rt.instance.get(Hs).getPreferredRemoteKernelId(e),s=async()=>{let c=t.kernels.find(p=>p.kind==="connectToLiveRemoteKernel"&&p.id===o);if(c)return c;if(t.status==="idle")return;let d=await new Promise(p=>t.onDidChangeKernels(()=>{let f=t.kernels.find(m=>m.kind==="connectToLiveRemoteKernel"&&m.id===o);f&&p(f),(t.status==="idle"||n.isCancellationRequested)&&p(void 0)},this,this.disposables));if(d)return d};if(o){let c=await s();if(c||i)return c}let a=(l=t.kernels.find(c=>Mt(c)))==null?void 0:l.serverProviderHandle;if(a){let c=await this.jupyterConnection.createConnectionInfo(a),d=(e.uri,void 0),p=d&&t.kernels.find(f=>Mt(f)&&f.kind==="connectToLiveRemoteKernel"&&f.kernelModel.model&&f.kernelModel.model.path===d.path&&f.kernelModel.model.name===d.name);if(p)return p}return this.findPreferredKernelSpecConnection(e,t,n,i)}async findPreferredLocalKernelSpecConnection(e,t,n){return this.findPreferredKernelSpecConnection(e,t,n,!1)}async findPreferredKernelSpecConnection(e,t,n,i){var d;let o=Ca(e),s=(d=o==null?void 0:o.kernelspec)==null?void 0:d.name,a=()=>{let p=s?t.kernels.filter(m=>(m.kind==="startUsingLocalKernelSpec"||m.kind==="startUsingRemoteKernelSpec")&&m.kernelSpec.name===s):[];if(p.length||i)return p;let f=PA(e);if(f)return t.kernels.filter(m=>(m.kind==="startUsingLocalKernelSpec"||m.kind==="startUsingRemoteKernelSpec")&&m.kernelSpec.language&&(m.kernelSpec.language===f||Kc(m.kernelSpec.language)===Kc(f)))},l=a();if(Array.isArray(l)&&l.length)return i&&l.length>1?void 0:l[0];if(t.status==="idle")return;let c=[];return new Promise(p=>t.onDidChangeKernels(()=>{if(n.isCancellationRequested)return p(void 0);let f=a();if(Array.isArray(f)&&f.length)return i&&f.length>1?p(void 0):p(f[0]);t.status==="idle"&&p(void 0)},this,this.disposables)).finally(()=>fe(c))}async findPreferredPythonKernelConnection(e,t,n){return this.findPreferredPythonKernelConnectionImpl(e,t,n)}async findPreferredPythonKernelConnectionImpl(e,t,n){t=t||rt.instance.get(ai).registered.find(c=>c.kind==="localPythonEnvironment");let i=rt.instance.get(im),o=Tj(e,t);if(o)return o;let s=await i.getActiveInterpreter(e.uri);if(!s)return;let a=()=>{if(!n.isCancellationRequested)return t.kernels.filter(c=>c.kind==="startUsingPythonInterpreter").map(c=>c).find(c=>c.interpreter.id===s.id)},l=a();if(l)return l;if(t.status==="discovering")return await new Promise(c=>{t.onDidChangeStatus(()=>t.status==="idle"&&c(),this,this.disposables),t.onDidChangeKernels(()=>(Tj(e,t)||a())&&c(),this,this.disposables)}),Tj(e,t)||a()}};function Tj(r,e){var i,o;let t=((i=VA.workspace.getWorkspaceFolder(r.uri))==null?void 0:i.uri)||(((o=VA.workspace.workspaceFolders)==null?void 0:o.length)===1?VA.workspace.workspaceFolders[0].uri:void 0),n=$X(qv(r.uri),e);if(n)return n;if(t)return $X(t,e)}function $X(r,e){let n=e.kernels.filter(a=>a.kind==="startUsingPythonInterpreter").map(a=>a).filter(a=>{var l,c,d;return YX(((d=(c=(l=zi(a.interpreter))==null?void 0:l.environment)==null?void 0:c.folderUri)==null?void 0:d.fsPath)||a.interpreter.uri.fsPath,r.fsPath)}),i=n.find(a=>{var l;return zr(a.interpreter)==="Venv"&&((l=_s(a.interpreter))==null?void 0:l.toLowerCase())===".venv"});if(i)return i;let o=n.find(a=>{var l;return zr(a.interpreter)==="Conda"&&((l=_s(a.interpreter))==null?void 0:l.toLowerCase())===".venv"});if(o)return o;let s=n.find(a=>{var l;return((l=_s(a.interpreter))==null?void 0:l.toLowerCase())===".venv"});return s||(n.length?n[0]:void 0)}function jA(r){return r===Ge||r===Ov}var zS=class{constructor(e,t,n,i,o,s,a){this.kernelFinder=e;this.serverUriStorage=t;this.serverSelector=n;this.jupyterConnection=i;this.displayDataProvider=o;this.kernelFinderController=s;this.jupyterServerRegistry=a;this.localDisposables=[]}async selectRemoteKernel(e,t){var o,s,a,l;if(e.notebookType!==bt&&e.notebookType!==ht)return;this.localDisposables.forEach(c=>c.dispose()),this.localDisposables=[],(o=this.cancellationTokenSource)==null||o.cancel(),(s=this.cancellationTokenSource)==null||s.dispose(),this.cancellationTokenSource=new ci.CancellationTokenSource;let n=new jx,i={disposables:[],notebook:e};try{if(await n.run(this.getRemoteServersFromProvider.bind(this,t,this.cancellationTokenSource.token),i)===Ye.cancel||((a=i.selection)==null?void 0:a.type)==="userPerformedSomeOtherAction")throw new ci.CancellationError;if(this.cancellationTokenSource.token.isCancellationRequested){fe(i.disposables);return}if(((l=i.selection)==null?void 0:l.type)==="connection")return i.selection.connection}finally{fe(i.disposables)}}async getRemoteServersFromProvider(e,t,n,i){var D;let o=this.kernelFinder.registered.filter(P=>P.kind==="remote"),s=[],a=[],l=[],c=(D=this.jupyterServerRegistry.jupyterCollections.find(P=>P.extensionId===e.extensionId&&P.id===e.id))==null?void 0:D.serverProvider,d=c!=null&&c.provideJupyterServers?Promise.resolve(c.provideJupyterServers.bind(c)(t)).then(P=>P||[]):Promise.resolve([]),p=new Set,f=await d,m=new Set(f.map(P=>P.id));if(o.filter(P=>P.serverProviderHandle.id===e.id).filter(P=>m.has(P.serverProviderHandle.id)).map(P=>{let M=this.serverUriStorage.all.find(x=>Jt(x.provider)===Jt(P.serverProviderHandle));p.add(Jt(P.serverProviderHandle)),l.push({server:P,time:M==null?void 0:M.time})}),l.sort((P,M)=>!P.time&&!M.time?P.server.displayName.localeCompare(M.server.displayName):!P.time&&M.time?1:P.time&&!M.time||(P.time||0)>(M.time||0)?-1:1),l.filter(({time:P})=>(P||0)>0).forEach(({server:P,time:M})=>{s.push({type:"finder",kernelFinderInfo:P,idAndHandle:P.serverProviderHandle,label:P.displayName,description:M?C.jupyterServerLastConnectionForQuickPickDescription(new Date(M)):void 0,buttons:c!=null&&c.removeJupyterServer&&jA(e.extensionId)?[{iconPath:new ci.ThemeIcon("close"),tooltip:C.removeRemoteJupyterServerEntryInQuickPick}]:[]})}),l.filter(({time:P})=>!P).forEach(({server:P})=>{s.push({type:"finder",kernelFinderInfo:P,idAndHandle:P.serverProviderHandle,label:P.displayName,buttons:c!=null&&c.removeJupyterServer&&jA(e.extensionId)?[{iconPath:new ci.ThemeIcon("close"),tooltip:C.removeRemoteJupyterServerEntryInQuickPick}]:[]})}),f.sort((P,M)=>P.label.localeCompare(M.label)).forEach(P=>{let M=Jt({extensionId:e.extensionId,id:e.id,handle:P.id});p.has(M)||s.push({type:"jupyterServer",label:P.label,idAndHandle:{extensionId:e.extensionId,id:e.id,handle:P.id},server:P,buttons:c!=null&&c.removeJupyterServer&&jA(e.extensionId)?[{iconPath:new ci.ThemeIcon("close"),tooltip:C.removeRemoteJupyterServerEntryInQuickPick}]:[]})}),e.commandProvider){let P=(await Promise.resolve(e.commandProvider.provideCommands(void 0,t))||[]).map(M=>({...M,provider:e,type:"uriProviderQuickPick",command:M}));s.length>0&&P.length&&a.push({label:"",kind:ci.QuickPickItemKind.Separator}),a.push(...P)}let g=s.concat(a),h=new ci.EventEmitter,v=g.length===1&&"command"in g[0]&&g[0].command.canBeAutoSelected?g[0]:void 0;if(c){let P=g.filter(M=>"type"in M);P.length===1&&P.every(M=>M.type!=="uriProviderQuickPick")?v=P[0]:P.every(M=>M.type==="uriProviderQuickPick")&&P.filter(M=>M.picked).length===1&&(v=g.filter(M=>M.picked)[0])}let S,_;if(v)_=v;else{let{quickPick:P,selection:M}=n.showLazyLoadQuickPick({items:g,placeholder:e.extensionId===Ge||e.extensionId===Ov?C.enterOrSelectRemoteJupyterPlaceholder:C.selectRemoteJupyterPlaceholder,title:C.quickPickTitleForSelectionOfJupyterServer,supportBackInFirstStep:!0,onDidTriggerItemButton:async x=>{if("type"in x.item&&(x.item.type==="finder"||x.item.type==="jupyterServer")){let A=x.item.idAndHandle.handle,j=f.find(re=>re.id===A);c!=null&&c.removeJupyterServer&&j&&jA(e.extensionId)&&(P.busy=!0,this.serverUriStorage.remove({extensionId:e.extensionId,id:e.id,handle:A}).catch(y),await c.removeJupyterServer(j),P.busy=!1,g.splice(g.indexOf(x.item),1),h.fire(g.concat([])))}},onDidChangeItems:h.event});P.onDidChangeValue(async x=>{var R;if(!((R=e.commandProvider)!=null&&R.provideCommands))return;let A=[];s.length>0&&A.push({label:"",kind:ci.QuickPickItemKind.Separator});let re=(await Promise.resolve(e.commandProvider.provideCommands(x,t))||[]).map(Z=>({...Z,provider:e,type:"uriProviderQuickPick",command:Z}));P.items=s.concat(A).concat(re)},this),S=P,_=await M}if(!t.isCancellationRequested&&_&&"type"in _)switch(_.type){case"finder":{let P=await this.selectRemoteKernelFromPicker(i.notebook,Promise.resolve(_.kernelFinderInfo),t).catch(M=>b.error("Failed to select a kernel",M));if(P&&P===Ye.back){if(_===v)throw Ye.back;return this.getRemoteServersFromProvider(e,t,n,i)}if(!P||P instanceof Ye)throw new ci.CancellationError;i.selection={type:"connection",connection:P};return}case"jupyterServer":{let P=(async()=>{let x={id:e.id,handle:_.server.id,extensionId:e.extensionId};return e.extensionId.toLowerCase()===Zl.toLowerCase()&&await ds(t,this.serverSelector.addJupyterServer(x)),this.kernelFinderController.getOrCreateRemoteKernelFinder(x,_.server.label)})(),M=await this.selectRemoteKernelFromPicker(i.notebook,P,t).catch(x=>b.error("Failed to select a kernel",x));if(M&&M===Ye.back){if(_===v)throw Ye.back;return this.getRemoteServersFromProvider(e,t,n,i)}if(!M||M instanceof Ye)throw new ci.CancellationError;i.selection={type:"connection",connection:M};return}case"uriProviderQuickPick":{let P=ci.notebooks.createNotebookControllerDetectionTask(bt);try{S&&(S.busy=!0);let M=await this.selectRemoteServerFromRemoteKernelFinder(_,i,t);return S&&(S.busy=!1),M}catch(M){if(M===Ye.back&&!v)return this.getRemoteServersFromProvider(e,t,n,i);throw M}finally{P.dispose()}}default:break}}async selectRemoteServerFromRemoteKernelFinder(e,t,n){var a;if(!((a=e.provider.commandProvider)!=null&&a.handleCommand)||n.isCancellationRequested)return;let i=await Promise.resolve(e.provider.commandProvider.handleCommand(e.command,n));if(!i)throw Ye.back;if(n.isCancellationRequested)throw new ci.CancellationError;let o=(async()=>{let l={id:e.provider.id,handle:i.id,extensionId:e.provider.extensionId};return l.extensionId.toLowerCase()===Zl.toLowerCase()&&await ds(n,this.serverSelector.addJupyterServer(l)),this.kernelFinderController.getOrCreateRemoteKernelFinder(l,i.label)})(),s=await this.selectRemoteKernelFromPicker(t.notebook,o,n).catch(l=>b.error("Failed to select a kernel",l));if(s&&s===Ye.back)throw Ye.back;if(!s||s instanceof Ye)throw new ci.CancellationError;t.selection={type:"connection",connection:s}}async selectRemoteKernelFromPicker(e,t,n){let i,o=d=>{let p=this.displayDataProvider.getDisplayData(d);return{label:`${d===i?"$(star-full) ":""}${p.label}`,description:p.description,detail:p.detail}},s=d=>({label:this.displayDataProvider.getDisplayData(d).category||"Other"}),a=d=>({label:C.failedToFetchKernelSpecsRemoteErrorMessageForQuickPickLabel,detail:C.failedToFetchKernelSpecsRemoteErrorMessageForQuickPickDetail}),l=new WA(t,o,s,{supportsBack:!0},a),c=new $S(this.jupyterConnection);return t.then(d=>c.findPreferredRemoteKernelConnection(e,d,n)).then(d=>{i=d,(d==null?void 0:d.kind)==="startUsingRemoteKernelSpec"&&(l.recommended=d),l.selected=d}).catch(d=>b.error("Failed to determine preferred remote kernel",d)),l.selectItem(n)}};zS=E([(0,hu.injectable)(),I(0,(0,hu.inject)(ai)),I(1,(0,hu.inject)(fr)),I(2,(0,hu.inject)(Fl)),I(3,(0,hu.inject)(gn)),I(4,(0,hu.inject)(EI)),I(5,(0,hu.inject)(eD)),I(6,(0,hu.inject)(lr))],zS);function zX(r,e){r.addSingleton(Tt,HS),r.addBinding(Tt,Ue),r.addSingleton(EI,jS),r.addSingleton(BR,zS),r.addSingleton(Ue,YS),HX(r,e)}u();var pD=$(te()),fv=require("vscode");u();var QS=Symbol("IJupyterDebugService"),gm=Symbol("INotebookDebuggingManager");var BA=Symbol("IDebugLocationTrackerFactory"),HA=Symbol("IDebugLocationTracker");var XS=class{constructor(e,t){this.debuggingManager=e;this.disposables=t}activate(){this.disposables.push(fv.commands.registerCommand(Q.RunByLine,this.runByLine,this)),this.disposables.push(fv.commands.registerCommand(Q.RunByLineNext,this.runByLineNext,this)),this.disposables.push(fv.commands.registerCommand(Q.RunByLineStop,this.runByLineStop,this)),this.disposables.push(fv.commands.registerCommand(Q.RunAndDebugCell,this.runAndDebugCell,this))}async runByLine(e){J("DATASCIENCE.DEBUGGING.CLICKED_RUNBYLINE"),e!=null||(e=this.getCellFromActiveEditor()),e&&await this.debuggingManager.tryToStartDebugging(0,e)}async runByLineNext(e){e!=null||(e=this.getCellFromActiveEditor()),e&&this.debuggingManager.runByLineNext(e)}async runByLineStop(e){e!=null||(e=this.getCellFromActiveEditor()),e&&this.debuggingManager.runByLineStop(e)}async runAndDebugCell(e){J("DATASCIENCE.DEBUGGING.CLICKED_RUN_AND_DEBUG_CELL"),e!=null||(e=this.getCellFromActiveEditor()),e&&await this.debuggingManager.tryToStartDebugging(1,e)}getCellFromActiveEditor(){let e=fv.window.activeNotebookEditor;if(e){let t=e.selections[0];if(t)return e.notebook.cellAt(t.start)}}dispose(){this.disposables.forEach(e=>e.dispose())}};XS=E([(0,pD.injectable)(),I(0,(0,pD.inject)(gm)),I(1,(0,pD.inject)(ie))],XS);u();var Hl=$(te());var fD=require("vscode");u();var kj=new Set(["DataFrame","list","dict","ndarray","Series","Tensor","EagerTensor","DataArray"]);function qA(r){var e;return{name:(e=r.evaluateName)!=null?e:r.name,type:r.type,count:0,shape:"",size:0,supportsDataExplorer:kj.has(r.type||""),value:r.value,truncated:!0,frameId:r.variablesReference}}function GA(r){let e=r.index,t=r.columns;return{data:r.data.map((o,s)=>{let a={index:e[s]};return t.forEach((l,c)=>{a[l]=o[c]}),a})}}u();var Nj=require("vscode"),ZS=class{constructor(e){this._sessionId=e;this.topMostFrameId=0;this.sequenceNumbersOfRequestsPendingResponses=new Set;this.waitingForStackTrace=!1;this.debugLocationUpdatedEvent=new Nj.EventEmitter;this.sessionEndedEmitter=new Nj.EventEmitter;this.DebugLocation=void 0}get sessionId(){return this._sessionId}get sessionEnded(){return this.sessionEndedEmitter.event}get debugLocationUpdated(){return this.debugLocationUpdatedEvent.event}get debugLocation(){return this._debugLocation}onDidSendMessage(e){var t,n;if(this.isResponseForRequestToFetchAllFrames(e)){let i=(t=e.body)==null?void 0:t.stackFrames[0];this.topMostFrameId=i==null?void 0:i.id,this.sequenceNumbersOfRequestsPendingResponses.delete(e.request_seq),this.waitingForStackTrace&&(this.DebugLocation={lineNumber:i==null?void 0:i.line,fileName:this.normalizeFilePath((n=i==null?void 0:i.source)==null?void 0:n.path),column:i.column},this.waitingForStackTrace=!1)}this.isStopEvent(e)&&(this.waitingForStackTrace=!0),this.isContinueEvent(e)&&(this.DebugLocation=void 0,this.waitingForStackTrace=!1)}onWillStopSession(){this.sessionEndedEmitter.fire(this)}onWillReceiveMessage(e){this.isRequestToFetchAllFrames(e)&&this.sequenceNumbersOfRequestsPendingResponses.add(e.seq)}set DebugLocation(e){let t=this._debugLocation;this._debugLocation=e,this._debugLocation!==t&&this.debugLocationUpdatedEvent.fire()}normalizeFilePath(e){return process.platform!=="win32"?e.replace(/\\/g,"/"):e}isStopEvent(e){return e.type==="event"&&e.event==="stopped"}isContinueEvent(e){if(e.type==="event"){if(e.event==="continue")return!0}else if(e.type==="response"&&e.command==="continue")return!0;return!1}isResponseForRequestToFetchAllFrames(e){var t;return e.type==="response"&&e.command==="stackTrace"&&((t=e.body)==null?void 0:t.stackFrames[0])&&this.sequenceNumbersOfRequestsPendingResponses.has(e.request_seq)}isRequestToFetchAllFrames(e){return e.type==="request"&&e.command==="stackTrace"&&(e.arguments.startFrame===0||e.arguments.startFrame===void 0)}};var kIe=new Set(["In","Out","exit","quit"]),YA=100,e_=class extends ZS{constructor(t,n,i,o,s,a){super(void 0);this.debugService=t;this.debuggingManager=n;this.configService=i;this.varScriptGenerator=o;this.dfScriptGenerator=s;this.kernelProvider=a;this.refreshEventEmitter=new fD.EventEmitter;this.lastKnownVariables=[];this.importedGetVariableInfoScriptsIntoKernel=new Set;this.watchedNotebooks=new Map;this.debuggingStarted=!1;this.currentVariablesReference=0;this.currentSeqNumsForVariables=new Set;this.debuggingManager.onDoneDebugging(()=>this.refreshEventEmitter.fire(),this)}get refreshRequired(){return this.refreshEventEmitter.event}get active(){return(this.debugService.activeDebugSession!==void 0||this.activeNotebookIsDebugging())&&this.debuggingStarted}getAllVariableDiscriptions(){throw new Error("Method not implemented.")}async getVariables(t,n){n&&this.watchKernel(n);let i=n&&this.kernelProvider.getKernelExecution(n),o={executionCount:i?i.executionCount:t.executionCount,pageStartIndex:0,pageResponse:[],totalCount:0,refreshCount:t.refreshCount};if(this.active){let s=t.sortColumn,a=(d,p)=>{let f=d[s]?d[s]:"",m=p[s]?p[s]:"";return t.sortAscending?f.localeCompare(m,void 0,{sensitivity:"base"}):m.localeCompare(f,void 0,{sensitivity:"base"})};this.lastKnownVariables.sort(a);let l=t.startIndex?t.startIndex:0,c=t.pageSize?t.pageSize:YA;o.pageStartIndex=l;for(let d=l;d<l+c&&d<this.lastKnownVariables.length;d+=1){let p=this.lastKnownVariables[d].truncated?await this.getFullVariable(this.lastKnownVariables[d]):this.lastKnownVariables[d];this.lastKnownVariables[d]=p,o.pageResponse.push(p)}o.totalCount=this.lastKnownVariables.length}return o}async getMatchingVariable(t,n){if(this.active){let i=this.lastKnownVariables.find(o=>o.name===t);return i&&(n!=null&&n.resourceUri)&&Jv(n==null?void 0:n.resourceUri).toLowerCase()===".ipynb"&&J("DATASCIENCE.RUN_BY_LINE_VARIABLE_HOVER"),i}}async getVariableValueSummary(t){}async getDataFrameInfo(t,n,i,o){var m;if(!this.active)return t;o&&(t=await this.getFullVariable(t)),n&&this.watchKernel(n);let s=t.name;i&&(s=`${t.name}${i}`);let{cleanupCode:a,initializeCode:l,code:c}=await this.dfScriptGenerator.generateCodeToGetDataFrameInfo({isDebugging:!0,variableName:s}),d=await this.evaluate({code:c,cleanupCode:a,initializeCode:l,frameId:t.frameId}),p=n==null?void 0:n.notebook,f=p?tr(p.uri.path):"";return!f&&((m=this.debugLocation)!=null&&m.fileName)&&(f=tr(this.debugLocation.fileName)),d?{...t,...JSON.parse(d.result),maximumRowChunkSize:YA,fileName:f}:t}async getDataFrameRows(t,n,i,o,s){if(i-n>YA)throw new Error(`Debugger cannot provide more than ${YA} rows at once`);if(!this.debugService.activeDebugSession||t.columns===void 0)return{data:[]};o&&this.watchKernel(o);let a=t.name;s&&(a=`${t.name}${s}`);let{cleanupCode:l,initializeCode:c,code:d}=await this.dfScriptGenerator.generateCodeToGetDataFrameRows({isDebugging:!0,variableName:a,startIndex:n,endIndex:i}),p=await this.evaluate({code:d,cleanupCode:l,initializeCode:c,frameId:t.frameId});return GA(JSON.parse(p.result))}onWillReceiveMessage(t){super.onWillReceiveMessage(t),t.type==="request"&&t.command==="variables"&&t.arguments&&this.currentVariablesReference===t.arguments.variablesReference&&this.currentSeqNumsForVariables.add(t.seq)}onDidSendMessage(t){var n;if(super.onDidSendMessage(t),t.type==="response"&&t.command==="initialize")this.debuggingStarted=!0;else if(t.type==="event"&&t.event==="stopped"&&this.activeNotebookIsDebugging())this.handleNotebookVariables(t).catch(y);else if(t.type==="response"&&t.command==="scopes"&&t.body&&t.body.scopes){let o=t.body.scopes[0].variablesReference;o!==this.currentVariablesReference&&(this.currentVariablesReference=o,this.currentSeqNumsForVariables.clear())}else if(t.type==="response"&&t.command==="variables"&&t.body)this.currentSeqNumsForVariables.has(t.request_seq)&&this.updateVariables(void 0,t),this.monkeyPatchDataViewableVariables(t);else if(t.type==="event"&&t.event==="terminated"){this.lastKnownVariables=[],this.topMostFrameId=0,this.debuggingStarted=!1,this.refreshEventEmitter.fire();let i=(n=this.debugService.activeDebugSession)==null?void 0:n.id;i&&this.importedGetVariableInfoScriptsIntoKernel.delete(i)}}watchKernel(t){var i;let n=(i=t.notebook)==null?void 0:i.uri.toString();if(n&&!this.watchedNotebooks.has(n)){let o=[];o.push(t.onRestarted(this.resetImport.bind(this,n))),o.push(t.onDisposed(()=>{this.resetImport(n),o.forEach(s=>s.dispose()),this.watchedNotebooks.delete(n)})),this.watchedNotebooks.set(n,o)}}resetImport(t){this.importedGetVariableInfoScriptsIntoKernel.delete(t)}async evaluate({code:t,cleanupCode:n,frameId:i,initializeCode:o}){if(this.debugService.activeDebugSession){i=this.topMostFrameId||i;let s={frameId:i,context:"repl",format:{rawString:!0}};b.debug(`Evaluating in debugger : ${this.debugService.activeDebugSession.id}: ${t}`);try{o&&await this.debugService.activeDebugSession.customRequest("evaluate",{...s,expression:o});let a=await this.debugService.activeDebugSession.customRequest("evaluate",{...s,expression:t});if(a&&a.result!=="None")return a;b.error(`Cannot evaluate ${t}`);return}finally{n&&await this.debugService.activeDebugSession.customRequest("evaluate",{...s,expression:n})}}throw Error("Debugger is not active, cannot evaluate.")}async getFullVariable(t){let{initializeCode:n,code:i,cleanupCode:o}=await this.varScriptGenerator.generateCodeToGetVariableInfo({isDebugging:!0,variableName:t.name}),s=await this.evaluate({code:i,initializeCode:n,cleanupCode:o,frameId:t.frameId});return s&&s.result?{...t,truncated:!1,...JSON.parse(s.result)}:t}monkeyPatchDataViewableVariables(t){t.body.variables.forEach(n=>{n.type&&kj.has(n.type)&&(n.__vscodeVariableMenuContext="viewableInDataViewer")})}updateVariables(t,n){var s;let i=this.configService.getSettings(t).variableExplorerExclude?(s=this.configService.getSettings().variableExplorerExclude)==null?void 0:s.split(";"):[],o=n.body.variables.filter(a=>!(!a.name||!a.type||!a.value||i&&i.includes(a.type)||a.name.startsWith("_")||kIe.has(a.name)||a.type==="NoneType"));this.lastKnownVariables=o.map(a=>qA(a)),this.refreshEventEmitter.fire()}activeNotebookIsDebugging(){let t=fD.window.activeNotebookEditor;return!!t&&this.debuggingManager.isDebugging(t.notebook)}async handleNotebookVariables(t){var o;let n=(o=fD.window.activeNotebookEditor)==null?void 0:o.notebook,i=t.body.threadId;if(n){let s=this.debuggingManager.getDebugSession(n);if(s){let a=await s.customRequest("stackTrace",{threadId:i,startFrame:0,levels:1});if(a&&a.stackFrames[0]){let l=a.stackFrames[0],c=this.debuggingManager.getDebugMode(n),d;if(c===0){let p=this.debuggingManager.getDebugCell(n);l.source&&p&&l.source.path===p.document.uri.toString()&&(d=await s.customRequest("scopes",{frameId:l.id}))}else{let p=tr(n.uri.toString());l.source&&l.source.path&&l.source.path.includes(p)&&(d=await s.customRequest("scopes",{frameId:l.id}))}d&&(d.scopes.forEach(p=>{s.customRequest("variables",{variablesReference:p.variablesReference}).then(y,y)}),this.refreshEventEmitter.fire())}}}}};e_=E([(0,Hl.injectable)(),I(0,(0,Hl.inject)(QS)),I(0,(0,Hl.named)(tt.MULTIPLEXING_DEBUGSERVICE)),I(1,(0,Hl.inject)(gm)),I(2,(0,Hl.inject)(Ae)),I(3,(0,Hl.inject)(ay)),I(4,(0,Hl.inject)(ly)),I(5,(0,Hl.inject)(He))],e_);u();var Xd=$(te()),hm=require("vscode");u();var QX=require("vscode"),mr=class{constructor(e){this.name=e}get value(){return this.lastValue}async set(e){this.lastValue!==e&&(this.lastValue=e,await QX.commands.executeCommand("setContext",this.name,this.lastValue))}};u();var nZ=require("vscode");u();var mD=(o=>(o[o.Unknown=0]="Unknown",o[o.Ok=1]="Ok",o[o.Outdated=2]="Outdated",o[o.NotInstalled=3]="NotInstalled",o[o.ControllerNotSelected=4]="ControllerNotSelected",o))(mD||{});async function XX(r){var o,s;let e="5dc3a68c-e34e-4080-9c3e-2a532b2ccb4d",t=`import builtins
import ipykernel
builtins.print("${e}" + ipykernel.__version__ + "${e}")`,n=await r.executeHidden(t),i=/^(\d+)\.\d+\.\d+$/;for(let a of n){if(a.output_type!=="stream")continue;let l=(s=(o=a.text)==null?void 0:o.toString().trim())!=null?s:"";if(!l.includes(e))continue;let c=l.split(e)[1].trim().match(i);if(c){let d=c[1];return Number(d)>=6?1:2}}return 0}function gD(r){let e=r;if(typeof e.__notebookUri=="undefined"||typeof e.__mode=="undefined"||(e.__mode===1||e.__mode===2||e.__mode===0)&&typeof e.__cellIndex=="undefined")throw new Error("Invalid launch configuration")}function ZX(r){if(gD(r),r.__mode!==2)throw new Error("Invalid launch configuration")}function $A(r,e){switch(r.type){case"event":let t=r;switch(t.event){case"output":e(t.body);break;case"loadedSource":e(t.body);break;case"breakpoint":e(t.body.breakpoint);break;default:break}break;case"request":let n=r;switch(n.command){case"setBreakpoints":let o=n.arguments,s=o.breakpoints;if(s&&s.length){let a=s[0].line;s.forEach(c=>{e(c,{...o.source})});let l={source:o.source,line:a};e(l),o.source=l.source}break;case"breakpointLocations":e(n.arguments);break;case"source":e(n.arguments);break;case"gotoTargets":e(n.arguments);break;default:break}break;case"response":let i=r;if(i.success&&i.body)switch(i.command){case"stackTrace":i.body.stackFrames.forEach(o=>{e(o)});break;case"loadedSources":i.body.sources.forEach(o=>{let s={source:o};e(s),o.path=s.source.path});break;case"scopes":i.body.scopes.forEach(o=>{e(o)});break;case"setFunctionBreakpoints":i.body.breakpoints.forEach(o=>{e(o)});break;case"setBreakpoints":i.body.breakpoints.forEach(o=>{e(o)});break;default:break}break}}function eZ(r){return/~\d+\\/.test(r)}function tZ(r,e){return new RegExp(r.replace(/\\/g,"\\\\").replace(/~\d+\\\\/g,"[^\\\\]+\\\\"),"i").test(e)}async function mv(r,e){let t=`import debugpy
debugpy.debug_this_thread()`;await r.executeHidden(t),await e.dumpAllCells()}function rZ(r){return!!r.header&&r.header.msg_type==="debug_event"}function hD(r){return r.includes("Frame skipped from debugging during step-in")}function Rj(r){return r.event==="debugpyAttach"}var zA=class{constructor(e,t,n){this.debugAdapter=e;this.debugCell=t;this.execution=n;J("DATASCIENCE.DEBUGGING.SUCCESSFULLY_STARTED_RUN_AND_DEBUG_CELL")}trace(e,t){b.debug(`[Debug-Cell] ${e}: ${t}`)}async willSendEvent(e){return Rj(e)?(this.trace("intercept","debugpyAttach request for subprocess, not supported"),!0):e.event==="output"&&hD(e.body.output)?(this.trace("intercept","justMyCode notification"),!0):!1}async willSendRequest(e){e.command==="configurationDone"&&(await mv(this.execution,this.debugAdapter),nZ.commands.executeCommand("notebook.cell.execute",{ranges:[{start:this.debugCell.index,end:this.debugCell.index+1}],document:this.debugCell.notebook.uri}).then(y,y))}};u();var vD=class{constructor(e,t,n,i){this.mode=e;this.debugAdapter=t;this.debugCell=n;this.serviceContainer=i;this.debuggingManager=this.serviceContainer.get(gm)}trace(e,t){b.debug(`[Debug-Restart] ${e}: ${t}`)}error(e,t){b.error(`[Debug-Restart] ${e}: ${t}`)}async willSendResponse(e){e.command==="initialize"&&e.body&&(e.body.supportsRestartRequest=!0)}async willSendRequest(e){if(e.command==="restart")return this.trace("restart","Handling restart request"),setTimeout(()=>{this.debugAdapter.disconnect().then(()=>(this.trace("restart","doRestart"),this.debuggingManager.tryToStartDebugging(this.mode,this.debugCell,!0))).catch(t=>{this.error("restart",`Error restarting: ${t}`)})},0),{command:e.command,request_seq:e.seq,seq:e.seq,success:!0,type:"response"}}};u();var yD=require("vscode");var QA=class{constructor(e,t,n,i){this.debugAdapter=e;this.debugCell=t;this.execution=n;this.settings=i;J("DATASCIENCE.DEBUGGING.SUCCESSFULLY_STARTED_RUNBYLINE")}continue(){if(typeof this.lastPausedThreadId!="number"){b.debug("No paused thread, can't do RBL"),this.stop();return}this.debugAdapter.stepIn(this.lastPausedThreadId).then(y,y)}stop(){b.ci("RunbylineController::stop()"),this.execution.executeHidden("pass").then(y,y),this.debugAdapter.disconnect().then(y,y)}getMode(){return this.debugAdapter.getConfiguration().__mode}async willSendEvent(e){return e.event==="stopped"&&(this.lastPausedThreadId=e.body.threadId,await this.handleStoppedEvent(this.lastPausedThreadId))?(this.trace("intercepted","handled stop event"),!0):e.event==="output"&&hD(e.body.output)?(this.trace("intercept","justMyCode notification"),!0):!1}async willSendRequest(e){b.ci(`willSendRequest: ${e.command}`),e.command==="configurationDone"&&await this.initializeExecute()}async handleStoppedEvent(e){return await this.shouldStepIn(e)?(this.debugAdapter.stepIn(e).then(y,y),!0):!1}async shouldStepIn(e){var n;let t=await this.debugAdapter.stackTrace({threadId:e,startFrame:0,levels:1});if(t&&t.stackFrames[0]){let i=t.stackFrames[0],o=new yD.Position(i.line,i.column);return(n=this.lastPausePosition)!=null&&n.isEqual(o)?(this.trace("intercept","working around duplicate stop event"),!0):(this.lastPausePosition=o,!!i.source&&i.source.path!==this.debugCell.document.uri.toString())}return!1}trace(e,t){b.debug(`[Debug-RBL] ${e}: ${t}`)}async initializeExecute(){await mv(this.execution,this.debugAdapter);let e=st(this.debugCell.document.getText(),{trim:!1,removeEmptyEntries:!1}),t=[];if(Ph(e,()=>void 0,(n,i)=>{n.trim().length!==0&&t.push(i)}),t.sort(),t.length!==0){let n={line:t[0]+1};await this.debugAdapter.setBreakpoints({source:{name:tr(this.debugCell.notebook.uri.path),path:this.debugCell.document.uri.toString()},breakpoints:[n],sourceModified:!1}),this.settings.getSettings(this.debugCell.notebook.uri).showVariableViewWhenDebugging&&yD.commands.executeCommand(Q.OpenVariableView).then(y,y)}yD.commands.executeCommand("notebook.cell.execute",{ranges:[{start:this.debugCell.index,end:this.debugCell.index+1}],document:this.debugCell.notebook.uri}).then(y,y)}};u();var t_=class{constructor(e,t,n){this.document=e;this.config=t;this.session=n}};u();var ui=require("vscode");var r_=class{constructor(e,t,n){this.kernelProvider=e;this.controllerRegistration=t;this.serviceContainer=n;this.notebookToDebugger=new Map;this.notebookToDebugAdapter=new Map;this.notebookInProgress=new Set;this.disposables=[];this._doneDebugging=new ui.EventEmitter}activate(){this.disposables.push(ui.debug.onDidTerminateDebugSession(this.endSession.bind(this)),ui.workspace.onDidCloseNotebookDocument(async e=>{let t=this.notebookToDebugger.get(e);t&&(await ui.debug.stopDebugging(t.session),this.onDidStopDebugging(e))}))}getDebugCell(e){var t;return(t=this.notebookToDebugAdapter.get(e))==null?void 0:t.debugCell}get onDoneDebugging(){return this._doneDebugging.event}dispose(){this.disposables.forEach(e=>e.dispose())}isDebugging(e){return this.notebookToDebugger.has(e)}getDebugSession(e){let t=this.notebookToDebugger.get(e);if(t)return t.session}getDebugAdapter(e){return this.notebookToDebugAdapter.get(e)}onDidStopDebugging(e){}async startDebuggingConfig(e,t){b.ci(`Attempting to start debugging with config ${JSON.stringify(e)}`);try{await ui.debug.startDebugging(void 0,e,t)}catch(n){b.error(`Can't start debugging (${n})`),ui.window.showErrorMessage(C.cantStartDebugging).then(y,y)}}trackDebugAdapter(e,t){this.notebookToDebugAdapter.set(e,t),this.disposables.push(t.onDidEndSession(this.endSession.bind(this)))}async endSession(e){b.info(`Ending debug session ${e.id}`),this._doneDebugging.fire();for(let[t,n]of this.notebookToDebugger.entries())if(n&&e.id===n.session.id){this.notebookToDebugger.delete(t),this.notebookToDebugAdapter.delete(t),this.onDidStopDebugging(t);break}}getDebuggerByUri(e){for(let[t,n]of this.notebookToDebugger.entries())if(e===t)return n}async ensureKernelIsRunning(e){let t=this.controllerRegistration.getSelected(e),n=this.kernelProvider.get(e);return t&&(!n||n&&n.status==="unknown")&&(n=await ka.connectToNotebookKernel(t.connection,this.serviceContainer,{notebook:e,controller:t.controller,resource:e.uri},new vr(!1),this.disposables,"jupyterExtension")),n}findEditorForCell(e){let t=e.notebook.uri.toString();return ui.window.visibleNotebookEditors.find(n=>n.notebook.uri.toString()===t)}async checkIpykernelAndPrompt(e,t=!0){let n=this.findEditorForCell(e);if(!n)return ui.window.showErrorMessage(C.noNotebookToDebug).then(y,y),0;let i=await this.checkForIpykernel6(n.notebook);switch(i){case 3:break;case 2:case 0:{this.promptInstallIpykernel6().then(y,y);break}case 4:if(t)return await ui.commands.executeCommand("notebook.selectKernel",{notebookEditor:n}),await this.checkIpykernelAndPrompt(e,!1)}return i}async checkForIpykernel6(e){var t,n;try{let i=this.kernelProvider.get(e);if(!i){let l=this.controllerRegistration.getSelected(e);if(!l)return 4;i=this.kernelProvider.getOrCreate(e,{metadata:l.connection,controller:l==null?void 0:l.controller,resourceUri:e.uri})}let o=i.kernelConnectionMetadata;if(Mt(o)){if(o.kind==="startUsingRemoteKernelSpec"&&((t=o.kernelSpec.metadata)!=null&&t.debugger))return 1;if(o.kind==="connectToLiveRemoteKernel"&&((n=o.kernelModel.metadata)!=null&&n.debugger))return 1}let s=this.kernelProvider.getKernelExecution(i),a=await XX(s);return J("DATASCIENCE.DEBUGGING.IPYKERNEL6_STATUS",void 0,{status:a===1?"installed":"notInstalled"}),a}catch(i){b.error("Debugging: Could not check for ipykernel 6",i)}return 0}async promptInstallIpykernel6(){await ui.window.showInformationMessage(C.needIpykernel6,{modal:!0},C.setup)===C.setup?(J("DATASCIENCE.DEBUGGING.CLICKED_ON_SETUP"),ui.env.openExternal(ui.Uri.parse("https://github.com/microsoft/vscode-jupyter/wiki/Setting-Up-Run-by-Line-and-Debugging-for-Notebooks"))):J("DATASCIENCE.DEBUGGING.CLOSED_MODAL")}};u();u();var Jl=require("vscode");u();var XA=class{constructor(e){this.debugAdapter=e}trace(e,t){b.debug(`[Debug-Reset] ${e}: ${t}`)}async willSendRequest(e){e.command==="attach"&&(this.trace("attach","Continuing paused kernel threads if needed"),(await this.debugAdapter.debugInfo()).stoppedThreads.forEach(n=>this.debugAdapter.continueDirect(n)))}};var n_=class{constructor(e,t,n,i,o,s){this.session=e;this.notebookDocument=t;this.jupyterSession=n;this.kernel=i;this.platformService=o;this.debugService=s;this.fileToCell=new Map;this.sendMessage=new Jl.EventEmitter;this.endSession=new Jl.EventEmitter;this.disposables=[];this.delegates=[];this.onDidSendMessage=this.sendMessage.event;this.onDidEndSession=this.endSession.event;this.disconnected=!1;var l;b.ci("Creating kernel debug adapter for debugging notebooks");let a=this.session.configuration;gD(a),this.configuration=a,this.debugCell=t.cellAt(a.__cellIndex),this.addDebuggingDelegates([new XA(this)]),(l=this.jupyterSession.kernel)==null||l.iopubMessage.connect(this.onIOPubMessage,this),this.disposables.push(new Jl.Disposable(()=>{var c;return(c=this.jupyterSession.kernel)==null?void 0:c.iopubMessage.disconnect(this.onIOPubMessage,this)})),this.kernel&&(this.kernel.addHook("willRestart",()=>this.disconnect(),this,this.disposables),this.kernel.addHook("interruptCompleted",()=>this.disconnect(),this,this.disposables),this.disposables.push(this.kernel.onDisposed(()=>{this.disconnected||(Jl.debug.stopDebugging(this.session).then(y,y),this.disconnect().catch(y),J("DATASCIENCE.DEBUGGING.ENDED_SESSION",void 0,{reason:"onKernelDisposed"}))}))),this.disposables.push(Mr.onDidChangeNotebookCellExecutionState(c=>{this.configuration.__cellIndex===c.cell.index&&c.state===1&&!this.disconnected&&(J("DATASCIENCE.DEBUGGING.ENDED_SESSION",void 0,{reason:"normally"}),this.disconnect().catch(y))},this,this.disposables)),this.disposables.push(Jl.workspace.onDidChangeNotebookDocument(c=>{c.contentChanges.forEach(d=>{d.removedCells.forEach(p=>{p===this.debugCell&&this.disconnect().catch(y)})})},this,this.disposables)),this.disposables.push(this.debugService.onDidTerminateDebugSession(c=>{(c===this.session||c===this.session)&&this.disconnect().catch(y)}))}addDebuggingDelegates(e){this.delegates.push(...e)}trace(e,t){b.debug(`[Debug] ${e}: ${t}`)}async onIOPubMessage(e,t){var n,i;if(b.ci(`Debug IO Pub message: ${JSON.stringify(t)}`),rZ(t)){this.trace("event",JSON.stringify(t));for(let o of(n=this.delegates)!=null?n:[])if(await((i=o==null?void 0:o.willSendEvent)==null?void 0:i.call(o,t.content)))return;this.sendMessage.fire(t.content)}}handleMessage(e){this.handleClientMessageAsync(e).catch(y)}async handleClientMessageAsync(e){var t,n;try{if(b.ci(`KernelDebugAdapter::handleMessage ${JSON.stringify(e,void 0," ")}`),e.type==="request"&&e.command==="setBreakpoints"){let i=e.arguments;if(i.source&&i.source.path&&i.source.path.indexOf("vscode-notebook-cell:")===0){let o=this.notebookDocument.getCells().find(s=>s.document.uri.toString()===i.source.path);o&&await this.dumpCell(o.index)}}if(e.type==="request")for(let i of(t=this.delegates)!=null?t:[]){let o=await((n=i==null?void 0:i.willSendRequest)==null?void 0:n.call(i,e));if(o){this.trace("response",JSON.stringify(o)),this.sendMessage.fire(o);return}}await this.sendMessageToJupyterSession(e)}catch(i){b.error(`KernelDebugAdapter::handleMessage failure: ${i}`)}}getConfiguration(){return this.configuration}stepIn(e){return this.session.customRequest("stepIn",{threadId:e})}async debugInfo(){return await this.session.customRequest("debugInfo")}continueDirect(e){if(!this.jupyterSession.kernel)throw new tn;this.jupyterSession.kernel.requestDebug({seq:0,type:"request",command:"continue",arguments:{threadId:e}})}async disconnect(){var e;if(!this.disconnected){if(this.disconnected=!0,this.debugService.activeDebugSession===this.session||((e=this.debugService.activeDebugSession)==null?void 0:e.id)===this.session.id)try{await Promise.all([this.deleteDumpedFiles().catch(t=>b.warn("Error deleting temporary debug files.",t)),this.session.customRequest("disconnect",{restart:!1})])}catch(t){b.error("Failed to disconnect debug session",t)}this.endSession.fire(this.session)}}dispose(){this.disposables.forEach(e=>e.dispose())}stackTrace(e){return this.session.customRequest("stackTrace",e)}setBreakpoints(e){return this.session.customRequest("setBreakpoints",e)}async dumpAllCells(){await Promise.all(this.notebookDocument.getCells().map(async e=>{e.kind===Jl.NotebookCellKind.Code&&await this.dumpCell(e.index)}))}lookupCellByLongName(e){if(this.platformService.isWindows){e=Ss(e);for(let[t,n]of this.fileToCell.entries())if(eZ(t)&&tZ(t,e))return n}}async sendMessageToJupyterSession(e){if(this.jupyterSession.isDisposed||this.jupyterSession.status==="dead"||!this.jupyterSession.kernel){b.info(`Skipping sending message ${e.type} because session is disposed`);return}if(this.trace("to kernel",JSON.stringify(e)),e.type==="request"){let t=await this.sendRequestToJupyterSession(e);t&&this.sendMessage.fire(t)}else if(e.type==="response"){$A(e,this.translateRealLocationToDebuggerLocation.bind(this));let t=e;return this.jupyterSession.kernel.requestDebug({seq:t.seq,type:"request",command:t.command},!0).done}else b.error(`Unknown message type to send ${e.type}`)}async sendRequestToJupyterSession(e){var s,a;if($A(e,this.translateRealLocationToDebuggerLocation.bind(this)),!this.jupyterSession.kernel)throw new tn;this.trace("to kernel, mapped",JSON.stringify(e));let t=e,o=(await this.jupyterSession.kernel.requestDebug({seq:t.seq,type:"request",command:t.command,arguments:t.arguments},!0).done).content;$A(o,this.translateDebuggerLocationToRealLocation.bind(this));for(let l of(s=this.delegates)!=null?s:[])await((a=l==null?void 0:l.willSendResponse)==null?void 0:a.call(l,o));return this.trace("response",JSON.stringify(o)),o}translateDebuggerLocationToRealLocation(e,t){var n,i;if(t=(n=e==null?void 0:e.source)!=null?n:t,t&&t.path){let o=(i=this.fileToCell.get(t.path))!=null?i:this.lookupCellByLongName(t.path);o&&(t.name=tr(o.path),t.path=o.toString())}}async deleteDumpedFiles(){let e=this.getDumpFilesForDeletion();if(this.jupyterSession.kernel&&e.length){let n=`import os as _VSCODE_os
_VSCODE_fileList = [${e.map(i=>'"'+i.replace(/\\/g,"\\\\")+'"').join(",")}]
for file in _VSCODE_fileList:
    try:
        _VSCODE_os.remove(file)
    except:
        pass
del _VSCODE_fileList
del _VSCODE_os`;await Fi(this.jupyterSession.kernel,n,{traceErrors:!0,traceErrorsMessage:"Error deleting temporary debugging files"})}}};var ZA=class extends n_{constructor(){super(...arguments);this.cellToFile=new Map}async dumpCell(t){let n=this.notebookDocument.cellAt(t);try{let i=await this.session.customRequest("dumpCell",{code:n.document.getText().replace(/\r\n/g,`
`)}),o=Ss(i.sourcePath);this.fileToCell.set(o,n.document.uri),this.cellToFile.set(n.document.uri.toString(),o)}catch(i){b.error(i)}}translateRealLocationToDebuggerLocation(t){let n=t.source;if(n&&n.path){let i=this.cellToFile.get(n.path);i&&(n.path=i)}}getDumpFilesForDeletion(){return Array.from(this.cellToFile.values())}};var i_=class extends r_{constructor(t,n,i,o,s,a){super(t,n,a);this.configurationService=i;this.platform=o;this.debugService=s;this.notebookToRunByLineController=new Map;this.runByLineCells=new mr(br.RunByLineCells),this.runByLineDocuments=new mr(br.RunByLineDocuments),this.debugDocuments=new mr(br.DebugDocuments)}activate(){super.activate(),this.disposables.push(hm.debug.registerDebugAdapterDescriptorFactory(DL,{createDebugAdapterDescriptor:async t=>this.createDebugAdapterDescriptor(t)}))}getDebugMode(t){let n=this.notebookToRunByLineController.get(t);return n==null?void 0:n.getMode()}onDidStopDebugging(t){super.onDidStopDebugging(t),this.notebookToRunByLineController.delete(t),this.updateRunByLineContextKeys(),this.updateDebugContextKey()}updateRunByLineContextKeys(){let t=[],n=[];this.notebookToRunByLineController.forEach(i=>{t.push(i.debugCell.document.uri),n.push(i.debugCell.notebook.uri)}),this.runByLineCells.set(t).catch(y),this.runByLineDocuments.set(n).catch(y)}updateDebugContextKey(){let t=new SA;this.notebookToDebugAdapter.forEach((n,i)=>t.add(i.uri)),this.notebookInProgress.forEach(n=>t.add(n.uri)),this.debugDocuments.set(Array.from(t.values())).catch(y)}async tryToStartDebugging(t,n,i=!1){if(b.info(`Starting debugging with mode ${t}`),!i){let o=await this.checkIpykernelAndPrompt(n);if(o!==1){b.info(`Ipykernel check failed: ${mD[o]}`);return}}(t===0||t===1)&&await this.startDebuggingCell(t,n)}runByLineNext(t){let n=this.notebookToRunByLineController.get(t.notebook);n&&n.debugCell.document.uri.toString()===t.document.uri.toString()&&n.continue()}runByLineStop(t){let n=this.notebookToRunByLineController.get(t.notebook);n&&(J("DATASCIENCE.DEBUGGING.ENDED_SESSION",void 0,{reason:"withKeybinding"}),n.stop())}async startDebuggingCell(t,n){let i=n.notebook,o=this.configurationService.getSettings(i.uri),s={type:DL,name:tr(i.uri.toString()),request:"attach",justMyCode:t===1?o.debugJustMyCode:!0,__mode:t,__cellIndex:n.index,__notebookUri:i.uri.toString()},a=t===0?{suppressDebugStatusbar:!0,suppressDebugToolbar:!0,suppressDebugView:!0,suppressSaveBeforeStart:!0}:{suppressSaveBeforeStart:!0};return this.startDebuggingConfig(s,a)}async createDebugAdapterDescriptor(t){let n=t.configuration;gD(n);let i=n.__notebookUri,o=hm.workspace.notebookDocuments.find(s=>s.uri.toString()===i);if(!o){b.info(`Cannot start debugging. Notebook ${i} not found.`);return}if(this.notebookInProgress.has(o)){b.info("Cannot start debugging. Already debugging this notebook");return}if(this.isDebugging(o)){b.info("Cannot start debugging. Already debugging this notebook document.");return}this.notebookToDebugger.set(o,new t_(o,n,t));try{return this.notebookInProgress.add(o),this.updateDebugContextKey(),await this.doCreateDebugAdapterDescriptor(n,t,o)}finally{this.notebookInProgress.delete(o),this.updateDebugContextKey()}}async doCreateDebugAdapterDescriptor(t,n,i){let o=await this.ensureKernelIsRunning(i);if(o!=null&&o.session){let s=new ZA(n,i,o.session,o,this.platform,this.debugService);if(t.__mode===0&&typeof t.__cellIndex=="number"){let a=i.cellAt(t.__cellIndex),l=new QA(s,a,this.kernelProvider.getKernelExecution(o),this.configurationService);s.addDebuggingDelegates([l,new vD(0,s,a,this.serviceContainer)]),this.notebookToRunByLineController.set(i,l),this.updateRunByLineContextKeys()}else if(t.__mode===1&&typeof t.__cellIndex=="number"){let a=i.cellAt(t.__cellIndex),l=new zA(s,a,this.kernelProvider.getKernelExecution(o));s.addDebuggingDelegates([l,new vD(1,s,a,this.serviceContainer)])}return this.trackDebugAdapter(i,s),this.updateDebugContextKey(),new hm.DebugAdapterInlineImplementation(s)}else hm.window.showInformationMessage(C.kernelWasNotStarted).then(y,y)}};i_=E([(0,Xd.injectable)(),I(0,(0,Xd.inject)(He)),I(1,(0,Xd.inject)(Tt)),I(2,(0,Xd.inject)(Ae)),I(3,(0,Xd.inject)(ps)),I(4,(0,Xd.inject)(uo)),I(5,(0,Xd.inject)(Kr))],i_);u();var bD=$(te()),iZ=require("vscode");var o_=class{constructor(e,t){this.disposableRegistry=t;this.activeTrackers=new WeakMap;this.activeTrackersById=new Map;this.updatedEmitter=new iZ.EventEmitter;t.push(e.registerDebugAdapterTrackerFactory("python",this))}createDebugAdapterTracker(e){let t=new ZS(e.id);return this.activeTrackers.set(e,t),this.activeTrackersById.set(e.id,t),t.sessionEnded(()=>{this.activeTrackers.delete(e),this.activeTrackersById.delete(e.id)},this,this.disposableRegistry),t.debugLocationUpdated(this.onLocationUpdated,this,this.disposableRegistry),this.onLocationUpdated(),t}get updated(){return this.updatedEmitter.event}getLocation(e){let t=this.activeTrackers.get(e)||this.activeTrackersById.get(e.id);if(t)return t.debugLocation}onLocationUpdated(){this.updatedEmitter.fire()}};o_=E([(0,bD.injectable)(),I(0,(0,bD.inject)(uo)),I(1,(0,bD.inject)(ie))],o_);u();var vu=$(te()),gv=require("vscode");var s_=class{constructor(e,t,n){this.vscodeDebugService=t;this.jupyterDebugService=n;this.sessionChangedEvent=new gv.EventEmitter;this.sessionStartedEvent=new gv.EventEmitter;this.sessionTerminatedEvent=new gv.EventEmitter;this.sessionCustomEvent=new gv.EventEmitter;e.push(t.onDidTerminateDebugSession(this.endedDebugSession.bind(this))),e.push(t.onDidStartDebugSession(this.startedDebugSession.bind(this))),e.push(t.onDidChangeActiveDebugSession(this.changedDebugSession.bind(this))),e.push(t.onDidReceiveDebugSessionCustomEvent(this.gotCustomEvent.bind(this))),n&&(e.push(n.onDidTerminateDebugSession(this.endedDebugSession.bind(this))),e.push(n.onDidStartDebugSession(this.startedDebugSession.bind(this))),e.push(n.onDidChangeActiveDebugSession(this.changedDebugSession.bind(this))),e.push(n.onDidReceiveDebugSessionCustomEvent(this.gotCustomEvent.bind(this))))}get activeDebugSession(){return this.activeService.activeDebugSession}get activeDebugConsole(){return this.activeService.activeDebugConsole}get breakpoints(){return this.activeService.breakpoints}get onDidChangeActiveDebugSession(){return this.sessionChangedEvent.event}get onDidStartDebugSession(){return this.sessionStartedEvent.event}get onDidReceiveDebugSessionCustomEvent(){return this.sessionCustomEvent.event}get onDidTerminateDebugSession(){return this.sessionTerminatedEvent.event}get onDidChangeBreakpoints(){return this.activeService.onDidChangeBreakpoints}get onBreakpointHit(){if(!this.jupyterDebugService)throw new Error("No jupyter debugger service");return this.jupyterDebugService.onBreakpointHit}startRunByLine(e){if(this.lastStartedService=this.jupyterDebugService,!this.jupyterDebugService)throw new Error("No jupyter debugger service");return this.jupyterDebugService.startRunByLine(e)}registerDebugConfigurationProvider(e,t){let n=this.vscodeDebugService.registerDebugConfigurationProvider(e,t);if(this.jupyterDebugService){let i=this.jupyterDebugService.registerDebugConfigurationProvider(e,t);return this.combineDisposables(n,i)}return n}registerDebugAdapterTrackerFactory(e,t){let n=this.vscodeDebugService.registerDebugAdapterTrackerFactory(e,t);if(this.jupyterDebugService){let i=this.jupyterDebugService.registerDebugAdapterTrackerFactory(e,t);return this.combineDisposables(n,i)}return n}startDebugging(e,t,n){return this.lastStartedService=this.vscodeDebugService,this.vscodeDebugService.startDebugging(e,t,n)}addBreakpoints(e){return this.activeService.addBreakpoints(e)}removeBreakpoints(e){return this.activeService.removeBreakpoints(e)}getStack(){if(!this.jupyterDebugService)throw new Error("No jupyter debugger service");if(this.lastStartedService===this.jupyterDebugService)return this.jupyterDebugService.getStack();throw new Error("Requesting jupyter specific stack when not debugging.")}step(){if(!this.jupyterDebugService)throw new Error("No jupyter debugger service");if(this.lastStartedService===this.jupyterDebugService)return this.jupyterDebugService.step();throw new Error("Requesting jupyter specific step when not debugging.")}continue(){if(!this.jupyterDebugService)throw new Error("No jupyter debugger service");if(this.lastStartedService===this.jupyterDebugService)return this.jupyterDebugService.continue();throw new Error("Requesting jupyter specific step when not debugging.")}requestVariables(){if(!this.jupyterDebugService)throw new Error("No jupyter debugger service");if(this.lastStartedService===this.jupyterDebugService)return this.jupyterDebugService.requestVariables();throw new Error("Requesting jupyter specific variables when not debugging.")}stop(){this.jupyterDebugService&&this.lastStartedService===this.jupyterDebugService?this.jupyterDebugService.stop():gv.commands.executeCommand("workbench.action.debug.stop").then(y,y)}get activeService(){return this.lastStartedService?this.lastStartedService:this.vscodeDebugService}combineDisposables(e,t){return{dispose:()=>{e.dispose(),t.dispose()}}}endedDebugSession(e){this.sessionTerminatedEvent.fire(e),this.lastStartedService=void 0}startedDebugSession(e){this.sessionStartedEvent.fire(e)}changedDebugSession(e){this.sessionChangedEvent.fire(e)}gotCustomEvent(e){this.sessionCustomEvent.fire(e)}};s_=E([(0,vu.injectable)(),I(0,(0,vu.inject)(ie)),I(1,(0,vu.inject)(uo)),I(2,(0,vu.optional)()),I(2,(0,vu.inject)(QS)),I(2,(0,vu.named)(tt.RUN_BY_LINE_DEBUGSERVICE))],s_);u();var Aj=$(zh()),vv=$(te());u();var a_=Symbol("IFileConverter"),vm=Symbol("IExportBase"),gPt=Symbol("IExport"),ym=Symbol("IExportUtil");function NIe(){return`${jf}${(0,Aj.default)()}`}function RIe(r){let e=`${NIe()}${(0,Aj.default)()}.ipynb`;return r?`${mi(r,".ipynb")}${e}`:`${C.defaultNotebookName}${e}`}var hv=class{constructor(e,t,n,i){this.kernelProvider=e;this.fs=t;this.jupyterConnection=n;this.exportUtil=i}async export(e,t,n,i){}async executeCommand(e,t,n,i,o){var _;let s=this.kernelProvider.get(e);if(!s||(s.session||await s.start(new vr(!1)),!((_=s.session)!=null&&_.kernel)))return;let a=s.kernelConnectionMetadata,l=s.resourceUri;if(!Mt(a)||l)return;let c=s.session.kernel,p=(await this.jupyterConnection.createConnectionInfo(a.serverProviderHandle)).settings,f=oi(),m=new f.ContentsManager({serverSettings:p}),g=await this.exportUtil.getContent(e),h="";switch(n){case"html":h=".html";break;case"pdf":h=".pdf";break;case"python":h=".py";break}let v=await this.createBackingFile(l,m);if(!v)return;await m.save(v.filePath,{content:JSON.parse(g),type:"notebook"}).catch(y);let S;try{let D=await this.getCWD(s);S=(await m.newUntitled({type:"file",ext:h})).path;let M=`${D}/${v.filePath}`,x=await Fi(c,`!jupyter nbconvert ${M} --to ${n} --output ${tr(S)}`),A=this.parseStreamOutput(x);if(this.isExportFailed(A))throw new Error(A||`Failed to export to ${n}`);if(A&&b.debug(A),n==="pdf"){let j=await m.get(S,{type:"file",format:"base64",content:!0}),R=await this.b64toBlob(j.content,"application/pdf").arrayBuffer();await this.fs.writeFile(t,new Uint8Array(R))}else{let j=await m.get(S,{type:"file",format:"text",content:!0});await this.fs.writeFile(t,j.content)}}finally{S&&await m.delete(S),await v.dispose(),await m.delete(v.filePath).catch(y),m.dispose()}}async createBackingFile(e,t){let n,i={type:"notebook"},o=RIe(e);try{n=await t.newUntitled(i);let s=Di(n.path);n=await t.rename(n.path,s.length&&s!=="."?`${s}/${o}`:o)}catch(s){b.error(`Backing file not supported: ${s}`)}if(n){let s=n.path;return{filePath:s,dispose:()=>t.delete(s)}}}async getContents(e,t,n){return await n.get(e,{type:"file",format:t,content:!0})}b64toBlob(e,t){t=t||"";let n=512;e=e.replace(/^[^,]+,/,""),e=e.replace(/\s/g,"");let i=atob(e),o=[];for(let a=0;a<i.length;a+=n){let l=i.slice(a,a+n),c=new Array(l.length);for(let p=0;p<l.length;p++)c[p]=l.charCodeAt(p);let d=new Uint8Array(c);o.push(d)}return new Blob(o,{type:t})}isExportFailed(e){return e?/Traceback \(most recent call last\)/g.exec(e):!0}parseStreamOutput(e){if(e.length===0)return;let t=e[0];return t.name!=="stdout"&&t.output_type!=="stream"?void 0:Fc(t.text).trim()}async getCWD(e){var i;if(!((i=e.session)!=null&&i.kernel))throw new tn;let t=await Fi(e.session.kernel,"import os;os.getcwd();");if(t.length===0)return;let n=t[0];if(n.output_type==="execute_result")return n.data["text/plain"]}};E([Zz("PerformingExport")],hv.prototype,"executeCommand",1),hv=E([(0,vv.injectable)(),I(0,(0,vv.inject)(He)),I(1,(0,vv.inject)(wt)),I(2,(0,vv.inject)(gn)),I(3,(0,vv.inject)(ym))],hv);u();var oZ=$(te());u();var l_=require("vscode");u();var ID=require("vscode");var AIe={PDF:["pdf"]},MIe={HTML:["html","htm"]},OIe={Python:["py"]},ep=class{async showDialog(e,t,n){let i={},o;switch(e){case"python":i=OIe,o=".py";break;case"pdf":o=".pdf",i=AIe;break;case"html":o=".html",i=MIe;break;case"ipynb":o=".ipynb";let l=C.exportDialogFilter;i[l]=["ipynb"];break;default:return}let s=n||!t?n||"":`${tr(t.path,vp(t.path))}${o}`,a={defaultUri:await this.getDefaultUri(t,s),saveLabel:C.exportButtonTitle,filters:i};return ID.window.showSaveDialog(a)}async getDefaultUri(e,t){if(e&&e.scheme==="untitled"&&xn())return;if(!e||e.scheme==="file"||e.scheme==="untitled"||e.scheme==="vscode-interactive"){let i=rt.instance.get(ZR);return ID.Uri.file(AE(await i.computeWorkingDirectory(e),t))}let n=AE(Di(e.path),t);return ID.Uri.parse(`${e.scheme}://${n}`).with({authority:e.authority})}};var eM=class{async getContent(e){let t=l_.extensions.getExtension("vscode.ipynb");if(!t)throw new Error("Unable to export notebook as the built-in vscode.ipynb extension is currently unavailable.");t.isActive||await t.activate();let i=e.getCells().map(s=>{let a=new l_.NotebookCellData(s.kind,s.document.getText(),s.document.languageId);return a.metadata=s.metadata,a.mime=s.mime,a.outputs=[...s.outputs],a}),o=new l_.NotebookData(i);return o.metadata=JSON.parse(JSON.stringify(e.metadata)),t.exports.exportNotebook(o)}async getTargetFile(e,t,n){return await new ep().showDialog(e,t,n)}};var c_=class extends eM{};c_=E([(0,oZ.injectable)()],c_);u();var p_=$(te());u();var sM=$(te()),aM=require("vscode");u();var tp=require("vscode");var tM=class{constructor(){this.fs=rt.instance.get(wt)}async openFile(e,t,n=!1){if(e==="python")await this.openPythonFile(t,n),J("DATASCIENCE.EXPORT_NOTEBOOK_AS",void 0,{format:e,successful:!0,opened:!0});else{let i=await this.askOpenFile(t,n);J("DATASCIENCE.EXPORT_NOTEBOOK_AS",void 0,{format:e,successful:!0,opened:i})}}async openPythonFile(e,t){let n;if(t)n=await tp.window.showTextDocument(e);else{let i=await this.fs.readFile(e);await this.fs.delete(e);let o=await tp.workspace.openTextDocument({language:Je,content:i});n=await tp.window.showTextDocument(o)}await n.edit(i=>{i.insert(new tp.Position(n.document.lineCount,0),`
`)})}async askOpenFile(e,t){let n=C.openExportFileYes,i=C.openExportFileNo,o=[n,i];return await tp.window.showInformationMessage(C.openExportedFileMessage,...o).then(a=>a)===n?(t?tp.window.showTextDocument(e).then(y,y):KI(e.toString()),!0):!1}};u();var rM=class{async export(e,t,n,i){await rt.instance.get(vm).executeCommand(e,t,"python",n,i)}};u();var nM=class{async export(e,t,n,i){await rt.instance.get(vm).executeCommand(e,t,"pdf",n,i)}};u();var iM=class{async export(e,t,n,i){await rt.instance.get(vm).executeCommand(e,t,"html",n,i)}};u();var Mj=require("vscode");var oM=class{constructor(){this.fs=rt.instance.get(wt),this.configuration=rt.instance.get(Ae),this.platform=rt.instance.get(ps)}async writeFile(e,t){await this.fs.writeFile(e,t)}getEOL(){return this.platform.isWindows?`\r
`:`
`}async export(e,t,n){if(n.isCancellationRequested)return;let i=this.exportDocument(e);await this.writeFile(t,i)}exportDocument(e){return e.getCells().filter(t=>{var n;return!((n=t.metadata)!=null&&n.isInteractiveWindowMessageCell)}).reduce((t,n)=>t+this.exportCell(n),"")}exportCell(e){if(e.document.lineCount){let t=this.cellMarker(e),n=this.getEOL();switch(e.kind){case Mj.NotebookCellKind.Code:return`${t}${n}${this.exportCodeCell(e)}${n}${n}`;case Mj.NotebookCellKind.Markup:return`${t} [markdown]${n}${this.exportMarkdownCell(e)}${n}${n}`}}return""}exportCodeCell(e){let t=st(e.document.getText(),{trim:!1,removeEmptyEntries:!1}),n=this.configuration.getSettings(e.notebook.uri).pythonExportMethod==="commentMagics";return iI(t,this.getEOL(),n?LIe:void 0).join("")}exportMarkdownCell(e){let t=st(e.document.getText(),{trim:!1,removeEmptyEntries:!1});return iI(t,this.getEOL(),KIe).join("")}cellMarker(e){var n;let t=this.configuration.getSettings(e.notebook.uri);return(n=e.metadata.interactiveWindowCellMarker)!=null?n:t.defaultCellMarker}};function LIe(r){return/^\s*!/.test(r)||/^\s*%/.test(r)?`# ${r}`:r}function KIe(r){return`# ${r}`}var u_=class{constructor(e,t,n){this.exportUtil=e;this.progressReporter=t;this.configuration=n}async importIpynb(e){let t=this.progressReporter.createProgressIndicator(C.importingIpynb,!0);try{let n=await aM.workspace.openNotebookDocument(e);await this.exportImpl("python",n,void 0,t.token)}finally{t.dispose()}}async export(e,t,n,i){let o=this.progressReporter.createProgressIndicator(C.exportingToFormat(e.toString()),!0);try{await this.exportImpl(e,t,n,o.token,i)}finally{o.dispose()}if(o.token.isCancellationRequested){J("DATASCIENCE.EXPORT_NOTEBOOK_AS",void 0,{format:e,cancelled:!0});return}}async exportImpl(e,t,n,i,o){try{let s=await this.exportUtil.getTargetFile(e,t.uri,n);if(!s)return;await this.performExport(e,t,s,i,o)}catch(s){b.error("Export failed",s),J("DATASCIENCE.EXPORT_NOTEBOOK_AS_FAILED",void 0,{format:e}),e==="pdf"&&b.error(C.exportToPDFDependencyMessage),this.showExportFailed(C.exportFailedGeneralMessage)}}async performExport(e,t,n,i,o){e==="python"&&this.configuration.getSettings(t.uri).pythonExportMethod!=="nbconvert"?await this.performPlainExport(e,t,n,i):await this.performNbConvertExport(t,e,n,o,i),n&&this.openExportedFile(e,n).catch(y)}async openExportedFile(e,t){await new tM().openFile(e,t,!0).catch(y)}async performPlainExport(e,t,n,i){if(n)switch(e){case"python":await new oM().export(t,n,i);break}return n}async performNbConvertExport(e,t,n,i,o){try{return await this.exportToFormat(e,n,t,i,o)}finally{}}async exportToFormat(e,t,n,i,o){switch(n){case"python":return new rM().export(e,t,i,o);case"pdf":return new nM().export(e,t,i,o);case"html":return new iM().export(e,t,i,o);default:break}}showExportFailed(e){aM.window.showErrorMessage(`${C.failedExportMessage} ${e}`)}};u_=E([I(0,(0,sM.inject)(ym)),I(1,(0,sM.inject)(Ul)),I(2,(0,sM.inject)(Ae))],u_);var d_=class extends u_{constructor(t,n,i){super(t,n,i);this.exportUtil=t}};d_=E([(0,p_.injectable)(),I(0,(0,p_.inject)(ym)),I(1,(0,p_.inject)(Ul)),I(2,(0,p_.inject)(Ae))],d_);u();var _D=$(te()),yv=require("vscode");u();var SD=require("vscode");var Oj=new WeakMap;async function yu(r,e){let t=r;if(r.isClosed)return!0;let n=Oj.has(t)?Oj.get(t):Promise.resolve(),i=Te(),o=n.finally(async()=>{let s=new SD.WorkspaceEdit,a=e(s);Wv(a)&&await a,await SD.workspace.applyEdit(s).then(l=>i.resolve(l),l=>i.reject(l))}).catch(y);return Oj.set(t,o),i.promise}var f_=class{constructor(e,t){this.disposables=e;this.controllerRegistration=t}activate(){this.controllerRegistration.onControllerSelected(this.onDidChangeNotebookController,this,this.disposables)}async onDidChangeNotebookController(e){let t=e.notebook,n=e.controller.connection;if(!hr(t))return;let i=yv.window.visibleNotebookEditors.find(d=>d.notebook===t);if(!i)return;let o=t.getCells().filter(d=>d.kind===yv.NotebookCellKind.Code&&d.document.getText().trim().length===0),s=t.getCells().filter(d=>d.kind===yv.NotebookCellKind.Code).length;if(o.length===0||o.length!==s)return;let a,l=n.kind;switch(n.kind){case"connectToLiveRemoteKernel":{a=n.kernelModel.language;break}case"startUsingRemoteKernelSpec":case"startUsingLocalKernelSpec":{a=n.kernelSpec.language;break}case"startUsingPythonInterpreter":{a=Je;break}default:{b.error(`Unsupported kernel kind encountered ${l}`);return}}if(!a)return;let c=Kc(a);yu(i.notebook,async()=>{await o.map(async d=>{if(c.toLowerCase()!==d.document.languageId)return yv.languages.setTextDocumentLanguage(d.document,c).then(y,y)})}).then(y,y)}};f_=E([(0,_D.injectable)(),I(0,(0,_D.inject)(ie)),I(1,(0,_D.inject)(Tt))],f_);u();var ql=$(te()),Ir=require("vscode");var m_=class{constructor(e,t,n,i,o,s,a,l){this.disposableRegistry=e;this.languageService=t;this.configurationService=n;this.kernelProvider=i;this.controllerRegistration=o;this.errorHandler=s;this.notebookEditorProvider=a;this.serviceContainer=l;this.kernelInterruptedDontAskToRestart=!1;this.pendingRestartInterrupt=new WeakMap}register(){this.disposableRegistry.push(Ir.commands.registerCommand(Q.NotebookEditorRemoveAllCells,()=>this.removeAllCells())),this.disposableRegistry.push(Ir.commands.registerCommand(Q.NotebookEditorRunAllCells,()=>this.runAllCells())),this.disposableRegistry.push(Ir.commands.registerCommand(Q.NotebookEditorAddCellBelow,()=>this.addCellBelow())),this.disposableRegistry.push(Ir.commands.registerCommand(Q.RestartKernelAndRunUpToSelectedCell,()=>this.restartKernelAndRunUpToSelectedCell())),this.disposableRegistry.push(Ir.commands.registerCommand(Q.RestartKernel,e=>{var t;return e&&"notebookEditor"in e?this.restartKernel((t=e==null?void 0:e.notebookEditor)==null?void 0:t.notebookUri).catch(y):this.restartKernel(e).catch(y)})),this.disposableRegistry.push(Ir.commands.registerCommand(Q.InterruptKernel,e=>{var t;return this.interruptKernel((t=e==null?void 0:e.notebookEditor)==null?void 0:t.notebookUri)})),this.disposableRegistry.push(Ir.commands.registerCommand(Q.RestartKernelAndRunAllCells,e=>{var t;e&&"notebookEditor"in e?this.restartKernelAndRunAllCells((t=e==null?void 0:e.notebookEditor)==null?void 0:t.notebookUri).catch(y):this.restartKernelAndRunAllCells(e).catch(y)}))}runAllCells(){Ir.window.activeNotebookEditor&&Ir.commands.executeCommand("notebook.execute").then(y,y)}addCellBelow(){Ir.window.activeNotebookEditor&&Ir.commands.executeCommand("notebook.cell.insertCodeCellBelow").then(y,y)}removeAllCells(){var n;let e=(n=Ir.window.activeNotebookEditor)==null?void 0:n.notebook;if(!e)return;let t=this.languageService.getPreferredLanguage(Ca(e));yu(e,i=>{let o=Ir.NotebookEdit.replaceCells(new Ir.NotebookRange(0,e.cellCount),[new Ir.NotebookCellData(Ir.NotebookCellKind.Code,"",t)]);i.set(e.uri,[o])}).then(y,y)}async interruptKernel(e){var o;let t=e!=null?e:(o=this.notebookEditorProvider.activeNotebookEditor)==null?void 0:o.notebook.uri,n=Ir.workspace.notebookDocuments.find(s=>s.uri.toString()===(t==null?void 0:t.toString()));if(n===void 0)return;b.debug(`Command interrupted kernel for ${ve(n.uri)}`);let i=this.kernelProvider.get(n);if(!i){b.info("Interrupt requested & no kernel.");return}await this.wrapKernelMethod("interrupt",i)}async restartKernelAndRunAllCells(e){await this.restartKernel(e),this.runAllCells()}async restartKernelAndRunUpToSelectedCell(){let e=this.notebookEditorProvider.activeNotebookEditor;e&&(await this.restartKernel(e.notebook.uri),Ir.commands.executeCommand("notebook.cell.execute",{ranges:[{start:0,end:e.selection.end}],document:e.notebook.uri}).then(y,y))}async restartKernel(e){var o;let t=e!=null?e:(o=this.notebookEditorProvider.activeNotebookEditor)==null?void 0:o.notebook.uri,n=Ir.workspace.notebookDocuments.find(s=>s.uri.toString()===(t==null?void 0:t.toString()));if(n===void 0)return;let i=this.kernelProvider.get(n);if(i)if(b.debug(`Restart kernel command handler for ${ve(n.uri)}`),await this.shouldAskForRestart(n.uri)){let s=C.restartKernelMessage,a=C.restartKernelMessageYes,l=C.restartKernelMessageDontAskAgain,c=await Ir.window.showInformationMessage(s,{modal:!0},a,l);c===l?(await this.disableAskForRestart(n.uri),this.wrapKernelMethod("restart",i).catch(y)):c===a&&this.wrapKernelMethod("restart",i).catch(y)}else this.wrapKernelMethod("restart",i).catch(y)}async wrapKernelMethod(e,t){let n=t.notebook,i=this.pendingRestartInterrupt.get(t);if(i)return i;let o=(async()=>{let s=this.kernelProvider.getKernelExecution(t).pendingCells[0],a=this.controllerRegistration.getSelected(n);try{if(!a)throw new Error("No kernel associated with the notebook");await ka.wrapKernelMethod(a.connection,e,t.creator,this.serviceContainer,{resource:t.resourceUri,notebook:n,controller:a.controller},new vr(!1),this.disposableRegistry)}catch(l){s?await Vf(s,t.controller,await this.errorHandler.getErrorMessageForDisplayInCell(l,e,t.resourceUri),!1):Ir.window.showErrorMessage(l.toString()).then(y,y)}})();return o.finally(()=>{this.pendingRestartInterrupt.get(t)===o&&this.pendingRestartInterrupt.delete(t)}).catch(y),this.pendingRestartInterrupt.set(t,o),o}async shouldAskForRestart(e){if(this.kernelInterruptedDontAskToRestart)return!1;let t=this.configurationService.getSettings(e);return t&&t.askForKernelRestart===!0}async disableAskForRestart(e){this.configurationService.getSettings(e)&&this.configurationService.updateSetting("askForKernelRestart",!1,void 0,Ir.ConfigurationTarget.Global).catch(y)}};m_=E([(0,ql.injectable)(),I(0,(0,ql.inject)(ie)),I(1,(0,ql.inject)(Js)),I(2,(0,ql.inject)(Ae)),I(3,(0,ql.inject)(He)),I(4,(0,ql.inject)(Tt)),I(5,(0,ql.inject)(Cn)),I(6,(0,ql.inject)(Ko)),I(7,(0,ql.inject)(Kr))],m_);u();var sZ=$(te()),bm=require("vscode");var g_=class{constructor(){this.providers=new Set}registerEmbedNotebookProvider(e){this.providers.add(e)}findNotebookEditor(e){var o;let t=e?Fa(e,!0):"false",n=Al(e)==="notebook"?bm.workspace.notebookDocuments.find(s=>Fa(s.uri,!0)===t):void 0,i=n&&((o=bm.window.activeNotebookEditor)==null?void 0:o.notebook)===n?bm.window.activeNotebookEditor:void 0;if(i)return i;for(let s of this.providers){let a=s.findNotebookEditor(e);if(a)return a}}get activeNotebookEditor(){var e,t;return this.findNotebookEditor((e=bm.window.activeNotebookEditor)==null?void 0:e.notebook.uri)||this.findNotebookEditor((t=bm.window.activeTextEditor)==null?void 0:t.document.uri)}findAssociatedNotebookDocument(e){let t=Pi()==="Windows",n=bm.workspace.notebookDocuments.find(i=>t?i.uri.path.toLowerCase()===e.path.toLowerCase():i.uri.path===e.path);if(n)return n;for(let i of this.providers){let o=i.findAssociatedNotebookDocument(e);if(o)return o}}};g_=E([(0,sZ.injectable)()],g_);u();var lM=$(te()),v_=require("vscode");var h_=class{constructor(e){this.sentMimeTypes=new Set;this.disposables=[];e.push(this)}activate(){this.isTelemetryDisabled=h0(),v_.workspace.onDidOpenNotebookDocument(this.onDidOpenCloseDocument,this,this.disposables),v_.workspace.onDidCloseNotebookDocument(this.onDidOpenCloseDocument,this,this.disposables),v_.workspace.onDidSaveNotebookDocument(this.onDidOpenCloseDocument,this,this.disposables),Mr.onDidChangeNotebookCellExecutionState(this.onDidChangeNotebookCellExecutionState,this,this.disposables),this.disposables.push(v0(e=>this.isTelemetryDisabled=e))}dispose(){fe(this.disposables)}async onDidChangeNotebookCellExecutionState(e){!hr(e.cell.notebook)||this.isTelemetryDisabled||e.state!==1||this.checkCell(e.cell,"onExecution")}onDidOpenCloseDocument(e){!hr(e)||this.isTelemetryDisabled||e.getCells().forEach(t=>this.checkCell(t,"onOpenCloseOrSave"))}checkCell(e,t){if(e.kind===v_.NotebookCellKind.Markup||e.document.languageId==="raw")return;let n=e.notebook.notebookType===bt?"notebook":"interactive";e.outputs.map(i=>i.items.map(o=>o.mime)).flat().map(i=>this.sendTelemetry(i,t,n))}sendTelemetry(e,t,n){let i=`${e}-${t}`;this.sentMimeTypes.has(i)||(this.sentMimeTypes.add(i),e=e.replace(/\//g,"_").replace(/\\/g,"_"),J("DS_INTERNAL.CELL_OUTPUT_MIME_TYPE",void 0,{mimeType:e,when:t,resourceType:n}))}};h_=E([(0,lM.injectable)(),I(0,(0,lM.inject)(ie))],h_);u();var cM=$(te());var FIe=/(;32m[ ->]*?)(\d+)(.*)/g,y_=class{constructor(e){this.configurationService=e}format(e,t){return e.notebook.notebookType!==bt?t:t.map(n=>this.modifyTracebackFrameIPython(e,n))}modifyTracebackFrameIPython(e,t){var o;let n=this.configurationService.getSettings(e.document.uri);return((o=n==null?void 0:n.formatStackTraces)!=null?o:!1)&&/^[Cell|Input|File].*?\n.*/.test(t)?this.modifyTracebackFrameIPython8(e,t):t}modifyTracebackFrameIPython8(e,t){t=t.replace(/\u001b\[4\dm/g,""),t=t.replace(/\u001b\[38;.*?\d+m/g,"\x1B[39m"),t=t.replace(/(;32m[ ->]*?)(\d+)(.*)\n/g,(s,a,l,c)=>(c=c.replace(/\u001b\[3\d+m/g,"\x1B[39m"),`${a}${l}${c}
`)),b.ci(`Trace frame to match: ${t}`);let n=(s,a)=>{let l=s.replace(FIe,(d,p,f,m)=>{let g=parseInt(f,10);return`${p}<a href='${e.document.uri.toString()}?line=${g-1}'>${g}</a>${m}`}),c=C.cellAtFormat(at(e.document.uri),e.index+1);return l.replace(/.*?\n/,`\x1B[1;32m${c}\x1B[0m line \x1B[0;36m${a}
`)},i=/^Input.*?\[.*32mIn\s+\[(\d+).*?0;36m(.*?)\n.*/.exec(t);if(i&&i.length>1)return n(t,i[2]);let o=/Cell.*?\[.*32mIn\s*\[(\d+)\]\,\s+line\s+([(\d+)])(.*?)\n.*/gm.exec(t);return o&&o.length>1?n(t,o[2]):t}};y_=E([(0,cM.injectable)(),I(0,(0,cM.inject)(Ae))],y_);function aZ(r,e){zX(r,e),r.addSingleton(Ue,nv),r.addSingleton(Ko,g_),r.addSingleton(Ue,lv),r.addSingleton(vI,y_),r.addSingleton(lm,lm),r.addBinding(lm,Ue),r.addSingleton(Ue,VS),r.addSingleton(sy,m_),r.addSingleton(Js,Js),r.addBinding(Js,Ue),r.addSingleton(Ue,f_),r.addSingleton(gm,i_,void 0,[Ue]),r.addSingleton(QS,s_,tt.MULTIPLEXING_DEBUGSERVICE),r.addSingleton(HA,o_,void 0,[BA]),r.addSingleton(Wi,e_,tt.DEBUGGER_VARIABLES),r.addSingleton(Ue,XS),r.addSingleton(Ue,h_),r.addSingleton(vm,hv),r.addSingleton(a_,d_),r.addSingleton(ym,c_)}u();u();var Ln=$(te()),qe=require("vscode");u();var Im=Symbol("IDataScienceCodeLensProvider"),uM=Symbol("ICodeWatcher"),dM=Symbol("ICodeLensFactory"),QNt=Symbol("IGeneratedCodeStore"),Ra=Symbol("IGeneratedCodeStorageFactory"),b_=Symbol("ICodeGeneratorFactory");u();var lZ=Symbol("IInteractiveWindowDebugger"),gs=Symbol("IInteractiveWindowProvider"),pM=Symbol("IInteractiveControllerHelper"),fM=Symbol("IInteractiveWindowDebuggingManager");u();var mM=require("vscode");async function gM(r){let e=await mM.workspace.openNotebookDocument(r);await mM.window.showNotebookDocument(e)}u();var Aa=require("vscode");u();var Fo=class{constructor(e){this.codeMatchRegEx=this.createRegExp(e?e.codeRegularExpression:void 0,xE.PythonCellMarker),this.markdownMatchRegEx=this.createRegExp(e?e.markdownRegularExpression:void 0,xE.PythonMarkdownCellMarker),this.codeExecRegEx=new RegExp(`${this.codeMatchRegEx.source}(.*)`),this.markdownExecRegEx=new RegExp(`${this.markdownMatchRegEx.source}(.*)`),this.defaultCellMarker=e!=null&&e.defaultCellMarker?e.defaultCellMarker:"# %%"}isCell(e){return this.isCode(e)||this.isMarkdown(e)}isMarkdown(e){return this.markdownMatchRegEx.test(e.trim())}isCode(e){return this.codeMatchRegEx.test(e.trim())||e.trim()===this.defaultCellMarker}getCellType(e){return this.isMarkdown(e)?"markdown":"code"}isEmptyCell(e){return this.stripFirstMarker(e).trim().length===0}stripFirstMarker(e){let t=st(e,{trim:!1,removeEmptyEntries:!1});return t.length>0&&(this.isCode(t[0])||this.isMarkdown(t[0]))?t.slice(1).join(`
`):e}stripFirstMarkerNoConcat(e){return e.length>0&&(this.isCode(e[0])||this.isMarkdown(e[0]))?e.slice(1):e}getFirstMarker(e){let t=st(e,{trim:!1,removeEmptyEntries:!1});if(t.length>0&&(this.isCode(t[0])||this.isMarkdown(t[0])))return t[0]}createRegExp(e,t){try{if(e)return new RegExp(e)}catch(n){}return t}};u();var Gs=require("vscode");function cZ(r,e){let t=ct(r);return t?e==1?C.restartingKernelCustomHeader(t):C.startingNewKernelCustomHeader(t):e==1?C.restartingKernelHeader:C.startingNewKernelHeader}function uZ(r,e){let t=ct(r);return e==1?C.restartedKernelHeader(t||""):C.connectedKernelHeader(t||"")}function ED(r){var e;return r.kind===Gs.NotebookCellKind.Markup&&((e=r.metadata)==null?void 0:e.isInteractiveWindowMessageCell)===!0}var hM=class{constructor(e,t){this.notebookDocument=e;this.isDeleted=!1;if(e.cellCount){let n=e.cellAt(e.cellCount);ED(n)&&(this.sysInfoCellPromise=Promise.resolve(n),this.sysInfoCellPromise=this.updateMessage(t))}this.sysInfoCellPromise===void 0&&(this.sysInfoCellPromise=this.createCell(t))}async createCell(e){let t;return await yu(this.notebookDocument,n=>{let i=new Gs.NotebookCellData(Gs.NotebookCellKind.Markup,e,DE);i.metadata={isInteractiveWindowMessageCell:!0},t=this.notebookDocument.cellCount;let o=Gs.NotebookEdit.insertCells(t,[i]);n.set(this.notebookDocument.uri,[o])}),t=t!=null?t:this.notebookDocument.cellCount-1,this.notebookDocument.cellAt(t)}async updateMessage(e){let t=await this.sysInfoCellPromise;return await yu(this.notebookDocument,n=>{if(t.index>=0&&!this.isDeleted&&ED(t)){n.replace(t.document.uri,new Gs.Range(0,0,t.document.lineCount,0),e),n.set(this.notebookDocument.uri,[Gs.NotebookEdit.updateCellMetadata(t.index,{isInteractiveWindowMessageCell:!0})]);return}}),t}async deleteCell(){this.isDeleted=!0;let e=await this.sysInfoCellPromise;await yu(this.notebookDocument,t=>{if(e.index>=0&&ED(e)){let n=Gs.NotebookEdit.deleteCells(new Gs.NotebookRange(e.index,e.index+1));t.set(this.notebookDocument.uri,[n]);return}})}};function vM(r){return/^#\s*!/.test(r)?/^#\s*!\s*%%?/.test(r)?r.replace(/^#\s*!\s*/,""):r.replace(/^#\s*/,""):r}function dZ(r){return new Aa.NotebookCellData(Aa.NotebookCellKind.Code,r.join(`
`),"python")}function pZ(r){return new Aa.NotebookCellData(Aa.NotebookCellKind.Markup,R0(r).join(`
`),"markdown")}function WIe(r,e,t){let n=st(e,{trim:!1}),i=n[0];if(new Fo(r).isMarkdown(i)){let s=-1;return Ph(n,(a,l)=>void 0,(a,l)=>{a&&a.length>0&&s===-1&&(s=t?l:-1)}),s>=0?[pZ(n.slice(0,s)),dZ(n.slice(s))]:[pZ(n)]}else return[dZ(n)]}function fZ(r,e){let t=new Fo(e);for(let n=0;n<r.lineCount;n+=1){let i=r.lineAt(n);if(t.isCell(i.text))return!0}return!1}function CD(r,e){let t=new Fo(e),n=[];for(let i=0;i<r.lineCount;i+=1){let o=r.lineAt(i);if(t.isCell(o.text)){if(n.length>0){let s=n[n.length-1];s.range=new Aa.Range(s.range.start,r.lineAt(i-1).range.end)}n.push({range:o.range,cell_type:t.getCellType(o.text)})}}if(n.length>=1){let i=r.lineAt(r.lineCount-1),o=n[n.length-1];o.range=new Aa.Range(o.range.start,i.range.end)}return n}function Lj(r,e){let t=CD(r,e);return Array.prototype.concat(...t.map(n=>{let i=r.getText(n.range);return WIe(e,i,!1)}))}function mZ(r){return r.getCells().filter(e=>!ED(e)).map(e=>{let t=st(e.document.getText(),{trim:!1,removeEmptyEntries:!1});e.metadata.interactiveWindowCellMarker!==void 0&&t.unshift(e.metadata.interactiveWindowCellMarker+`
`);let n=new Aa.NotebookCellData(e.kind,t.join(`
`),e.kind===Aa.NotebookCellKind.Code?e.document.languageId:"markdown");return e.kind===Aa.NotebookCellKind.Code&&(n.outputs=[...e.outputs]),n.metadata=Tf(e),n})}u();var wD=require("vscode");var Kj=class{constructor(e,t,n){this.disposed=!1;this.dispose=()=>{this.disposed||(this.disposed=!0,this.timeout&&(clearTimeout(this.timeout),this.timeout=void 0),this.disposeCallback(),this.deferred.completed||this.deferred.resolve())};this.promise=()=>this.deferred.promise;this.reject=()=>{this.deferred.reject(),this.dispose()};this.deferred=Te(),this.disposeCallback=t,n&&(this.timeout=setTimeout(this.dispose,n))}},yM=class{constructor(){this.statusCount=0;this.incrementCount=()=>{this.statusCount+=1};this.decrementCount=()=>{let e=this.statusCount-1;this.statusCount=Math.max(e,0)}}set(e,t,n){this.incrementCount();let i=new Kj(e,()=>this.decrementCount(),t),o={location:n?wD.ProgressLocation.Notification:wD.ProgressLocation.Window,title:e,cancellable:n!==void 0};return wD.window.withProgress(o,(s,a)=>(a&&n&&a.onCancellationRequested(()=>{n(),i.reject()}),i.promise())).then(y,y),i}async waitWithStatus(e,t,n,i){let o=this.set(t,n,i),s;try{s=await e()}finally{o.dispose()}return s}};var hs=class{constructor(e,t,n,i,o,s,a,l,c,d,p,f,m){this.disposables=e;this.jupyterExporter=t;this.jupyterServerHelper=n;this.fileSystem=i;this.configuration=o;this.dataScienceCodeLensProvider=s;this.debugService=a;this.configService=l;this.interactiveWindowProvider=c;this.kernelProvider=d;this.dataScienceErrorHandler=p;this.ipynbProvider=f;this.fileConverter=m;this.statusProvider=new yM,qe.workspace.isTrusted||qe.workspace.onDidGrantWorkspaceTrust(this.registerCommandsIfTrusted,this,this.disposables)}activate(){this.registerCommandsIfTrusted(),this.registerCommand(Q.InsertCellBelowPosition,this.insertCellBelowPosition),this.registerCommand(Q.InsertCellBelow,this.insertCellBelow),this.registerCommand(Q.InsertCellAbove,this.insertCellAbove),this.registerCommand(Q.DeleteCells,this.deleteCells),this.registerCommand(Q.SelectCell,this.selectCell),this.registerCommand(Q.SelectCellContents,this.selectCellContents),this.registerCommand(Q.ExtendSelectionByCellAbove,this.extendSelectionByCellAbove),this.registerCommand(Q.ExtendSelectionByCellBelow,this.extendSelectionByCellBelow),this.registerCommand(Q.MoveCellsUp,this.moveCellsUp),this.registerCommand(Q.MoveCellsDown,this.moveCellsDown),this.registerCommand(Q.ChangeCellToMarkdown,this.changeCellToMarkdown),this.registerCommand(Q.ChangeCellToCode,this.changeCellToCode),this.registerCommand(Q.GotoNextCellInFile,this.gotoNextCellInFile),this.registerCommand(Q.GotoPrevCellInFile,this.gotoPrevCellInFile),this.registerCommand(Q.AddCellBelow,this.addCellBelow),this.registerCommand(Q.CreateNewNotebook,this.createNewNotebook),this.registerCommand(Q.LatestExtension,this.openPythonExtensionPage),this.registerCommand(Q.EnableLoadingWidgetsFrom3rdPartySource,this.enableLoadingWidgetScriptsFromThirdParty),this.registerCommand(Q.CreateNewInteractive,e=>this.createNewInteractiveWindow(e)),this.registerCommand(Q.ImportNotebook,(e,t="commandpalette")=>this.listenForErrors(()=>e?this.importNotebookOnFile(e):this.importNotebook())),this.registerCommand(Q.ImportNotebookFile,(e,t="commandpalette")=>this.listenForErrors(()=>e?this.importNotebookOnFile(e):this.importNotebook())),qe.commands.registerCommand(Q.ExportFileAsNotebook,(e,t="commandpalette")=>this.listenForErrors(()=>{if(e)return this.exportFile(e);{let n=qe.window.activeTextEditor;if(n&&n.document.languageId===Je)return this.exportFile(n.document.uri)}return Promise.resolve()})),this.registerCommand(Q.ExportFileAndOutputAsNotebook,(e,t="commandpalette")=>this.listenForErrors(()=>{if(e)return this.exportFileAndOutput(e);{let n=qe.window.activeTextEditor;if(n&&n.document.languageId===Je)return this.exportFileAndOutput(n.document.uri)}return Promise.resolve()})),this.registerCommand(Q.ExpandAllCells,async e=>{var t;return this.expandAllCells((t=e==null?void 0:e.notebookEditor)==null?void 0:t.notebookUri)}),this.registerCommand(Q.CollapseAllCells,async e=>{var t;return this.collapseAllCells((t=e==null?void 0:e.notebookEditor)==null?void 0:t.notebookUri)}),this.registerCommand(Q.ExportOutputAsNotebook,()=>this.exportCells()),this.registerCommand(Q.InteractiveExportAsNotebook,e=>{var t;return this.export((t=e==null?void 0:e.notebookEditor)==null?void 0:t.notebookUri)}),this.registerCommand(Q.InteractiveExportAs,e=>{var t;return this.exportAs((t=e==null?void 0:e.notebookEditor)==null?void 0:t.notebookUri)}),this.registerCommand(Q.ScrollToCell,(e,t)=>this.scrollToCell(e,t)),this.registerCommand(Q.InteractiveClearAll,this.clearAllCellsInInteractiveWindow),this.registerCommand(Q.InteractiveGoToCode,this.goToCodeInInteractiveWindow),qe.commands.registerCommand(Q.InteractiveCopyCell,this.copyCellInInteractiveWindow)}dispose(){this.disposables.forEach(e=>e.dispose())}registerCommandsIfTrusted(){qe.workspace.isTrusted&&(this.registerCommand(Q.RunAllCells,this.runAllCells),this.registerCommand(Q.RunCell,this.runCell),this.registerCommand(Q.RunCurrentCell,this.runCurrentCell),this.registerCommand(Q.RunCurrentCellAdvance,this.runCurrentCellAndAdvance),this.registerCommand(Q.ExecSelectionInInteractiveWindow,e=>{this.runSelectionOrLine(e).catch(y)}),this.registerCommand(Q.RunAllCellsAbove,this.runAllCellsAbove),this.registerCommand(Q.RunCellAndAllBelow,this.runCellAndAllBelow),this.registerCommand(Q.RunAllCellsAbovePalette,this.runAllCellsAboveFromCursor),this.registerCommand(Q.RunCellAndAllBelowPalette,this.runCellAndAllBelowFromCursor),this.registerCommand(Q.RunCurrentCellAndAddBelow,this.runCurrentCellAndAddBelow),this.registerCommand(Q.DebugCell,this.debugCell),this.registerCommand(Q.DebugStepOver,this.debugStepOver),this.registerCommand(Q.DebugContinue,this.debugContinue),this.registerCommand(Q.DebugStop,this.debugStop),this.registerCommand(Q.DebugCurrentCellPalette,this.debugCurrentCellFromCursor),this.registerCommand(Q.OpenVariableView,this.openVariableView),this.registerCommand(Q.OpenOutlineView,this.openOutlineView),this.registerCommand(Q.RunToLine,this.runToLine),this.registerCommand(Q.RunFromLine,this.runFromLine),this.registerCommand(Q.RunFileInInteractiveWindows,this.runFileInteractive),this.registerCommand(Q.DebugFileInInteractiveWindows,this.debugFileInteractive))}registerCommand(e,t){let n=qe.commands.registerCommand(e,t,this);this.disposables.push(n)}getCodeWatcher(e){if(e&&this.dataScienceCodeLensProvider){let t=qe.workspace.textDocuments.filter(n=>ea(n.uri,e));if(t&&t.length===1)return this.dataScienceCodeLensProvider.getCodeWatcher(t[0]);if(t&&t.length>1)throw new Error(C.documentMismatch(at(e)))}}async enableLoadingWidgetScriptsFromThirdParty(){this.configService.getSettings(void 0).widgetScriptSources.length>0||await this.configService.updateSetting("widgetScriptSources",["jsdelivr.com","unpkg.com"],void 0,qe.ConfigurationTarget.Global).catch(y)}async runAllCells(e){let t=this.getCodeWatcher(e);if(t||(t=this.getCurrentCodeWatcher()),t)return t.runAllCells()}async runFileInteractive(e){let t=this.getCodeWatcher(e);if(t||(t=this.getCurrentCodeWatcher()),t)return t.runFileInteractive()}async debugFileInteractive(e){let t=this.getCodeWatcher(e);if(t||(t=this.getCurrentCodeWatcher()),t)return t.debugFileInteractive()}async runCell(e,t,n,i,o){let s=this.getCodeWatcher(e);if(s)return s.runCell(new qe.Range(t,n,i,o))}async runAllCellsAbove(e,t,n){if(e){let i=this.getCodeWatcher(e);if(i)return i.runAllCellsAbove(t,n)}}async runCellAndAllBelow(e,t,n){if(e){let i=this.getCodeWatcher(e);if(i)return i.runCellAndAllBelow(t,n)}}async runToLine(){let e=this.getCurrentCodeWatcher(),t=qe.window.activeTextEditor;if(e&&t&&t.selection)return e.runToLine(t.selection.start.line)}async runFromLine(){let e=this.getCurrentCodeWatcher(),t=qe.window.activeTextEditor;if(e&&t&&t.selection)return e.runFromLine(t.selection.start.line)}async runCurrentCell(){let e=this.getCurrentCodeWatcher();if(e)return e.runCurrentCell()}async runCurrentCellAndAdvance(){let e=this.getCurrentCodeWatcher();if(e)return e.runCurrentCellAndAdvance()}async runSelectionOrLine(e){let t=this.getCurrentCodeWatcher();if(t)return t.runSelectionOrLine(qe.window.activeTextEditor,Dn(e)?void 0:e)}async debugCell(e,t,n,i,o){if(e){let s=this.getCodeWatcher(e);if(s)return s.debugCell(new qe.Range(t,n,i,o))}}async debugStepOver(){var e;(e=this.debugService)!=null&&e.activeDebugSession&&qe.commands.executeCommand("workbench.action.debug.stepOver").then(y,y)}async debugStop(e){var t;if((t=this.debugService)!=null&&t.activeDebugSession&&this.interactiveWindowProvider){let n=this.interactiveWindowProvider.get(e);if(n&&n.notebookDocument){let i=this.kernelProvider.get(n.notebookDocument);i&&(b.debug(`Interrupt kernel due to debug stop of IW ${e.toString()}`),await i.interrupt())}qe.commands.executeCommand("workbench.action.debug.stop").then(y,y)}}async debugContinue(){var e;(e=this.debugService)!=null&&e.activeDebugSession&&qe.commands.executeCommand("workbench.action.debug.continue").then(y,y)}async addCellBelow(){var e;await((e=this.getCurrentCodeWatcher())==null?void 0:e.addEmptyCellToBottom())}async runCurrentCellAndAddBelow(){var e;(e=this.getCurrentCodeWatcher())==null||e.runCurrentCellAndAddBelow()}async insertCellBelowPosition(){var e;(e=this.getCurrentCodeWatcher())==null||e.insertCellBelowPosition()}async insertCellBelow(){var e;(e=this.getCurrentCodeWatcher())==null||e.insertCellBelow()}async insertCellAbove(){var e;(e=this.getCurrentCodeWatcher())==null||e.insertCellAbove()}async deleteCells(){var e;(e=this.getCurrentCodeWatcher())==null||e.deleteCells()}async selectCell(){var e;(e=this.getCurrentCodeWatcher())==null||e.selectCell()}async selectCellContents(){var e;(e=this.getCurrentCodeWatcher())==null||e.selectCellContents()}async extendSelectionByCellAbove(){var e;(e=this.getCurrentCodeWatcher())==null||e.extendSelectionByCellAbove()}async extendSelectionByCellBelow(){var e;(e=this.getCurrentCodeWatcher())==null||e.extendSelectionByCellBelow()}async moveCellsUp(){var e;(e=this.getCurrentCodeWatcher())==null||e.moveCellsUp()}async moveCellsDown(){var e;(e=this.getCurrentCodeWatcher())==null||e.moveCellsDown()}async changeCellToMarkdown(){var e;(e=this.getCurrentCodeWatcher())==null||e.changeCellToMarkdown()}async changeCellToCode(){var e;(e=this.getCurrentCodeWatcher())==null||e.changeCellToCode()}async gotoNextCellInFile(){var e;(e=this.getCurrentCodeWatcher())==null||e.gotoNextCell()}async gotoPrevCellInFile(){var e;(e=this.getCurrentCodeWatcher())==null||e.gotoPreviousCell()}async runAllCellsAboveFromCursor(){let e=this.getCurrentCodeLens();if(e){let t=this.getCurrentCodeWatcher();if(t)return t.runAllCellsAbove(e.range.start.line,e.range.start.character)}else return}async runCellAndAllBelowFromCursor(){let e=this.getCurrentCodeLens();if(e){let t=this.getCurrentCodeWatcher();if(t)return t.runCellAndAllBelow(e.range.start.line,e.range.start.character)}else return}async debugCurrentCellFromCursor(){if(this.getCurrentCodeLens()){let t=this.getCurrentCodeWatcher();if(t)return t.debugCurrentCell()}else return}async createNewNotebook(){qe.window.showInformationMessage('This command has been deprecated and will eventually be removed, please use ["Create: New Jupyter Notebook"](command:workbench.action.openGlobalKeybindings?%5B%22@command:ipynb.newUntitledIpynb%22%5D) instead.').then(y,y),await qe.commands.executeCommand("ipynb.newUntitledIpynb")}getCurrentCodeLens(){let e=qe.window.activeTextEditor,t=this.getCurrentCodeWatcher();if(e&&t)return t.getCodeLenses().find(n=>n.range.end.line>=e.selection.anchor.line&&n.range.start.line<=e.selection.anchor.line)}getCurrentCodeWatcher(){let e=qe.window.activeTextEditor;if(!(!e||!e.document||!this.dataScienceCodeLensProvider))return this.dataScienceCodeLensProvider.getCodeWatcher(e.document)}openPythonExtensionPage(){qe.env.openExternal(qe.Uri.parse("https://marketplace.visualstudio.com/items?itemName=ms-toolsai.jupyter")).then(y,y)}async openVariableView(){return qe.commands.executeCommand("jupyterViewVariables.focus")}async openOutlineView(){return qe.commands.executeCommand("outline.focus")}async listenForErrors(e){let t;try{return t=await e(),t}catch(n){b.error("listenForErrors",n),this.dataScienceErrorHandler.handleError(n).then(y,y)}return t}async exportFile(e){let t=at(e);if(t&&t.length>0&&this.jupyterExporter){let n=qe.window.activeTextEditor;if(n&&this.fileSystem.arePathsSame(n.document.uri,e)){let i=Lj(n.document,this.configuration.getSettings(n.document.uri));if(i){let o=await new ep().showDialog("ipynb",e);if(await this.waitForStatus(async()=>{var s;if(o){let a=await((s=this.jupyterExporter)==null?void 0:s.serialize(i));await this.fileSystem.writeFile(o,a||"")}},C.exportingFormat,ve(e)),o&&t){let s=C.exportOpenQuestion1;await qe.window.showInformationMessage(C.exportDialogComplete(ve(e)),s)===s&&await gM(o)}}}}}async exportFileAndOutput(e){let t=at(e);if(t&&t.length>0&&this.jupyterExporter&&this.jupyterServerHelper&&await this.jupyterServerHelper.isJupyterServerSupported()){let n=qe.window.activeTextEditor;if(n&&n.document&&this.fileSystem.arePathsSame(n.document.uri,e)){let i=Lj(n.document,this.configuration.getSettings(n.document.uri));if(i){let o=await new ep().showDialog("ipynb",e);return o?(await this.waitForStatus(async()=>{var s;if(o){let a=await((s=this.jupyterExporter)==null?void 0:s.serialize(i));await this.fileSystem.writeFile(o,a||"")}},C.exportingFormat,ve(e)),await qe.workspace.openNotebookDocument(o).then(s=>qe.window.showNotebookDocument(s)),await qe.commands.executeCommand("notebook.execute"),o):void 0}}}else this.jupyterServerHelper&&await this.dataScienceErrorHandler.handleError(new tm(C.jupyterNotSupported(await this.jupyterServerHelper.getJupyterServerError())))}async expandAllCells(e){let t=this.interactiveWindowProvider.getInteractiveWindowWithNotebook(e);b.info(`Expanding all cells in interactive window with uri ${t==null?void 0:t.notebookUri}`),t&&await t.expandAllCells()}async collapseAllCells(e){let t=this.interactiveWindowProvider.getInteractiveWindowWithNotebook(e);b.info(`Collapsing all cells in interactive window with uri ${t==null?void 0:t.notebookUri}`),t&&await t.collapseAllCells()}exportCells(){var t;let e=(t=this.interactiveWindowProvider)==null?void 0:t.activeWindow;e&&e.export()}exportAs(e){let t=this.interactiveWindowProvider.getInteractiveWindowWithNotebook(e);t&&t.exportAs()}export(e){let t=this.interactiveWindowProvider.getInteractiveWindowWithNotebook(e);t&&t.export()}async createNewInteractiveWindow(e){var t;await((t=this.interactiveWindowProvider)==null?void 0:t.getOrCreate(void 0,e))}waitForStatus(e,t,n,i){let o=t(n||"");return this.statusProvider.waitWithStatus(e,o,void 0,i)}async importNotebook(){let e=C.importDialogFilter,t={};t[e]=["ipynb"];let n=await qe.window.showOpenDialog({openLabel:C.importDialogTitle,filters:t});n&&n.length>0&&await this.waitForStatus(async()=>{await this.fileConverter.importIpynb(n[0])},C.importingFormat,ve(n[0]))}async importNotebookOnFile(e){let t=at(e);t&&t.length>0&&await this.waitForStatus(async()=>{await this.fileConverter.importIpynb(e)},C.importingFormat,ve(e))}async scrollToCell(e,t){if(t&&e){let n=this.interactiveWindowProvider.getInteractiveWindowsWithSubmitter(e);for(let i=0;i<n.length;i+=1)if(await n[i].hasCell(t)){n[i].scrollToCell(t);break}}}async clearAllCellsInInteractiveWindow(e){var s,a;let t=(a=this.interactiveWindowProvider.getInteractiveWindowWithNotebook((s=e==null?void 0:e.notebookEditor)==null?void 0:s.notebookUri))==null?void 0:a.notebookUri;if(!t)return;let n=qe.workspace.notebookDocuments.find(l=>l.uri.toString()===t.toString());if(!n)return;let i=new qe.WorkspaceEdit,o=qe.NotebookEdit.deleteCells(new qe.NotebookRange(0,n.cellCount));i.set(n.uri,[o]),await qe.workspace.applyEdit(i)}async goToCodeInInteractiveWindow(e){var t;if(e&&((t=e.metadata)!=null&&t.interactive)){let n=qe.Uri.parse(e.metadata.interactive.uristring),i=e.metadata.interactive.lineIndex,o=await qe.window.showTextDocument(n,{viewColumn:qe.ViewColumn.One});o&&(o.revealRange(new qe.Range(i,0,i,0)),o.selection=new qe.Selection(new qe.Position(i,0),new qe.Position(i,0)))}}async copyCellInInteractiveWindow(e){var t;if(e){let n=this.configuration.getSettings(e.notebook.uri),i=[(t=e.metadata.interactiveWindowCellMarker)!=null?t:n.defaultCellMarker,e.document.getText()].join(`
`);await qe.env.clipboard.writeText(i)}}};E([Mn("DATASCIENCE.DEBUG_STEP_OVER")],hs.prototype,"debugStepOver",1),E([Mn("DATASCIENCE.DEBUG_STOP")],hs.prototype,"debugStop",1),E([Mn("DATASCIENCE.DEBUG_CONTINUE")],hs.prototype,"debugContinue",1),E([Nr("DATASCIENCE.ADD_CELL_BELOW")],hs.prototype,"addCellBelow",1),E([Mn("DATASCIENCE.EXPORT_PYTHON_FILE")],hs.prototype,"exportFile",1),E([Mn("DATASCIENCE.EXPORT_PYTHON_FILE_AND_OUTPUT")],hs.prototype,"exportFileAndOutput",1),E([Mn("DATASCIENCE.IMPORT_NOTEBOOK",{scope:"command"})],hs.prototype,"importNotebook",1),E([Mn("DATASCIENCE.IMPORT_NOTEBOOK",{scope:"file"})],hs.prototype,"importNotebookOnFile",1),hs=E([(0,Ln.injectable)(),I(0,(0,Ln.inject)(ie)),I(1,(0,Ln.inject)(CI)),I(1,(0,Ln.optional)()),I(2,(0,Ln.inject)(qR)),I(2,(0,Ln.optional)()),I(3,(0,Ln.inject)(wt)),I(4,(0,Ln.inject)(Ae)),I(5,(0,Ln.inject)(Im)),I(5,(0,Ln.optional)()),I(6,(0,Ln.inject)(uo)),I(6,(0,Ln.optional)()),I(7,(0,Ln.inject)(Ae)),I(8,(0,Ln.inject)(gs)),I(9,(0,Ln.inject)(He)),I(10,(0,Ln.inject)(Cn)),I(11,(0,Ln.inject)(Ko)),I(12,(0,Ln.inject)(a_))],hs);u();var bv=$(te()),Sm=require("vscode");u();function Gl(r){if(r.metadata.interactive!==void 0)return r.metadata}function gZ(r,e,t){let n=st(r,{trim:!1,removeEmptyEntries:!1}),i=t.stripFirstMarkerNoConcat(n),o=hG(i),s=iI(o,`
`,e.magicCommandsAsComments?vM:void 0);return Bv(s.join(""))}function xD(r){let e=r;return e&&e.input&&Dn(e.input.uri)&&Dn(e.input.inputBoxUri)}var VIe=C.runCurrentCellAndAddBelow,jIe=C.addCellBelowCommandTitle,BIe=C.debugCellCommandTitle,HIe=C.debugCellCommandTitle,JIe=C.debugStepOverCommandTitle,qIe=C.debugContinueCommandTitle,GIe=C.debugStopCommandTitle,YIe=C.runCellLensCommandTitle,$Ie=C.runAllCellsLensCommandTitle,zIe=C.runAllCellsAboveLensCommandTitle,hZ=C.runCellAndAllBelowLensCommandTitle,QIe=C.scrollToCellTitleFormatMessage,I_=class{constructor(e,t,n,i){this.configService=e;this.generatedCodeStorageFactory=n;this.updateEvent=new Sm.EventEmitter;this.notebookData=new Map;this.codeLensCache=new Map;this.totalCodeLensUpdateTimeInMs=0;this.codeLensUpdateCount=0;this.maxCellCount=0;Sm.workspace.onDidCloseTextDocument(this.onClosedDocument,this,t),Sm.workspace.onDidGrantWorkspaceTrust(()=>this.codeLensCache.clear(),this,t),this.configService.getSettings(void 0).onDidChange(this.onChangedSettings,this,t),Mr.onDidChangeNotebookCellExecutionState(this.onDidChangeNotebookCellExecutionState,this,t),i.onDidDisposeKernel(o=>{this.notebookData.delete(o.notebook.uri.toString())},this,t)}getPerfMeasures(){return{totalCodeLensUpdateTimeInMs:this.totalCodeLensUpdateTimeInMs,codeLensUpdateCount:this.codeLensUpdateCount,maxCellCount:this.maxCellCount}}get updateRequired(){return this.updateEvent.event}createCodeLenses(e){let t=this.getCodeLensCacheData(e);return[...t.documentLenses,...t.gotoCellLens]}getCellRanges(e){return this.getCodeLensCacheData(e).cellRanges}getCodeLensCacheData(e){var l;let t=new It,n=!1,i=e.uri.toString(),o=this.codeLensCache.get(i),s=!1;o||(o={cachedDocumentVersion:void 0,cachedExecutionCounts:new Set,documentLenses:[],cellRanges:[],gotoCellLens:[]},s=!0,this.codeLensCache.set(i,o)),o.cachedDocumentVersion!==e.version&&(o.cellRanges=CD(e,this.configService.getSettings(e.uri)),o.documentLenses=[],o.gotoCellLens=[],o.cachedDocumentVersion=e.version,s=!0);let a=this.getDocumentExecutionCounts(i);if((a.length!==o.cachedExecutionCounts.size||a.find(c=>!(o!=null&&o.cachedExecutionCounts.has(c))))&&(o.gotoCellLens=[],o.cachedExecutionCounts=new Set(a),s=!0),o.documentLenses.length===0&&s&&o.cellRanges.length){n=!0;let c=this.enumerateCommands(e.uri);b.debug(`CodeLensFactory: Generating new code lenses for version ${e.version} of document ${e.uri} for commands ${c.join(", ")}`);let d=!0;o.cellRanges.forEach(p=>{c.forEach(f=>{let m=this.createCodeLens(e,p,f,d);m&&o.documentLenses.push(m)}),d=!1})}else b.ci(`NOT Generating new code lenses for version ${e.version} of document ${e.uri} - needUpdate: ${s}, cellRanges.length: ${o.cellRanges.length}`);if(s&&o.gotoCellLens.length===0&&o.cellRanges.length&&this.configService.getSettings(e.uri).addGotoCodeLenses){let c=this.generatedCodeStorageFactory.get({fileUri:e.uri}),d=c?(l=c.all.find(p=>p.uri.toString()===e.uri.toString()))==null?void 0:l.generatedCodes:void 0;d&&d.length&&o.cellRanges.forEach(p=>{let f=this.createExecutionLens(e,p.range,d);f&&(o==null||o.gotoCellLens.push(f))})}return n&&(this.totalCodeLensUpdateTimeInMs+=t.elapsedTime,this.codeLensUpdateCount+=1,this.maxCellCount=Math.max(this.maxCellCount,o.cellRanges.length)),o}getDocumentExecutionCounts(e){return[...this.notebookData.values()].map(t=>t.documentExecutionCounts.get(e)).filter(t=>t!==void 0)}onDidChangeNotebookCellExecutionState(e){var i;if(e.cell.notebook.notebookType!==ht||e.state!==1||!((i=e.cell.executionSummary)!=null&&i.executionOrder))return;let t=Gl(e.cell),n=this.notebookData.get(e.cell.notebook.uri.toString());n||(n={cellExecutionCounts:new Map,documentExecutionCounts:new Map},this.notebookData.set(e.cell.notebook.uri.toString(),n)),n!==void 0&&t!==void 0&&(n.cellExecutionCounts.set(t.id,e.cell.executionSummary.executionOrder),n.documentExecutionCounts.set(t.interactive.uristring,e.cell.executionSummary.executionOrder),this.updateEvent.fire())}onClosedDocument(e){this.codeLensCache.delete(e.uri.toString())}onChangedSettings(){this.codeLensCache.clear(),this.updateEvent.fire()}enumerateCommands(e){let t,n=this.configService.getSettings(e).codeLenses;n?t=n.split(",").map(s=>s.trim()):t=Nu.DefaultDesignLenses;let i=this.configService.getSettings(e).debugCodeLenses;i?t=t.concat(i.split(",").map(s=>s.trim())):t=t.concat(Nu.DefaultDebuggingLenses);let o=[];return Sm.workspace.isTrusted||(o=[...Nu.DebuggerCommands,...Nu.DebuggerCommands,Q.RunAllCells,Q.RunAllCellsAbove,Q.RunAllCellsAbovePalette,Q.RunCellAndAllBelowPalette,Q.RunCurrentCell,Q.RunCurrentCellAdvance,Q.RunCurrentCellAndAddBelow,Q.RunFileInInteractiveWindows,Q.InterruptKernel,Q.RunToLine,Q.RunCell,Q.DebugCell,Q.DebugContinue,Q.DebugStepOver,Q.DebugStop,Q.RunCellAndAllBelowPalette]),o&&(t=t.filter(s=>!o.includes(s))),t}createCodeLens(e,t,n,i){let{range:o,cell_type:s}=t;switch(n){case Q.RunCurrentCellAndAddBelow:return this.generateCodeLens(o,Q.RunCurrentCellAndAddBelow,VIe);case Q.AddCellBelow:return this.generateCodeLens(o,Q.AddCellBelow,jIe,[e.uri,o.start.line]);case Q.DebugCurrentCellPalette:return this.generateCodeLens(o,Q.DebugCurrentCellPalette,BIe);case Q.DebugCell:if(s!=="code")break;return this.generateCodeLens(o,Q.DebugCell,HIe,[e.uri,o.start.line,o.start.character,o.end.line,o.end.character]);case Q.DebugStepOver:if(s!=="code")break;return this.generateCodeLens(o,Q.DebugStepOver,JIe,[e.uri]);case Q.DebugContinue:if(s!=="code")break;return this.generateCodeLens(o,Q.DebugContinue,qIe,[e.uri]);case Q.DebugStop:if(s!=="code")break;return this.generateCodeLens(o,Q.DebugStop,GIe,[e.uri]);case Q.RunCurrentCell:case Q.RunCell:return this.generateCodeLens(o,Q.RunCell,YIe,[e.uri,o.start.line,o.start.character,o.end.line,o.end.character]);case Q.RunAllCells:return this.generateCodeLens(o,Q.RunAllCells,$Ie,[e.uri,o.start.line,o.start.character]);case Q.RunAllCellsAbovePalette:case Q.RunAllCellsAbove:return i?this.generateCodeLens(o,Q.RunCellAndAllBelow,hZ,[e.uri,o.start.line,o.start.character]):this.generateCodeLens(o,Q.RunAllCellsAbove,zIe,[e.uri,o.start.line,o.start.character]);case Q.RunCellAndAllBelowPalette:case Q.RunCellAndAllBelow:return this.generateCodeLens(o,Q.RunCellAndAllBelow,hZ,[e.uri,o.start.line,o.start.character]);default:b.warn(`Invalid command for code lens ${n}`);break}}findMatchingCellExecutionCount(e){let t=[...this.notebookData.values()].find(n=>n.cellExecutionCounts.get(e));return t==null?void 0:t.cellExecutionCounts.get(e)}createExecutionLens(e,t,n){if(n){let i=n.filter(o=>o.line-2===t.start.line).sort((o,s)=>o.timestamp-s.timestamp);if(i&&i.length){let o=i[i.length-1],s=this.findMatchingCellExecutionCount(o.id);if(s!==void 0)return this.generateCodeLens(t,Q.ScrollToCell,QIe(s),[e.uri,o.id])}}}generateCodeLens(e,t,n,i){return new Sm.CodeLens(e,XIe(t,n,i))}};I_=E([(0,bv.injectable)(),I(0,(0,bv.inject)(Ae)),I(1,(0,bv.inject)(ie)),I(2,(0,bv.inject)(Ra)),I(3,(0,bv.inject)(He))],I_);function XIe(r,e,t){return{arguments:t,title:e,command:r}}u();var bu=$(te()),Yl=$(require("vscode"));var S_=class{constructor(e,t,n,i,o){this.serviceContainer=e;this.debugLocationTracker=t;this.configuration=n;this.debugService=o;this.totalExecutionTimeInMs=0;this.totalGetCodeLensCalls=0;this.activeCodeWatchers=[];this.didChangeCodeLenses=new Yl.EventEmitter;i.push(this),i.push(Yl.workspace.onDidGrantWorkspaceTrust(()=>{this.activeCodeWatchers=fe(this.activeCodeWatchers),this.didChangeCodeLenses.fire()})),i.push(this.debugService.onDidChangeActiveDebugSession(this.onChangeDebugSession.bind(this))),i.push(Yl.workspace.onDidCloseTextDocument(this.onDidCloseTextDocument.bind(this))),this.debugLocationTracker&&i.push(this.debugLocationTracker.updated(this.onDebugLocationUpdated.bind(this)))}dispose(){this.totalGetCodeLensCalls>0&&J("DS_INTERNAL.CODE_LENS_ACQ_TIME",{duration:this.totalExecutionTimeInMs/this.totalGetCodeLensCalls}),fe(this.activeCodeWatchers)}get onDidChangeCodeLenses(){return this.didChangeCodeLenses.event}provideCodeLenses(e,t){return[up,zD].includes(e.uri.scheme)?[]:this.getCodeLensTimed(e)}getCodeWatcher(e){return this.matchWatcher(e.uri)}onDebugLocationUpdated(){this.didChangeCodeLenses.fire()}onChangeDebugSession(e){this.didChangeCodeLenses.fire()}onDidCloseTextDocument(e){let t=this.activeCodeWatchers.findIndex(n=>n.uri&&n.uri.toString()===e.uri.toString());t>=0&&this.activeCodeWatchers.splice(t,1)[0].dispose()}getCodeLensTimed(e){let t=new It,n=this.getCodeLens(e);return this.totalExecutionTimeInMs+=t.elapsedTime,this.totalGetCodeLensCalls+=1,new mr(br.HasCodeCells).set(n&&n.length>0).catch(y),this.configuration.getSettings(e.uri).enableCellCodeLens?this.adjustDebuggingLenses(e,n):[]}adjustDebuggingLenses(e,t){let n=Nu.DebuggerCommands;if(this.debugLocationTracker&&this.debugService.activeDebugSession){let i=this.debugLocationTracker.getLocation(this.debugService.activeDebugSession),o;try{o=i?Yl.Uri.parse(i.fileName):void 0}catch(s){}if(i&&(ea(Yl.Uri.file(i.fileName),e.uri,!0)||o&&ea(o,e.uri,!0)))return t.filter(a=>{let l=new Yl.Position(i.lineNumber-1,i.column-1);return a.range.contains(l)}).filter(a=>a.command?n.includes(a.command.command):!1);b.ci(`Detected debugging context because activeDebugSession is name:"${this.debugService.activeDebugSession.name}", type: "${this.debugService.activeDebugSession.type}", but fell through with debugLocation: ${JSON.stringify(i)}, and document.uri: ${e.uri.toString()}`)}else return t.filter(i=>i.command?!n.includes(i.command.command):!1);return[]}getCodeLens(e){let t=this.matchWatcher(e.uri);return t?t.getCodeLenses():(b.debug(`Creating a new watcher for document ${e.uri}`),this.createNewCodeWatcher(e).getCodeLenses())}matchWatcher(e){let t=this.activeCodeWatchers.findIndex(i=>i.uri&&i.uri.toString()==e.toString());if(t>=0)return this.activeCodeWatchers[t];let n=Yl.workspace.textDocuments.filter(i=>i.uri.toString()===e.toString());if(n&&n.length>0)return b.debug(`creating new code watcher with matching document ${e}`),this.createNewCodeWatcher(n[0])}createNewCodeWatcher(e){let t=this.serviceContainer.get(uM);return t.setDocument(e),t.codeLensUpdated(this.onWatcherUpdated.bind(this)),this.activeCodeWatchers.push(t),t}onWatcherUpdated(){this.didChangeCodeLenses.fire()}};S_=E([(0,bu.injectable)(),I(0,(0,bu.inject)(Kr)),I(1,(0,bu.inject)(HA)),I(1,(0,bu.optional)()),I(2,(0,bu.inject)(Ae)),I(3,(0,bu.inject)(ie)),I(4,(0,bu.inject)(uo))],S_);u();var _m=$(te()),_e=require("vscode");u();var bM=Symbol("ICodeExecutionHelper");u();var Iv=class extends Error{constructor(t){super("Cell failed to execute");this.cell=t}};function ZIe(r,e){if(e<=0)throw new RangeError(`Length must be > 0 not ${e}`);return r<0&&(r+=e),r<0?0:r>=e?e-1:r}var nr=class{constructor(e,t,n,i,o){this.interactiveWindowProvider=e;this.configService=t;this.executionHelper=n;this.dataScienceErrorHandler=i;this.codeLensFactory=o;this.version=-1;this.codeLenses=[];this.cells=[];this.codeLensUpdatedEvent=new _e.EventEmitter;this.disposables=[this.codeLensUpdatedEvent]}setDocument(e){this.document=e,this.version=e.version,this.codeLenses=this.codeLensFactory.createCodeLenses(e),this.cells=this.codeLensFactory.getCellRanges(e),this.disposables.push(this.codeLensFactory.updateRequired(this.onCodeLensFactoryUpdated.bind(this))),this.disposables.push(_e.workspace.onDidCloseTextDocument(this.onDocumentClosed.bind(this))),this.disposables.push(_e.workspace.onDidCloseNotebookDocument(this.ondidCloseNotebook.bind(this)))}get codeLensUpdated(){return this.codeLensUpdatedEvent.event}get uri(){var e;return(e=this.document)==null?void 0:e.uri}getVersion(){return this.version}getCodeLenses(){let e=this.document;return e&&e.version!=this.version&&(this.codeLenses=this.codeLensFactory.createCodeLenses(e),this.cells=this.codeLensFactory.getCellRanges(e),this.version=e.version),this.codeLenses}async debugCurrentCell(){if(!(!_e.window.activeTextEditor||!_e.window.activeTextEditor.document))return this.runMatchingCell(_e.window.activeTextEditor.selection,!1,!0)}dispose(){let e=this.codeLensFactory.getPerfMeasures();e&&e.codeLensUpdateCount>0&&J("DS_INTERNAL.DOCUMENT_WITH_CODE_CELLS",{codeLensUpdateTime:e.totalCodeLensUpdateTimeInMs/e.codeLensUpdateCount,maxCellCount:e.maxCellCount}),fe(this.disposables)}async runAllCells(e){let t=await this.getActiveInteractiveWindow(),n=this.codeLenses.filter(s=>s.command&&s.command.command===Q.RunCell&&s.command.arguments&&s.command.arguments.length>=5),i=n.length,o=Promise.resolve(!0);for(let s of n){let a=new _e.Range(s.command.arguments[1],s.command.arguments[2],s.command.arguments[3],s.command.arguments[4]);if(this.document){i===n.length&&(a=new _e.Range(new _e.Position(0,0),a.end));let l=this.document.getText(a);i-=1,o=this.addCode(t,l,this.document.uri,a.start.line,e)}}if(await o,n.length===0)return this.runFileAsOneCell(e!=null?e:!1)}async runFileInteractive(){var e;if(this.document&&this.configService.getSettings((e=this.document)==null?void 0:e.uri).splitRunFileIntoCells)return this.runAllCells();if(this.document)return this.runFileAsOneCell(!1)}async debugFileInteractive(){var e;if(this.document&&this.configService.getSettings((e=this.document)==null?void 0:e.uri).splitRunFileIntoCells)return this.runAllCells(!0);if(this.document)return this.runFileAsOneCell(!0)}async runAllCellsAbove(e,t){let n=await this.getActiveInteractiveWindow(),i=this.codeLenses.filter(l=>l.command&&l.command.command===Q.RunCell),o=i.findIndex(l=>l.range.start.line>=e&&l.range.start.character>=t);o<0&&(o=i.length);let s=o,a=Promise.resolve(!0);for(let l of i)if(o>0&&this.document){let c=new _e.Range(l.range.start,l.range.end);o===s&&(c=new _e.Range(new _e.Position(0,0),c.end)),o-=1;let d=this.document.getText(c);a=this.addCode(n,d,this.document.uri,l.range.start.line)}else break;await a}async runCellAndAllBelow(e,t){let n=await this.getActiveInteractiveWindow(),i=this.codeLenses.filter(l=>l.command&&l.command.command===Q.RunCell),o=i.findIndex(l=>l.range.start.line>=e&&l.range.start.character>=t),s=o>0?i.length-o:i.length,a=Promise.resolve(!0);for(let l=o;l>=0&&l<i.length;l+=1)if(s>0&&this.document){let c=i[l];s-=1;let d=this.document.getText(c.range);a=this.addCode(n,d,this.document.uri,c.range.start.line)}await a}async runSelectionOrLine(e,t){var n;if(this.document&&e&&ea(e.document.uri,this.document.uri)){let i=await this.getActiveInteractiveWindow(),o;if(t===void 0||Dn(t)?o=this.executionHelper.getSelectedTextToExecute(e):o=t,!o)return;let a=((n=this.configService.getSettings(e.document.uri).normalizeSelectionForInteractiveWindow)!=null?n:!0)?await this.executionHelper.normalizeLines(o):o;if(!a||a.trim().length===0)return;await this.addCode(i,a,this.document.uri,e.selection.start.line)}}async runToLine(e){if(this.document&&e>0){let t=await this.getActiveInteractiveWindow(),n=this.document.lineAt(e-1),i=this.document.getText(new _e.Range(0,0,n.range.end.line,n.range.end.character));i&&i.trim().length&&await this.addCode(t,i,this.document.uri,0)}}async runFromLine(e){if(this.document&&e<this.document.lineCount){let t=await this.getActiveInteractiveWindow(),n=this.document.lineAt(this.document.lineCount-1),i=this.document.getText(new _e.Range(e,0,n.range.end.line,n.range.end.character));i&&i.trim().length&&await this.addCode(t,i,this.document.uri,e)}}async runCell(e){if(!_e.window.activeTextEditor||!_e.window.activeTextEditor.document)return;let t=e.contains(_e.window.activeTextEditor.selection.start)&&this.configService.getSettings(_e.window.activeTextEditor.document.uri).enableAutoMoveToNextCell;return this.runMatchingCell(e,t)}async debugCell(e){if(!(!_e.window.activeTextEditor||!_e.window.activeTextEditor.document))return this.runMatchingCell(e,!1,!0)}async runCurrentCell(){if(!(!_e.window.activeTextEditor||!_e.window.activeTextEditor.document))return this.runMatchingCell(_e.window.activeTextEditor.selection,!1)}async runCurrentCellAndAdvance(){if(!(!_e.window.activeTextEditor||!_e.window.activeTextEditor.document))return this.runMatchingCell(_e.window.activeTextEditor.selection,!0)}async addEmptyCellToBottom(){let e=_e.window.activeTextEditor;e&&this.insertCell(e,e.document.lineCount+1)}async runCurrentCellAndAddBelow(){if(!_e.window.activeTextEditor||!_e.window.activeTextEditor.document)return;let e=_e.window.activeTextEditor,t=new Fo(this.configService.getSettings(e.document.uri)),n=0,i=this.getDefaultCellMarker(e.document.uri);e&&e.edit(s=>{let a=!0;for(let l=e.selection.end.line+1;l<e.document.lineCount;l+=1)if(t.isCell(e.document.lineAt(l).text)){a=!1,n=l,s.insert(new _e.Position(l,0),`${i}

`);break}a&&(n=e.document.lineCount,s.insert(new _e.Position(e.document.lineCount,0),`
${i}
`))}).then(y,y);let o=new _e.Position(n+1,0);return this.runMatchingCell(e.selection,!1).then(()=>this.advanceToRange(new _e.Range(o,o)))}insertCellBelowPosition(){let e=_e.window.activeTextEditor;e&&e.selection&&this.insertCell(e,e.selection.end.line+1)}insertCellBelow(){let e=_e.window.activeTextEditor;if(e&&e.selection){let t=this.getCellFromPosition(e.selection.end);t?this.insertCell(e,t.range.end.line+1):this.insertCell(e,e.selection.end.line+1)}}insertCellAbove(){let e=_e.window.activeTextEditor;if(e&&e.selection){let t=this.getCellFromPosition(e.selection.start);t?this.insertCell(e,t.range.start.line):this.insertCell(e,e.selection.start.line)}}deleteCells(){let e=_e.window.activeTextEditor;if(!e||!e.selection)return;let t=this.getStartEndCells(e.selection);if(!t)return;let n=t[0],i=t[1],o=0,s=0,a=i.range.end.line+1,l=0;n.range.start.line>0&&(o=n.range.start.line-1,s=e.document.lineAt(o).range.end.character,a=i.range.end.line,l=i.range.end.character);let c=new _e.Range(new _e.Position(o,s),new _e.Position(a,l));e.edit(d=>{d.replace(c,""),this.codeLensUpdatedEvent.fire()}).then(y,y)}selectCell(){let e=_e.window.activeTextEditor;if(e&&e.selection){let t=this.getStartEndCells(e.selection);if(t){let n=t[0],i=t[1];e.selection.anchor.isBeforeOrEqual(e.selection.active)?e.selection=new _e.Selection(n.range.start,i.range.end):e.selection=new _e.Selection(i.range.end,n.range.start)}}}selectCellContents(){let e=_e.window.activeTextEditor;if(!e||!e.selection)return;let t=this.getStartEndCellIndex(e.selection);if(!t)return;let n=t[0],i=t[1],o=e.selection.anchor.isBeforeOrEqual(e.selection.active),s=this.cells,a=[];for(let l=n;l<=i;l+=1){let c=s[l],d=c.range.start.line+1,p=0,f=c.range.end.line,m=c.range.end.character;c.range.start.line===c.range.end.line&&(d=c.range.start.line,p=e.document.lineAt(d).range.end.character,f=d,m=p),o?a.push(new _e.Selection(d,p,f,m)):a.push(new _e.Selection(f,m,d,p))}e.selections=a}extendSelectionByCellAbove(){let e=_e.window.activeTextEditor;if(!e||!e.selection)return;let t=e.selection,n=this.getStartEndCellIndex(e.selection);if(!n)return;let i=e.selection.anchor.isBefore(e.selection.active),o=this.cells,s=n[0],a=n[1],l=o[s],c=o[a];if(!l.range.start.isEqual(t.start)||!c.range.end.isEqual(t.end)){let d;i?s<a?d=new _e.Selection(l.range.start,o[a-1].range.end):d=new _e.Selection(l.range.end,l.range.start):d=new _e.Selection(c.range.end,l.range.start),e.selection=d}else{let d;i&&s<a?(d=o[a-1],e.selection=new _e.Selection(l.range.start,d.range.end)):s>0&&(d=o[s-1],e.selection=new _e.Selection(c.range.end,d.range.start)),d&&e.revealRange(d.range,_e.TextEditorRevealType.Default)}}extendSelectionByCellBelow(){let e=_e.window.activeTextEditor;if(!e||!e.selection)return;let t=e.selection,n=this.getStartEndCellIndex(e.selection);if(!n)return;let i=e.selection.anchor.isBeforeOrEqual(e.selection.active),o=this.cells,s=n[0],a=n[1],l=o[s],c=o[a];if(!l.range.start.isEqual(t.start)||!c.range.end.isEqual(t.end)){let d;i?d=new _e.Selection(l.range.start,c.range.end):s<a?d=new _e.Selection(o[s+1].range.start,c.range.end):d=new _e.Selection(c.range.start,c.range.end),e.selection=d}else{let d;i||s===a?a<o.length-1&&(d=o[a+1],e.selection=new _e.Selection(l.range.start,d.range.end)):s<a&&(d=o[s+1],e.selection=new _e.Selection(c.range.end,d.range.start)),d&&e.revealRange(d.range,_e.TextEditorRevealType.Default)}}async moveCellsUp(){await this.moveCellsDirection(!0)}async moveCellsDown(){await this.moveCellsDirection(!1)}changeCellToMarkdown(){this.applyToCells((e,t,n)=>this.changeCellTo(e,t,"markdown"))}changeCellToCode(){this.applyToCells((e,t,n)=>this.changeCellTo(e,t,"code"))}gotoNextCell(){let e=_e.window.activeTextEditor;if(!e||!e.selection)return;let t=e.selection,n=this.getCurrentCellLens(t.start),i=this.getNextCellLens(t.start);n&&i&&this.advanceToRange(i.range)}gotoPreviousCell(){let e=_e.window.activeTextEditor;if(!e||!e.selection)return;let t=e.selection,n=this.getCurrentCellLens(t.start),i=this.getPreviousCellLens(t.start);n&&i&&this.advanceToRange(i.range)}applyToCells(e){let t=_e.window.activeTextEditor,n=this.getStartEndCellIndex(t==null?void 0:t.selection);if(!t||!n)return;let i=this.cells,o=n[0],s=n[1];for(let a=o;a<=s;a+=1)e(t,i[a],a)}changeCellTo(e,t,n){if(n==="raw")throw Error("Cell Type raw not implemented");if(t.cell_type===n)return;let i=new Fo(this.configService.getSettings(e.document.uri)),o=e.document.lineAt(t.range.start.line),s=e.document.getText(o.range),a=this.getDefaultCellMarker(e.document.uri),l=n==="markdown"?i.codeExecRegEx.exec(s):i.markdownExecRegEx.exec(s);if(!l)return;let c=l[l.length-1],d=n==="markdown"?`${a} [markdown]${c}`:`${a}${c}`;e.edit(async p=>{p.replace(o.range,d),t.cell_type=n,t.range.start.line<t.range.end.line&&(e.selection=new _e.Selection(t.range.start.line+1,0,t.range.end.line,t.range.end.character),_e.commands.executeCommand("editor.action.removeCommentLine").then(y,y),n==="markdown"&&_e.commands.executeCommand("editor.action.addCommentLine").then(y,y))}).then(y,y)}async moveCellsDirection(e){let t=_e.window.activeTextEditor;if(!t||!t.selection)return!1;let n=this.getStartEndCellIndex(t.selection);if(!n)return!1;let i=n[0],o=n[1],s=this.cells,a=s[i],l=s[o];if(!a||!l)return!1;let c=new _e.Range(a.range.start,l.range.end),d=new _e.Range(t.selection.start.line-c.start.line,t.selection.start.character,t.selection.end.line-c.start.line,t.selection.end.character),p=t.selection.active.isBefore(t.selection.anchor),f;if(e){if(i===0)return!1;{let m=s[i-1];f=this.exchangeTextLines(t,m.range,c).then(h=>(h&&(t.selection=new _e.Selection(m.range.start.line+d.start.line,d.start.character,m.range.start.line+d.end.line,d.end.character)),h))}}else{if(o===s.length-1)return!1;{let m=s[o+1],g=this.exchangeTextLines(t,c,m.range),h=m.range.end.line-m.range.start.line,v=c.end.line-c.start.line,S=h-v;f=g.then(_=>(_&&(t.selection=new _e.Selection(m.range.start.line+S+d.start.line,d.start.character,m.range.start.line+S+d.end.line,d.end.character)),_))}}return f.then(m=>(m&&p&&(t.selection=new _e.Selection(t.selection.active,t.selection.anchor)),!0))}exchangeTextLines(e,t,n){let i=t.start.line,o=t.end.line,s=n.start.line,a=n.end.line;if(o>=s)throw RangeError(`Above lines must be fully above not ${o} <= ${s}`);let l=new _e.Range(i,0,o,e.document.lineAt(o).range.end.character),c=e.document.getText(l),d=new _e.Range(s,0,a,e.document.lineAt(a).range.end.character),p=e.document.getText(d),f="";if(o+1<s){let h=o+1,v=s-1,S=new _e.Range(h,0,v,e.document.lineAt(v).range.end.character);f=`${e.document.getText(S)}
`}let m=`${p}
${f}${c}`,g=new _e.Range(l.start,d.end);return e.edit(h=>{h.replace(g,m),this.codeLensUpdatedEvent.fire()})}getStartEndCells(e){let t=this.getStartEndCellIndex(e);if(t){let n=this.getCellFromIndex(t[0]),i=this.getCellFromIndex(t[1]);return[n,i]}}getStartEndCellIndex(e){if(!e)return;let t=this.getCellIndex(e.start),n=t;if(e.start.line!==e.end.line&&(n=this.getCellIndex(e.end)),t===-1){if(n===-1)return;{t=0;let i=this.getCellFromIndex(0);if(e.start.line>i.range.start.line)throw RangeError(`Should not be able to pick a range with an end in a cell and start after a cell. ${e.start.line} > ${i.range.end.line}`)}}if(t>=0&&n>=0)return[t,n]}insertCell(e,t){let n=this.getDefaultCellMarker(e.document.uri),i=t>=e.document.lineCount?`
${n}
`:`${n}

`,o=new _e.Position(t,0),s=new _e.Position(t+1,0);e.edit(a=>{a.insert(o,i),this.codeLensUpdatedEvent.fire()}).then(y,y),e.selection=new _e.Selection(s,s)}getDefaultCellMarker(e){return this.configService.getSettings(e).defaultCellMarker||tt.DefaultCodeCellMarker}onCodeLensFactoryUpdated(){this.document&&(this.codeLenses=this.codeLensFactory.createCodeLenses(this.document),this.cells=this.codeLensFactory.getCellRanges(this.document)),this.codeLensUpdatedEvent.fire()}onDocumentClosed(e){this.document&&ea(e.uri,this.document.uri)&&fe(this.disposables)}ondidCloseNotebook(e){var t;e.notebookType===ht&&this.configService.getSettings((t=this.document)==null?void 0:t.uri).addGotoCodeLenses&&this.onCodeLensFactoryUpdated()}getActiveInteractiveWindow(){var e;return this.interactiveWindowProvider.getOrCreate((e=this.document)==null?void 0:e.uri)}async addCode(e,t,n,i,o){let s=!1;try{o?s=await e.debugCode(t,n,i):s=await e.addCode(t,n,i)}catch(a){a instanceof Iv||await this.dataScienceErrorHandler.handleError(a)}return s}async runMatchingCell(e,t,n){let i=this.getCurrentCellLens(e.start),o=this.getNextCellLens(e.start);if(i&&this.document){let s=Bv(this.document.getText(i.range));if(t){let l=_e.window.activeTextEditor,{newCellOnRunLast:c}=this.configService.getSettings(this.document.uri),d=new Fo(this.configService.getSettings(this.document.uri));o?this.advanceToRange(o.range):c&&l&&!d.isEmptyCell(s)&&this.insertCell(l,i.range.end.line+1)}let a=await this.getActiveInteractiveWindow();await this.addCode(a,s,this.document.uri,i.range.start.line,n)}}getCellIndex(e){return this.cells.findIndex(t=>e&&t.range.contains(e))}getCellFromIndex(e){let t=this.cells,n=ZIe(e,t.length);return t[n]}getCellFromPosition(e){if(!e){let t=_e.window.activeTextEditor;t&&t.selection&&(e=t.selection.active)}if(e){let t=this.getCellIndex(e);if(t>=0)return this.cells[t]}}getCurrentCellLens(e){return this.codeLenses.find(t=>t.range.contains(e)&&t.command!==void 0&&t.command.command===Q.RunCell)}getNextCellLens(e){let t=this.codeLenses.findIndex(n=>n.range.contains(e)&&n.command!==void 0&&n.command.command===Q.RunCell);if(t>=0)return this.codeLenses.find((n,i)=>n.command!==void 0&&n.command.command===Q.RunCell&&i>t)}getPreviousCellLens(e){let t=this.codeLenses.findIndex(n=>n.range.contains(e)&&n.command!==void 0&&n.command.command===Q.RunCell);if(t>=1)return this.codeLenses.find((n,i)=>n.command!==void 0&&i<t&&i+1===t)}async runFileAsOneCell(e){if(this.document){let t=await this.getActiveInteractiveWindow(),n=this.document.getText();await this.addCode(t,n,this.document.uri,0,e)}}advanceToRange(e){let t=_e.window.activeTextEditor,n=new _e.Selection(e.start,e.start);t&&(t.selection=n,t.revealRange(e,_e.TextEditorRevealType.Default))}};E([Mn("DATASCIENCE.DEBUG_CURRENT_CELL")],nr.prototype,"debugCurrentCell",1),E([Mn("DATASCIENCE.RUN_ALL_CELLS")],nr.prototype,"runAllCells",1),E([Mn("DATASCIENCE.RUN_FILE_INTERACTIVE")],nr.prototype,"runFileInteractive",1),E([Mn("DATASCIENCE.DEBUG_FILE_INTERACTIVE")],nr.prototype,"debugFileInteractive",1),E([Mn("DATASCIENCE.RUN_ALL_CELLS_ABOVE")],nr.prototype,"runAllCellsAbove",1),E([Mn("DATASCIENCE.RUN_CELL_AND_ALL_BELOW")],nr.prototype,"runCellAndAllBelow",1),E([Mn("DATASCIENCE.RUN_SELECTION_OR_LINE")],nr.prototype,"runSelectionOrLine",1),E([Mn("DATASCIENCE.RUN_TO_LINE")],nr.prototype,"runToLine",1),E([Mn("DATASCIENCE.RUN_FROM_LINE")],nr.prototype,"runFromLine",1),E([QH("CodeWatcher::runCell",4)],nr.prototype,"runCell",1),E([Mn("DATASCIENCE.DEBUG_CURRENT_CELL")],nr.prototype,"debugCell",1),E([Mn("DATASCIENCE.RUN_CURRENT_CELL")],nr.prototype,"runCurrentCell",1),E([Mn("DATASCIENCE.RUN_CURRENT_CELL_AND_ADVANCE")],nr.prototype,"runCurrentCellAndAdvance",1),E([Nr("DATASCIENCE.RUN_CURRENT_CELL_AND_ADD_BELOW")],nr.prototype,"runCurrentCellAndAddBelow",1),E([Nr("DATASCIENCE.RUN_INSERT_CELL_BELOW_POSITION")],nr.prototype,"insertCellBelowPosition",1),E([Nr("DATASCIENCE.RUN_INSERT_CELL_BELOW")],nr.prototype,"insertCellBelow",1),E([Nr("DATASCIENCE.RUN_INSERT_CELL_ABOVE")],nr.prototype,"insertCellAbove",1),E([Nr("DATASCIENCE.RUN_DELETE_CELLS")],nr.prototype,"deleteCells",1),E([Nr("DATASCIENCE.RUN_SELECT_CELL")],nr.prototype,"selectCell",1),E([Nr("DATASCIENCE.RUN_SELECT_CELL_CONTENTS")],nr.prototype,"selectCellContents",1),E([Nr("DATASCIENCE.RUN_EXTEND_SELECTION_BY_CELL_ABOVE")],nr.prototype,"extendSelectionByCellAbove",1),E([Nr("DATASCIENCE.RUN_EXTEND_SELECTION_BY_CELL_BELOW")],nr.prototype,"extendSelectionByCellBelow",1),E([Nr("DATASCIENCE.RUN_MOVE_CELLS_UP")],nr.prototype,"moveCellsUp",1),E([Nr("DATASCIENCE.RUN_MOVE_CELLS_DOWN")],nr.prototype,"moveCellsDown",1),E([Nr("DATASCIENCE.RUN_CHANGE_CELL_TO_MARKDOWN")],nr.prototype,"changeCellToMarkdown",1),E([Nr("DATASCIENCE.RUN_CHANGE_CELL_TO_CODE")],nr.prototype,"changeCellToCode",1),E([Nr("DATASCIENCE.GOTO_NEXT_CELL_IN_FILE")],nr.prototype,"gotoNextCell",1),E([Nr("DATASCIENCE.GOTO_PREV_CELL_IN_FILE")],nr.prototype,"gotoPreviousCell",1),nr=E([(0,_m.injectable)(),I(0,(0,_m.inject)(gs)),I(1,(0,_m.inject)(Ae)),I(2,(0,_m.inject)(bM)),I(3,(0,_m.inject)(Cn)),I(4,(0,_m.inject)(dM))],nr);u();var E_=$(te()),xi=$(require("vscode"));var Em=require("vscode");var __=class{constructor(e,t,n){this.configuration=t;this.extensionChecker=n;this.computeDecorations(),e.push(this),e.push(this.configuration.getSettings(void 0).onDidChange(this.settingsChanged,this)),e.push(xi.window.onDidChangeActiveTextEditor(this.changedEditor,this)),e.push(xi.window.onDidChangeTextEditorSelection(this.changedSelection,this)),e.push(xi.workspace.onDidChangeTextDocument(this.changedDocument,this)),this.settingsChanged()}activate(){}dispose(){this.timer&&clearTimeout(this.timer)}settingsChanged(){xi.window.activeTextEditor&&this.triggerUpdate(xi.window.activeTextEditor)}changedEditor(){this.triggerUpdate(void 0)}changedDocument(e){xi.window.activeTextEditor&&e.document===xi.window.activeTextEditor.document&&this.triggerUpdate(Em.window.activeTextEditor)}changedSelection(e){e.textEditor&&e.textEditor.selection.anchor&&this.triggerUpdate(e.textEditor)}triggerUpdate(e){this.timer&&clearTimeout(this.timer),this.timer=setTimeout(()=>this.update(e),100)}computeDecorations(){this.currentCellTopUnfocused=Em.window.createTextEditorDecorationType({borderColor:new xi.ThemeColor("interactive.inactiveCodeBorder"),borderWidth:"2px 0px 0px 0px",borderStyle:"solid",isWholeLine:!0}),this.currentCellBottomUnfocused=Em.window.createTextEditorDecorationType({borderColor:new xi.ThemeColor("interactive.inactiveCodeBorder"),borderWidth:"0px 0px 1px 0px",borderStyle:"solid",isWholeLine:!0}),this.currentCellTop=Em.window.createTextEditorDecorationType({borderColor:new xi.ThemeColor("interactive.activeCodeBorder"),borderWidth:"2px 0px 0px 0px",borderStyle:"solid",isWholeLine:!0}),this.currentCellBottom=Em.window.createTextEditorDecorationType({borderColor:new xi.ThemeColor("interactive.activeCodeBorder"),borderWidth:"0px 0px 1px 0px",borderStyle:"solid",isWholeLine:!0})}cellDecorationEnabled(e){return e.decorateCells===!1?!1:e.decorateCells==="currentCell"||e.decorateCells==="allCells"}update(e){let t=e===void 0?Em.window.visibleTextEditors:[e];for(let n of t)if(n&&n.document&&n.document.languageId===Je&&!rI(n.document)&&this.currentCellTop&&this.currentCellBottom&&this.currentCellTopUnfocused&&this.currentCellBottomUnfocused&&this.extensionChecker.isPythonExtensionInstalled){let i=this.configuration.getSettings(n.document.uri);if(this.cellDecorationEnabled(i)){let o=CD(n.document,i),s=o.map(d=>d.range).filter(d=>d.contains(n.selection.anchor)),a=s.length>0?[new xi.Range(s[0].start,s[0].start)]:[],l=i.decorateCells!=="allCells"&&s.length>0?[new xi.Range(s[0].end,s[0].end)]:[],c=[];i.decorateCells==="allCells"&&o.forEach(d=>{let p=d.range.start;p!==s[0].start&&c.push(new xi.Range(p,p))}),Em.window.activeTextEditor===n?(n.setDecorations(this.currentCellTop,a),n.setDecorations(this.currentCellBottom,l),n.setDecorations(this.currentCellTopUnfocused,c),n.setDecorations(this.currentCellBottomUnfocused,[])):(n.setDecorations(this.currentCellTop,[]),n.setDecorations(this.currentCellBottom,[]),n.setDecorations(this.currentCellTopUnfocused,[...c,...a]),n.setDecorations(this.currentCellBottomUnfocused,l))}else n.setDecorations(this.currentCellTop,[]),n.setDecorations(this.currentCellBottom,[]),n.setDecorations(this.currentCellTopUnfocused,[]),n.setDecorations(this.currentCellBottomUnfocused,[])}}};__=E([(0,E_.injectable)(),I(0,(0,E_.inject)(ie)),I(1,(0,E_.inject)(Ae)),I(2,(0,E_.inject)(Io))],__);u();var vs=$(te()),en=require("vscode");u();var jt=require("vscode");var vZ=$(zh());var Sv=class{constructor(e,t,n,i,o){this.serviceContainer=e;this._owner=t;this.controllerFactory=n;this.inputUri=o;this._onDidChangeViewState=new jt.EventEmitter;this.closedEvent=new jt.EventEmitter;this._submitters=[];this.internalDisposables=[];var s;this.fs=this.serviceContainer.get(wt),this.configuration=this.serviceContainer.get(Ae),this.jupyterExporter=this.serviceContainer.get(CI),this.interactiveWindowDebugger=this.serviceContainer.tryGet(lZ),this.errorHandler=this.serviceContainer.get(Cn),this.codeGeneratorFactory=this.serviceContainer.get(b_),this.storageFactory=this.serviceContainer.get(Ra),this.kernelProvider=this.serviceContainer.get(He),this.debuggingManager=this.serviceContainer.get(fM),this.notebookUri=xD(i)?i.input.uri:i.notebook.uri,this._owner&&this._submitters.push(this._owner),jt.window.onDidChangeActiveNotebookEditor(a=>{(a==null?void 0:a.notebook.uri.toString())===this.notebookUri.toString()&&this._onDidChangeViewState.fire()},this.internalDisposables),jt.workspace.onDidCloseNotebookDocument(a=>{a.uri.toString()===this.notebookUri.toString()&&this.closedEvent.fire()},this.internalDisposables),((s=jt.window.activeNotebookEditor)==null?void 0:s.notebook.uri.toString())===this.notebookUri.toString()&&this._onDidChangeViewState.fire(),this.cellMatcher=new Fo(this.configuration.getSettings(this.owningResource)),this.notebookDocument&&this.codeGeneratorFactory.getOrCreate(this.notebookDocument)}get onDidChangeViewState(){return this._onDidChangeViewState.event}get closed(){return this.closedEvent.event}get owner(){return this._owner}get submitters(){return this._submitters}get notebookDocument(){return this._notebookDocument||(this._notebookDocument=jt.workspace.notebookDocuments.find(e=>e.uri.toString()===this.notebookUri.toString())),this._notebookDocument}get kernelConnectionMetadata(){var e;return(e=this.controller)==null?void 0:e.metadata}notifyConnectionReset(){if(this.notebookDocument)this.controller||(this.controller=this.initController(this.notebookDocument)),this.controller.setInfoMessageCell(C.noKernelConnected);else{let e=jt.workspace.onDidOpenNotebookDocument(t=>{t.uri.toString()===this.notebookUri.toString()&&(this._notebookDocument=t,this.controller=this.initController(t),this.internalDisposables.push(this.controller.listenForControllerSelection()),this.controller.setInfoMessageCell(C.noKernelConnected),e.dispose())})}}initController(e){let t=this.controllerFactory.create(e,this.errorHandler,this.kernelProvider,this._owner);return this.internalDisposables.push(t.listenForControllerSelection()),t}async ensureInitialized(){if(!this.notebookDocument&&(b.debug("Showing Interactive editor to initialize codeGenerator from notebook document"),await this.showInteractiveEditor(),!this.notebookDocument))throw new Error("Could not open notebook document for Interactive Window");this.codeGeneratorFactory.get(this.notebookDocument)||this.codeGeneratorFactory.getOrCreate(this.notebookDocument),this.controller||(this.controller=this.initController(this.notebookDocument)),this.controller.controller?this.controller.startKernel().catch(y):(b.info("No controller selected for Interactive Window initialization"),this.controller.setInfoMessageCell(C.selectKernelForEditor))}async showInteractiveEditor(){let e;jt.window.tabGroups.all.find(i=>{i.tabs.find(o=>{xD(o)&&o.input.uri.toString()==this.notebookUri.toString()&&(e=o)})});let t=this.notebookDocument||await this.openNotebookDocument();return await jt.window.showNotebookDocument(t,{preserveFocus:!0,viewColumn:e==null?void 0:e.group.viewColumn})}async openNotebookDocument(){return b.debug(`Opening notebook document ${this.notebookUri}`),await jt.workspace.openNotebookDocument(this.notebookUri)}dispose(){var e;this.internalDisposables.forEach(t=>t.dispose()),(e=this.controller)==null||e.disconnect()}async showErrorForCell(e,t){var o,s,a;let n=(o=this.controller)==null?void 0:o.controller,i=fy(e);if(n&&i&&t){let l=lo.getOrCreate(t,new uv(n));try{await l.appendOutput(i)}catch(c){b.warn(`Could not append error message "${i}" to cell: ${c}`)}finally{l.end(!1,(a=(s=t.executionSummary)==null?void 0:s.timing)==null?void 0:a.endTime)}}else b.info(`Could not append error message to cell "${i}"`)}changeMode(e){var t;(t=this.controller)==null||t.updateMode(e)}async addCode(e,t,n){return this.submitCode(e,t,n,!1)}useNewDebugMode(){var t;return!!(this.configuration.getSettings(this.owner).forceIPyKernelDebugger||(t=this.controller)!=null&&t.metadata&&!er(this.controller.metadata))}async debugCode(e,t,n){let i=!0,o=jt.workspace.textDocuments.find(a=>this.fs.arePathsSame(a.uri,t));if(!this.useNewDebugMode()&&o&&o.isUntitled){let a=[...jt.workspace.textDocuments];if(i=await o.save(),i){let l=jt.workspace.textDocuments.filter(c=>a.indexOf(c)===-1);l&&l.length>0&&(t=(l.find(d=>d.languageId==="python")||l.find(d=>!d.fileName.endsWith(".interactive"))||l[0]).uri,await jt.workspace.openTextDocument(t))}}let s=!0;return i?this.submitCode(e,t,n,!0):s}async submitCode(e,t,n,i){var d;if(this.cellMatcher.isEmptyCell(e)||!((d=this.controller)!=null&&d.controller))return!0;this.updateOwners(t);let o=st(e,{trim:!1}),s=new Fo(this.configuration.getSettings(t)),a=-1;s.isMarkdown(o[0])&&Ph(o,(p,f)=>void 0,(p,f)=>{p&&p.length>0&&a===-1&&(a=f)});let c=(a>0?[o.slice(0,a).join(`
`),o.slice(a).join(`
`)]:[e]).map(p=>{let f=Te();this.controller.setPendingCellAdd(f.promise);let m=this.addNotebookCell(p,t,n),g=this.createExecutionPromise(m,i);return g.catch(h=>{h instanceof Iv?m.then(v=>{h.cell!==v&&this.showErrorForCell(C.cellStopOnErrorMessage,v).then(y,y)}).catch(y):m.then(v=>this.errorHandler.getErrorMessageForDisplayInCell(h,"execution",this.owningResource).then(S=>this.showErrorForCell(S,v))).catch(y)}).finally(()=>{f==null||f.resolve()}),g});return c[c.length-1]}async createExecutionPromise(e,t){var a,l;if(!this.controller||!this.notebookDocument)return!1;b.ci("InteractiveWindow.ts.createExecutionPromise.start");let n=this.controller.startKernel(),i=await e,o=!0,s=async()=>void 0;try{let c=await n;await this.generateCodeAndAddMetadata(i,t,c),t&&this.useNewDebugMode()?await this.debuggingManager.start(this.notebookDocument,i):t&&er(c.kernelConnectionMetadata)&&this.interactiveWindowDebugger&&(s=async()=>{var f;return(f=this.interactiveWindowDebugger)==null?void 0:f.detach(c)},await this.interactiveWindowDebugger.attach(c),await this.interactiveWindowDebugger.updateSourceMaps(((a=this.storageFactory.get({notebook:i.notebook}))==null?void 0:a.all)||[]),this.interactiveWindowDebugger.enable(c)),b.ci("InteractiveWindow.ts.createExecutionPromise.kernel.executeCell");let d=Gl(i);o=await this.kernelProvider.getKernelExecution(c).executeCell(i,(l=d==null?void 0:d.generatedCode)==null?void 0:l.code).then(()=>!0,()=>!1),b.ci("InteractiveWindow.ts.createExecutionPromise.kernel.executeCell.finished")}finally{await s(),b.ci("InteractiveWindow.ts.createExecutionPromise.end")}if(!o)throw new Iv(i);return o}async expandAllCells(){this.notebookDocument&&await Promise.all(this.notebookDocument.getCells().map(async(e,t)=>{await jt.commands.executeCommand("notebook.cell.expandCellInput",{ranges:[{start:t,end:t+1}],document:this.notebookUri})}))}async collapseAllCells(){this.notebookDocument&&await Promise.all(this.notebookDocument.getCells().map(async(e,t)=>{e.kind===jt.NotebookCellKind.Code&&await jt.commands.executeCommand("notebook.cell.collapseCellInput",{ranges:[{start:t,end:t+1}],document:this.notebookUri})}))}async scrollToCell(e){let t=await this.showInteractiveEditor(),n=t.notebook.getCells().find(i=>{var o;return((o=Gl(i))==null?void 0:o.id)===e});if(n){let i=new jt.NotebookRange(n.index,n.index+1);t.revealRange(i,jt.NotebookEditorRevealType.Default),t.selection=i}}async hasCell(e){let t=this.notebookDocument;return!!t&&t.getCells().some(n=>{var i;return((i=Gl(n))==null?void 0:i.id)===e})}get owningResource(){if(this.owner)return this.owner;let e=tI();if(e)return e}updateOwners(e){var t;this._owner||(this._owner=e,(t=this.controller)==null||t.updateOwners(e)),this._submitters.find(n=>n.toString()==e.toString())||this._submitters.push(e)}async addNotebookCell(e,t,n){var g,h;let i=this.notebookDocument;if(!i)throw new Error("No notebook document");let o=this.configuration.getSettings(this.owningResource),s=this.cellMatcher.getCellType(e)===DE,a=s?R0(st(e)).join(""):gZ(e,o,this.cellMatcher),l=this.cellMatcher.getFirstMarker(e),c=(h=(g=jt.workspace.textDocuments.find(v=>{var S;return v.uri.toString()===((S=this.owner)==null?void 0:S.toString())}))==null?void 0:g.languageId)!=null?h:Je,d=new jt.NotebookCellData(s?jt.NotebookCellKind.Markup:jt.NotebookCellKind.Code,a,s?DE:c),p={uristring:t.toString(),lineIndex:n,originalSource:e},f={interactiveWindowCellMarker:l,interactive:p,id:(0,vZ.default)()};d.metadata=f,await yu(i,v=>{let S=jt.NotebookEdit.insertCells(i.cellCount,[d]);v.set(i.uri,[S])});let m=i.cellCount-1;return i.cellAt(m)}async generateCodeAndAddMetadata(e,t,n){let i=Gl(e);if(!i)return;let o=!er(n.kernelConnectionMetadata)||this.configuration.getSettings(void 0).forceIPyKernelDebugger,s=await this.codeGeneratorFactory.getOrCreate(this.notebookDocument).generateCode(i,e.index,t,o),a={...i,generatedCode:s},l=new jt.WorkspaceEdit,c=jt.NotebookEdit.updateCellMetadata(e.index,a);l.set(e.notebook.uri,[c]),await jt.workspace.applyEdit(l)}async export(){var n;if(!this.notebookDocument)throw new Error("no notebook to export.");let e=mZ(this.notebookDocument),t=await new ep().showDialog("ipynb",this.owningResource);t&&await((n=this.jupyterExporter)==null?void 0:n.exportToFile(e,at(t)))}async exportAs(){var n;if(await this.ensureInitialized(),!this.controller)throw new Error("An active kernel is required to export the notebook.");let e=(n=this.controller.kernel)==null?void 0:n.value,t;if(this.submitters&&this.submitters.length){let i=this.submitters[this.submitters.length-1];t=tr(i.path,vp(i.path))}xn()?jt.commands.executeCommand(Q.ExportAsPythonScript,this.notebookDocument,e==null?void 0:e.kernelConnectionMetadata.interpreter).then(y,y):jt.commands.executeCommand(Q.Export,this.notebookDocument,t,e==null?void 0:e.kernelConnectionMetadata.interpreter).then(y,y)}};E([DO()],Sv.prototype,"showErrorForCell",1),E([DO()],Sv.prototype,"createExecutionPromise",1);u();function yZ(r){return C.interactiveWindowTitleFormat(tr(r.path))}u();var Fj=class{constructor(e,t,n,i,o,s,a){this.controllerService=e;this.mode=t;this.notebook=n;this.errorHandler=i;this.kernelProvider=o;this.owner=s;this.disposables=[];this.controller=a==null?void 0:a.controller,this.metadata=a==null?void 0:a.connection}updateMode(e){this.mode=e}updateOwners(e){this.owner=e}async startKernel(){var e;if((e=this.connectingListener)==null||e.dispose(),this.kernel)return this.kernel.promise;if(!this.controller||!this.metadata)throw new Error("Interactive Window kernel not selected");this.setInfoMessage(this.metadata,0);try{let t=await this.createKernel(),n=async()=>{this.notebook&&this.metadata&&(this.systemInfoCell=void 0,this.setInfoMessage(this.metadata,1))};return this.disposables.push(t.addHook("willRestart",n)),t.onRestarted(async()=>{b.debug("Restart event handled in IW"),this.fileInKernel=void 0;try{await this.setFileInKernel(t)}catch(i){b.error("Failed to run initialization after restarting")}finally{this.finishSysInfoMessage(t,1)}},this,this.disposables),this.fileInKernel=void 0,await this.setFileInKernel(t),this.finishSysInfoMessage(t,0),t}catch(t){throw this.owner?this.deleteSysInfoCell():await this.finishSysInfoWithFailureMessage(t),t}}async createKernel(){if(this.kernel)return this.kernel.promise;if(!this.controller||!this.metadata)throw new Error("Controller not selected");let e=Te();e.promise.catch(y),this.kernel=e;try{let{kernel:t,actualController:n}=await this.controllerService.createKernel(this.metadata,this.controller,this.owner,this.notebook,this.disposables);return this.metadata=t.kernelConnectionMetadata,this.controller=n,this.disposables.push(t),e.resolve(t),t}catch(t){throw e.reject(t),this.disconnect(),t}}async setFileInKernel(e){let t=this.owner;if(!t){b.ci("Unable to run initialization for IW");return}let n=at(t),i=this.kernelProvider.getKernelExecution(e);this.mode==="perFile"&&!this.fileInKernel?(b.debug(`Initializing __file__ in setFileInKernel with ${t} for mode ${this.mode}`),this.fileInKernel=t,await i.executeHidden(`__file__ = '${n.replace(/\\/g,"\\\\")}'`)):(!this.fileInKernel||this.fileInKernel.toString()!==t.toString())&&this.mode!=="perFile"?(b.debug(`Initializing __file__ in setFileInKernel with ${t} for mode ${this.mode}`),this.fileInKernel=t,await i.executeHidden(`__file__ = '${n.replace(/\\/g,"\\\\")}'`)):b.debug(`Not Initializing __file__ in setFileInKernel with ${n} for mode ${this.mode} currently ${this.fileInKernel}`)}setPendingCellAdd(e){if(this.metadata&&this.notebook){let t=this.controllerService.getRegisteredController(this.metadata);t==null||t.setPendingCellAddition(this.notebook,e)}}listenForControllerSelection(){return this.controllerService.onControllerSelected(e=>{var t,n,i,o;if(!(!this.notebook||e.notebook.uri.toString()!==((n=(t=this.notebook)==null?void 0:t.uri)==null?void 0:n.toString()))&&e.controller.id!==((i=this.controller)==null?void 0:i.id)){let s=!!this.kernel;this.disconnect(),this.controller=e.controller.controller,this.metadata=e.controller.connection,s?this.startKernel().catch(y):((o=this.connectingListener)==null||o.dispose(),this.connectingListener=e.controller.onConnecting(()=>{this.startKernel().catch(y)}),this.disposables.push(this.connectingListener))}},this)}setInfoMessageCell(e){this.systemInfoCell?this.systemInfoCell.updateMessage(e).catch(t=>b.warn(`could not update info cell with message: "${e}", error: ${t}`)):this.systemInfoCell=new hM(this.notebook,e)}setInfoMessage(e,t){let n=cZ(e,t);this.setInfoMessageCell(n)}finishSysInfoMessage(e,t){var i;let n=uZ(e.kernelConnectionMetadata,t);(i=this.systemInfoCell)==null||i.updateMessage(n).catch(o=>b.warn(`System info message was not updated: "${n}" because of error: ${o}`)),this.systemInfoCell=void 0}async finishSysInfoWithFailureMessage(e){var n;let t=await this.errorHandler.getErrorMessageForDisplayInCell(e,"start",this.owner);t=t.split(`
`).join(`  
`),(n=this.systemInfoCell)==null||n.updateMessage(t).catch(i=>b.warn(`System info message was not updated: "${t}" because of error: ${i}`)),this.systemInfoCell=void 0}deleteSysInfoCell(){var e;(e=this.systemInfoCell)==null||e.deleteCell().then(y,y),this.systemInfoCell=void 0}disconnect(){this.disposables.forEach(e=>e.dispose()),this.disposables=[],this.kernel=void 0}},DD=class{constructor(e,t,n){this.controllerService=e;this.mode=t;this.initialController=n}create(e,t,n,i){let o=this.initialController,s=this.controllerService.getSelectedController(e);return s&&(o=s),new Fj(this.controllerService,this.mode,e,t,n,i,o)}};var bZ="ds_asked_per_file_interactive",IZ="ds_interactive_window_cache",C_=class{constructor(e,t,n,i,o,s,a,l){this.serviceContainer=e;this.disposables=t;this.fs=n;this.configService=i;this.globalMemento=o;this.workspaceMemento=s;this.notebookEditorProvider=a;this.controllerHelper=l;this._onDidChangeActiveInteractiveWindow=new en.EventEmitter;this._windows=[];this.notebookEditorProvider.registerEmbedNotebookProvider(this),this.restoreWindows()}get onDidChangeActiveInteractiveWindow(){return this._onDidChangeActiveInteractiveWindow.event}get activeWindow(){var t;let e=(t=en.window.activeNotebookEditor)==null?void 0:t.notebook.uri.toString();return e?this._windows.find(n=>{var i;return((i=n.notebookUri)==null?void 0:i.toString())===e}):void 0}restoreWindows(){let e=new Map;en.window.tabGroups.all.forEach(t=>{t.tabs.forEach(n=>{xD(n)&&n.input.uri&&e.set(n.input.uri.toString(),n)})}),this.workspaceMemento.get(IZ,[]).forEach(t=>{if(!t.uriString||!e.get(t.uriString))return;let n=e.get(t.uriString);if(!n)return;let i=this.configService.getSettings(n.input.uri).interactiveWindowMode,o=new Sv(this.serviceContainer,en.Uri.parse(t.owner),new DD(this.controllerHelper,i),n,en.Uri.parse(t.inputBoxUriString));o.notifyConnectionReset(),this._windows.push(o),J("DS_INTERNAL.CREATED_INTERACTIVE_WINDOW",{windowCount:this._windows.length},{hasKernel:!1,hasOwner:!!t.owner,mode:i,restored:!0});let s=o.closed(this.onInteractiveWindowClosed.bind(this,o));this.disposables.push(o),this.disposables.push(s),this.disposables.push(o.onDidChangeViewState(this.raiseOnDidChangeActiveInteractiveWindow.bind(this)))}),this._updateWindowCache()}async getOrCreate(e,t){if(!en.workspace.isTrusted)throw new Error("Workspace not trusted");let n=await this.getInteractiveMode(e);this.pendingCreations&&await this.pendingCreations.catch(y);let i=this.getExisting(e,n,t);return i||(i=await this.create(e,n,t)),await i.ensureInitialized(),i}get(e){let t=this.configService.getSettings(e).interactiveWindowMode;return this.getExisting(e,t)}async create(e,t,n){let i=Te();this.pendingCreations=i.promise;try{let o=await this.controllerHelper.getInitialController(e,n);b.info(`Starting interactive window for resource '${ve(e)}' with controller '${o==null?void 0:o.id}'`);let[s,a]=await this.createEditor(o,e,t);o&&o.controller.updateNotebookAffinity(a.notebook,en.NotebookControllerAffinity.Preferred),b.debug(`Interactive Window Editor Created: ${a.notebook.uri.toString()} with input box: ${s.toString()}`);let l=new Sv(this.serviceContainer,e,new DD(this.controllerHelper,t,o),a,s);this._windows.push(l),J("DS_INTERNAL.CREATED_INTERACTIVE_WINDOW",{windowCount:this._windows.length},{hasKernel:!!o,hasOwner:!!e,mode:t,restored:!1}),this._updateWindowCache(),this.lastActiveInteractiveWindow=l;let c=l.closed(this.onInteractiveWindowClosed.bind(this,l));return this.disposables.push(l),this.disposables.push(c),this.disposables.push(l.onDidChangeViewState(this.raiseOnDidChangeActiveInteractiveWindow.bind(this))),l}finally{i.resolve()}}async createEditor(e,t,n){let i=e?`${Ge}/${e.id}`:void 0,o=t!==void 0,s=this.getInteractiveViewColumn(t),{inputUri:a,notebookEditor:l}=await en.commands.executeCommand("interactive.open",{viewColumn:s,preserveFocus:o},void 0,i,t&&n==="perFile"?yZ(t):void 0);if(!l)throw new Error("Failed to request creation of interactive window from VS Code.");return[a,l]}getInteractiveViewColumn(e){if(e)return en.ViewColumn.Beside;let t=this.configService.getSettings(e).interactiveWindowViewColumn;return t==="secondGroup"?en.ViewColumn.One:t==="active"?en.ViewColumn.Active:en.ViewColumn.Beside}async getInteractiveMode(e){let t=this.configService.getSettings(e).interactiveWindowMode;if(t==="multiple"&&e&&!this.globalMemento.get(bZ)&&this._windows.length===1&&(!this._windows[0].owner||!this.fs.arePathsSame(this._windows[0].owner,e))){this.globalMemento.update(bZ,!0).then(y,y);let n=[C.interactiveWindowModeBannerSwitchYes,C.interactiveWindowModeBannerSwitchNo];await en.window.showInformationMessage(C.interactiveWindowModeBannerTitle,...n)===n[0]&&(t="perFile",this._windows[0].changeMode(t),await this.configService.updateSetting("interactiveWindow.creationMode",t,e,en.ConfigurationTarget.Global))}return t}_updateWindowCache(){let e=this._windows.map(t=>{var n;return{owner:(n=t.owner)==null?void 0:n.toString(),uriString:t.notebookUri.toString(),inputBoxUriString:t.inputUri.toString()}});this.workspaceMemento.update(IZ,e).then(y,y)}getExisting(e,t,n){return t==="single"?this._windows.length>0?this._windows[0]:void 0:t==="multiple"?e?this.activeWindow||this.lastActiveInteractiveWindow||this._windows[0]:void 0:this._windows.find(i=>{var o;return!e&&!i.owner&&!n?!0:e&&i.owner&&this.fs.arePathsSame(e,i.owner)?!n||((o=i.kernelConnectionMetadata)==null?void 0:o.id)===n.id:!1})}raiseOnDidChangeActiveInteractiveWindow(){this.lastActiveInteractiveWindow=this.activeWindow?this.activeWindow:this.lastActiveInteractiveWindow,this._onDidChangeActiveInteractiveWindow.fire(this.activeWindow)}onInteractiveWindowClosed(e){var t;b.debug(`Closing interactive window: ${(t=e.notebookUri)==null?void 0:t.toString()}`),e.dispose(),this._windows=this._windows.filter(n=>n!==e),this._updateWindowCache(),this.lastActiveInteractiveWindow===e&&(this.lastActiveInteractiveWindow=this._windows[0]),this.raiseOnDidChangeActiveInteractiveWindow()}getActiveOrAssociatedInteractiveWindow(){if(this.activeWindow)return this.activeWindow;if(en.window.activeTextEditor===void 0)return;let e=en.window.activeTextEditor.document.uri;if(e.scheme!==up)return this.get(e)}findNotebookEditor(e){var n,i;let t;if(e&&e.path.endsWith(".interactive"))t=(n=this.get(e))==null?void 0:n.notebookDocument;else{let o=this.configService.getSettings(e).interactiveWindowMode;t=(i=this.getExisting(e,o))==null?void 0:i.notebookDocument}return t?en.window.visibleNotebookEditors.find(o=>o.notebook===t):void 0}findAssociatedNotebookDocument(e){let t=this._windows.find(i=>{var o;return((o=i.inputUri)==null?void 0:o.toString())===e.toString()});return t==null?void 0:t.notebookDocument}getInteractiveWindowWithNotebook(e){let t;return e!==void 0?t=this._windows.find(n=>{var i;return((i=n.notebookUri)==null?void 0:i.toString())===e.toString()}):t=this.getActiveOrAssociatedInteractiveWindow(),t}getInteractiveWindowsWithSubmitter(e){return this._windows.filter(t=>t.submitters.find(n=>this.fs.arePathsSame(e,n)))}};C_=E([(0,vs.injectable)(),I(0,(0,vs.inject)(Kr)),I(1,(0,vs.inject)(ie)),I(2,(0,vs.inject)(wt)),I(3,(0,vs.inject)(Ae)),I(4,(0,vs.inject)(St)),I(4,(0,vs.named)(ir)),I(5,(0,vs.inject)(St)),I(5,(0,vs.named)(Es)),I(6,(0,vs.inject)(Ko)),I(7,(0,vs.inject)(pM))],C_);u();var x_=$(te());u();var Iu=require("vscode");var IM=class{constructor(e,t,n,i){this.configService=e;this.storage=t;this.notebook=n;this.executionCount=0;this.cellIndexesCounted={};this.disposables=[];i.push(this),Iu.workspace.onDidChangeTextDocument(this.onChangedDocument,this,this.disposables),Mr.onDidChangeNotebookCellExecutionState(this.onDidCellStateChange,this,this.disposables)}dispose(){this.disposed||(this.disposed=!0,this.storage.clear(),this.disposables.forEach(e=>e.dispose()))}reset(){this.storage.clear(),this.executionCount=0}async generateCode(e,t,n,i){let{executableLines:o}=this.extractExecutableLines(e);if(this.executionCount+=1,this.cellIndexesCounted[t]=!0,o.length>0&&o.find(s=>s.trim().length>0))return this.generateCodeImpl(e,this.executionCount,n,i)}extractExecutableLines(e){let t=e.interactive.originalSource,n=this.configService.getSettings(this.notebook.uri),i=new Fo(n),o=nI(t);if(n.magicCommandsAsComments&&o.forEach((s,a)=>o[a]=vM(s)),e.interactiveWindowCellMarker&&o.length&&o[0].trim()===e.interactiveWindowCellMarker.trim()){let s=o.slice(1).filter(a=>a.trim().length>0);if(s.length>0&&s[0].trim().startsWith("%%")){let a=o.slice(o.indexOf(s[0]));return{lines:a,executableLines:a}}}return o.length>0&&(i.isCode(o[0])||i.isMarkdown(o[0]))?{lines:o,executableLines:o.slice(1)}:{lines:o,executableLines:o}}onDidCellStateChange(e){var t;e.state===1&&(e.state!==1||e.cell.notebook!==this.notebook||!((t=e.cell.executionSummary)!=null&&t.executionOrder)||this.cellIndexesCounted[e.cell.index]||(this.executionCount+=1,this.cellIndexesCounted[e.cell.index]=!0))}async generateCodeImpl(e,t,n,i){let{lineIndex:o,uristring:s}=e.interactive,a=Iu.workspace.textDocuments.find(re=>re.uri.toString()===s);if(!a)return;let{stripped:l,trueStartLine:c}=this.extractStrippedLines(e),d=a.lineAt(c),p=a.lineAt(Math.min(c+l.length-1,a.lineCount-1)),f=0;for(;f<l.length&&l[f].trim().length===0;)f+=1;let m=f+c,g=a.offsetAt(new Iu.Position(o,0)),h=a.offsetAt(p.rangeIncludingLineBreak.end),v=(e.interactiveWindowCellMarker||"").length>0,{runtimeLine:S,debuggerStartLine:_}=this.addHiddenLines(n,l,c,m,v,i),D=l.join(""),P=a.getText(new Iu.Range(new Iu.Position(o,0),p.rangeIncludingLineBreak.end)),M=(await ja(D,"SHA-1")).substring(0,12),x=this.getRuntimeFile(M,t),A=n?-1:0,j={line:d?d.lineNumber+1:1,endLine:p?p.lineNumber+1:1,firstNonBlankLineIndex:m,debuggerStartLine:_,executionCount:t,startOffset:g,endOffset:h,deleted:!1,code:D,trimmedRightCode:l.map(re=>re.replace(/[ \t\r]+\n$/g,`
`)).join(""),realCode:P,runtimeLine:S,runtimeFile:x,id:e.id,timestamp:Date.now(),lineOffsetRelativeToIndexOfFirstLineInCell:A,hasCellMarker:v};return b.info(`Generated code for ${t} = ${x} with ${l.length} lines`),this.storage.store(Iu.Uri.parse(e.interactive.uristring),j),j}getRuntimeFile(e,t){return`<ipython-input-${t}-${e}>`}onChangedDocument(e){let t=this.storage.getFileGeneratedCode(e.document.uri);if(t){let n=e.document.getText();e.contentChanges.forEach(i=>{this.handleContentChange(n,i,t)})}}extractStrippedLines(e){let t=nI(e.interactive.originalSource),{lines:n}=this.extractExecutableLines(e),i=e.interactive.lineIndex+1;if(!e.interactiveWindowCellMarker){i=e.interactive.lineIndex;for(let l=0;l<n.length;l+=1)if(n[l]!==t[l]){i+=l+1;break}}let o=0;for(;o<n.length&&n[o].trim().length===0;)o+=1;let s=n.length-1,a=n.length-2;for(;a>0;){let l=n[s],c=n[a];if((l.length===0||l===`
`)&&(c.length===0||c===`
`))n.splice(s,1),s-=1,a-=1;else break}!n[s].endsWith(`
`)&&n[s].length>0&&(n[s]=`${n[s]}
`);for(let l=0;l<n.length;l++)n[l]=n[l].replace(/\r\n/g,`
`);return{stripped:n,trueStartLine:i}}handleContentChange(e,t,n){let i=t.range.start.line-t.range.end.line+t.text.split(`
`).length-1,o=t.text.length-t.rangeLength,s=t.rangeLength<=0?t.rangeOffset:t.rangeOffset+t.rangeLength-1;n.forEach(a=>{a.endOffset<t.rangeOffset||(a.startOffset>s?(a.line+=i,a.endLine+=i,a.startOffset+=o,a.endOffset+=o):a.startOffset===s?a.deleted||t.rangeLength>0||i===0?a.deleted=e.substr(a.startOffset,a.endOffset-a.startOffset)!==a.realCode:(a.line+=i,a.endLine+=i,a.startOffset+=o,a.endOffset+=o):a.deleted=e.substr(a.startOffset,a.endOffset-a.startOffset)!==a.realCode)})}addHiddenLines(e,t,n,i,o,s){let a=s||this.configService.getSettings(void 0).forceIPyKernelDebugger===!0;return e&&this.configService.getSettings(this.notebook.uri).stopOnFirstLineWhileDebugging?a?(t.splice(0,0,`breakpoint()
`),{runtimeLine:1,debuggerStartLine:n+1}):(t.splice(0,0,`breakpoint()
`),{runtimeLine:2,debuggerStartLine:n}):{runtimeLine:1,debuggerStartLine:o?i:i+1}}};var SZ=require("vscode");var w_=class{constructor(e,t,n){this.configService=e;this.storageFactory=t;this.disposables=n;this.codeGenerators=new WeakMap}activate(){SZ.workspace.onDidCloseNotebookDocument(this.onDidCloseNotebook,this,this.disposables)}getOrCreate(e){let t=this.get(e);if(t)return t;let n=new IM(this.configService,this.storageFactory.getOrCreate(e),e,this.disposables);return this.codeGenerators.set(e,n),n}get(e){return this.codeGenerators.get(e)}onDidCloseNotebook(e){var t;(t=this.codeGenerators.get(e))==null||t.dispose(),this.codeGenerators.delete(e)}};w_=E([(0,x_.injectable)(),I(0,(0,x_.inject)(Ae)),I(1,(0,x_.inject)(Ra)),I(2,(0,x_.inject)(ie))],w_);u();var _Z=$(te()),EZ=require("vscode");u();var SM=class{constructor(){this.codeGeneratorsByFile=new mu}clear(){this.codeGeneratorsByFile.clear()}get all(){return[...this.codeGeneratorsByFile.entries()].map(e=>({uri:e[0],generatedCodes:e[1].filter(t=>!t.deleted)})).filter(e=>e.generatedCodes.length>0)}getFileGeneratedCode(e){return this.codeGeneratorsByFile.get(e)||[]}store(e,t){let n=this.codeGeneratorsByFile.get(e)||[],i=!1;for(let o=0;o<n.length&&!i;o+=1){let s=n[o];t.line>=s.line&&t.line<=s.endLine?(n.splice(o,1,t),i=!0):s.line>t.line&&(n.splice(o,0,t),i=!0)}i||n.push(t),this.codeGeneratorsByFile.set(e,n)}};var D_=class{constructor(){this.storages=new WeakMap}getOrCreate(e){return this.storages.has(e)||this.storages.set(e,new SM),this.storages.get(e)}get(e){if("notebook"in e)return this.storages.get(e.notebook);{let t=EZ.workspace.notebookDocuments.find(n=>{let i=this.storages.get(n);return i==null?void 0:i.all.find(o=>o.uri.toString()===e.fileUri.toString())});return t?this.storages.get(t):void 0}}};D_=E([(0,_Z.injectable)()],D_);u();var Cm=$(te());var P_=class{constructor(e,t,n,i,o){this.kernelProvider=e;this.codeGeneratorFactory=n;this.storageFactory=i;this.controllers=o;this.disposables=[];t.push(this)}dispose(){fe(this.disposables)}activate(){this.kernelProvider.onDidCreateKernel(this.onDidCreateKernel,this,this.disposables),this.controllers.onControllerSelected(this.onNotebookControllerSelected,this,this.disposables)}onNotebookControllerSelected({notebook:e}){var t,n;(t=this.storageFactory.get({notebook:e}))==null||t.clear(),(n=this.codeGeneratorFactory.get(e))==null||n.reset()}onDidCreateKernel(e){var n;let t=e.notebook;e.creator!=="jupyterExtension"||t.notebookType!==ht||((n=this.storageFactory.get({notebook:t}))==null||n.clear(),e.onRestarted(()=>{var i;(i=this.storageFactory.get({notebook:t}))==null||i.clear(),this.codeGeneratorFactory.getOrCreate(t).reset()},this,this.disposables))}};P_=E([(0,Cm.injectable)(),I(0,(0,Cm.inject)(He)),I(1,(0,Cm.inject)(ie)),I(2,(0,Cm.inject)(b_)),I(3,(0,Cm.inject)(Ra)),I(4,(0,Cm.inject)(Tt))],P_);u();var k_=$(te()),oee=require("vscode");var iee=nee(),EM=/(;32m[ ->]*?)(\d+)(.*)/g,T_=class{constructor(e,t,n){this.storageFactory=e;this.platformService=t;this.configurationService=n}format(e,t){var a;if(e.notebook.notebookType!==ht)return t;let n=this.storageFactory.get({notebook:e.notebook}),i=t.some(l=>/^[Input|Cell|File].*?\n.*/.test(l));if(!i&&!n)return t;let o=this.configurationService.getSettings(e.document.uri),s=(a=o==null?void 0:o.formatStackTraces)!=null?a:!1;return t.map(l=>i?this.modifyTracebackFrameIPython8(l,n==null?void 0:n.all,s):s?this.modifyTracebackFrameIPython7(l,n.all):l)}modifyTracebackFrameIPython8(e,t,n){var d,p,f,m,g;e=e.replace(/\u001b\[4\dm/g,""),e=e.replace(/\u001b\[38;.*?\d+m/g,"\x1B[39m"),e=e.replace(/(;32m[ ->]*?)(\d+)(.*)\n/g,(h,v,S,_)=>(_=_.replace(/\u001b\[3\d+m/g,"\x1B[39m"),`${v}${S}${_}
`)),b.ci(`Trace frame to match: ${e}`);let i,o,s=/Cell\s+(?:\u001b\[.+?m)?In\s*\[(?<executionCount>\d+)\],\s*line (?<lineNumber>\d+).*/,l=/Input\s+?(?:\u001b\[.+?m)?In\s*\[(?<executionCount>\d+)\].*line: (?<lineNumber>\d).*/.exec(e),c=s.exec(e);if(l&&((d=l.groups)!=null&&d.executionCount)&&((p=l.groups)!=null&&p.lineNumber)?(i=parseInt(l.groups.executionCount),o=(f=l.groups)==null?void 0:f.lineNumber):c&&((m=c.groups)!=null&&m.executionCount)&&((g=c.groups)!=null&&g.lineNumber)&&(i=parseInt(c.groups.executionCount),o=c.groups.lineNumber),t&&i){let h,v;for(let S of t)if(v=S.generatedCodes.find(_=>_.executionCount===i),v){h=S.uri;break}if(v&&h){let S=e;return n&&(S=S.replace(EM,(_,D,P,M)=>{let x=parseInt(P,10),re=(v.hasCellMarker?v.line-1:v.line)-1+v.lineOffsetRelativeToIndexOfFirstLineInCell+x;return`${D}<a href='${h==null?void 0:h.toString()}?line=${re-1}'>${re}</a>${M}`})),S.replace(/.*?\n/,`File \x1B[1;32m${at(h)}:${o}\x1B[0m
`)}}if(n){let h=/^File.*?\[\d;32m(.*):\d+.*\u001b.*\n/.exec(e);if(h&&h.length>1){let v=pP(h[1],at(this.platformService.homeDir)),S=oee.Uri.file(v);return e.replace(EM,(_,D,P,M)=>{let x=parseInt(P,10);return`${D}<a href='${S==null?void 0:S.toString()}?line=${x-1}'>${x}</a>${M}`})}}return e}modifyTracebackFrameIPython7(e,t){return t.map(i=>i.uri).forEach(i=>{let o=at(i),s=ve(i),a=this.storageFactory.get({fileUri:i});if(a){if(e.includes(o)&&new RegExp(`\\[.*?;32m${iee(o)}`).test(e)||e.includes(s)&&new RegExp(`\\[.*?;32m${iee(s)}`).test(e)){let l="",c=/(;32m[ ->]*?)(\d+)(.*)/g;for(let p=c.exec(e);p&&p.length>3;p=c.exec(e)){let f=fu(p[3]).substr(1);l=`${l}${f}
`}let d=this.findCellOffset(a.getFileGeneratedCode(i),l);d!==void 0&&(e=e.replace(EM,(p,f,m,g)=>{let h=parseInt(m,10),v=d+h-1;return`${f}<a href='${i.toString()}?line=${v}'>${v+1}</a>${g}`}))}if(e.includes(o)){let l=this.findCellOffset(a.getFileGeneratedCode(i),e);if(l)return e.replace(EM,(c,d,p,f)=>{let m=parseInt(p,10),g=l+m-1;return`${d}<a href='${i.toString()}?line=${g}'>${g+1}</a>${f}`})}}}),e}findCellOffset(e,t){if(e){for(let n of e)if(n.trimmedRightCode.indexOf(t)>=0)return n.firstNonBlankLineIndex}}};T_=E([(0,k_.injectable)(),I(0,(0,k_.inject)(Ra)),I(1,(0,k_.inject)(ps)),I(2,(0,k_.inject)(Ae))],T_);u();var Su=$(te()),wm=require("vscode");u();function see(r){let e={source:{path:at(r.uri)},pydevdSourceMaps:[]};return e.pydevdSourceMaps=r.generatedCodes.map(t=>({line:t.debuggerStartLine,endLine:t.endLine,runtimeSource:{path:t.runtimeFile},runtimeLine:t.runtimeLine})),e}u();var CM=class{constructor(e,t,n){this.debugAdapter=e;this.debugCell=t;this.execution=n;this._ready=Te();this.ready=this._ready.promise;J("DATASCIENCE.DEBUGGING.SUCCESSFULLY_STARTED_RUN_AND_DEBUG_CELL")}trace(e,t){b.debug(`[Debug-IW] ${e}: ${t}`)}async willSendEvent(e){return Rj(e)?(this.trace("intercept","debugpyAttach request for subprocess, not supported"),!0):e.event==="output"&&hD(e.body.output)?(this.trace("intercept","justMyCode notification"),!0):!1}async willSendRequest(e){let t=Gl(this.debugCell);e.command==="setBreakpoints"&&t&&t.generatedCode&&!this.cellDumpInvoked&&(this.debugCellDumped||(this.debugCellDumped=mv(this.execution,this.debugAdapter)),await this.debugCellDumped),e.command==="configurationDone"&&t&&t.generatedCode&&(this.debugCellDumped||(this.debugCellDumped=mv(this.execution,this.debugAdapter)),await this.debugCellDumped,this._ready.resolve())}};u();var wM=class extends t_{constructor(){super(...arguments);this._ready=Te();this.ready=this._ready.promise}resolve(){this._ready.resolve()}};u();var Uj=require("vscode");var xM=class extends n_{constructor(t,n,i,o,s,a,l){super(t,n,i,o,s,a);this.cellToDebugFileSortedInReverseOrderByLineNumber=[];l&&(this.debugLocationTracker=l.createDebugAdapterTracker(t),this.debugLocationTracker.onWillStartSession&&this.debugLocationTracker.onWillStartSession(),this.onDidSendMessage(c=>{var d;(d=this.debugLocationTracker)!=null&&d.onDidSendMessage&&this.debugLocationTracker.onDidSendMessage(c)},this,this.disposables),this.onDidEndSession(()=>{var c;(c=this.debugLocationTracker)!=null&&c.onWillStopSession&&this.debugLocationTracker.onWillStopSession()},this,this.disposables))}handleClientMessageAsync(t){var n,i;return b.ci(`KernelDebugAdapter::handleMessage ${JSON.stringify(t,void 0," ")}`),t.type==="request"&&((n=this.debugLocationTracker)!=null&&n.onWillReceiveMessage)&&this.debugLocationTracker.onWillReceiveMessage(t),t.type==="response"&&((i=this.debugLocationTracker)!=null&&i.onDidSendMessage)&&this.debugLocationTracker.onDidSendMessage(t),super.handleClientMessageAsync(t)}async dumpCell(t){var o,s;let n=this.notebookDocument.cellAt(t),i=Gl(n);if(!i)throw new Error("Not an interactive window cell");try{let a=(((o=i.generatedCode)==null?void 0:o.code)||n.document.getText()).replace(/\r\n/g,`
`),l=await this.session.customRequest("dumpCell",{code:a}),c=Ss(l.sourcePath);this.fileToCell.set(c,Uj.Uri.parse(i.interactive.uristring));let d=0;i.generatedCode&&!i.generatedCode.hasCellMarker&&(d=i.generatedCode.firstNonBlankLineIndex),this.cellToDebugFileSortedInReverseOrderByLineNumber.push({debugFilePath:c,interactiveWindow:Uj.Uri.parse(i.interactive.uristring),metadata:i,lineOffset:d+i.interactive.lineIndex+(((s=i.generatedCode)==null?void 0:s.lineOffsetRelativeToIndexOfFirstLineInCell)||0)}),this.cellToDebugFileSortedInReverseOrderByLineNumber.sort((p,f)=>f.metadata.interactive.lineIndex-p.metadata.interactive.lineIndex)}catch(a){b.error(`Failed to dump cell for ${n.index} with code ${i.interactive.originalSource}`,a)}}translateDebuggerLocationToRealLocation(t,n){var o;if(n=(o=t==null?void 0:t.source)!=null?o:n,!n||!n.path)return;let i=this.cellToDebugFileSortedInReverseOrderByLineNumber.find(s=>s.debugFilePath===n.path);i&&(n.name=tr(i.interactiveWindow.path),n.path=i.interactiveWindow.toString(),typeof(t==null?void 0:t.endLine)=="number"&&(t.endLine=t.endLine+(i.lineOffset||0)),typeof(t==null?void 0:t.line)=="number"&&(t.line=t.line+(i.lineOffset||0)))}translateRealLocationToDebuggerLocation(t,n){var s;let i=t.line;if(n=(s=t==null?void 0:t.source)!=null?s:n,!n||!n.path||typeof i!="number")return;let o=this.cellToDebugFileSortedInReverseOrderByLineNumber.find(a=>i>=a.metadata.interactive.lineIndex+1);!o||o.interactiveWindow.path!==n.path||(n.path=o.debugFilePath,typeof(t==null?void 0:t.endLine)=="number"&&(t.endLine=t.endLine-(o.lineOffset||0)),typeof(t==null?void 0:t.line)=="number"&&(t.line=t.line-(o.lineOffset||0)))}async sendRequestToJupyterSession(t){var n,i;if(t.command==="setBreakpoints"){let o=t.arguments;if(delete o.lines,o.source.path!==((n=this.cellToDebugFileSortedInReverseOrderByLineNumber[0])==null?void 0:n.interactiveWindow.path))return super.sendRequestToJupyterSession(t);let s,a=[],l=[],c=()=>{if(a.length){let f=JSON.parse(JSON.stringify(t));f.arguments.breakpoints=a,l.push(super.sendRequestToJupyterSession(f))}};for(let f of(i=t.arguments.breakpoints)!=null?i:[]){let m=this.cellToDebugFileSortedInReverseOrderByLineNumber.find(g=>f.line>=g.metadata.generatedCode.line&&f.line<=g.metadata.generatedCode.endLine);if(m&&m.metadata.interactive.lineIndex!==s)c(),s=m.metadata.interactive.lineIndex,a=[f];else if(m)a.push(f);else{let g={...f,verified:!0};l.push(Promise.resolve({body:{breakpoints:[g]}}))}}c();let d=await Promise.all(l),p=JSON.parse(JSON.stringify(d[0]));return d.slice(1).forEach(f=>{var m;p.body.breakpoints=p.body.breakpoints.concat((m=f.body.breakpoints)!=null?m:[])}),p.command="setBreakpoints",p.type="response",p.success=!0,p.request_seq=t.seq,p}return super.sendRequestToJupyterSession(t)}getDumpFilesForDeletion(){return this.cellToDebugFileSortedInReverseOrderByLineNumber.map(t=>t.debugFilePath)}};u();var aee=require("vscode");var DM=class{constructor(e){this.debugCell=e}trace(e,t){b.debug(`[Debug-IWRestart] ${e}: ${t}`)}async willSendResponse(e){e.command==="initialize"&&e.body&&(e.body.supportsRestartRequest=!0)}async willSendRequest(e){if(e.command==="restart")return this.trace("restart","Showing warning for unsupported restart request"),aee.window.showWarningMessage(C.restartNotSupported,{modal:!0}).then(y,y),{command:e.command,request_seq:e.seq,seq:e.seq,success:!0,type:"response"}}};var N_=class extends r_{constructor(t,n,i,o,s,a,l){super(t,n,l);this.platform=i;this.debugLocationTrackerFactory=o;this.configService=s;this.debugService=a}activate(){super.activate(),this.disposables.push(wm.debug.registerDebugAdapterDescriptorFactory(PL,{createDebugAdapterDescriptor:async t=>this.createDebugAdapterDescriptor(t)}))}getDebugMode(t){return 2}async start(t,n){b.ci("Starting debugging IW"),await this.checkIpykernelAndPrompt(n)===1&&await this.startDebuggingCell(t,n)}async startDebuggingCell(t,n){let i=this.configService.getSettings(t.uri),o={type:PL,name:tr(t.uri.toString()),request:"attach",justMyCode:i.debugJustMyCode,__notebookUri:t.uri.toString(),__mode:2,__cellIndex:n.index},s={suppressSaveBeforeStart:!0};await this.startDebuggingConfig(o,s);let a=this.notebookToDebugger.get(t);if(!a){b.error("Debugger not found, could not start debugging.");return}await a.ready}async createDebugAdapterDescriptor(t){let n=t.configuration;ZX(n);let i=wm.workspace.notebookDocuments.find(s=>s.uri.toString()===n.__notebookUri);if(!i||typeof n.__cellIndex!="number"){b.error("Invalid debug session for debugging of IW using Jupyter Protocol");return}if(this.notebookInProgress.has(i)){b.info("Cannot start debugging. Already debugging this notebook");return}if(this.isDebugging(i)){b.info("Cannot start debugging. Already debugging this notebook document. Toolbar should update");return}let o=new wM(i,n,t);this.notebookToDebugger.set(i,o);try{return this.notebookInProgress.add(i),await this.doCreateDebugAdapterDescriptor(n,t,i,o)}finally{this.notebookInProgress.delete(i)}}async doCreateDebugAdapterDescriptor(t,n,i,o){let s=await this.ensureKernelIsRunning(i);if(!(s!=null&&s.session)){wm.window.showInformationMessage(C.kernelWasNotStarted).then(y,y);return}let a=new xM(n,i,s.session,s,this.platform,this.debugService,this.debugLocationTrackerFactory);this.disposables.push(a.onDidEndSession(this.endSession.bind(this)));let l=i.cellAt(t.__cellIndex),c=new CM(a,l,this.kernelProvider.getKernelExecution(s));return a.addDebuggingDelegates([c,new DM(l)]),c.ready.then(()=>o.resolve()).catch(d=>console.error("Failed waiting for controller to be ready",d)),this.trackDebugAdapter(i,a),new wm.DebugAdapterInlineImplementation(a)}async updateSourceMaps(t,n){let i=this.getDebugSession(t.notebook);i&&(b.ci("Sending debug request for source map"),await Promise.all(n.map(async o=>{if(i)return i.customRequest("setPydevdSourceMap",see(o))})))}};N_=E([(0,Su.injectable)(),I(0,(0,Su.inject)(He)),I(1,(0,Su.inject)(Tt)),I(2,(0,Su.inject)(ps)),I(3,(0,Su.inject)(BA)),I(4,(0,Su.inject)(Ae)),I(5,(0,Su.inject)(uo)),I(6,(0,Su.inject)(Kr))],N_);u();var _v=$(te()),lee=require("vscode");var R_=class{constructor(e,t,n,i){this.configService=e;this.fs=t;this.context=n;this.registry=i;this.priority=5}activate(){this.registry.register(this,ht)}async getCode(e){var t;if(!qt(e.kernelConnectionMetadata))return[];if(!xn()){if(this.configService.getSettings(void 0).forceIPyKernelDebugger===!0)return[];if(!er(e.kernelConnectionMetadata))return[]}if(((t=e.notebook)==null?void 0:t.notebookType)===ht){if(!er(e.kernelConnectionMetadata))return[];this.addRunCellHookContents||(this.addRunCellHookContents=this.fs.readFile(lee.Uri.joinPath(this.context.extensionUri,"pythonFiles","vscode_datascience_helpers","kernel","addRunCellHook.py")));let n=await this.addRunCellHookContents;return st(n,{trim:!1})}return[]}};R_=E([(0,_v.injectable)(),I(0,(0,_v.inject)(Ae)),I(1,(0,_v.inject)(wt)),I(2,(0,_v.inject)(ot)),I(3,(0,_v.inject)(Ad))],R_);u();var M_=$(te()),O_=require("vscode");var A_=class{constructor(e,t,n){this.dataScienceCodeLensProvider=e;this.extensionContext=t;this.configurationService=n}activate(){this.configurationService.getSettings().pythonCellFolding&&this.extensionContext.subscriptions.push(O_.languages.registerFoldingRangeProvider([$D],this))}provideFoldingRanges(e,t,n){if([up,zD].includes(e.uri.scheme))return;let i=this.dataScienceCodeLensProvider.getCodeWatcher(e);if(i){let o=i.getCodeLenses();return n.isCancellationRequested||o.length==0?void 0:o.map(s=>new O_.FoldingRange(s.range.start.line,s.range.end.line,O_.FoldingRangeKind.Region))}}};A_=E([(0,M_.injectable)(),I(0,(0,M_.inject)(Im)),I(1,(0,M_.inject)(ot)),I(2,(0,M_.inject)(Ae))],A_);u();var kD=$(te());var cee=require("vscode");var L_=class{constructor(e,t){this.dataScienceCodeLensProvider=e;this.extensionContext=t}activate(){this.extensionContext.subscriptions.push(cee.languages.registerCodeLensProvider([$D],this.dataScienceCodeLensProvider))}};L_=E([(0,kD.injectable)(),I(0,(0,kD.inject)(Im)),I(1,(0,kD.inject)(ot))],L_);u();var Ma=$(te());var Wj="LastInteractiveKernelSelected",K_=class{constructor(e,t,n,i,o){this.controllerRegistration=e;this.interpreterService=t;this.disposables=n;this.workspaceMemento=i;this.serviceContainer=o;this.onControllerSelected=this.controllerRegistration.onControllerSelected}async getInitialController(e,t){if(t){let n=this.controllerRegistration.get(t,ht);if(n)return n}if(this.workspaceMemento.get(Wj)){let n=this.workspaceMemento.get(Wj),i=n?this.controllerRegistration.get(n,ht):void 0;if(i)return i}if(this.interpreterService)return await ASe(ht,e,this.interpreterService,this.controllerRegistration)}getSelectedController(e){return this.controllerRegistration.getSelected(e)}getRegisteredController(e){return this.controllerRegistration.get(e,"interactive")}async createKernel(e,t,n,i,o){await Ta(n,e);let s=(d,p)=>{d!=="start"&&d!=="restart"||b.ci(`(onStart) Looking for controller ${p.controller.id} in ${this.controllerRegistration.all.map(f=>`${f.kind}:${f.id}`).join(", ")}`)},a=await ka.connectToNotebookKernel(e,this.serviceContainer,{resource:n||i.uri,notebook:i,controller:t},new vr(!1),o,"jupyterExtension",s),l=this.controllerRegistration.registered.find(d=>d.id===a.controller.id);if(!l)throw Error(`Controller ${a.controller.id} not found or not yet created`);let c=l.controller;return this.interpreterService&&MSe(a.kernelConnectionMetadata,n,this.interpreterService).then(async d=>{await this.workspaceMemento.update(Wj,d?void 0:a.kernelConnectionMetadata)}).catch(d=>{b.warn("Failed to store kernel connection metadata",d)}),{kernel:a,actualController:c}}};K_=E([(0,Ma.injectable)(),I(0,(0,Ma.inject)(Tt)),I(1,(0,Ma.inject)(im)),I(1,(0,Ma.optional)()),I(2,(0,Ma.inject)(ie)),I(3,(0,Ma.inject)(St)),I(3,(0,Ma.named)(Es)),I(4,(0,Ma.inject)(Kr))],K_);async function ASe(r,e,t,n){let i=await t.getActiveInterpreter(e);if(i){let o=await Mx(i),s=kx.create({kernelSpec:o,interpreter:i,id:KR(o,i)}),a=n.addOrUpdate(s,[r]),l=a[0];return n.trackActiveInterpreterControllers(a),b.ci(`Active Interpreter Controller ${l.connection.kind}:${l.id} created for View ${r} with resource ${ve(e)}`),l}}async function MSe(r,e,t){var i;let n=await t.getActiveInterpreter(e);return(n==null?void 0:n.id)===((i=r.interpreter)==null?void 0:i.id)}function uee(r){r.addSingleton(gs,C_),r.addSingleton(pM,K_),r.addSingleton(Ue,hs),r.add(uM,nr),r.addSingleton(dM,I_),r.addSingleton(Im,S_),r.addSingleton(Ue,L_),r.addSingleton(Ue,A_),r.addSingleton(Ue,__),r.addSingleton(Ue,P_),r.addSingleton(b_,w_,void 0,[Ue]),r.addSingleton(Ra,D_),r.addSingleton(vI,T_),r.addSingleton(fM,N_,void 0,[Ue]),r.addSingleton(Ue,R_)}u();u();var dee=$(te());u();var fo=require("vscode");var PM=class{async normalizeLines(e,t){return e}async getFileToExecute(){let e=fo.window.activeTextEditor;if(!e){fo.window.showErrorMessage("No open file to run in terminal").then(y,y);return}if(e.document.isUntitled){fo.window.showErrorMessage("The active file needs to be saved before it can be run").then(y,y);return}if(e.document.languageId!==Je){fo.window.showErrorMessage("The active file is not a Python source file").then(y,y);return}return e.document.isDirty&&await e.document.save(),e.document.uri}getSelectedTextToExecute(e){if(!e)return;let t=e.selection,n;return t.isEmpty?n=e.document.lineAt(t.start.line).text:t.isSingleLine?n=this.getSingleLineSelectionText(e):n=this.getMultiLineSelectionText(e),Bv(n.trimEnd())}async saveFileIfDirty(e){let t=fo.workspace.textDocuments.filter(n=>n.uri.path===e.path);t.length===1&&t[0].isDirty&&await t[0].save()}getSingleLineSelectionText(e){let t=e.selection,n=new fo.Range(t.start,t.end),i=e.document.getText(n),o=e.document.lineAt(t.start.line).text;return i.trim()===o.trim()?o:i}getMultiLineSelectionText(e){let t=e.selection,n=new fo.Range(t.start,t.end),i=e.document.getText(n),o=new fo.Range(new fo.Position(t.start.line,0),new fo.Position(t.end.line,e.document.lineAt(t.end.line).text.length)),s=e.document.getText(o);if(i.trim()===s.trim())return s;let a=e.document.lineAt(t.start.line).text,l=new fo.Range(t.start,new fo.Position(t.start.line,a.length)),c=e.document.getText(l);return c.trimStart()===a.trimStart()?a+i.substring(c.length):i}};var F_=class extends PM{};F_=E([(0,dee.injectable)()],F_);function pee(r){r.addSingleton(bM,F_)}u();u();var Oa=$(te());u();var Ys=require("vscode");var TM=class{constructor(e,t,n,i,o,s){this.fileConverter=e;this.fs=t;this.interactiveProvider=n;this.controllerRegistration=i;this.preferredKernel=o;this.kernelFinder=s;this.disposables=[]}register(){this.registerCommand(Q.ExportAsPythonScript,(e,t)=>this.export(e,"python",void 0,t)),this.registerCommand(Q.ExportToHTML,(e,t,n)=>this.export(e,"html",t,n)),this.registerCommand(Q.ExportToPDF,(e,t,n)=>this.export(e,"pdf",t,n)),this.registerCommand(Q.Export,(e,t,n)=>this.export(e,void 0,t,n)),this.registerCommand(Q.NativeNotebookExport,e=>this.nativeNotebookExport(e))}dispose(){this.disposables.forEach(e=>e.dispose())}registerCommand(e,t){let n=Ys.commands.registerCommand(e,t,this);this.disposables.push(n)}async nativeNotebookExport(e){var i,o,s;let t=Dn(e)?e:(i=e==null?void 0:e.notebookEditor)==null?void 0:i.notebookUri,n=t?Ys.workspace.notebookDocuments.find(a=>this.fs.arePathsSame(a.uri,t)):(o=Ys.window.activeNotebookEditor)==null?void 0:o.notebook;if(n){let a,l=this.kernelFinder.registered.find(p=>p.kind==="localPythonEnvironment"),c=new Ys.CancellationTokenSource;try{a=l?await this.preferredKernel.findPreferredLocalKernelSpecConnection(n,l,c.token).then(p=>p==null?void 0:p.interpreter):void 0}finally{c.dispose()}let d=((s=this.controllerRegistration.getSelected(n))==null?void 0:s.connection.interpreter)||a;return this.export(n,void 0,void 0,d)}else return this.export(void 0,void 0,void 0,void 0)}async export(e,t,n,i){var o,s,a,l;if(!e){if(e=((o=Ys.window.activeNotebookEditor)==null?void 0:o.notebook)||((a=(s=this.interactiveProvider)==null?void 0:s.getActiveOrAssociatedInteractiveWindow())==null?void 0:a.notebookDocument),!e){b.info("Export called without a valid exportable document active");return}i=i||((l=this.controllerRegistration.getSelected(e))==null?void 0:l.connection.interpreter),t&&J("DATASCIENCE.EXPORT_NOTEBOOK_AS_COMMAND",void 0,{format:t})}if(t)await this.fileConverter.export(t,e,n,i);else{let c=await this.showExportQuickPickMenu(e,n,i).then(d=>d);c!==void 0?c.handler():J("DATASCIENCE.CLICKED_EXPORT_NOTEBOOK_AS_QUICK_PICK")}}getExportQuickPickItems(e,t,n){let i=[];return(n||e.metadata&&OR(Ca(e)))&&i.push({label:C.exportPythonQuickPickLabel,picked:!0,handler:()=>{J("DATASCIENCE.CLICKED_EXPORT_NOTEBOOK_AS_QUICK_PICK",void 0,{format:"python"}),Ys.commands.executeCommand(Q.ExportAsPythonScript,e,n).then(y,y)}}),i.push({label:C.exportHTMLQuickPickLabel,picked:!1,handler:()=>{J("DATASCIENCE.CLICKED_EXPORT_NOTEBOOK_AS_QUICK_PICK",void 0,{format:"html"}),Ys.commands.executeCommand(Q.ExportToHTML,e,t,n).then(y,y)}},{label:C.exportPDFQuickPickLabel,picked:!1,handler:()=>{J("DATASCIENCE.CLICKED_EXPORT_NOTEBOOK_AS_QUICK_PICK",void 0,{format:"pdf"}),Ys.commands.executeCommand(Q.ExportToPDF,e,t,n).then(y,y)}}),i}async showExportQuickPickMenu(e,t,n){let i=this.getExportQuickPickItems(e,t,n),o={ignoreFocusOut:!1,matchOnDescription:!0,matchOnDetail:!0,placeHolder:C.exportAsQuickPickPlaceholder};return Ys.window.showQuickPick(i,o)}};var kM=require("vscode");var U_=class{constructor(e,t,n,i,o,s,a){this.disposables=e;this.fileConverter=t;this.fs=n;this.interactiveProvider=i;this.controllerSelection=o;this.kernelFinder=s;this.jupyterConnection=a;this.exportCommand=new TM(this.fileConverter,this.fs,this.interactiveProvider,o,new $S(a),s),kM.workspace.isTrusted||kM.workspace.onDidGrantWorkspaceTrust(this.registerCommandsIfTrusted,this,this.disposables)}activate(){this.registerCommandsIfTrusted()}registerCommandsIfTrusted(){var e;kM.workspace.isTrusted&&((e=this.exportCommand)==null||e.register())}};U_=E([(0,Oa.injectable)(),I(0,(0,Oa.inject)(ie)),I(1,(0,Oa.inject)(a_)),I(2,(0,Oa.inject)(wt)),I(3,(0,Oa.inject)(gs)),I(3,(0,Oa.optional)()),I(4,(0,Oa.inject)(Tt)),I(5,(0,Oa.inject)(ai)),I(6,(0,Oa.inject)(gn))],U_);u();var _u=$(te()),mo=require("vscode");var W_=class{constructor(e,t,n,i,o){this.interactiveProvider=e;this.kernelProvider=n;this.controllers=i;this.jupyterUriProviderRegistration=o;this.disposables=[];this.isPythonFileActive=!1;t.push(this),this.nativeContext=new mr(br.IsNativeActive),this.canRestartNotebookKernelContext=new mr(br.CanRestartNotebookKernel),this.canInterruptNotebookKernelContext=new mr(br.CanInterruptNotebookKernel),this.canRestartInteractiveWindowKernelContext=new mr(br.CanRestartInteractiveWindowKernel),this.canInterruptInteractiveWindowKernelContext=new mr(br.CanInterruptInteractiveWindowKernel),this.interactiveContext=new mr(br.IsInteractiveActive),this.interactiveOrNativeContext=new mr(br.IsInteractiveOrNativeActive),this.pythonOrNativeContext=new mr(br.IsPythonOrNativeActive),this.pythonOrInteractiveContext=new mr(br.IsPythonOrInteractiveActive),this.pythonOrInteractiveOrNativeContext=new mr(br.IsPythonOrInteractiveOrNativeActive),this.hasNativeNotebookCells=new mr(br.HaveNativeCells),this.isPythonNotebook=new mr(br.IsPythonNotebook),this.isJupyterKernelSelected=new mr(br.IsJupyterKernelSelected),this.hasNativeNotebookOrInteractiveWindowOpen=new mr(br.HasNativeNotebookOrInteractiveWindowOpen),this.kernelSourceContext=new mr(br.KernelSource)}dispose(){this.disposables.forEach(e=>e.dispose())}activate(){var e;mo.window.onDidChangeActiveTextEditor(this.onDidChangeActiveTextEditor,this,this.disposables),this.kernelProvider.onKernelStatusChanged(this.onDidKernelStatusChange,this,this.disposables),this.interactiveProvider&&(this.interactiveProvider.onDidChangeActiveInteractiveWindow(this.onDidChangeActiveInteractiveWindow,this,this.disposables),this.interactiveProvider.activeWindow&&this.onDidChangeActiveInteractiveWindow()),mo.window.activeNotebookEditor&&this.onDidChangeActiveNotebookEditor(mo.window.activeNotebookEditor),mo.window.onDidChangeActiveNotebookEditor(this.onDidChangeActiveNotebookEditor,this,this.disposables),((e=mo.window.activeTextEditor)==null?void 0:e.document.languageId)===Je&&this.onDidChangeActiveTextEditor(mo.window.activeTextEditor),mo.window.onDidChangeNotebookEditorSelection(this.updateNativeNotebookInteractiveWindowOpenContext,this,this.disposables),mo.workspace.onDidOpenNotebookDocument(this.updateNativeNotebookInteractiveWindowOpenContext,this,this.disposables),mo.workspace.onDidCloseNotebookDocument(this.updateNativeNotebookInteractiveWindowOpenContext,this,this.disposables),this.controllers.onControllerSelectionChanged(()=>this.updateSelectedKernelContext(),this,this.disposables),this.updateSelectedKernelContext()}updateNativeNotebookCellContext(){var t;let e=(((t=mo.window.activeNotebookEditor)==null?void 0:t.notebook.cellCount)||0)>0;this.hasNativeNotebookCells.set(e).catch(y)}onDidChangeActiveInteractiveWindow(e){this.interactiveContext.set(!!e).catch(y),this.updateNativeNotebookInteractiveWindowOpenContext(),this.updateMergedContexts(),this.updateContextOfActiveInteractiveWindowKernel()}onDidChangeActiveNotebookEditor(e){let t=e?e.notebook.notebookType===bt:!1;this.nativeContext.set(t).catch(y),this.isPythonNotebook.set(e&&t?OR(Ca(e.notebook)):!1).catch(y),this.updateContextOfActiveNotebookKernel(e),this.updateContextOfActiveInteractiveWindowKernel(),this.updateNativeNotebookInteractiveWindowOpenContext(),this.updateNativeNotebookCellContext(),this.updateMergedContexts()}updateNativeNotebookInteractiveWindowOpenContext(){this.hasNativeNotebookOrInteractiveWindowOpen.set(mo.workspace.notebookDocuments.some(e=>e.notebookType===bt||e.notebookType===ht)).catch(y)}updateContextOfActiveNotebookKernel(e){let t=e&&e.notebook.notebookType===bt?this.kernelProvider.get(e.notebook):void 0;if(t){let n=this.kernelProvider.getKernelExecution(t),i=t.status!=="unknown"||n.executionCount>0||t.startedAtLeastOnce;this.canRestartNotebookKernelContext.set(!!i).catch(y);let o=t.status==="busy";this.canInterruptNotebookKernelContext.set(!!o).catch(y)}else this.canRestartNotebookKernelContext.set(!1).catch(y),this.canInterruptNotebookKernelContext.set(!1).catch(y);this.updateKernelSourceContext(t).catch(y),this.updateSelectedKernelContext()}async updateKernelSourceContext(e){if(!e||!Mt(e.kernelConnectionMetadata)){this.kernelSourceContext.set("").catch(y);return}let t=e.kernelConnectionMetadata,n=await this.jupyterUriProviderRegistration.jupyterCollections.find(i=>i.extensionId===t.serverProviderHandle.extensionId&&i.id===t.serverProviderHandle.id);if(!n){this.kernelSourceContext.set("").catch(y);return}this.kernelSourceContext.set(n.id).catch(y)}updateSelectedKernelContext(){var t,n,i;let e=((t=mo.window.activeNotebookEditor)==null?void 0:t.notebook)||((i=(n=this.interactiveProvider)==null?void 0:n.getActiveOrAssociatedInteractiveWindow())==null?void 0:i.notebookDocument);e&&hr(e)&&this.controllers.getSelected(e)?this.isJupyterKernelSelected.set(!0).catch(y):this.isJupyterKernelSelected.set(!1).catch(y)}updateContextOfActiveInteractiveWindowKernel(){var n,i;let e=(i=(n=this.interactiveProvider)==null?void 0:n.getActiveOrAssociatedInteractiveWindow())==null?void 0:i.notebookDocument,t=e?this.kernelProvider.get(e):void 0;if(t){let o=t.status!=="unknown";this.canRestartInteractiveWindowKernelContext.set(!!o).catch(y);let s=t.status==="busy";this.canInterruptInteractiveWindowKernelContext.set(!!s).catch(y)}else this.canRestartInteractiveWindowKernelContext.set(!1).catch(y),this.canInterruptInteractiveWindowKernelContext.set(!1).catch(y);this.updateSelectedKernelContext()}onDidKernelStatusChange({kernel:e}){var n;let t=e.notebook;t.notebookType===ht?this.updateContextOfActiveInteractiveWindowKernel():t.notebookType===bt&&t===((n=mo.window.activeNotebookEditor)==null?void 0:n.notebook)&&this.updateContextOfActiveNotebookKernel(mo.window.activeNotebookEditor)}onDidChangeActiveTextEditor(e){this.isPythonFileActive=(e==null?void 0:e.document.languageId)===Je&&!P9(e.document.uri),this.updateNativeNotebookCellContext(),this.updateMergedContexts(),this.updateContextOfActiveInteractiveWindowKernel()}updateMergedContexts(){this.interactiveOrNativeContext.set(this.nativeContext.value===!0||this.interactiveContext.value===!0).catch(y),this.pythonOrNativeContext.set(this.nativeContext.value===!0||this.isPythonFileActive===!0).catch(y),this.pythonOrInteractiveContext.set(this.interactiveContext.value===!0||this.isPythonFileActive===!0).catch(y),this.pythonOrInteractiveOrNativeContext.set(this.nativeContext.value===!0||this.interactiveContext.value===!0&&this.isPythonFileActive===!0).catch(y)}};W_=E([(0,_u.injectable)(),I(0,(0,_u.inject)(gs)),I(0,(0,_u.optional)()),I(1,(0,_u.inject)(ie)),I(2,(0,_u.inject)(He)),I(3,(0,_u.inject)(Tt)),I(4,(0,_u.inject)(lr))],W_);u();var Eu=$(te());var Vj=require("vscode");var V_=class{constructor(e,t,n,i){this.disposableRegistry=e;this.configuration=t;this.rawSupported=n;this.commandListeners=i;this.isDisposed=!1;this.startTime=Date.now();this.onSettingsChanged=()=>{let t=this.configuration.getSettings(void 0).sendSelectionToInteractiveWindow;new mr(br.OwnsSelection).set(t).catch(y)}}get activationStartTime(){return this.startTime}activate(){this.onSettingsChanged(),this.changeHandler=this.configuration.getSettings(void 0).onDidChange(this.onSettingsChanged.bind(this)),this.disposableRegistry.push(this),this.disposableRegistry.push(Vj.window.onDidChangeActiveTextEditor(()=>this.onChangedActiveTextEditor())),this.onChangedActiveTextEditor(),this.computeZmqAvailable(),this.commandListeners&&this.commandListeners.forEach(e=>e.register())}async dispose(){this.changeHandler&&(this.changeHandler.dispose(),this.changeHandler=void 0)}computeZmqAvailable(){new mr(br.ZmqAvailable).set(this.rawSupported?this.rawSupported.isSupported:!1).then(y,y)}onChangedActiveTextEditor(){let e=new mr(br.HasCodeCells),t=Vj.window.activeTextEditor;t&&t.document.languageId===Je?e.set(fZ(t.document,this.configuration.getSettings())).catch(y):e.set(!1).catch(y)}};V_=E([(0,Eu.injectable)(),I(0,(0,Eu.inject)(ie)),I(1,(0,Eu.inject)(Ae)),I(2,(0,Eu.inject)(jd)),I(2,(0,Eu.optional)()),I(3,(0,Eu.multiInject)(sy))],V_);u();var xm=$(te()),Cu=require("vscode");var j_=class{constructor(e,t,n){this.jupyterServerHelper=e;this.fileSystem=t;this.errorHandler=n;this.extractPythonMainVersion=async()=>{if(!this.jupyterServerHelper)return 3;let e=await this.jupyterServerHelper.getUsableJupyterPython(),t=await Cp(e);return e&&t&&t.major||3}}async exportToFile(e,t,n=!0){let i=await this.serialize(e);try{if(await this.fileSystem.writeFile(Cu.Uri.file(t),i||""),!n)return;let o=C.exportOpenQuestion1;Cu.window.showInformationMessage(C.exportDialogComplete(t),o).then(async s=>{try{s===o&&await gM(Cu.Uri.file(t))}catch(a){await this.errorHandler.handleError(a)}},y)}catch(o){b.error("Error in exporting notebook file"),Cu.window.showInformationMessage(C.exportDialogFailed(o)).then(y,y)}}async serialize(e,t){var a;let n=await this.extractPythonMainVersion(),i={language_info:{codemirror_mode:{name:"ipython",version:n},file_extension:".py",mimetype:"text/x-python",name:"python",nbconvert_exporter:"python",pygments_lexer:`ipython${n}`,version:n},kernelspec:t},o=(a=Cu.extensions.getExtension("vscode.ipynb"))==null?void 0:a.exports;if(!o)throw new Error("vscode.ipynb extension not found");let s=new Cu.NotebookData(e);return s.metadata={metadata:i,nbformat:wO.major,nbformat_minor:wO.minor},o.exportNotebook(s)}};j_=E([(0,xm.injectable)(),I(0,(0,xm.inject)(qR)),I(0,(0,xm.optional)()),I(1,(0,xm.inject)(wt)),I(2,(0,xm.inject)(Cn))],j_);u();var Vi=$(te()),NM=require("vscode");u();var Cv=$(te()),Ev=require("vscode");var mee=require("vscode");var jj="JUPYTER_API_ACCESS_INFORMATION",fee=new Set([Ge.split(".")[0],"rchiodo","donjayamanne","SynapseVSCode"]),Bj=new Set(["rchiodo","nuant"]),rp=class{constructor(e,t){this.globalState=e;this.context=t;this.extensionAccess=new Map;this.promiseChain=new Fv}async getAccessInformation(e){var s,a;let t=!e.extensionId||e.extensionId===QD?"":e.extensionId.split(".")[0]||"";if(this.context.extensionMode===Ev.ExtensionMode.Test||!t||Kd()==="insiders"){if(!fee.has(t)&&!Bj.has(t)){b.warn(`Publisher ${t} is allowed to access the Kernel API with a message.`);let l=((a=(s=mee.extensions.getExtension(e.extensionId))==null?void 0:s.packageJSON)==null?void 0:a.displayName)||"",c=l&&e.extensionId?`${l} (${e.extensionId})`:e.extensionId||t;Ev.window.showErrorMessage(C.thanksForUsingJupyterKernelApiPleaseRegisterWithUs(c)).then(y,y)}if(!Bj.has(t)||!t||this.context.extensionMode===Ev.ExtensionMode.Test)return{extensionId:e.extensionId,accessAllowed:!0}}if(fee.has(t))return{extensionId:e.extensionId,accessAllowed:!0};if(!Bj.has(t))return Ev.window.showErrorMessage(`Please contact the Jupyter Extension to get access to the Kernel API. Publisher ${t}`).then(y,y),b.error(`Publisher ${t} is not allowed to access the Kernel API.`),{extensionId:e.extensionId,accessAllowed:!1};let n=this.globalState.get(jj),i=n==null?void 0:n.find(l=>l.extensionId===e.extensionId);if(i)return J("DATASCIENCE.JUPYTER_KERNEL_API_ACCESS",void 0,{extensionId:e.extensionId,allowed:i.allowed}),{extensionId:e.extensionId,accessAllowed:i.allowed==="yes"};if(this.extensionAccess.get(e.extensionId))return this.extensionAccess.get(e.extensionId);let o=(async()=>{let l=C.allowExtensionToUseJupyterKernelApi(`${e.displayName} (${e.extensionId})`,Fe.bannerLabelYes),d=await Ev.window.showInformationMessage(l,{modal:!0},Fe.bannerLabelYes,Fe.bannerLabelNo)===Fe.bannerLabelYes;return this.promiseChain.chainFinally(async()=>{let p=[...this.globalState.get(jj,[])];return p=p.filter(f=>f.extensionId!==e.extensionId),p.push({allowed:d?"yes":"no",extensionId:e.extensionId}),this.globalState.update(jj,p)}).then(y,y),J("DATASCIENCE.JUPYTER_KERNEL_API_ACCESS",void 0,{extensionId:e.extensionId,allowed:d?"yes":"no"}),{extensionId:e.extensionId,accessAllowed:d}})();return this.extensionAccess.set(e.extensionId,o),o}};rp=E([(0,Cv.injectable)(),I(0,(0,Cv.inject)(St)),I(0,(0,Cv.named)(ir)),I(1,(0,Cv.inject)(ot))],rp);u();var gee=new WeakMap;function Hj(r){let e=gee.get(r);return e||(e=OSe(r),gee.set(r,e)),e}function OSe(r){return new Proxy(r,{get(e,t){return t==="kernel"?e.kernel?LSe(e.kernel):void 0:Reflect.get(e,t)}})}var hee=new WeakMap;function LSe(r){let e=hee.get(r);return e||(e=KSe(r),hee.set(r,e)),e}function KSe(r){return new Proxy(r,{get(e,t){return t==="registerCommTarget"?(n,i)=>(sX(r,n),Reflect.get(e,t).apply(e,[n,i])):t==="removeCommTarget"?(n,i)=>(aX(r,n),Reflect.get(e,t).apply(e,[n,i])):Reflect.get(e,t)}})}var B_=class{constructor(e,t,n,i,o,s,a,l){this.kernelProvider=e;this.kernelFinder=t;this.thirdPartyKernelProvider=n;this.disposables=i;this.controllerRegistration=o;this.apiAccess=s;this.extensions=a;this.serviceContainer=l;this.chainedApiAccess=new Fv;this.extensionApi=new Map}async getService(){let e=this.extensions.determineExtensionFromCallStack(),t=await this.chainedApiAccess.chainFinally(()=>this.apiAccess.getAccessInformation(e));if(!t.accessAllowed)return;if(this.extensionApi.get(t.extensionId))return this.extensionApi.get(t.extensionId);let n=new ND(t.extensionId,this.kernelProvider,this.kernelFinder,this.thirdPartyKernelProvider,this.disposables,this.controllerRegistration,this.serviceContainer);return this.extensionApi.set(t.extensionId,n),n}};B_=E([(0,Vi.injectable)(),I(0,(0,Vi.inject)(He)),I(1,(0,Vi.inject)(ai)),I(2,(0,Vi.inject)(Wh)),I(3,(0,Vi.inject)(ie)),I(4,(0,Vi.inject)(Tt)),I(5,(0,Vi.inject)(rp)),I(6,(0,Vi.inject)(Ba)),I(7,(0,Vi.inject)(Kr))],B_);var ND=class{constructor(e,t,n,i,o,s,a){this.callingExtensionId=e;this.kernelProvider=t;this.kernelFinder=n;this.thirdPartyKernelProvider=i;this.disposables=o;this.controllerRegistration=s;this.serviceContainer=a;this._onDidChangeKernelSpecifications=new NM.EventEmitter;this._onDidChangeKernels=new NM.EventEmitter;this.translatedConnections=new WeakMap;this._onDidChangeStatus=new NM.EventEmitter;this._status=this.kernelFinder.status,this.kernelFinder.onDidChangeStatus(()=>{this._status=this.kernelFinder.status,this._onDidChangeStatus.fire()},this,o),this.kernelProvider.onDidDisposeKernel(l=>{var c;b.ci(`Kernel ${l.kernelConnectionMetadata.id}, ${(c=l.kernelConnectionMetadata.interpreter)==null?void 0:c.uri.toString()} disposed`),this._onDidChangeKernels.fire()},this,o),this.kernelProvider.onDidStartKernel(l=>{var c;b.ci(`Kernel ${l.kernelConnectionMetadata.id}, ${(c=l.kernelConnectionMetadata.interpreter)==null?void 0:c.uri.toString()} started`),this._onDidChangeKernels.fire()},this,o),this.thirdPartyKernelProvider.onDidDisposeKernel(l=>{var c;b.ci(`Third party Kernel ${l.kernelConnectionMetadata.id}, ${(c=l.kernelConnectionMetadata.interpreter)==null?void 0:c.uri.toString()} disposed`),this._onDidChangeKernels.fire()},this,o),this.thirdPartyKernelProvider.onDidStartKernel(l=>{var c;b.ci(`Third party Kernel ${l.kernelConnectionMetadata.id}, ${(c=l.kernelConnectionMetadata.interpreter)==null?void 0:c.uri.toString()} started`),this._onDidChangeKernels.fire()},this,o),this.controllerRegistration.onDidChange(()=>this._onDidChangeKernelSpecifications.fire(),this,o)}get onDidChangeKernelSpecifications(){return J("DATASCIENCE.JUPYTER_KERNEL_API_USAGE",void 0,{extensionId:this.callingExtensionId,pemUsed:"onDidChangeKernelSpecifications"}),b.debug(`API called from ${this.callingExtensionId}`),this._onDidChangeKernelSpecifications.event}get onDidChangeKernels(){return J("DATASCIENCE.JUPYTER_KERNEL_API_USAGE",void 0,{extensionId:this.callingExtensionId,pemUsed:"onDidChangeKernels"}),this._onDidChangeKernels.event}get status(){return this._status}get onDidChangeStatus(){return this._onDidChangeStatus.event}async getKernelSpecifications(){return J("DATASCIENCE.JUPYTER_KERNEL_API_USAGE",void 0,{extensionId:this.callingExtensionId,pemUsed:"getKernelSpecifications"}),this.kernelFinder.kernels.map(e=>this.translateKernelConnectionMetadataToExportedType(e))}getActiveKernels(){J("DATASCIENCE.JUPYTER_KERNEL_API_USAGE",void 0,{extensionId:this.callingExtensionId,pemUsed:"getActiveKernels"});let e=[],t=new Set;return this.kernelProvider.kernels.filter(n=>n.startedAtLeastOnce||n.kernelConnectionMetadata.kind==="connectToLiveRemoteKernel").forEach(n=>{var o,s;let i=this.kernelProvider.get(n.notebook);i&&((s=(o=i.session)==null?void 0:o.kernel)!=null&&s.id)&&t.add(i.session.kernel.id),e.push({metadata:this.translateKernelConnectionMetadataToExportedType(n.kernelConnectionMetadata),uri:n.uri,id:n.id})}),this.thirdPartyKernelProvider.kernels.filter(n=>n.startedAtLeastOnce||n.kernelConnectionMetadata.kind==="connectToLiveRemoteKernel").forEach(n=>{var o,s;let i=this.thirdPartyKernelProvider.get(n.uri);i&&((s=(o=i.session)==null?void 0:o.kernel)!=null&&s.id)&&t.add(i.session.kernel.id),e.push({metadata:this.translateKernelConnectionMetadataToExportedType(n.kernelConnectionMetadata),uri:n.uri,id:n.id})}),this.controllerRegistration.registered.forEach(n=>{n.controller.notebookType===bt&&n.connection.kind==="connectToLiveRemoteKernel"&&(!n.connection.kernelModel.id||t.has(n.connection.kernelModel.id)||e.push({metadata:n.connection,uri:void 0,id:n.id}))}),e}getKernel(e){var n;J("DATASCIENCE.JUPYTER_KERNEL_API_USAGE",void 0,{extensionId:this.callingExtensionId,pemUsed:"getKernel"});let t=(n=this.thirdPartyKernelProvider.get(e))!=null?n:this.kernelProvider.get(e);if(t!=null&&t.session)return{metadata:this.translateKernelConnectionMetadataToExportedType(t.kernelConnectionMetadata),connection:Hj(t.session)}}async startKernel(e,t){return J("DATASCIENCE.JUPYTER_KERNEL_API_USAGE",void 0,{extensionId:this.callingExtensionId,pemUsed:"startKernel"}),this.startOrConnect(e,t)}async connect(e,t){return J("DATASCIENCE.JUPYTER_KERNEL_API_USAGE",void 0,{extensionId:this.callingExtensionId,pemUsed:"connect"}),this.startOrConnect(e,t)}async startOrConnect(e,t){let n=this.kernelFinder.kernels.find(o=>o.id===e.id);if(!n)throw new Error("Not found");let i=await ka.connectToKernel(n,this.serviceContainer,{resource:t},new vr(!1),this.disposables,"3rdPartyExtension");if(!(i!=null&&i.session))throw new Error("Not found");return Hj(i.session)}translateKernelConnectionMetadataToExportedType(e){if(!this.translatedConnections.has(e)){let t=Object.freeze(Yc.fromJSON(e.toJSON()));this.translatedConnections.set(e,t)}return this.translatedConnections.get(e)}};ND=E([I(1,(0,Vi.inject)(He)),I(2,(0,Vi.inject)(ai)),I(3,(0,Vi.inject)(Wh)),I(4,(0,Vi.inject)(ie)),I(5,(0,Vi.inject)(Tt)),I(6,(0,Vi.inject)(Kr))],ND);u();var J_=$(te());var H_=class{constructor(e){this.syncActivationServices=e}activate(){this.syncActivationServices.map(e=>{try{e.activate()}catch(t){b.error(`Error in activating extension, failed in ${e.constructor.name}`,t)}})}};H_=E([(0,J_.injectable)(),I(0,(0,J_.optional)()),I(0,(0,J_.multiInject)(Ue))],H_);u();u();var $l=require("vscode");function vee(r,e){e&&$l.commands.registerCommand("dataScience.ClearCache",async()=>{let t=[];for(let n of r.globalState.keys())t.push(r.globalState.update(n,void 0).then(y,y));for(let n of r.workspaceState.keys())t.push(r.workspaceState.update(n,void 0).then(y,y));t.push($l.commands.executeCommand(Q.ClearSavedJupyterUris).then(y,y)),await Promise.all(t).catch(y),await Promise.all([$l.workspace.fs.delete($l.Uri.joinPath(r.globalStorageUri,"lastExecutedRemoteCell.json")).then(y,y),$l.workspace.fs.delete($l.Uri.joinPath(r.globalStorageUri,"remoteServersMRUList.json")).then(y,y),$l.workspace.fs.delete($l.Uri.joinPath(r.globalStorageUri,yS)).then(y,y)]),b.info("Cache cleared")})}function yee(r,e){vee(r,e)}u();u();var MM=$(te()),zt=require("vscode");var RM=C.percentPipCondaInstallInsteadOfBang("pip"),Jj=C.percentPipCondaInstallInsteadOfBang("conda"),bee=C.matplotlibWidgetInsteadOfOther,AM="Jupyter",q_=class{constructor(e){this.disposables=[];this.notebooksProcessed=new WeakMap;this.cellsToProcess=new Set;this.problems=zt.languages.createDiagnosticCollection(AM),this.disposables.push(this.problems),e.push(this)}dispose(){fe(this.disposables),this.problems.dispose()}activate(){this.disposables.push(zt.languages.registerCodeActionsProvider(Je,this)),this.disposables.push(zt.languages.registerHoverProvider(Je,this)),zt.workspace.onDidChangeTextDocument(t=>{let n=rI(t.document);if(!n)return;let i=n.getCells().find(o=>o.document===t.document);i&&this.analyzeNotebookCell(i)},this,this.disposables),zt.workspace.onDidCloseNotebookDocument(t=>{this.problems.delete(t.uri);let n=this.notebooksProcessed.get(t);this.notebooksProcessed.delete(t),n&&n.forEach((i,o)=>this.problems.delete(zt.Uri.parse(o)))},this,this.disposables),zt.workspace.onDidOpenNotebookDocument(t=>this.analyzeNotebook(t),this,this.disposables);let e=new ec(300);this.disposables.push(e),zt.workspace.onDidChangeNotebookDocument(t=>{e.trigger(()=>{let n=this.notebooksProcessed.get(t.notebook);t.contentChanges.forEach(i=>{i.removedCells.forEach(o=>{n==null||n.delete(o.document.uri.toString())}),i.addedCells.forEach(o=>this.queueCellForProcessing(o))}),t.cellChanges.forEach(i=>this.queueCellForProcessing(i.cell))})},this,this.disposables),zt.workspace.notebookDocuments.map(t=>this.analyzeNotebook(t))}provideHover(e,t,n){let i=rI(e);if((i==null?void 0:i.notebookType)!==bt)return;let o=this.problems.get(e.uri);if(!o)return;let s=o.find(l=>l.message===RM||l.message===Jj);if(!s||!s.range.contains(t))return;let a=s.message===RM?"pip":"conda";return new zt.Hover(C.pipCondaInstallHoverWarning(a,"https://aka.ms/jupyterCellMagicBangInstall"),s.range)}provideCodeActions(e,t,n,i){if(!rI(e))return[];let o=[];return n.diagnostics.forEach(s=>{switch(s.message){case RM:o.push(this.createReplaceCodeAction(e,"pip",s));break;case Jj:o.push(this.createReplaceCodeAction(e,"conda",s));break;case bee:o.push(this.createGotoWikiAction(e,zt.Uri.parse("https://aka.ms/vscodejupytermatplotlibwidget"),s));break;default:break}}),o}createReplaceCodeAction(e,t,n){let i=new zt.CodeAction(C.replacePipCondaInstallCodeAction(t),zt.CodeActionKind.QuickFix);i.isPreferred=!0,i.diagnostics=[n];let o=new zt.WorkspaceEdit;return o.replace(e.uri,new zt.Range(n.range.start,new zt.Position(n.range.start.line,n.range.start.character+1)),"%"),i.edit=o,i}createGotoWikiAction(e,t,n){let i=new zt.CodeAction(C.matplotlibWidgetCodeActionTitle,zt.CodeActionKind.QuickFix);return i.isPreferred=!0,i.diagnostics=[n],i.command={title:C.matplotlibWidgetCodeActionTitle,command:"vscode.open",arguments:[t]},i}analyzeNotebook(e){e.notebookType===bt&&e.getCells().forEach((t,n)=>n<100?this.queueCellForProcessing(t):void 0)}queueCellForProcessing(e){this.cellsToProcess.add(e),this.analyzeNotebookCells()}analyzeNotebookCells(){if(this.cellsToProcess.size===0)return;let e=this.cellsToProcess.values().next().value;this.cellsToProcess.delete(e),this.analyzeNotebookCell(e),setTimeout(()=>this.analyzeNotebookCells(),0)}analyzeNotebookCell(e){var n;if(e.kind!==zt.NotebookCellKind.Code||e.document.languageId!==Je||e.notebook.isClosed||e.document.isClosed||((n=this.notebooksProcessed.get(e.notebook))==null?void 0:n.get(e.document.uri.toString()))===e.document.version)return;this.problems.delete(e.document.uri);let t=this.notebooksProcessed.get(e.notebook)||new Map;t.set(e.document.uri.toString(),e.document.version),this.notebooksProcessed.set(e.notebook,t);for(let i=0;i<Math.min(e.document.lineCount,50);i++){let o=e.document.lineAt(i),s=o.text;if(s.trim().startsWith("!pip install")){let a=s.indexOf("!"),l=s.indexOf("l"),c=new zt.Range(o.lineNumber,a,o.lineNumber,l+2);this.problems.set(e.document.uri,[{message:RM,range:c,severity:zt.DiagnosticSeverity.Error,source:AM}])}else if(s.trim().startsWith("!conda install")){let a=s.indexOf("!"),l=s.indexOf("l"),c=new zt.Range(o.lineNumber,a,o.lineNumber,l+2);this.problems.set(e.document.uri,[{message:Jj,range:c,severity:zt.DiagnosticSeverity.Error,source:AM}])}else if(s.trim().startsWith("%matplotlib")&&!s.trim().endsWith("widget")&&!s.trim().endsWith("inline")){let a=s.indexOf("%"),l=s.length,c=new zt.Range(o.lineNumber,a,o.lineNumber,l);this.problems.set(e.document.uri,[{message:bee,range:c,severity:zt.DiagnosticSeverity.Warning,source:AM}])}}}};q_=E([(0,MM.injectable)(),I(0,(0,MM.inject)(ie))],q_);u();var UM=$(te()),Sr=require("vscode");u();var Iee=new Map([["method",0],["function",1],["constructor",2],["field",3],["variable",4],["class",5],["struct",6],["interface",7],["module",8],["property",9],["event",10],["operator",11],["unit",12],["value",13],["constant",14],["enum",15],["enumMember",16],["keyword",17],["text",18],["color",19],["file",20],["reference",21],["customcolor",22],["folder",23],["typeParameter",24],["snippet",25],["<unknown>",3]]);u();function OM(r){if(r>=300)return"ZZZZZZZ";if(r<=25)return`A${String.fromCharCode(65+r)}`;let e=String.fromCharCode(65+Math.ceil(r/25)),t=String.fromCharCode(65+r%25);return`${e}${t}`}u();var Dee=require("vscode");u();var wv=require("vscode");var FSe=new Map([["julia",jSe],["python",WSe],["r",BSe]]);function See(r,e){let t=FSe.get(e.toLowerCase());return t?t(r):r}var USe=["Docstring:","Options:","Parameters","Returns","See Also","Notes","Examples","Usage:","Subclasses:"];function WSe(r){let e=st(r,{trim:!1,removeEmptyEntries:!1}),t=-1,n=!1,i=!1,o=[],s=new Set,a=!1,l="",c=!1,d=!1;if(e.map((f,m)=>{if(m===0){let h=["Signature:","Init signature:"].find(v=>f.toLowerCase().startsWith(v.toLowerCase()));if(h){n=!0,f=f.substring(h.length).trim(),o.push("```python"),f.trim().length&&(o.push(f),c=!0);return}}if(f.startsWith("File:")&&m===e.length-1||f.startsWith("Type:")&&m===0)return;if(!a&&f.toLowerCase().startsWith("String form:".toLowerCase())){i=!0;return}let g=USe.find(h=>f.trim().toLowerCase().startsWith(h.toLowerCase()));if(g&&!s.has(g)){l=g.toLowerCase(),s.add(g),a=!0,t=m,i=!1,n&&o.push("```","----------"),n=!1,d=!1,l!=="docstring:"&&o.push(`## ${g}`);let h=f.includes(":")?f.split(":")[1].replace("<no docstring>","").trim():"";h.length&&(o.push(h),c=!0);return}if(!i){if(t+1===m&&f.replace(/-/g,"").replace(/:/g,"").replace("<no docstring>","").trim().length===0){t=m,i=!1,n=!1,d=!1;return}if(l==="parameters"||l==="see also"){f.trim().length&&f.includes(":")&&f.substring(0,1)===f.trim().substring(0,1)?o.push(`* ${f}`):o.push(f),c=c||f.trim().length>0;return}if(l==="options:"){f.startsWith("-")&&f.trim().length&&f.includes(":")&&f.substring(0,1)===f.trim().substring(0,1)?o.push(`* ${f}`):o.push(f),c=c||f.trim().length>0;return}if(l==="returns"){f.trim().length&&f.substring(0,1)===f.trim().substring(0,1)?o.push(`* ${f}`):o.push(f),c=c||f.trim().length>0;return}if(l==="examples"&&!n&&(t+1===m||t+2===m))return i=!1,n=!0,c=c||f.trim().length>0,o.push("```python",f);if(!n&&f.startsWith("class ")&&f.trim().endsWith("):")){n=!0,d=!0,o.push("```python",f),c=c||f.trim().length>0;return}if(n&&d&&f.trim().length>0&&f.substring(0,1)!==" "&&f.substring(0,1)!=="	")return n=!1,d=!1,o.push(f,"```");c=c||f.trim().length>0,o.push(f)}}),!c)return"";let p=o.join(`  
`);return n?new wv.MarkdownString(p+"  \n```"):new wv.MarkdownString(p)}var VSe=[{section:"Examples:",header:"Examples",nextLine://g},{section:"Usage note",header:"Usage note",nextLine://g},{section:"Note:",header:"\u2502 Note",nextLine:"\u2502"},{section:"Note:",header:"\u2502 Note",nextLine:String.fromCharCode(9474)}];function jSe(r){let e=st(r,{trim:!1,removeEmptyEntries:!1}),t=!1,n=[],i=new Set,o="",s=!1,a=!1;e.every(c=>c.trim().length===0||c.startsWith("  "))&&e.forEach((c,d)=>e[d]=c.trim().length?c.substring(2):c),e.map((c,d)=>{if(c.trim()==="\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500")return a=!1,n.push(c);if(!a)return o="signature",t=!0,a=!0,c.trim().length?(s=!0,n.push("```julia",c)):n.push("```julia");o==="signature"&&c.trim()===""&&(o="",t=!1,s=!1,n.push("```"));let p=VSe.find(f=>c.trim().toLowerCase().startsWith(f.header.toLowerCase()));if(p&&(typeof p.nextLine=="string"?e[d+1].trim()===p.nextLine.trim():e[d+1].trim().replace(p.nextLine,"").length===0)){e[d+1]="",o=p.section.toLowerCase(),i.add(p.header),t&&n.push("```"),t=!1,n.push(`## ${p.section}`),o==="note:"&&!e.slice(d+1).every(f=>f.trim().length===0||f.trim().startsWith("|")||f.trim().startsWith(String.fromCharCode(9474)))&&(o="");return}if(o==="examples:"&&!t)return t=!0,c.trim().length?(s=!0,n.push("```julia",c)):n.push("```julia");if(o==="note:"){n.push(c.trim()?c.trim().substring(1):"");return}t&&!s&&c.trim().length===0||n.push(c)});let l=n.join(`  
`);return t?new wv.MarkdownString(l+"  \n```"):new wv.MarkdownString(l)}function BSe(r){let e=st(r,{trim:!1,removeEmptyEntries:!1}),t=[];e.forEach((a,l)=>e[l]=a.indexOf("     ")===0?a.substring(5):a);let n="",i=!1,o=!1;e.map(a=>{let l=a.replace(/_/g,"").trim();if(a.startsWith("_")&&a.includes(String.fromCharCode(8))&&a.split("_").length===a.split(String.fromCharCode(8)).length&&l){i&&t.push("```"),i=!1,n=l.trim().toLowerCase(),t.push(`## ${l}`);return}if((n==="examples"||n==="examples:"||n==="usage"||n==="usage:")&&!i)return i=!0,a.trim().length?(o=!0,t.push("```r",a)):t.push("```r");if(n==="note:"){t.push(a.trim()?a.trim().substring(1):"");return}i&&!o&&a.trim().length===0||t.push(a)});let s=t.join(`  
`);return i?new wv.MarkdownString(s+"  \n```"):new wv.MarkdownString(s)}u();var _ee=new WeakMap;async function xv(r,e,t){var f;let n=_ee.get(r)||0;_ee.set(r,n+1);let i=JR(Ge,r),o=`application/vnd.vscode.bg.execution.${n}`,s=`application/vnd.vscode.bg.execution.${n}.result`,a=`application/vnd.vscode.bg.execution.${n}.error`,l="",c=`
def __jupyter_exec_background__():
    from IPython.display import display
    from threading import Thread
    from traceback import format_exc

    # First send a dummy response to get the display id.
    # Later we'll send the real response with the actual data.
    # And that can happen much later even after the execution completes,
    # as that response will be sent from a bg thread.
    output = display({"${o}": ""}, raw=True, display_id=True)

    def do_implementation():
        ${e.map((m,g)=>g===0?m:`        ${m}`).join(`
`)}

    def bg_main():
        try:
            output.update({"${s}": do_implementation()}, raw=True)
        except Exception as e:
            output.update({"${a}": format_exc()}, raw=True)


    Thread(target=bg_main, daemon=True).start()


__jupyter_exec_background__()
del __jupyter_exec_background__
`.trim(),d=new Pn;d.add(t.onCancellationRequested(()=>d.dispose()));let p=Fs(t,new Promise((m,g)=>{d.add(i.onDidReceiveDisplayUpdate(async h=>{var _;if(t.isCancellationRequested)return m(void 0);let v=Vh(h);if(!l||((_=v==null?void 0:v.transient)==null?void 0:_.display_id)!==l)return;let S=h.items.find(D=>D.mime===s);if(S)try{return m(JSON.parse(new TextDecoder().decode(S.data)))}catch(D){return g(new Error("Failed to parse the result",D))}}))})).finally(()=>{r.session&&V$(r.session,l),d.dispose()});for await(let m of i.executeCode(c,t)){if(t.isCancellationRequested)return;let g=Vh(m);if(!((f=g==null?void 0:g.transient)!=null&&f.display_id))continue;if(m.items.find(v=>v.mime===o)){l=g.transient.display_id;continue}if(l===g.transient.display_id){let v=m.items.find(S=>S.mime===s||S.mime===a);if((v==null?void 0:v.mime)===s)return JSON.parse(new TextDecoder().decode(v.data));if((v==null?void 0:v.mime)===a){b.warn(`Error in background execution:
`,new TextDecoder().decode(v.data));return}}}if(!t.isCancellationRequested){if(!l){b.warn("Failed to get display id for completions");return}return p}}var HSe=1,Dm=pi.IntellisenseResolveTimeout,Eee=5,qj=new WeakSet,LM=class extends Error{constructor(){super("Request timed out")}};async function Pee(r,e,t,n,i,o,s,a){var p;if(!r.range||!((p=n.session)!=null&&p.kernel)||qj.has(n)||!qt(n.kernelConnectionMetadata)&&n.status!=="idle")return r;let l=e_e(e||r,s,a),c=ZSe(l,n,t),d=iz(t);try{let f=await Uv(Dm,new LM,Fs(d.token,c));if(!t.isCancellationRequested&&(f==null?void 0:f.status)==="ok"&&(f!=null&&f.found)){let m=JSe(f);r.documentation=See(m,o)}}catch(f){if(f instanceof Dee.CancellationError)return r;f instanceof LM&&(d.cancel(),qSe(n,o,i))}finally{d.dispose()}return r}function JSe(r){return!r||r.status!=="ok"||!r.found?";":!r.data||typeof r.data!="object"?"":"text/plain"in r.data?fu(r.data["text/plain"]):""}var Cee=new WeakSet;function qSe(r,e,t){qt(r.kernelConnectionMetadata)||qj.has(r)||(qj.add(r),b.warn(`Failed to inspect code in kernel ${ct(r.kernelConnectionMetadata)}`),Cee.has(r)||(Cee.add(r),J("DATASCIENCE.JUPYTER_KERNEL_CODE_COMPLETION_CANNOT_RESOLVE",void 0,{kernelId:t,kernelConnectionType:r.kernelConnectionMetadata.kind,kernelLanguage:e})))}var Gj=new WeakMap,Yj=new WeakMap;async function GSe(r,e,t){let n=`return get_ipython().kernel.do_inspect("${Ox(e.code)}", ${e.cursor_pos}, ${e.detail_level})`;return{content:await xv(r,[n],t)}}var wee={data:{},found:!1,status:"ok",metadata:{}};function YSe(r,e){var i;if(!((i=r.session)!=null&&i.kernel))return;let t=JSON.stringify(e),n=Gj.get(r.session.kernel);return n==null?void 0:n.get(t)}function $Se(r,e,t){var o;if(!((o=r.session)!=null&&o.kernel)||t.status!=="ok"||!t.found)return;let n=JSON.stringify(e),i=Gj.get(r.session.kernel)||new Map;Gj.set(r.session.kernel,i),i.size>100&&i.clear(),i.set(n,t)}function zSe(r){var t;if(!((t=r.session)!=null&&t.kernel))return!1;let e=Yj.get(r.session.kernel)||{maxTime:0,lastRequestTime:0,numberOfTimesMaxedOut:0};return!qt(r.kernelConnectionMetadata)&&e.maxTime>Dm?(b.warn(`Not sending inspect request as previous requests took over ${Dm}s.`),!1):e.numberOfTimesMaxedOut>Eee?(b.warn(`Not sending inspect request as there have been at least ${Eee} requests that took over ${Dm}s.`),!1):e.maxTime>Dm&&Date.now()-e.lastRequestTime<3e4?(b.warn(`Not sending inspect request as previous requests took over ${Dm}s.`),!1):!0}async function QSe(r,e){var i;if(!((i=r.session)!=null&&i.kernel)||!xee(r))return;b.info(`Too many pending requests ${Tee(r)} for kernel ${r.id}, waiting for it to be ready.`);let t=r.session.kernel,n=new Pn;await Fs(e,new Promise(o=>{let s=()=>{if(e.isCancellationRequested)return;if(!xee(r)){o(),fe(n);return}let a=setTimeout(s,100);n.add({dispose:()=>clearTimeout(a)})};n.add(xh(e.onCancellationRequested)(()=>{o(),t.statusChanged.disconnect(s)})),t.statusChanged.connect(s),n.add({dispose:()=>{t.statusChanged.disconnect(s)}})})).finally(()=>fe(n))}function XSe(r,e){var n;if(!((n=r.session)!=null&&n.kernel))return;let t=Yj.get(r.session.kernel)||{maxTime:0,lastRequestTime:0,numberOfTimesMaxedOut:0};t.maxTime=Math.max(t.maxTime,e),t.lastRequestTime=Date.now(),e>Dm&&(t.numberOfTimesMaxedOut+=1),Yj.set(r.session.kernel,t)}async function ZSe(r,e,t){var l;if(!((l=e.session)!=null&&l.kernel))return;let n=YSe(e,r);if(n)return n;if(!zSe(e)||(await QSe(e,t),t.isCancellationRequested))return wee;let i=t_e(e),o=new It,s=st(r.code).reverse()[0].slice(-50);b.trace(`Inspecting code ${s}`);let a=qt(e.kernelConnectionMetadata)?GSe(e,r,t):e.session.kernel.requestInspect(r);return a.finally(()=>i.dispose()),a.then(({content:c})=>{var p;if(!((p=e.session)!=null&&p.kernel))return;$Se(e,r,c),XSe(e,o.elapsedTime);let d=o.elapsedTime>Dm?b.warn:b.debug;return t.isCancellationRequested?d(`Inspected code ${s} in ${o.elapsedTime}ms (but cancelled)`):d(`Inspected code ${s} in ${o.elapsedTime}ms`),c})}function e_e(r,e,t){var l;let n=e.getText(),i=(typeof r.insertText=="string"?r.insertText:(l=r.insertText)==null?void 0:l.value)||(typeof r.label=="string"?r.label:r.label.label)||"",o=n.substring(0,t.character)+i,s=t.character+i.length;return{code:o,cursor_pos:s,detail_level:0}}var RD=new WeakMap;function xee(r){var e;return(e=r.session)!=null&&e.kernel?Tee(r)>=HSe:!1}function Tee(r){var e,t,n,i,o;return(e=r.session)!=null&&e.kernel?(RD.has((t=r.session)==null?void 0:t.kernel)||RD.set((n=r.session)==null?void 0:n.kernel,{count:0}),((o=RD.get((i=r.session)==null?void 0:i.kernel))==null?void 0:o.count)||0):0}function t_e(r){var t,n,i;if(!((t=r.session)!=null&&t.kernel))return{dispose:y};let e=RD.get((n=r.session)==null?void 0:n.kernel)||{count:0};return RD.set((i=r.session)==null?void 0:i.kernel,e),e.count+=1,{dispose:()=>{e.count-=1}}}var FM=class extends Error{constructor(){super("Request timed out")}},$j=class{constructor(e,t,n){this.kernelId=e;this.kernel=t;this.monacoLanguage=n;this.pendingCompletionRequest=new WeakMap;this.previousCompletionItems=new WeakMap}async provideCompletionItems(e,t,n,i){var a;if(!((a=this.kernel.session)!=null&&a.kernel))return[];let o=e.version;if(this.pendingCompletionRequest.has(e))return[];this.pendingCompletionRequest.set(e,{position:t,version:o});let s=new Sr.Disposable(()=>{var l,c;(l=this.pendingCompletionRequest.get(e))!=null&&l.position.isEqual(t)&&((c=this.pendingCompletionRequest.get(e))==null?void 0:c.version)===o&&this.pendingCompletionRequest.delete(e)});try{let l=Ru(Fs(n,Promise.resolve(Sr.commands.executeCommand("vscode.executeCompletionItemProvider",e.uri,t)).then(m=>(m==null?void 0:m.items)||[]))),c=new It;if(await tc(50),n.isCancellationRequested)return[];let d=await Uv(pi.IntellisenseTimeout,new FM,this.provideCompletionItemsFromKernel(e,t,n,i));if(n.isCancellationRequested||!d||!d.length)return[];let p=await ho(0,l.promise);qt(this.kernel.kernelConnectionMetadata)&&!l.completed&&c.elapsedTime<pi.IntellisenseTimeout+50&&(p=await ho(pi.IntellisenseTimeout-c.elapsedTime,l.promise));let f=new Set((p||[]).map(m=>typeof m.label=="string"?m.label:m.label.label));return d.filter(m=>!f.has(typeof m.label=="string"?m.label:m.label.label))}catch(l){if(l instanceof FM)return[];throw l instanceof Sr.CancellationError||b.debug("Completions failed",l),l}finally{s.dispose()}}async provideCompletionItemsFromKernel(e,t,n,i){var v,S,_,D,P;if(n.isCancellationRequested||!((v=this.kernel.session)!=null&&v.kernel))return[];let o=new It,s={duration:0,timesExceededTimeout:0,requestDuration:0,completionItems:0},a={kernelId:this.kernelId,kernelConnectionType:this.kernel.kernelConnectionMetadata.kind,kernelLanguage:VM(this.kernel),monacoLanguage:this.monacoLanguage,cancelled:!1,kernelStatusBeforeRequest:this.kernel.status,completed:!1,requestSent:!1};if(!qt(this.kernel.kernelConnectionMetadata)&&this.kernel.status!=="idle")return[];let l=e.getText(),c=e.offsetAt(t);a.requestSent=!0;let d=await Fs(n,this.getKernelCompletion(l,c,n));if(b.debug(`Jupyter completion time: ${o.elapsedTime}`),a.cancelled=n.isCancellationRequested,a.completed=!n.isCancellationRequested,a.kernelStatusAfterRequest=this.kernel.status,s.requestDuration=n.isCancellationRequested?0:o.elapsedTime,n.isCancellationRequested)return[];if(((S=d==null?void 0:d.content)==null?void 0:S.status)!=="ok"||((P=(D=(_=d==null?void 0:d.content)==null?void 0:_.matches)==null?void 0:D.length)!=null?P:0)===0)return Nee(this.kernel,s,a),[];let p={matches:d.content.matches,cursor:{start:d.content.cursor_start,end:d.content.cursor_end},metadata:d.content.metadata},f=p.metadata?p.metadata._jupyter_types_experimental:[];s.completionItems=p.matches.length,Nee(this.kernel,s,a);let m={code:l,cursor:p.cursor,documentRef:new WeakRef(e),position:e.positionAt(p.cursor.start)},g=new Sr.Range(e.positionAt(p.cursor.start),e.positionAt(p.cursor.end)),h=[];return Array.isArray(f)&&f.length>=p.matches.length&&f.every(M=>M&&typeof M.text=="string")?h=d.content.matches.map((M,x)=>{let A=f[x],j=A.type?Iee.get(A.type):Sr.CompletionItemKind.Field,re=new Sr.CompletionItem(M,j);return typeof A.start=="number"&&typeof A.end=="number"?re.range=new Sr.Range(e.positionAt(A.start),e.positionAt(A.end)):re.range=g,re.insertText=A.text,re.sortText=OM(x),qt(this.kernel.kernelConnectionMetadata)&&(M.startsWith("%")||M.startsWith("!"))&&(re.sortText=`ZZZ${re.sortText}`),this.previousCompletionItems.set(re,{...m,originalCompletionItem:JSON.parse(JSON.stringify(re))}),re}):h=p.matches.map((M,x)=>{let A=new Sr.CompletionItem(M);return A.range=g,A.sortText=OM(x),qt(this.kernel.kernelConnectionMetadata)&&(M.startsWith("%")||M.startsWith("!"))&&(A.sortText=`ZZZ${A.sortText}`),this.previousCompletionItems.set(A,{...m,originalCompletionItem:A}),A}),qt(this.kernel.kernelConnectionMetadata)?o_e(i.triggerCharacter,this.allowStringFilterForPython,h,e,t):h}async resolveCompletionItem(e,t){var l;if(!e.range||!((l=this.kernel.session)!=null&&l.kernel))return e;let n=this.previousCompletionItems.get(e);if(!n)return e;let{documentRef:i,position:o,originalCompletionItem:s}=n,a=i.deref();return a?Pee(e,s,t,this.kernel,this.kernelId,this.monacoLanguage,a,o):e}async getKernelCompletion(e,t,n){var i;if((i=this.kernel.session)!=null&&i.kernel)return qt(this.kernel.kernelConnectionMetadata)?this.getPythonKernelCompletion(e,t,n):Fs(n,this.kernel.session.kernel.requestComplete({code:e,cursor_pos:t}))}async getPythonKernelCompletion(e,t,n){let i=`return get_ipython().kernel.do_complete("${Ox(e)}", ${t})`;return{content:await xv(this.kernel,[i],n)}}},kee=new WeakMap,KM=new WeakMap;function Nee(r,e,t){var o;let n=kee.get(r),i=((o=KM.get(r))==null?void 0:o.count)||0;e.duration>=pi.IntellisenseTimeout&&KM.set(r,{count:i+1,measures:e,properties:t}),e.timesExceededTimeout=i,n?n.elapsedTime>6e4&&(J("DATASCIENCE.JUPYTER_KERNEL_CODE_COMPLETION",e,t),n.reset(),KM.delete(r)):(J("DATASCIENCE.JUPYTER_KERNEL_CODE_COMPLETION",e,t),n=new It,kee.set(r,new It),KM.delete(r))}var zj=class extends Fr{constructor(t,n){super();this.kernel=t;this.notebookEditorProvider=n;this.cellCompletionProviders=new WeakMap;this.completionItemsSent=new WeakMap;this.monacoLanguage=WM(this.kernel);this.registerCompletionProvider(),this._register(Sr.workspace.onDidChangeConfiguration(i=>{var o;if(i.affectsConfiguration("jupyter.enableKernelCompletions"))if(Ree(this.kernel.notebook.uri))this.completionProvider||this.registerCompletionProvider();else{(o=this.completionProvider)==null||o.dispose(),this.completionProvider=void 0;return}!i.affectsConfiguration("jupyter.completionTriggerCharacters")&&!i.affectsConfiguration("jupyter.pythonCompletionTriggerCharacters")||this.registerCompletionProvider()}))}registerCompletionProvider(){var n;if(!Ree(this.kernel.notebook.uri))return;let t=r_e(this.kernel);if(t.length===0){n_e(this.kernel);return}b.trace(`Registering Kernel Completion Provider from kernel ${ct(this.kernel.kernelConnectionMetadata)} for language ${this.monacoLanguage}`),this.allowStringFilterForPython=t.includes("'")||t.includes('"'),(n=this.completionProvider)==null||n.dispose(),this.completionProvider=void 0,this.completionProvider=Sr.languages.registerCompletionItemProvider(this.monacoLanguage,this,...t)}dispose(){var t;super.dispose(),(t=this.completionProvider)==null||t.dispose()}async provideCompletionItems(t,n,i,o){if(this.notebookEditorProvider.findAssociatedNotebookDocument(t.uri)!==this.kernel.notebook)return[];let s=this.cellCompletionProviders.get(t);if(!s){let a=await Nt(this.kernel.kernelConnectionMetadata.id);s=new $j(a,this.kernel,this.monacoLanguage),this.cellCompletionProviders.set(t,s)}return s.allowStringFilterForPython=this.allowStringFilterForPython,s.provideCompletionItems(t,n,i,o).then(a=>(a.forEach(l=>this.completionItemsSent.set(l,s)),a))}async resolveCompletionItem(t,n){let i=this.completionItemsSent.get(t);return i?i.resolveCompletionItem(t,n):t}},Pm=class extends Fr{constructor(t){super();this.kernelCompletionProviders=new WeakMap;t.push(this)}activate(){let t=rt.instance.get(He);this._register(t.onDidStartKernel(async n=>{var a;if((a=n.session)!=null&&a.kernel&&qt(n.kernelConnectionMetadata)&&n.session.kernel.requestComplete({code:"__file__.",cursor_pos:9}),!WM(n)||this.kernelCompletionProviders.has(n))return;let o=rt.instance.get(Ko),s=this._register(new zj(n,o));this.kernelCompletionProviders.set(n,s)})),this._register(t.onDidDisposeKernel(n=>{var i;(i=this.kernelCompletionProviders.get(n))==null||i.dispose()}))}};Pm=E([(0,UM.injectable)(),I(0,(0,UM.inject)(ie))],Pm);function WM(r){return Kc(VM(r))}function VM(r){let e="";switch(r.kernelConnectionMetadata.kind){case"connectToLiveRemoteKernel":e=r.kernelConnectionMetadata.kernelModel.language;break;case"startUsingRemoteKernelSpec":e=r.kernelConnectionMetadata.kernelSpec.language;break;case"startUsingLocalKernelSpec":e=r.kernelConnectionMetadata.kernelSpec.language;break;default:e=r.kernelConnectionMetadata.kernelSpec.language;break}return(e||"").toLowerCase()}function Ree(r){return Sr.workspace.getConfiguration("jupyter",r).get("enableKernelCompletions",!1)}function r_e(r){let e=Sr.workspace.getConfiguration("jupyter",r.notebook.uri).get("completionTriggerCharacters");if(!e||typeof e!="object")return[];let t=VM(r),n=WM(r);return t in e?Array.isArray(e[t])?e[t]:[]:n in e?Array.isArray(e[n])?e[n]:[]:[]}function n_e(r){let e=VM(r),t=WM(r);e.toLowerCase()===t.toLowerCase()?b.warn(Sr.l10n.t(`Kernel completions not enabled for '{0}'. 
To enable Kernel completion for this language please add the following setting 
jupyter.completionTriggerCharacters = {1}: [<List of characters that will trigger completions>]}. 
For more information please see https://aka.ms/vscodeJupyterCompletion`,ct(r.kernelConnectionMetadata),`{${e}`)):b.warn(Sr.l10n.t(`Kernel completions not enabled for '{0}'. 
To enable Kernel completion for this language please add the following setting 
jupyter.completionTriggerCharacters = {1}: [<List of characters that will trigger completions>]}. 
 or the following: 
jupyter.completionTriggerCharacters = {2}: [<List of characters that will trigger completions>]}. 
For more information please see https://aka.ms/vscodeJupyterCompletion`,ct(r.kernelConnectionMetadata),`{${e}`,`{${t}`))}function i_e(r,e){let t=r.indexOf('"'),n=r.indexOf("'"),i=r.lastIndexOf('"'),o=r.lastIndexOf("'"),s=t>=0?t:n,a=i>=0?i:o;return s>=0&&e.character>s&&e.character<=a}function o_e(r,e,t,n,i){let o=t,s=i.character===0?void 0:new Sr.Range(i.line,i.character-1,i.line,i.character),l=(s?n.getText(s):void 0)===".",c=n.getWordRangeAtPosition(l||r==="."?new Sr.Position(i.line,i.character-1):i),d=c&&s?c.union(s):void 0,p=n.lineAt(i.line).text,f=d?n.getText(d):p,m=f.endsWith(".")||l,g=e&&(r=="'"||r=='"'||i_e(p,i));return b.ci(`Jupyter completions filtering applied: ${g} on ${p}`),o=o.map((h,v)=>{let S=typeof h.label=="string"?h.label:h.label.label,_=typeof h.label=="string"?h.label:h.label.label;if(_.startsWith("%")||_.startsWith("!"))return{...h,sortText:`ZZZ${h.sortText}`};if(g)return h;let D=f?_.indexOf(f):-1,P,M,x;if(f&&m&&_.includes(f)){P=_.substring(_.indexOf(f)+(m?f.length:0)),M=_.substring(_.indexOf(f)+f.length);let A=(typeof h.label=="string"?h.label.length:h.label.label.length)-M.length;x=h.range&&"start"in h.range?new Sr.Range(new Sr.Position(h.range.start.line,h.range.start.character+A),h.range.end):h.range}if(!M&&D>0){P=_.substring(_.indexOf(f)+(m?f.length:0)),M=_.substring(_.indexOf(f)+f.length);let A=(typeof h.label=="string"?h.label.length:h.label.label.length)-M.length;x=h.range&&"start"in h.range?new Sr.Range(new Sr.Position(h.range.start.line,h.range.start.character+A),h.range.end):h.range}return P&&M&&x&&(h.label=P,S=M,h.insertText=M,h.filterText=m?`.${M}`:M,h.range=x,h.sortText=OM(v)),S.endsWith("/")?{...h,command:{command:"editor.action.triggerSuggest",title:""}}:(S.includes(" ")&&(S=S.replace(/\\ /g," "),typeof h.label=="string"?h.label=h.label.replace(/\\ /g," "):h.label.label=h.label.label.replace(/\\ /g," ")),g||!S.includes(".")&&!S.endsWith("/")?h:void 0)}).filter(h=>h!==void 0),b.ci(`Jupyter completions for ${f} at pos ${i.line}:${i.character} with trigger: ${r}
   ${t.map(h=>h.label).join(",")}`),b.ci(`Jupyter results for ${f} at pos ${i.line}:${i.character} with trigger: ${r}
   ${o.map(h=>h.label).join(",")}`),o}function Aee(r,e){r.addSingleton(Ue,q_),r.addSingleton(Pm,Pm),r.addBinding(Pm,Ue)}u();var Y_=$(te());var Mee=require("vscode");var G_=class{constructor(e,t,n){this.extensionChecker=e;this.disposables=t;this.kernelProvider=n}activate(){this.extensionChecker.onPythonExtensionInstallationStatusChanged(this.onPythonExtensionInstallationStatusChanged,this,this.disposables)}async onPythonExtensionInstallationStatusChanged(e){e==="installed"&&this.anyKernelsAreActive()&&Mee.window.showInformationMessage(C.pythonExtensionInstalled,Fe.ok).then(y,y)}anyKernelsAreActive(){return this.kernelProvider.kernels.length>0}};G_=E([(0,Y_.injectable)(),I(0,(0,Y_.inject)(Io)),I(1,(0,Y_.inject)(ie)),I(2,(0,Y_.inject)(He))],G_);u();var jM=$(te()),wu=require("vscode");var s_e=/^\s*(from (?<fromImport>\w+)(?:\.\w+)* import \w+(?:, \w+)*(?: as \w+)?|import (?<importImport>\w+(?:, \w+)*)(?: as \w+)?)$/,a_e=1e3,l_e=vn(),$_=class{constructor(e,t=1e3){this.pendingChecks=new mu;this.disposables=new Pn;this.sentMatches=new Set;this.processedNotebookCells=new WeakMap;e.push(this.disposables),this.disposables.add(new wu.Disposable(()=>fe(this.pendingChecks.values()))),this.isTelemetryDisabled=h0(),this.disposables.add(wu.workspace.onDidOpenNotebookDocument(i=>this.onOpenedOrClosedNotebookDocument(i,"onOpenCloseOrSave"))),this.disposables.add(wu.workspace.onDidCloseNotebookDocument(i=>this.onOpenedOrClosedNotebookDocument(i,"onOpenCloseOrSave"))),this.disposables.add(wu.workspace.onDidSaveNotebookDocument(i=>this.onOpenedOrClosedNotebookDocument(i,"onOpenCloseOrSave")));let n=this.disposables.add(new ec(t));this.disposables.add(Mr.onDidChangeNotebookCellExecutionState(i=>{n.trigger(()=>{i.state==2&&!this.isTelemetryDisabled&&this.checkNotebookCell(i.cell,"onExecution").catch(y)})},this)),this.disposables.add(v0(i=>this.isTelemetryDisabled=i))}activate(){wu.workspace.notebookDocuments.forEach(e=>this.checkNotebookDocument(e,"onOpenCloseOrSave"))}getDocumentLines(e){let t=[];for(let n=0;n<Math.min(a_e,e.lineCount);n++){let i=e.lineAt(n);i.isEmptyOrWhitespace||t.push(i.text.trim())}return t}onOpenedOrClosedNotebookDocument(e,t){!hr(e)||this.isTelemetryDisabled||this.scheduleCheck(e.uri,this.checkNotebookDocument.bind(this,e,t))}scheduleCheck(e,t){let n=this.pendingChecks.get(e);if(n&&(n.dispose(),this.pendingChecks.delete(e)),l_e)t();else{let i=setTimeout(t,5e3);this.pendingChecks.set(e,new wu.Disposable(()=>clearTimeout(i)))}}async checkNotebookDocument(e,t){!hr(e)||this.isTelemetryDisabled||await Promise.all(e.getCells().map(async n=>this.checkNotebookCell(n,t)))}async checkNotebookCell(e,t){if(!(!hr(e.notebook)||e.kind!==wu.NotebookCellKind.Code||e.document.languageId!==Je||this.processedNotebookCells.get(e)===e.document.version))try{this.processedNotebookCells.set(e,e.document.version);let n=e.notebook.notebookType===bt?"notebook":"interactive";await this.sendTelemetryForImports(this.getDocumentLines(e.document),n,t)}catch(n){if(!ji)throw n}}lookForImports(e){let t=[];try{for(let n of e){if(!n.includes("import")&&!n.includes("from"))continue;let i=n?s_e.exec(n):null;i!==null&&i.groups!==void 0&&(i.groups.fromImport!==void 0?t.push(i.groups.fromImport):i.groups.importImport!==void 0&&t.push(...i.groups.importImport.split(",").map(o=>o.trim())))}}catch(n){}return t}async sendTelemetryForImports(e,t,n){await Promise.all(this.lookForImports(e).map(async i=>{let o=`${i}_${t||""}_${n}`;if(this.sentMatches.has(o))return;this.sentMatches.add(o);let s=await Nt(i);J("HASHED_PACKAGE_NAME",void 0,{hashedNamev2:s,resourceType:t,when:n})}))}};$_=E([(0,jM.injectable)(),I(0,(0,jM.inject)(ie))],$_);u();var Yr=$(te()),Kee=$(zh()),ut=require("vscode");u();var xu=require("vscode");var BM=class{constructor(e,t,n,i,o){this.configService=e;this.agentCreator=t;this.requestCreator=n;this.serverUriStorage=i;this.disposables=o;this.savedConnectInfo=new Map;this.serverUriStorage.onDidRemove(this.onDidRemoveServers,this,this.disposables)}getPasswordConnectionInfo(e){if(!e.url||e.url.length<1)throw new Error("Invalid URL");let t=z_(e.url),n=e.disposables||[],i=!Array.isArray(e.disposables),o=this.savedConnectInfo.get(e.handle);return o||(o=this.getJupyterConnectionInfo({url:t,isTokenEmpty:e.isTokenEmpty,disposables:n,validationErrorMessage:e.validationErrorMessage}).then(s=>((!s||s.requiresPassword&&Object.keys(s).length===1)&&(b.warn(`Password for ${t} was invalid.`),this.savedConnectInfo.delete(e.handle)),s)),o.catch(()=>this.savedConnectInfo.delete(e.handle)),o.finally(()=>{i&&fe(n)}).catch(y),this.savedConnectInfo.set(e.handle,o)),o}async getJupyterConnectionInfo(e){let t,n,i,o,s=await this.needPassword(e.url);if(s||e.isTokenEmpty){if(s&&e.isTokenEmpty){let a=xu.window.createInputBox();e.disposables.push(a),a.title=C.jupyterSelectPasswordTitle,a.placeholder=C.jupyterSelectPasswordPrompt,a.ignoreFocusOut=!0,a.password=!0,a.validationMessage=e.validationErrorMessage||"",a.show(),a.buttons=[xu.QuickInputButtons.Back],o=await new Promise((l,c)=>{a.onDidTriggerButton(d=>{d===xu.QuickInputButtons.Back&&c(Ye.back)},this,e.disposables),a.onDidChangeValue(()=>a.validationMessage="",this,e.disposables),a.onDidAccept(()=>l(a.value),this,e.disposables),a.onDidHide(()=>c(Ye.cancel),this,e.disposables)})}if(typeof o===void 0&&!o&&e.isTokenEmpty)throw new xu.CancellationError;if(o||e.isTokenEmpty)if(t=await this.getXSRFToken(e.url,""),t){let a=await this.getSessionCookie(e.url,t,o||"");n=a.sessionCookieName,i=a.sessionCookieValue}else n="authservice_session",i=o,t=await this.getXSRFToken(e.url,`${n}=${i}`);else return{requiresPassword:s}}else return{requiresPassword:s};return t&&n&&(i||e.isTokenEmpty)?(J("DS_INTERNAL.GET_PASSWORD_SUCCESS"),{requestHeaders:{Cookie:`_xsrf=${t}; ${n}=${i||""}`,"X-XSRFToken":t},requiresPassword:s}):(J("DS_INTERNAL.GET_PASSWORD_FAILURE"),{requiresPassword:s})}addAllowUnauthorized(e,t,n){if(e.startsWith("https")&&t&&this.agentCreator){let i=this.agentCreator.createHttpRequestAgent();return{...n,agent:i}}return n}async getXSRFToken(e,t){var a;let n,i,o=new URL("login?",z_(e)).toString();t!=""?(o=new URL("tree",z_(e)).toString(),i={Connection:"keep-alive",Cookie:t}):i={Connection:"keep-alive"};let s=await this.makeRequest(o,{method:"get",redirect:"manual",headers:i});if(s!==void 0&&s.ok){let l=this.getCookies(s);l.has("_xsrf")&&(n=(a=l.get("_xsrf"))==null?void 0:a.split(";")[0])}return n}async needPassword(e){let t=await this.makeRequest(z_(e),{method:"get",redirect:"follow",headers:{Connection:"keep-alive"}});if(t.status===200&&t.redirected){if(t.url.toLowerCase().includes("/login?"))return!0;if(t.url.toLowerCase().includes("/lab?"))return!1}let n=new URL("tree?",z_(e)).toString();return t=await this.makeRequest(n,{method:"get",redirect:"manual",headers:{Connection:"keep-alive"}}),t.status===404?(b.error(`Jupyter Server not found at ${e}, got 404 for ${n}`),!1):t.status!==200}async makeRequest(e,t){let n=this.configService.getSettings(void 0).allowUnauthorizedRemoteConnection;try{return await this.requestCreator.getFetchMethod()(e,this.addAllowUnauthorized(e,!!n,t))}catch(i){if(i.message.indexOf("reason: self signed certificate")>=0){let o=C.jupyterSelfCertEnable,s=C.jupyterSelfCertClose,a=await xu.window.showErrorMessage(C.jupyterSelfCertFail(i.message),{modal:!0},o,s);if(a===o)return J("DATASCIENCE.SELFCERTSMESSAGEENABLED"),await this.configService.updateSetting("allowUnauthorizedRemoteConnection",!0,void 0,xu.ConfigurationTarget.Workspace),this.requestCreator.getFetchMethod()(e,this.addAllowUnauthorized(e,!0,t));a===s&&J("DATASCIENCE.SELFCERTSMESSAGECLOSE")}throw i}}async getSessionCookie(e,t,n){let i,o,s=new URLSearchParams;s.append("_xsrf",t),s.append("password",n);let a=await this.makeRequest(new URL("login?",z_(e)).toString(),{method:"post",headers:{Cookie:`_xsrf=${t}`,Connection:"keep-alive","content-type":"application/x-www-form-urlencoded;charset=UTF-8"},body:s.toString(),redirect:"manual"});if(a.status===302){let l=this.getCookies(a);l.size>0&&(i=l.entries().next().value[0],o=l.entries().next().value[1])}return{sessionCookieName:i,sessionCookieValue:o}}getCookies(e){let t=new Map,i=(e.headers.raw?e.headers.raw():e.headers)["set-cookie"];return i&&i.forEach(o=>{let s=o.substring(0,o.indexOf("=")),a=o.substring(o.indexOf("=")+1);t.set(s,a)}),t}onDidRemoveServers(e){e.forEach(t=>{t.id.startsWith("_builtin")&&this.savedConnectInfo.delete(t.handle)})}};function z_(r){let e=r;return e[e.length-1]!=="/"&&(e=`${e}/`),e}u();var JM=require("vscode");var HM=class{constructor(e,t,n,i,o,s,a){this.multiStepFactory=e;this.asyncDisposableRegistry=t;this.configService=n;this.agentCreator=i;this.requestCreator=o;this.serverUriStorage=s;this.disposables=a;this.savedConnectInfo=new Map;this.serverUriStorage.onDidRemove(this.onDidRemoveServers,this,this.disposables)}async getPasswordConnectionInfo(e){if(!e.url||e.url.length<1)throw new Error("Invalid URL");if(!await this.isJupyterHub(e.url))throw new Error("Not a Jupyter Hub Url");let t=Oee(e.url),n=e.disposables||[],i=!Array.isArray(e.disposables),o=this.savedConnectInfo.get(e.handle);return o||(o=this.getJupyterHubConnectionInfo(t,e.validationErrorMessage).then(s=>((!s||s.requiresPassword&&Object.keys(s).length===1)&&(b.warn(`Password for ${t} was invalid.`),this.savedConnectInfo.delete(e.handle)),s)),o.catch(()=>this.savedConnectInfo.delete(e.handle)),o.finally(()=>{i&&fe(n)}).catch(y),this.savedConnectInfo.set(e.handle,o)),o}async isJupyterHub(e){try{if(e.toLowerCase().includes("/user/")&&e.includes("token="))return!1;if(e.toLowerCase().includes("/user/")&&!e.includes("token="))return!0;let t=await this.makeRequest(new URL("hub/api",Oee(e)).toString(),{method:"get"});if(t.status!==200)return!1;try{let n=await t.json();return b.trace(`JupyterHub version is ${n&&n.version} for url ${e}`),n&&n.version}catch(n){}return!1}catch(t){return b.debug(`Error in detecting whether url is isJupyterHub: ${t}`),!1}}async getJupyterHubConnectionInfo(e,t){try{let n=await this.getUserNameAndPassword(t);if(n.username||n.password){let i=await this.getJupyterHubConnectionInfoFromLogin(e,n.username,n.password);if(i){let o=Object.keys(i||{}).length===0,s=o?"emptyResponseFromLogin":"gotResponseFromLogin";J("DS_INTERNAL.JUPYTER_HUB_PASSWORD",void 0,{failed:o,info:s})}else{J("DS_INTERNAL.JUPYTER_HUB_PASSWORD",void 0,{failed:!0,info:"emptyResponseFromLogin"}),i=await this.getJupyterHubConnectionInfoFromApi(e,n.username,n.password);let o=Object.keys(i||{}).length===0,s=o?"emptyResponseFromApi":"gotResponseFromApi";J("DS_INTERNAL.JUPYTER_HUB_PASSWORD",void 0,{failed:o,info:s})}return i}return J("DS_INTERNAL.JUPYTER_HUB_PASSWORD",void 0,{failed:!1,info:"passwordNotRequired"}),{requiresPassword:!1}}catch(n){throw J("DS_INTERNAL.JUPYTER_HUB_PASSWORD",void 0,{failed:!0,info:"failure"}),n}}async getJupyterHubConnectionInfoFromLogin(e,t,n){let i=new URL(e),o=`${i.protocol}//${i.host}`,s=new URLSearchParams;s.append("username",t||""),s.append("password",n||"");let a=await this.makeRequest(`${o}/hub/login?next=`,{method:"POST",headers:{Connection:"keep-alive",Referer:`${o}/hub/login`,"content-type":"application/x-www-form-urlencoded;charset=UTF-8"},body:s.toString(),redirect:"manual"});if(a&&a.status===302){let c=[...this.getCookies(a).entries()].reduce((d,p)=>`${d};${p[0]}=${p[1]}`,"");if(a=await this.makeRequest(`${o}/hub/api/users/${t}/tokens`,{method:"POST",headers:{Connection:"keep-alive",Cookie:c,Referer:`${o}/hub/login`}}),a.ok&&a.status===200){let d=await a.json();if(d&&d.token&&d.id)return await this.makeRequest(`${o}/hub/api/users/${t}/server`,{method:"POST",headers:{Connection:"keep-alive",Cookie:c,Referer:`${o}/hub/login`}}),this.asyncDisposableRegistry.push({dispose:async()=>{this.makeRequest(`${o}/hub/api/users/${t}/tokens/${d.id}`,{method:"DELETE",headers:{Connection:"keep-alive",Cookie:c,Referer:`${o}/hub/login`}}).catch(y)}}),{requestHeaders:{},remappedBaseUrl:`${o}/user/${t}`,remappedToken:d.token,requiresPassword:!0}}}}async getJupyterHubConnectionInfoFromApi(e,t,n){let i=new URL(e),o=`${i.protocol}//${i.host}`,s=await this.makeRequest(`${o}/hub/api/authorizations/token`,{method:"POST",headers:{Connection:"keep-alive","content-type":"application/json;charset=UTF-8"},body:`{ "username": "${t||""}", "password": "${n||""}"  }`,redirect:"manual"});if(s.ok&&s.status===200){let a=await s.json();if(a&&a.user&&a.user.server&&a.token)return{requestHeaders:{},remappedBaseUrl:`${o}${a.user.server}`,remappedToken:a.token,requiresPassword:!0}}return{requiresPassword:!1}}addAllowUnauthorized(e,t,n){if(e.startsWith("https")&&t&&this.agentCreator){let i=this.agentCreator.createHttpRequestAgent();return{...n,agent:i}}return n}async getUserNameAndPassword(e){let t=this.multiStepFactory.create(),n={username:"",password:"",validationMessage:e};return await t.run(this.getUserNameMultiStep.bind(this),n),n}async getUserNameMultiStep(e,t){if(t.username=await e.showInputBox({title:C.jupyterSelectUserAndPasswordTitle,prompt:C.jupyterSelectUserPrompt,validate:this.validateUserNameOrPassword,validationMessage:t.validationMessage,value:""}),t.username)return this.getPasswordMultiStep.bind(this)}async validateUserNameOrPassword(e){}async getPasswordMultiStep(e,t){t.password=await e.showInputBox({title:C.jupyterSelectUserAndPasswordTitle,prompt:C.jupyterSelectPasswordPrompt,validate:this.validateUserNameOrPassword,value:"",password:!0})}async makeRequest(e,t){let n=this.configService.getSettings(void 0).allowUnauthorizedRemoteConnection;try{return await this.requestCreator.getFetchMethod()(e,this.addAllowUnauthorized(e,!!n,t))}catch(i){if(i.message.indexOf("reason: self signed certificate")>=0){let o=C.jupyterSelfCertEnable,s=C.jupyterSelfCertClose,a=await JM.window.showErrorMessage(C.jupyterSelfCertFail(i.message),{modal:!0},o,s);if(a===o)return J("DATASCIENCE.SELFCERTSMESSAGEENABLED"),await this.configService.updateSetting("allowUnauthorizedRemoteConnection",!0,void 0,JM.ConfigurationTarget.Workspace),this.requestCreator.getFetchMethod()(e,this.addAllowUnauthorized(e,!0,t));a===s&&J("DATASCIENCE.SELFCERTSMESSAGECLOSE")}throw i}}getCookies(e){let t=new Map,i=(e.headers.raw?e.headers.raw():e.headers)["set-cookie"];return i&&i.forEach(o=>{let s=o.substring(0,o.indexOf("=")),a=o.substring(o.indexOf("=")+1);t.set(s,a)}),t}onDidRemoveServers(e){e.forEach(t=>{t.id.startsWith("_builtin")&&this.savedConnectInfo.delete(t.handle)})}};function Oee(r){let e=r;return e[e.length-1]!=="/"&&(e=`${e}/`),e}var qM="user-jupyter-server-uri-list-version2";var c_e="DataScienceAllowInsecureConnections",Q_=class extends Fr{constructor(t,n,i,o,s,a,l,c,d,p,f,m,g,h=EO){super();this.jupyterConnection=n;this.context=f;this.fs=m;this.jupyterServerProviderRegistry=g;this.id=h;this.extensionId=Ge;this.documentation=ut.Uri.parse("https://aka.ms/vscodeJuptyerExtKernelPickerExistingServer");this.displayName=C.UserJupyterServerUrlProviderDisplayName;this.detail=C.UserJupyterServerUrlProviderDetail;this._onDidChangeHandles=this._register(new ut.EventEmitter);this.onDidChangeHandles=this._onDidChangeHandles.event;this._onDidChangeServers=this._register(new ut.EventEmitter);this.onDidChangeServers=this._onDidChangeServers.event;a.push(this),this.newStorage=new OD(i),this.secureConnectionValidator=new MD(s),this.jupyterServerUriInput=new AD(p),this.jupyterServerUriDisplayName=new Qj,this.jupyterPasswordConnect=new BM(t,d,p,o,a),this.jupyterHubPasswordConnect=new HM(l,c,t,d,p,o,a)}activate(){let t=this._register(this.jupyterServerProviderRegistry.createJupyterServerCollection(Ge,this.id,this.displayName,this));t.commandProvider=this,t.documentation=this.documentation,this._register(this.onDidChangeHandles(()=>this._onDidChangeServers.fire(),this)),this._register(ut.commands.registerCommand("dataScience.ClearUserProviderJupyterServerCache",async()=>{await Promise.all([this.newStorage.clear().catch(y),this.fs.delete(ut.Uri.joinPath(this.context.globalStorageUri,yS)).catch(y)]),this._onDidChangeHandles.fire()})),this.initializeServers().catch(y)}async resolveJupyterServer(t,n){let i=await this.getServerUri(t.id);return{...t,connectionInformation:{id:t.id,label:t.label,baseUrl:ut.Uri.parse(i.baseUrl),token:i.token,headers:i.authorizationHeader,mappedRemoteNotebookDir:i.mappedRemoteNotebookDir?ut.Uri.file(i.mappedRemoteNotebookDir):void 0}}}async handleCommand(t,n){let i=new ut.CancellationTokenSource;this._register(new ut.Disposable(()=>{i.cancel(),i.dispose()}));try{let o="url"in t?t.url:void 0,s=await this.captureRemoteJupyterUrl(i.token,o);if(!s||s===Ye.cancel)throw new ut.CancellationError;if(s&&s instanceof Ye)return;let l=(await this.provideJupyterServers(i.token)).find(c=>c.id===s);if(!l)throw new Error(`Server ${s} not found`);return l}catch(o){if(o instanceof ut.CancellationError)throw o;b.error("Failed to select a Jupyter Server",o);return}finally{i.cancel(),i.dispose()}}async provideCommands(t,n){let i="";try{t=(t||"").trim(),["http:","https:"].includes(new URL(t.trim()).protocol.toLowerCase())&&(i=t)}catch(o){}return i?[{label:C.connectToToTheJupyterServer(i),url:i}]:[{label:C.jupyterSelectUriCommandLabel,canBeAutoSelected:!0}]}async provideJupyterServers(t){return await this.initializeServers(),(await this.newStorage.getServers(!1)).map(i=>({id:i.handle,label:i.serverInfo.displayName}))}async removeJupyterServer(t){await this.initializeServers(),await this.newStorage.remove(t.id),this._onDidChangeHandles.fire()}initializeServers(){if(this._cachedServerInfoInitialized)return this._cachedServerInfoInitialized;let t=Te();return this._cachedServerInfoInitialized=t.promise,(async()=>{this.newStorage.getServers(!1).catch(y),t.resolve()})().then(()=>t.resolve(),n=>t.reject(n)).catch(y),this._cachedServerInfoInitialized}recommendInstallingJupyterHubExtension(){if(!ut.workspace.getConfiguration("jupyter").get("bypassJupyterHubExtensionCheck"))throw ut.extensions.getExtension(Ov)?ut.window.showInformationMessage(C.useJupyterHubExtension,{modal:!0,detail:C.useJupyterHubExtensionDetail}).then(()=>{ut.commands.executeCommand("notebook.selectKernel",{notebookEditor:ut.window.activeNotebookEditor}).then(y,y)},y):ut.window.showInformationMessage(C.installJupyterHub,{modal:!0,detail:C.installJupyterHubDetail},Fe.install,Fe.moreInfo).then(t=>{t===Fe.install?ut.commands.executeCommand("workbench.extensions.installExtension",Ov,{context:{skipWalkthrough:!0}}).then(y,y):t===Fe.moreInfo&&ut.env.openExternal(ut.Uri.parse("https://marketplace.visualstudio.com/items?itemName=ms-toolsai.jupyter-hub")).then(y,y)},y),new ut.CancellationError}async captureRemoteJupyterUrl(t,n=""){await this.initializeServers();let i=[],o={baseUrl:"",displayName:"",token:""},s="",a=!1,l=!1,c,d="Get Url",p="Get Url",f=n,m=!1;if(n){let g=await this.jupyterServerUriInput.parseUserUriAndGetValidationError(n);typeof g.validationError=="string"?(s=g.validationError,d="Get Url"):(m=!0,o=g.jupyterServerUri,d="Check Passwords")}try{let g=!1,h=!1;for(;;)try{if(c=(0,Kee.default)(),d==="Get Url"){m=!1,d="Check Passwords",p=void 0;let S=s;s="";let _=await this.jupyterServerUriInput.getUrlFromUser(f||n,S,i);o=_.jupyterServerUri,f=_.url}if(t.isCancellationRequested)return Ye.cancel;let v=[];if(d==="Check Passwords"){d="Check Insecure Connections",p=m&&n?void 0:"Get Url";try{let S=s;s="",g=await this.jupyterHubPasswordConnect.isJupyterHub(o.baseUrl),g&&this.recommendInstallingJupyterHubExtension();let _=g?await this.jupyterHubPasswordConnect.getPasswordConnectionInfo({url:o.baseUrl,handle:c,displayName:o.displayName,validationErrorMessage:S,disposables:v}):await this.jupyterPasswordConnect.getPasswordConnectionInfo({url:o.baseUrl,isTokenEmpty:o.token.length===0,handle:c,validationErrorMessage:S,disposables:v});a=_.requiresPassword,o.authorizationHeader=_.requestHeaders,h=!1}catch(S){if(h=!1,S instanceof ut.CancellationError||S==Ye.back||S==Ye.cancel)throw S;if(!Ks.isSelfCertsError(S)){if(!zc.isSelfCertsExpiredError(S)){Dv(c,o.baseUrl,g,"ConnectionFailure");let _=/(https?:\/\/[^\s]+)/g,D=(S.message||S.toString()).replace(_,P=>`[${P}](${P})`);if(s=(xn()?C.remoteJupyterConnectionFailedWithoutServerWithErrorWeb:C.remoteJupyterConnectionFailedWithoutServerWithError)(D),o.token.length>0&&(S.message||"").toLowerCase()==="Failed to fetch".toLowerCase())h=!0;else{d="Get Url";continue}}}}finally{v.forEach(S=>this._register(S))}}if(t.isCancellationRequested)return Ye.cancel;if(d==="Check Insecure Connections"&&(d="Verify Connection",p=a&&o.token.length===0?"Check Passwords":"Get Url",p==="Get Url"&&(p=m&&n?void 0:"Get Url"),!a&&o.token.length===0&&new URL(o.baseUrl).protocol.toLowerCase()==="http:"&&(l=!0,fe(v),!await this.secureConnectionValidator.promptToUseInsecureConnections())))return Dv(c,o.baseUrl,g,"InsecureHTTP"),Ye.cancel;if(t.isCancellationRequested)return Ye.cancel;if(d==="Verify Connection")try{d="Get Display Name",await this.jupyterConnection.validateRemoteUri({id:this.id,handle:c,extensionId:Ge},o,!0)}catch(S){if(b.warn("Uri verification error",S),h&&s){d="Get Url";continue}if(S instanceof ut.CancellationError||S==Ye.back||S==Ye.cancel)throw S;if(Ks.isSelfCertsError(S)){s=C.jupyterSelfCertFailErrorMessageOnly,d="Get Url",Dv(c,o.baseUrl,g,"SelfCert");continue}else if(zc.isSelfCertsExpiredError(S)){s=C.jupyterSelfCertExpiredErrorMessageOnly,d="Get Url",Dv(c,o.baseUrl,g,"ExpiredCert");continue}else if(a&&o.token.length===0){s=C.passwordFailure,d="Check Passwords",Dv(c,o.baseUrl,g,"AuthFailure");continue}else{Dv(c,o.baseUrl,g,"ConnectionFailure");let _=/(https?:\/\/[^\s]+)/g,D=(S.message||S.toString()).replace(_,P=>`[${P}](${P})`);s=(xn()?C.remoteJupyterConnectionFailedWithoutServerWithErrorWeb:C.remoteJupyterConnectionFailedWithoutServerWithError)(D),d="Get Url";continue}}finally{fe(v)}if(t.isCancellationRequested)return Ye.cancel;if(d==="Get Display Name"){fe(v),p=l?"Check Insecure Connections":a&&o.token.length===0?"Check Passwords":"Get Url",p==="Get Url"&&(p=m&&n?void 0:"Get Url"),o.displayName=await this.jupyterServerUriDisplayName.getDisplayName(c,o.displayName||new URL(o.baseUrl).hostname);break}}catch(v){if(v instanceof ut.CancellationError||v===Ye.cancel)return Ye.cancel;if(v===Ye.back){if(!p)return Ye.back;d=p;continue}throw v}return t.isCancellationRequested?Ye.cancel:(await this.addNewServer({handle:c,uri:f,serverInfo:o}),U1({extensionId:this.extensionId,id:this.id,handle:c},o.displayName),Dv(c,o.baseUrl,g),c)}catch(g){if(g instanceof ut.CancellationError)return Ye.cancel;throw g}finally{fe(i)}}async addNewServer(t){await this.newStorage.add(t),this._onDidChangeHandles.fire()}async getServerUri(t){let i=(await this.newStorage.getServers(!1)).find(c=>c.handle===t);if(!i)throw new Error("Server not found");let o=i.serverInfo,s=this.jupyterServerUriDisplayName.displayNamesOfHandles.get(t);s&&(o.displayName=s);let a=await this.jupyterHubPasswordConnect.isJupyterHub(o.baseUrl),l=Object.assign({},o);try{let c=a?await this.jupyterHubPasswordConnect.getPasswordConnectionInfo({url:o.baseUrl,handle:t,displayName:o.displayName}):await this.jupyterPasswordConnect.getPasswordConnectionInfo({url:o.baseUrl,isTokenEmpty:o.token.length===0,handle:t});l=Object.assign({},o,{authorizationHeader:c.requestHeaders||o.authorizationHeader}),a&&c.remappedBaseUrl&&(l.baseUrl=c.remappedBaseUrl),a&&c.remappedToken&&(l.token=c.remappedToken)}catch(c){b.error("Failed to validate Password info",c)}return l}};Q_=E([(0,Yr.injectable)(),I(0,(0,Yr.inject)(Ae)),I(1,(0,Yr.inject)(gn)),I(2,(0,Yr.inject)(Ux)),I(3,(0,Yr.inject)(fr)),I(4,(0,Yr.inject)(St)),I(4,(0,Yr.named)(ir)),I(5,(0,Yr.inject)(ie)),I(6,(0,Yr.inject)(E1)),I(7,(0,Yr.inject)(Ha)),I(8,(0,Yr.inject)($R)),I(8,(0,Yr.optional)()),I(9,(0,Yr.inject)(Bh)),I(10,(0,Yr.inject)(ot)),I(11,(0,Yr.inject)(wt)),I(12,(0,Yr.inject)(lr)),I(13,(0,Yr.optional)()),I(13,(0,Yr.inject)(Date.now().toString()))],Q_);var AD=class{constructor(e){this.requestCreator=e}async getUrlFromUser(e,t="",n){if(!e&&!sP)try{let s=await ut.env.clipboard.readText(),a=s.trim().startsWith("https://github.com/")?void 0:ut.Uri.parse(s.trim(),!0);e=s&&a&&a.scheme.toLowerCase().startsWith("http")?s:""}catch(s){e=""}let i=ut.window.createInputBox();n.push(i),i.title=C.jupyterSelectUriInputTitle,i.placeholder=C.jupyterSelectUriInputPlaceholder,i.value=e,i.validationMessage=t,i.buttons=[ut.QuickInputButtons.Back],i.ignoreFocusOut=!0,i.show();let o=Te();return i.onDidChangeValue(()=>i.validationMessage="",this,n),i.onDidHide(()=>o.reject(Ye.cancel),this,n),i.onDidTriggerButton(s=>{s===ut.QuickInputButtons.Back&&o.reject(Ye.back)},this,n),i.onDidAccept(async()=>{let s=await this.parseUserUriAndGetValidationError(i.value);if(typeof s.validationError=="string"){i.validationMessage=s.validationError;return}o.resolve(s)}),o.promise}async parseUserUriAndGetValidationError(e){let t=e.trim().replace(/\/(lab|tree)(\??)$/,""),n=Xj(t,"");return n?(n.baseUrl=await u_e(t,this.requestCreator)||n.baseUrl,!t.toLowerCase().startsWith("http:")&&!t.toLowerCase().startsWith("https:")?{validationError:C.jupyterSelectURIMustBeHttpOrHttps}:{jupyterServerUri:n,url:t,validationError:void 0}):{validationError:C.jupyterSelectURIInvalidURI}}};AD=E([I(0,(0,Yr.inject)(Bh))],AD);async function u_e(r,e){var t;try{if(r=((t=Xj(r,""))==null?void 0:t.baseUrl)||r,new URL(r).pathname==="/")return r;let n=r.indexOf("token=")>0?r.substring(0,r.indexOf("token=")):r,s=(await e.getFetchMethod()(n,{method:"GET",redirect:"manual"})).headers.get("location");if(s&&s.includes("login?"))return s.substring(0,s.indexOf("login?"))}catch(n){b.debug("Unable to identify the baseUrl of the Jupyter Server",n)}}function Dv(r,e,t,n){e=e.trim().toLowerCase();let i=Jt({handle:r,extensionId:Ge,id:EO});Promise.all([Nt(e.toLowerCase()),Nt(i.toLowerCase())]).then(([o,s])=>{J("DATASCIENCE.ENTER_REMOTE_JUPYTER_URL",void 0,{serverIdHash:s,failed:!!n,baseUrlHash:o,isJupyterHub:t,isLocalHost:["localhost","127.0.0.1","::1"].includes(new URL(e).hostname),reason:n})}).catch(o=>b.error(`Failed to hash remote url ${e}`,o))}var Qj=class{constructor(){this.displayNamesOfHandles=new Map}async getDisplayName(e,t){let n=[];try{let i=ut.window.createInputBox();n.push(i),i.ignoreFocusOut=!0,i.title=C.jupyterRenameServer,i.value=t,i.placeholder=C.jupyterServerUriDisplayNameInputPlaceholder,i.buttons=[ut.QuickInputButtons.Back],i.show();let o=Te();return n.push(i.onDidHide(()=>o.reject(Ye.cancel))),i.onDidTriggerButton(s=>{s===ut.QuickInputButtons.Back&&o.reject(Ye.back)},this,n),i.onDidAccept(()=>{let s=i.value.trim()||t;this.displayNamesOfHandles.set(e,s),o.resolve(s)},this,n),await o.promise}finally{fe(n)}}},MD=class{constructor(e){this.globalMemento=e}async promptToUseInsecureConnections(){if(this.globalMemento.get(c_e,!1))return!0;let e=[],t=Te();try{let n=ut.window.createQuickPick();return e.push(n),n.canSelectMany=!1,n.ignoreFocusOut=!0,n.title=C.insecureSessionMessage,n.buttons=[ut.QuickInputButtons.Back],n.items=[{label:Fe.bannerLabelYes},{label:Fe.bannerLabelNo}],n.show(),e.push(n.onDidHide(()=>t.reject(Ye.cancel))),n.onDidTriggerButton(i=>{i===ut.QuickInputButtons.Back&&t.reject(Ye.back)},this,e),n.onDidAccept(()=>t.resolve(n.selectedItems.some(i=>i.label===Fe.bannerLabelYes)),this,e),await t.promise}finally{fe(e)}}};MD=E([I(0,(0,Yr.inject)(St)),I(0,(0,Yr.named)(ir))],MD);function Xj(r,e){if(!r.startsWith(tt.REMOTE_URI))try{let t=new URL(r);return{baseUrl:`${t.protocol}//${t.host}${t.pathname==="/lab"||t.pathname==="/tree"?"":t.pathname}`,token:t.searchParams.get("token")||"",displayName:e||t.hostname}}catch(t){b.error(`Failed to parse URI ${r}`,t);return}}function Lee(r){return r.map(e=>({handle:e.handle,uri:e.uri,displayName:e.serverInfo.displayName}))}function d_e(r){let e=[];return r.forEach(t=>{let n=Xj(t.uri,t.displayName);n&&e.push({handle:t.handle,uri:t.uri,serverInfo:n})}),e}var OD=class{constructor(e){this.encryptedStorage=e;this.updatePromise=Promise.resolve()}async getServers(e){if(this.servers&&!e)return this.servers;let t=await this.encryptedStorage.retrieve(pi.JupyterServerRemoteLaunchService,qM);if(!t||t==="[]")return[];try{return this.servers=d_e(JSON.parse(t))}catch(n){return[]}}async add(e){this.servers&&(this.servers=this.servers.filter(t=>t.handle!==e.handle).concat(e)),await(this.updatePromise=this.updatePromise.then(async()=>{let t=(await this.getServers(!0)).concat(e);this.servers=t,await this.encryptedStorage.store(pi.JupyterServerRemoteLaunchService,qM,JSON.stringify(Lee(t)))}).catch(y))}async remove(e){this.servers&&(this.servers=this.servers.filter(t=>t.handle!==e)),await(this.updatePromise=this.updatePromise.then(async()=>{let t=(await this.getServers(!0)).filter(n=>n.handle!==e);return this.servers=t,this.encryptedStorage.store(pi.JupyterServerRemoteLaunchService,qM,JSON.stringify(Lee(t)))}).catch(y))}async clear(){this.servers=[],await(this.updatePromise=this.updatePromise.then(async()=>{this.servers=[],await this.encryptedStorage.store(pi.JupyterServerRemoteLaunchService,qM,void 0)}).catch(y))}};OD=E([I(0,(0,Yr.inject)(Ux))],OD);u();var LD=$(te()),Z_=require("vscode");var X_=class extends Fr{constructor(t,n){super();this.uriProviderRegistration=t;this.serverUriStorage=n;this.handleMappings=new Map;this._onDidChangeHandles=this._register(new Z_.EventEmitter);this.extensionId=Ge;this.id=GD;this.displayName="Jupyter Server for Testing";this.onDidChangeServers=this._onDidChangeHandles.event}async provideJupyterServers(t){return Array.from(this.handleMappings.values()).map(n=>n.server)}async resolveJupyterServer(t,n){return t}activate(){this._register(this.uriProviderRegistration.createJupyterServerCollection(Ge,this.id,this.displayName,this)),this._register(Z_.commands.registerCommand("jupyter.selectjupyteruri",this.selectJupyterUri,this))}async selectJupyterUri(t){var c;b.info(`Setting Jupyter Server URI to remote: ${t}`);let n=t.toString(!0),i=new URL(n),o=Z_.Uri.parse(`${i.protocol}//${i.host}${i.pathname==="/lab"?"":i.pathname}`),s=(c=i.searchParams.get("token"))!=null?c:"",a=await ja(t.toString(!0),"SHA-1"),l={label:this.displayName,id:a,connectionInformation:{baseUrl:o,token:s}};this.handleMappings.set(a,{uri:t,server:l}),await this.serverUriStorage.add({id:this.id,handle:a,extensionId:Ge}),this._onDidChangeHandles.fire()}};X_=E([(0,LD.injectable)(),I(0,(0,LD.inject)(lr)),I(1,(0,LD.inject)(fr))],X_);u();var GM=$(te());var KD=require("vscode");var eE=class{constructor(e){this.disposables=e}activate(){this.registerCommandsIfTrusted()}dispose(){this.disposables.forEach(e=>e.dispose())}registerCommandsIfTrusted(){KD.workspace.isTrusted&&this.registerCommand(Q.ContinueEditSessionInCodespace,this.continueEditSessionInCodespace)}registerCommand(e,t){let n=KD.commands.registerCommand(e,t,this);this.disposables.push(n)}async continueEditSessionInCodespace(){await KD.commands.executeCommand("_workbench.editSessions.actions.continueEditSession.github.codespaces.continueEditSessionInCodespaceWithJupyterServer")}};eE=E([(0,GM.injectable)(),I(0,(0,GM.inject)(ie))],eE);u();var Fee=$(te());var Uee=require("vscode");var tE=class{activate(){this.eagerlyActivateOtherExtensions().catch(y)}async eagerlyActivateOtherExtensions(){await Promise.all(Uee.extensions.all.filter(e=>{var t,n;return(n=(t=e.packageJSON)==null?void 0:t.contributes)==null?void 0:n.pythonRemoteServerProvider}).map(e=>e.isActive?Promise.resolve():e.activate().then(y,y)))}};tE=E([(0,Fee.injectable)()],tE);u();var YM=$(te()),Wee=require("vscode");var rE=class{constructor(e){this.uriStorage=e}activate(){Wee.commands.registerCommand("jupyter.getUsedAzMLServerHandles",()=>{let e=[];return this.uriStorage.all.forEach(n=>{n.provider.extensionId.toLowerCase()==="ms-toolsai.vscode-ai".toLowerCase()&&e.push(n.provider)}),e})}};rE=E([(0,YM.injectable)(),I(0,(0,YM.inject)(fr))],rE);u();var np=require("vscode");var Vee=$(te());var nE=class{activate(){let e=rt.instance.get(ie),t=new Pn;e.push(t),e.push(np.commands.registerCommand("jupyter.manageAccessToKernels",()=>p_e(t)))}};nE=E([(0,Vee.injectable)()],nE);async function p_e(r){let e=await J$(),t=[];Array.from(e.entries()).forEach(([s])=>{var l,c;let a=(c=(l=np.extensions.getExtension(s))==null?void 0:l.packageJSON)==null?void 0:c.displayName;a&&t.push({label:a,description:s,extensionId:s})});let n=[];r.add({dispose:()=>{n=fe(n)}});let i=np.window.createQuickPick();i.title=np.l10n.t("Manage Access To Jupyter Kernels"),i.placeholder=np.l10n.t("Choose which extensions can access Jupyter Kernels"),i.items=t,i.selectedItems=t.filter(s=>e.get(s.extensionId)===!0),i.canSelectMany=!0,i.ignoreFocusOut=!1;let o=!1;n.push(i),i.show(),await Promise.race([ax(i.onDidAccept,void 0,n).then(()=>o=!0),ax(i.onDidHide,void 0,n)]),o&&(await q$(i.selectedItems.map(s=>s.extensionId)),n=fe(n))}u();var Hee=require("vscode");u();var $M=class{constructor(){this.cache=new Map;this.executionCount=0}getResults(e,t){return this.executionCount!==e&&(this.cache.clear(),this.executionCount=e),this.cache.get(t)}setResults(e,t,n){if(this.executionCount<e)this.cache.clear(),this.executionCount=e;else if(this.executionCount>e)return;this.cache.set(t,n)}},jee=$M,Bee=$M;var Pv=$(te());var iE=class{constructor(e,t){this.variables=e;this.kernelProvider=t;this.variableResultCache=new jee;this.variableSummaryCache=new Bee;this.runningKernels=new Set;this._onDidChangeVariables=new Hee.EventEmitter;this.onDidChangeVariables=this._onDidChangeVariables.event;this.kernelProvider.onKernelStatusChanged(this.onKernelStatusChanged,this)}onKernelStatusChanged({kernel:e}){if("variableProvider"in e.controller&&e.controller.variableProvider!==this)return;let t=e.notebook.uri.toString(),n=this.runningKernels.has(t);e.status==="idle"&&!n?this.runningKernels.add(t):e.status!=="busy"&&e.status!=="idle"&&n&&(this.runningKernels.delete(t),this._onDidChangeVariables.fire(e.notebook))}_getVariableResultCacheKey(e,t,n){let i="",o=t;return o&&(i=`${o.name}.${o.propertyChain.join(".")}[[${n}`),`${e}:${i}`}async*provideVariables(e,t,n,i,o){if(o.isCancellationRequested)return;let s=this.kernelProvider.get(e);if(!s||s.status==="dead"||s.status==="terminating")return;let a=this.kernelProvider.getKernelExecution(s).executionCount,l=this._getVariableResultCacheKey(e.uri.toString(),t,i),c=this.variableResultCache.getResults(a,l);if(t){let d=t;if(!c&&d.getChildren)c=(await d.getChildren(i,o)).map(f=>this.createVariableResult(f,s)),this.variableResultCache.setResults(a,l,c);else if(!c)return;for(let p of c)yield p;if(n===2&&d.count&&c.length>0&&d.count>i+c.length)for await(let p of this.provideVariables(e,t,n,i+c.length,o))yield p}else{c||(c=(await this.variables.getAllVariableDiscriptions(s,void 0,i,o)).map(p=>this.createVariableResult(p,s)),this.variableResultCache.setResults(a,l,c));for(let d of c)yield d}}_getVariableSummaryCacheKey(e,t){return`${e}:${t.name}`}async*provideVariablesWithSummarization(e,t,n,i,o){var l;let s=this.kernelProvider.get(e),a=this.provideVariables(e,t,n,i,o);for await(let c of a)if(s&&s.status!=="dead"&&s.status!=="terminating"){let d=this._getVariableSummaryCacheKey(e.uri.toString(),c.variable),p=this.kernelProvider.getKernelExecution(s).executionCount,f=this.variableSummaryCache.getResults(p,d);f==null&&c.variable.type==="pandas.core.frame.DataFrame"&&(f=await this.variables.getVariableValueSummary({name:c.variable.name,value:c.variable.value,supportsDataExplorer:!1,type:(l=c.variable.type)!=null?l:"",size:0,count:0,shape:"",truncated:!0},s,o),this.variableSummaryCache.setResults(p,d,f!=null?f:null)),yield{hasNamedChildren:c.hasNamedChildren,indexedChildrenCount:c.indexedChildrenCount,variable:{name:c.variable.name,value:c.variable.value,expression:c.variable.expression,type:c.variable.type,language:c.variable.language,summary:f!=null?f:""}}}}createVariableResult(e,t){var s;let n=(s=e.count)!=null?s:0,i=!!e.hasNamedChildren,o={getChildren:(a,l)=>this.getChildren(o,a,t,l),expression:f_e(e.root,e.propertyChain),...e};return{variable:o,hasNamedChildren:i,indexedChildrenCount:n}}async getChildren(e,t,n,i){let o=e;return await this.variables.getAllVariableDiscriptions(n,o,t,i)}};iE=E([(0,Pv.injectable)(),I(0,(0,Pv.inject)(Wi)),I(0,(0,Pv.named)(tt.KERNEL_VARIABLES)),I(1,(0,Pv.inject)(He))],iE);function f_e(r,e){let t=r;for(let n of e)typeof n=="string"?t+=`.${n}`:t+=`[${n}]`;return t}u();var ip=$(te()),zM=require("vscode");var m_e=/Type:\s*(\w+)/,g_e=/Value:\s*(.*)/,h_e=/String form:\s*([\s\S]+?)\n/,v_e=/Docstring:\s*(.*)/,y_e=/Length:\s+(.*)/,b_e=/^\s+\[(\d+) rows x (\d+) columns\]/m,I_e=new Set(["DataFrame","list","dict","ndarray","Series","Tensor","EagerTensor","DataArray"]),oE=class{constructor(e,t,n,i){this.configService=e;this.disposables=n;this.kernelProvider=i;this.variableRequesters=new Map;this.cachedVariables=new Map;this.refreshEventEmitter=new zM.EventEmitter;this.variableRequesters.set(Je,t)}get refreshRequired(){return this.refreshEventEmitter.event}async getAllVariableDiscriptions(e,t,n,i){let o=$c(e.kernelConnectionMetadata)||Je,s=this.variableRequesters.get(o);return s?s.getAllVariableDiscriptions(e,t,n,i):[]}async getVariables(e,t){return this.getVariablesBasedOnKernel(t,e)}async getMatchingVariable(e,t,n){let i=this.cachedVariables.get(t.uri.toString());if(i){let o=i.variables.find(s=>s.name===e);return o&&!o.value&&(o=await this.getVariableValueFromKernel(o,t,n)),o}else{let o=await this.getVariableNamesAndTypesFromKernel(t,n);if(o){let s=o.find(a=>a.name===e);if(s)return this.getVariableValueFromKernel({name:e,value:void 0,supportsDataExplorer:!1,type:s.type,fullType:s.fullType,size:0,count:0,shape:"",truncated:!0},t,n)}}}async getVariableValueSummary(e,t,n){if(!t)return;let i=$c(t==null?void 0:t.kernelConnectionMetadata)||Je,o=this.variableRequesters.get(i);if(o)return o.getVariableValueSummary(e,t,n)}async getDataFrameInfo(e,t,n,i){if(!t)return e;let o=$c(t==null?void 0:t.kernelConnectionMetadata)||Je,s=this.variableRequesters.get(o);if(s){i&&(e=await this.getFullVariable(e,t));let a=e.name;return n&&(a=`${e.name}${n}`),s.getDataFrameInfo(e,t,a)}return e}async getDataFrameRows(e,t,n,i,o){let s=$c(i==null?void 0:i.kernelConnectionMetadata)||Je,a=this.variableRequesters.get(s);if(a){let l=e.name;return o&&(l=`${e.name}${o}`),a.getDataFrameRows(t,n,i,l)}return{data:[]}}async getFullVariable(e,t,n){let i=$c(t==null?void 0:t.kernelConnectionMetadata)||Je,o=this.variableRequesters.get(i);return o?o.getFullVariable(e,t,n):e}async getVariablesBasedOnKernel(e,t){var l;let n=this.cachedVariables.get(e.uri.toString()),i=this.kernelProvider.getKernelExecution(e).pendingCells.length>0,o=this.kernelProvider.getKernelExecution(e);(!n||!i&&(n.currentExecutionCount!==t.executionCount||n.currentExecutionCount!==o.executionCount))&&(n={currentExecutionCount:o.executionCount,variables:(await this.getVariableNamesAndTypesFromKernel(e)).map(c=>({name:c.name,value:void 0,supportsDataExplorer:!1,type:c.type,fullType:c.fullType,size:0,shape:"",count:0,truncated:!0,fileName:e.notebook.uri}))});let s=this.configService.getSettings(e.resourceUri).variableExplorerExclude?(l=this.configService.getSettings().variableExplorerExclude)==null?void 0:l.split(";"):[],a={executionCount:o.executionCount,pageStartIndex:-1,pageResponse:[],totalCount:0,refreshCount:t.refreshCount};if(n){let c=t.sortColumn,d=(m,g)=>{let h=m[c]?m[c]:"",v=g[c]?g[c]:"";return t.sortAscending?h.localeCompare(v,void 0,{sensitivity:"base"}):v.localeCompare(h,void 0,{sensitivity:"base"})};n.variables.sort(d);let p=t.startIndex?t.startIndex:0,f=t.pageSize?t.pageSize:100;a.pageStartIndex=p;for(let m=p;m<p+f&&m<n.variables.length;){if(s&&s.indexOf(n.variables[m].type)>=0){n.variables.splice(m,1);continue}let g=typeof n.variables[m].value=="string"?n.variables[m]:await this.getVariableValueFromKernel(n.variables[m],e);n.variables[m]=g,a.pageResponse.push(g),m+=1}this.cachedVariables.set(e.uri.toString(),n),a.totalCount=n.variables.length}return a}async getVariableProperties(e,t,n){let i=await this.getMatchingVariable(e,t,n),o=$c(t.kernelConnectionMetadata)||Je,s=this.variableRequesters.get(o);return s?s.getVariableProperties(e,n,i):{}}async getVariableNamesAndTypesFromKernel(e,t){let n=$c(e.kernelConnectionMetadata)||Je,i=this.variableRequesters.get(n);return i?i.getVariableNamesAndTypesFromKernel(e,t):[]}inspect(e,t,n=0,i){let o=Te();try{e.requestInspect({code:t,cursor_pos:n,detail_level:0}).then(s=>{s&&s.content.status==="ok"?o.resolve(s.content.data):o.resolve(void 0)}).catch(s=>{o.reject(s)})}catch(s){o.reject(s)}return i&&this.disposables.push(i.onCancellationRequested(()=>o.reject(new zM.CancellationError))),o.promise}async getVariableValueFromKernel(e,t,n){var o;let i={...e};if(!t.disposed&&((o=t.session)!=null&&o.kernel)){let s=await this.inspect(t.session.kernel,e.name,0,n);if(s&&s.hasOwnProperty("text/plain")){let a=fu(s["text/plain"].toString()),l=m_e.exec(a),c=y_e.exec(a),d=b_e.exec(a);l&&(i.type=l[1]),i.value=[g_e,h_e,v_e].reduce((p,f)=>{var m;return p||((m=f.exec(a))==null?void 0:m[1])||""},""),c&&(i.count=parseInt(c[1],10)),d&&(i.shape=`(${d[1]}, ${d[2]})`)}s&&s.type&&(i.type=s.type.toString()),s&&s.value&&(i.value=s.value.toString()),I_e.has(i.type)&&(i.supportsDataExplorer=!0)}return i.type&&i.count&&!i.shape&&qt(t.kernelConnectionMetadata)&&i.supportsDataExplorer&&i.type!=="list"&&(i=await this.getFullVariable(i,t)),i}};oE=E([(0,ip.injectable)(),I(0,(0,ip.inject)(Ae)),I(1,(0,ip.inject)(mA)),I(1,(0,ip.named)(tt.PYTHON_VARIABLES_REQUESTER)),I(2,(0,ip.inject)(ie)),I(3,(0,ip.inject)(He))],oE);u();var FD=$(te());u();var sE=class extends it{constructor(){super("unknown",C.jupyterDataRateExceeded)}};async function QM(r,{code:e,initializeCode:t,cleanupCode:n},i){var o;if(r.disposed||r.disposing||!((o=r.session)!=null&&o.kernel)||!r.session.kernel||r.session.isDisposed)return[];try{return t&&await Fi(r.session.kernel,t,i),await Fi(r.session.kernel,e,i)}catch(s){if(s instanceof tn)return[];throw s}finally{n&&await Fi(r.session.kernel,n,i)}}var aE=class{constructor(e,t){this.varScriptGenerator=e;this.dfScriptGenerator=t}async getDataFrameInfo(e,t,n){var c;let{code:i,cleanupCode:o,initializeCode:s}=await this.dfScriptGenerator.generateCodeToGetDataFrameInfo({isDebugging:!1,variableName:n}),a=await QM(t,{code:i,cleanupCode:o,initializeCode:s},{traceErrors:!0,traceErrorsMessage:"Failure in execute_request for getDataFrameInfo",telemetryName:"DATASCIENCE.PYTHON_VARIABLE_FETCHING_CODE_FAILURE"}),l=((c=t.notebook)==null?void 0:c.uri)||t.resourceUri||t.uri;return{...e,...this.deserializeJupyterResult(a),fileName:l}}async getDataFrameRows(e,t,n,i){let{code:o,cleanupCode:s,initializeCode:a}=await this.dfScriptGenerator.generateCodeToGetDataFrameRows({isDebugging:!1,variableName:i,startIndex:e,endIndex:t}),l=await QM(n,{code:o,cleanupCode:s,initializeCode:a},{traceErrors:!0,traceErrorsMessage:"Failure in execute_request for getDataFrameRows",telemetryName:"DATASCIENCE.PYTHON_VARIABLE_FETCHING_CODE_FAILURE"});return l.length===0?{data:[]}:GA(this.deserializeJupyterResult(l))}async getVariableProperties(e,t,n){let i={};return n&&n.value&&(i[`${e}`]=n.value),i}async getVariableValueSummary(e,t,n){let i=await this.varScriptGenerator.generateCodeToGetVariableValueSummary(e.name);try{let o=await xv(t,i.split(/\r?\n/),n);return o==null?void 0:o.summary}catch(o){b.warn(`Exception when getting variable summary for variable "${e.name}": ${o.message}`);return}}async getAllVariableDiscriptions(e,t,n,i){if(!e.session)return[];let o=t?{root:t.root,propertyChain:t.propertyChain,startIndex:n}:void 0,s=await this.varScriptGenerator.generateCodeToGetAllVariableDescriptions(o),a=await xv(e,s.split(/\r?\n/),i);if(e.disposed||e.disposing||i!=null&&i.isCancellationRequested||!a)return[];try{return a}catch(l){return b.error(l),[]}}async getVariableNamesAndTypesFromKernel(e,t){if(e.session){let{code:n,cleanupCode:i,initializeCode:o}=await this.varScriptGenerator.generateCodeToGetVariableTypes({isDebugging:!1}),s=await QM(e,{code:n,cleanupCode:i,initializeCode:o},{traceErrors:!0,traceErrorsMessage:"Failure in execute_request for getVariableNamesAndTypesFromKernel",telemetryName:"DATASCIENCE.PYTHON_VARIABLE_FETCHING_CODE_FAILURE"});if(e.disposed||e.disposing)return[];let a=this.deserializeJupyterResult(s),l=[];for(let c of a){let d={...c,value:void 0,supportsDataExplorer:!1,size:0,shape:"",count:0,truncated:!0};l.push(d)}return l}return[]}async getFullVariable(e,t,n){let{code:i,cleanupCode:o,initializeCode:s}=await this.varScriptGenerator.generateCodeToGetVariableInfo({isDebugging:!1,variableName:e.name}),a=await QM(t,{code:i,cleanupCode:o,initializeCode:s},{traceErrors:!0,traceErrorsMessage:"Failure in execute_request for getFullVariable",telemetryName:"DATASCIENCE.PYTHON_VARIABLE_FETCHING_CODE_FAILURE"});return{...e,...this.deserializeJupyterResult(a)}}extractJupyterResultText(e){if(e.length>0){let t=e[0];if(t&&t.output_type==="stream"&&t.name==="stderr"&&t.hasOwnProperty("text")){let n=t.text;if(n.includes("iopub_data_rate_limit"))throw new sE;{let i=C.jupyterGetVariablesExecutionError(n);throw b.error(i),new Error(i)}}if(t&&t.output_type==="execute_result"){let n=t.data;if(n&&n.hasOwnProperty("text/plain"))return n["text/plain"]}if(t&&t.output_type==="stream"&&t.hasOwnProperty("text"))return t.text;if(t&&t.output_type==="error"&&t.hasOwnProperty("traceback")){let i=t.traceback.map(fu).join(`\r
`),o=C.jupyterGetVariablesExecutionError(i);throw b.error(o),new Error(o)}}throw new Error(C.jupyterGetVariablesBadResults)}deserializeJupyterResult(e){let t=this.extractJupyterResultText(e);return JSON.parse(t)}};aE=E([(0,FD.injectable)(),I(0,(0,FD.inject)(ay)),I(1,(0,FD.inject)(ly))],aE);function Jee(r,e,t){e.addSingleton(Ue,V_),e.addSingleton(Ue,W_),e.addSingleton(Ue,U_),e.addSingleton(Ue,$_),e.addSingleton(Ue,tE),e.addSingleton(Ue,X_),e.add(x1,H_),e.add(CI,j_),e.addSingleton(XR,B_),e.addSingleton(rp,rp),e.addSingleton(Ue,G_),Aee(e,t),yee(r,t),e.addSingleton(Ue,Q_),e.addSingleton(Ue,eE),e.addSingleton(Ue,rE),e.addSingleton(Ue,nE),e.addSingleton(gA,iE),e.addSingleton(Wi,oE,tt.KERNEL_VARIABLES),e.addSingleton(mA,aE,tt.PYTHON_VARIABLES_REQUESTER)}u();u();var UD=$(te()),Gee=require("vscode");u();var qee=class{};"force_variable_refresh","settings_updated","activate","show_data_explorer","get_variables_request","get_variables_response","variable_explorer_toggle","set_variable_explorer_height","variable_explorer_height_response","open_link","variables_complete","update_settings","loc_init","update_variable_view_execution_count","get_html_by_id_request","get_html_by_id_response","restart_kernel";var XM=Symbol("INotebookWatcher"),ZM=Symbol("IVariableViewProvider");var lE=class{constructor(e,t){this.extensionContext=e;this.variableViewProvider=t}activate(){this.extensionContext.subscriptions.push(Gee.window.registerWebviewViewProvider(this.variableViewProvider.viewType,this.variableViewProvider,{webviewOptions:{retainContextWhenHidden:!1}}))}};lE=E([(0,UD.injectable)(),I(0,(0,UD.inject)(ot)),I(1,(0,UD.inject)(ZM))],lE);u();var $s=$(te());u();var rO=require("vscode");u();var eO=class{constructor(e,t){this.disposedCallback=t,this.callback=e}dispose(){this.disposedCallback()}onMessage(e,t){this.callback(e,t)}};u();u();var sp=require("vscode");var op=class{constructor(e,t,n){this.configService=e;this.rootPath=t;this.scripts=n;this.disposed=!1;this.themeIsDarkPromise=Te();this.webviewInit=Te();this._disposables=[];this.onMessageListeners=[];this._onDidDisposeWebviewPanel=new sp.EventEmitter;this.onDataScienceSettingsChanged=async()=>{let e=JSON.stringify(await this.generateDataScienceExtraSettings());this.postMessageInternal("update_settings",e).catch(y)};this.onWebViewLoadFailed=async()=>{this.dispose()};this.onPossibleSettingsChange=async e=>{if(e.affectsConfiguration("workbench.colorTheme")||e.affectsConfiguration("editor.fontSize")||e.affectsConfiguration("editor.fontFamily")||e.affectsConfiguration("editor.cursorStyle")||e.affectsConfiguration("editor.cursorBlinking")||e.affectsConfiguration("editor.autoClosingBrackets")||e.affectsConfiguration("editor.autoClosingQuotes")||e.affectsConfiguration("editor.autoSurround")||e.affectsConfiguration("editor.autoIndent")||e.affectsConfiguration("editor.scrollBeyondLastLine")||e.affectsConfiguration("editor.fontLigatures")||e.affectsConfiguration("editor.scrollbar.verticalScrollbarSize")||e.affectsConfiguration("editor.scrollbar.horizontalScrollbarSize")||e.affectsConfiguration("files.autoSave")||e.affectsConfiguration("files.autoSaveDelay")||e.affectsConfiguration("jupyter.widgetScriptSources")){let t=await this.generateDataScienceExtraSettings();if(t){let n=JSON.stringify(t);this.postMessageInternal("update_settings",n).catch(y)}}};this._disposables.push(sp.workspace.onDidChangeConfiguration(this.onPossibleSettingsChange,this)),this._disposables.push(this.configService.getSettings(void 0).onDidChange(this.onDataScienceSettingsChanged.bind(this)))}get onDidDispose(){return this._onDidDisposeWebviewPanel.event}dispose(){this.disposed||(this.disposed=!0,this._disposables.forEach(e=>e.dispose())),this.webviewInit=void 0,this._onDidDisposeWebviewPanel.fire()}getHTMLById(e){if(!this.activeHTMLRequest)this.activeHTMLRequest=Te(),this.postMessageInternal("get_html_by_id_request",e).catch(y);else throw new Error("getHTMLById request already in progress");return this.activeHTMLRequest.promise}addMessageListener(e){this.onMessageListeners.push(e)}removeMessageListener(e){let t=this.onMessageListeners.indexOf(e);t>=0&&this.onMessageListeners.splice(t,1)}asWebviewUri(e){var t;if(!this.webview)throw new Error("asWebViewUri called too early");return(t=this.webview)==null?void 0:t.asWebviewUri(e)}postMessage(e,t){return this.postMessageInternal(e.toString(),t)}onMessage(e,t){switch(e){case"started":this.webViewRendered();break;case"get_html_by_id_response":this.activeHTMLRequest&&(this.activeHTMLRequest.resolve(t),this.activeHTMLRequest=void 0);break;default:break}this.onMessageListeners.forEach(n=>{n(e,t)})}async loadWebview(e,t){var n;if(this.disposed=!1,this.webviewInit=this.webviewInit||Te(),this.webview===void 0){let i=await this.generateDataScienceExtraSettings(),o=(n=sp.workspace.getWorkspaceFolder(e))==null?void 0:n.uri;this.webview=await this.provideWebview(e,i,o,t),this._disposables.push(this.webview.loadFailed(this.onWebViewLoadFailed,this))}this.onDataScienceSettingsChanged().catch(y),this.sendLocStrings().catch(y)}async generateDataScienceExtraSettings(){let e=this.owningResource,t=sp.workspace.getConfiguration("editor"),n=sp.workspace.getConfiguration("workbench"),i=n?n.get("colorTheme",CO):CO,o=sp.extensions.getExtension(Qs);return{...JSON.parse(JSON.stringify(this.configService.getSettings(e))),extraSettings:{editor:{cursor:this.getValue(t,"cursorStyle","line"),cursorBlink:this.getValue(t,"cursorBlinking","blink"),autoClosingBrackets:this.getValue(t,"autoClosingBrackets","languageDefined"),autoClosingQuotes:this.getValue(t,"autoClosingQuotes","languageDefined"),autoSurround:this.getValue(t,"autoSurround","languageDefined"),autoIndent:this.getValue(t,"autoIndent",!1),fontLigatures:this.getValue(t,"fontLigatures",!1),scrollBeyondLastLine:this.getValue(t,"scrollBeyondLastLine",!0),verticalScrollbarSize:this.getValue(t,"scrollbar.verticalScrollbarSize",14),horizontalScrollbarSize:this.getValue(t,"scrollbar.horizontalScrollbarSize",10),fontSize:this.getValue(t,"fontSize",14),fontFamily:this.getValue(t,"fontFamily","Consolas, 'Courier New', monospace")},theme:i,hasPythonExtension:o!==void 0,isWeb:Pi()==="Unknown"}}}async sendLocStrings(){let e={collapseSingle:Bt.collapseSingle,expandSingle:Bt.expandSingle,openExportFileYes:C.openExportFileYes,openExportFileNo:C.openExportFileNo,noRowsInDataViewer:Bt.noRowsInDataViewer,sliceIndexError:Bt.sliceIndexError,sliceMismatchedAxesError:Bt.sliceMismatchedAxesError,filterRowsTooltip:Bt.sliceMismatchedAxesError,fetchingDataViewer:Bt.fetchingDataViewer,dataViewerHideFilters:Bt.dataViewerHideFilters,dataViewerShowFilters:Bt.dataViewerShowFilters,refreshDataViewer:Bt.refreshDataViewer,clearFilters:Bt.refreshDataViewer,sliceSummaryTitle:Bt.sliceSummaryTitle,sliceData:Bt.sliceData,sliceSubmitButton:Bt.sliceSubmitButton,sliceDropdownAxisLabel:Bt.sliceDropdownAxisLabel,sliceDropdownIndexLabel:Bt.sliceDropdownIndexLabel,variableExplorerNameColumn:Bt.variableExplorerNameColumn,variableExplorerTypeColumn:Bt.variableExplorerTypeColumn,variableExplorerCountColumn:Bt.variableExplorerCountColumn,variableExplorerValueColumn:Bt.variableExplorerValueColumn,collapseVariableExplorerLabel:Bt.collapseVariableExplorerLabel,variableLoadingValue:Bt.variableLoadingValue,showDataExplorerTooltip:Bt.showDataExplorerTooltip,noRowsInVariableExplorer:Bt.noRowsInVariableExplorer,loadingRowsInVariableExplorer:Bt.loadingRowsInVariableExplorer,previousPlot:Bt.previousPlot,nextPlot:Bt.nextPlot,panPlot:Bt.panPlot,zoomInPlot:Bt.zoomInPlot,zoomOutPlot:Bt.zoomOutPlot,exportPlot:Bt.exportPlot,deletePlot:Bt.deletePlot,selectedImageListLabel:Bt.selectedImageListLabel,selectedImageLabel:Bt.selectedImageLabel,dvDeprecationWarning:Bt.dvDeprecationWarning};this.postMessageInternal("loc_init",JSON.stringify(e)).catch(y)}async postMessageInternal(e,t){var n;this.webviewInit&&(await this.webviewInit.promise,(n=this.webview)==null||n.postMessage({type:e.toString(),payload:t}))}webViewRendered(){this.webviewInit&&!this.webviewInit.resolved&&this.webviewInit.resolve(),this.sendLocStrings().catch(y),this.onDataScienceSettingsChanged().catch(y)}getValue(e,t,n){return e?e.get(t,n):n}};E([Vv()],op.prototype,"getHTMLById",1),E([Vv()],op.prototype,"addMessageListener",1),E([Vv()],op.prototype,"removeMessageListener",1);var tO=class extends op{constructor(t,n,i,o,s){super(t,o,s);this.configService=t;this.provider=i;this.messageListener=n(this.onMessage.bind(this),this.dispose.bind(this))}get isDisposed(){return this.disposed}get webviewView(){return this.webview&&this.webview}async provideWebview(t,n,i,o){if(!o)throw new Error("WebviewViews must be passed an initial VS Code Webview");return this.provider.create({additionalPaths:i?[i]:[],rootPath:this.rootPath,cwd:t,listener:this.messageListener,scripts:this.scripts,settings:n,webviewHost:o})}};var Tv=class extends tO{constructor(t,n,i,o,s,a,l,c){let d=Hi(i.extensionUri,"dist","webviews","webview-side","viewers");super(t,(p,f)=>new eO(p,f),n,d,[Hi(d,"variableView.js")]);this.variables=o;this.disposables=s;this.notebookWatcher=a;this.experiments=l;this.dataViewerDelegator=c;this.notebookWatcher.onDidFinishExecutingActiveNotebook(this.activeNotebookExecuted,this,this.disposables),this.notebookWatcher.onDidChangeActiveNotebook(this.activeNotebookChanged,this,this.disposables),this.notebookWatcher.onDidRestartActiveNotebook(this.activeNotebookRestarted,this,this.disposables),this.variables.refreshRequired(this.sendRefreshMessage,this,this.disposables),rO.window.onDidChangeActiveTextEditor(this.activeTextEditorChanged,this,this.disposables)}get owningResource(){}async load(t){await super.loadWebview(rO.Uri.file(process.cwd()),t).catch(b.error),this.webviewView&&this.disposables.push(this.webviewView.onDidChangeVisibility(()=>{this.handleVisibilityChanged()})),this.handleVisibilityChanged()}get title(){return"variableView"}onMessage(t,n){switch(t){case"get_variables_request":this.handleMessage(t,n,this.requestVariables);break;case"show_data_explorer":this.handleMessage(t,n,this.showDataViewer);break;default:break}super.onMessage(t,n)}handleMessage(t,n,i){let o=n;i.bind(this)(o)}handleVisibilityChanged(){let t=new mr("jupyter.variableViewVisible"),n=!1;this.webviewView&&(n=this.webviewView.visible),t.set(n).catch(y),n&&(J("DS_INTERNAL.NATIVE_VARIABLE_VIEW_MADE_VISIBLE"),this.notebookWatcher.activeNotebookExecutionCount!==void 0?this.postMessage("update_variable_view_execution_count",{executionCount:this.notebookWatcher.activeNotebookExecutionCount}).catch(y):this.postMessage("force_variable_refresh").catch(y))}async showDataViewer(t){var n,i;return t.variable.fileName=(i=t.variable.fileName)!=null?i:(n=this.notebookWatcher.activeKernel)==null?void 0:n.notebook.uri,this.dataViewerDelegator.showContributedDataViewer(t.variable)}postProcessSupportsDataExplorer(t){let n=this.dataViewerDelegator.getVariableViewers();return t.pageResponse.forEach(i=>{this.experiments.inExperiment("DataViewerContribution")&&(i.supportsDataExplorer=n.some(o=>o.jupyterVariableViewers.dataTypes.includes(i.type)))}),t}async requestVariables(t){let n=this.notebookWatcher.activeKernel;if(n){let i=await this.variables.getVariables(t,n);this.postMessage("get_variables_response",this.postProcessSupportsDataExplorer(i)).catch(y),J("DS_INTERNAL.VARIABLE_EXPLORER_VARIABLE_COUNT",{variableCount:i.totalCount})}else{let i={executionCount:t.executionCount,pageStartIndex:-1,pageResponse:[],totalCount:0,refreshCount:t.refreshCount};this.postMessage("get_variables_response",i).catch(y)}}async activeNotebookExecuted(t){this.postMessage("update_variable_view_execution_count",{executionCount:t.executionCount}).catch(y)}async activeNotebookChanged(t){t.executionCount?this.postMessage("update_variable_view_execution_count",{executionCount:t.executionCount}).catch(y):this.postMessage("update_variable_view_execution_count",{executionCount:0}).catch(y),this.postMessage("force_variable_refresh").catch(y)}activeTextEditorChanged(){this.postMessage("force_variable_refresh").catch(y)}async activeNotebookRestarted(){this.postMessage("restart_kernel").catch(y)}async sendRefreshMessage(){this.postMessage("force_variable_refresh").catch(y)}};E([Nr("DS_INTERNAL.NATIVE_VARIABLE_VIEW_LOADED")],Tv.prototype,"load",1),E([yn()],Tv.prototype,"showDataViewer",1),E([yn()],Tv.prototype,"requestVariables",1);u();var zl=require("vscode");var nO=$(te());var Ql=class{constructor(e){this.experiments=e}async showContributedDataViewer(e){try{if(this.experiments.inExperiment("DataViewerContribution")){let t=this.getMatchingVariableViewers(e);if(t.length===0)return zl.commands.executeCommand("workbench.extensions.search","@tag:jupyterVariableViewers");if(t.length===1){let n=t[0].jupyterVariableViewers.command;return zl.commands.executeCommand(n,e)}else{let n=t.filter(o=>o.extension.id!==Ge);if(n.length===1){let o=n[0].jupyterVariableViewers.command;return zl.commands.executeCommand(o,e)}let i=zl.window.createQuickPick();i.title="Select DataFrame Viewer",i.items=t.map(o=>{var s,a;return{label:o.jupyterVariableViewers.title,detail:(a=(s=o.extension.packageJSON)==null?void 0:s.displayName)!=null?a:o.extension.id,command:o.jupyterVariableViewers.command}}),i.onDidAccept(async()=>{let o=i.selectedItems[0];if(o)return i.hide(),zl.commands.executeCommand(o.command,e)}),i.show()}}else return zl.commands.executeCommand(Q.ShowJupyterDataViewer,e)}catch(t){b.error(t),J("DATASCIENCE.FAILED_SHOW_DATA_EXPLORER"),zl.window.showErrorMessage(C.showDataViewerFail).then(y,y)}}getMatchingVariableViewers(e){return this.getVariableViewers().filter(n=>n.jupyterVariableViewers.dataTypes.includes(e.type))}getVariableViewers(){return zl.extensions.all.filter(t=>{var n,i,o,s;return((i=(n=t.packageJSON)==null?void 0:n.contributes)==null?void 0:i.jupyterVariableViewers)&&((s=(o=t.packageJSON)==null?void 0:o.contributes)==null?void 0:s.jupyterVariableViewers.length)}).map(t=>{var i;let n=(i=t.packageJSON)==null?void 0:i.contributes;return n!=null&&n.jupyterVariableViewers?n.jupyterVariableViewers.map(o=>({extension:t,jupyterVariableViewers:o})):[]}).flat()}};Ql=E([(0,nO.injectable)(),I(0,(0,nO.inject)(Sc))],Ql);var cE=class{constructor(e,t,n,i,o,s,a,l){this.configuration=e;this.webviewViewProvider=t;this.context=n;this.variables=i;this.disposables=o;this.notebookWatcher=s;this.experiments=a;this.dataViewerDelegator=l;this.viewType="jupyterViewVariables"}get activeVariableView(){if(!vn())throw new Error("activeVariableView only for test code");return this.variableView?Promise.resolve(this.variableView):(this.activeVariableViewPromise=Te(),this.activeVariableViewPromise.promise)}async resolveWebviewView(e,t,n){e.webview.options={enableScripts:!0},this.variableView=new Tv(this.configuration,this.webviewViewProvider,this.context,this.variables,this.disposables,this.notebookWatcher,this.experiments,this.dataViewerDelegator),this.activeVariableViewPromise&&this.activeVariableViewPromise.resolve(this.variableView),await this.variableView.load(e)}};cE=E([(0,$s.injectable)(),I(0,(0,$s.inject)(Ae)),I(1,(0,$s.inject)(e1)),I(2,(0,$s.inject)(ot)),I(3,(0,$s.inject)(Wi)),I(3,(0,$s.named)(tt.ALL_VARIABLES)),I(4,(0,$s.inject)(ie)),I(5,(0,$s.inject)(XM)),I(6,(0,$s.inject)(Sc)),I(7,(0,$s.inject)(Ql))],cE);u();var lp=$(te());u();var $ee=1e3,Yee;(t=>(t.Fetching="fetching",t.Skipped="skipped"))(Yee||(Yee={}));var ys;(f=>(f.Started="started",f.UpdateSettings="update_settings",f.InitializeData="init",f.GetAllRowsRequest="get_all_rows_request",f.GetAllRowsResponse="get_all_rows_response",f.GetRowsRequest="get_rows_request",f.GetRowsResponse="get_rows_response",f.CompletedData="complete",f.GetSliceRequest="get_slice_request",f.RefreshDataViewer="refresh_data_viewer",f.SliceEnablementStateChanged="slice_enablement_state_changed",f.DeprecationWarningClicked="deprecation_warning_clicked"))(ys||(ys={}));var uE=Symbol("IDataViewerFactory"),iO=Symbol("IDataViewer"),oO=Symbol("IJupyterVariableDataProvider"),sO=Symbol("IJupyterVariableDataProviderFactory"),dE=Symbol("IDataViewerDependencyService");var ap=class{constructor(e,t){this.variableManager=e;this.dependencyService=t;this.initialized=!1}get kernel(){return this._kernel}static getNormalizedColumns(e){return e.map(t=>{let n;switch(t.type){case"bool":n="bool";break;case"integer":case"int32":case"int64":case"float":case"float32":case"float64":case"number":n="number";break;default:n="string"}return{key:t.key,type:n}})}static parseShape(e){try{if(e.startsWith("(")&&e.endsWith(")"))return e.substring(1,e.length-1).split(",").map(t=>parseInt(t))}catch(t){b.error(`Could not parse IJupyterVariable with malformed shape: ${e}`)}}dispose(){}setDependencies(e,t){this._kernel=t,this.variable=e}async getDataFrameInfo(e,t){let n={};await this.ensureInitialized();let i=this.variable;return i&&((e||t)&&(i=await this.variableManager.getDataFrameInfo(i,this._kernel,e,t)),n={columns:i.columns?ap.getNormalizedColumns(i.columns):i.columns,indexColumn:i.indexColumn,rowCount:i.rowCount,dataDimensionality:i.dataDimensionality,shape:ap.parseShape(i.shape),sliceExpression:e,type:i.type,maximumRowChunkSize:i.maximumRowChunkSize,name:i.name,fileName:at(i.fileName)}),t&&(this.variable=i),n}async getAllRows(e){let t=[];return await this.ensureInitialized(),this.variable&&this.variable.rowCount&&(t=(await this.variableManager.getDataFrameRows(this.variable,0,this.variable.rowCount,this._kernel,e)).data),t}async getRows(e,t,n){let i=[];return await this.ensureInitialized(),this.variable&&this.variable.rowCount&&(i=(await this.variableManager.getDataFrameRows(this.variable,e,t,this._kernel,n)).data),i}async ensureInitialized(){var e,t;!this.initialized&&this.variable&&(this.initialized=!0,(e=this._kernel)!=null&&e.kernelConnectionMetadata&&this.dependencyService&&await this.dependencyService.checkAndInstallMissingDependencies(dp()?this._kernel:((t=this._kernel)==null?void 0:t.kernelConnectionMetadata.interpreter)||this._kernel),this.variable=await this.variableManager.getDataFrameInfo(this.variable,this._kernel))}};ap=E([(0,lp.injectable)(),I(0,(0,lp.inject)(Wi)),I(0,(0,lp.named)(tt.ALL_VARIABLES)),I(1,(0,lp.inject)(dE)),I(1,(0,lp.optional)())],ap);u();var aO=$(te());var pE=class{constructor(e){this.serviceContainer=e}async create(e,t){let n=this.serviceContainer.get(oO);return n.setDependencies(e,t),n}};pE=E([(0,aO.injectable)(),I(0,(0,aO.inject)(Kr))],pE);u();var Ar=$(te()),bs=require("vscode");u();var cO=require("vscode");var lO=class{constructor(e){this.configuration=e}async isRequestedColumnSizeAllowed(e,t){if(e>$ee&&await this.shouldAskForLargeData(t)){let n=C.tooManyColumnsMessage,i=C.tooManyColumnsYes,o=C.tooManyColumnsNo,s=C.tooManyColumnsDontAskAgain,a=await cO.window.showWarningMessage(n,i,o,s);return a===s&&await this.disableAskForLargeData(),a===i}return!0}async shouldAskForLargeData(e){let t=e?this.configuration.getSettings(e):this.configuration.getSettings();return t&&t.askForLargeDataFrames===!0}async disableAskForLargeData(e){let t=e?this.configuration.getSettings(e):this.configuration.getSettings();t&&(t.askForLargeDataFrames=!1,this.configuration.updateSetting("askForLargeDataFrames",!1,void 0,cO.ConfigurationTarget.Global).catch(y))}};var zee="ds_prompt_about_deprecation",fE=class{constructor(e,t,n,i,o,s,a,l,c,d,p,f,m,g,h){this.disposables=e;this.debugService=t;this.jupyterVariableDataProviderFactory=i;this.dataViewerFactory=o;this.variableProvider=s;this.errorHandler=a;this.dataViewerDependencyService=l;this.interpreterService=c;this.platformService=d;this.kernelProvider=p;this.interactiveWindowProvider=f;this.experimentService=m;this.globalMemento=g;this.dataViewerDelegator=h;this.dataViewerChecker=new lO(n),bs.workspace.isTrusted||bs.workspace.onDidGrantWorkspaceTrust(this.registerCommandsIfTrusted,this,this.disposables)}activate(){this.registerCommandsIfTrusted()}registerCommandsIfTrusted(){bs.workspace.isTrusted&&(this.registerCommand(Q.ShowDataViewer,this.delegateDataViewer),this.registerCommand(Q.ShowJupyterDataViewer,this.showJupyterVariableView))}registerCommand(e,t){let n=bs.commands.registerCommand(e,t,this);this.disposables.push(n)}async delegateDataViewer(e){let t="variable"in e?await this.getVariableFromRequest(e):e;if(t)return this.dataViewerDelegator.showContributedDataViewer(t)}async getVariableFromRequest(e){if(this.variableProvider){let t=qA(e.variable);return this.variableProvider.getFullVariable(t)}}async showJupyterVariableView(e){var n,i;J("OPEN_DATAVIEWER_FROM_VARIABLE_WINDOW_REQUEST_EX");let t=this.experimentService.inExperiment("DataViewerDeprecation");if(!this.globalMemento.get(zee)&&t&&(this.globalMemento.update(zee,!0).then(y,y),bs.window.showInformationMessage(C.dataViewerDeprecationMessage,C.dataViewerDeprecationRecommendationActionMessage).then(o=>{o===C.dataViewerDeprecationRecommendationActionMessage&&bs.commands.executeCommand("workbench.extensions.search","@tag:jupyterVariableViewers").then(y,y)},y)),(n=this.debugService)!=null&&n.activeDebugSession&&this.variableProvider&&this.jupyterVariableDataProviderFactory&&this.dataViewerFactory)try{if(this.debugService.activeDebugSession.configuration&&this.dataViewerDependencyService&&this.interpreterService){let l=await this.getDebugAdapterPython(this.debugService.activeDebugSession.configuration);l&&await this.dataViewerDependencyService.checkAndInstallMissingDependencies(l)}let o=await this.jupyterVariableDataProviderFactory.create(e),s=await o.getDataFrameInfo(),a=(i=s==null?void 0:s.columns)==null?void 0:i.length;if(a&&await this.dataViewerChecker.isRequestedColumnSizeAllowed(a)){let l=`${C.dataExplorerTitle} - ${e.name}`,c=await this.dataViewerFactory.create(o,l);return J("OPEN_DATAVIEWER_FROM_VARIABLE_WINDOW_SUCCESS_EX"),c}}catch(o){J("OPEN_DATAVIEWER_FROM_VARIABLE_WINDOW_ERROR_EX",void 0,void 0,o),b.error(o),this.errorHandler.handleError(o).then(y,y)}else try{let o=this.getActiveKernel();if(o&&this.jupyterVariableDataProviderFactory&&this.dataViewerFactory){let s=await this.jupyterVariableDataProviderFactory.create(e,o),a=`${C.dataExplorerTitle} - ${e.name}`;return await this.dataViewerFactory.create(s,a)}}catch(o){b.error(o),J("DATASCIENCE.FAILED_SHOW_DATA_EXPLORER"),bs.window.showErrorMessage(C.showDataViewerFail).then(y,y)}}getActiveKernel(){var s,a;let e=(s=bs.window.activeNotebookEditor)==null?void 0:s.notebook,t=(e==null?void 0:e.notebookType)==bt?this.kernelProvider.get(e):void 0;if(t)return t;let n=this.getActiveInteractiveWindowDocument(),i=n?this.kernelProvider.get(n):void 0;if(i)return i;let o=(a=this.dataViewerFactory)==null?void 0:a.activeViewer;return o?this.kernelProvider.kernels.find(l=>l===o.kernel):void 0}getActiveInteractiveWindowDocument(){let e=this.interactiveWindowProvider.getActiveOrAssociatedInteractiveWindow();if(e)return bs.workspace.notebookDocuments.find(t=>t===(e==null?void 0:e.notebookDocument))}async getDebugAdapterPython(e){if(!this.interpreterService){b.info("Interpreter Service missing when trying getDebugAdapterPython");return}let t="";if(e.debugAdapterPython!==void 0?(b.info("Found debugAdapterPython on Debug Configuration to use"),t=e.debugAdapterPython):e.pythonPath&&(b.info("Found pythonPath on Debug Configuration to use"),t=e.pythonPath),t){let n=t;return n.startsWith("~")&&this.platformService.homeDir&&(n=pP(n,this.platformService.homeDir.path)),this.interpreterService.getInterpreterDetails(bs.Uri.file(n))}else return this.interpreterService.getActiveInterpreter()}};fE=E([(0,Ar.injectable)(),I(0,(0,Ar.inject)(ie)),I(1,(0,Ar.inject)(uo)),I(1,(0,Ar.optional)()),I(2,(0,Ar.inject)(Ae)),I(3,(0,Ar.inject)(sO)),I(3,(0,Ar.optional)()),I(4,(0,Ar.inject)(uE)),I(4,(0,Ar.optional)()),I(5,(0,Ar.inject)(Wi)),I(5,(0,Ar.optional)()),I(5,(0,Ar.named)(tt.DEBUGGER_VARIABLES)),I(6,(0,Ar.inject)(Cn)),I(7,(0,Ar.inject)(dE)),I(7,(0,Ar.optional)()),I(8,(0,Ar.inject)(im)),I(8,(0,Ar.optional)()),I(9,(0,Ar.inject)(ps)),I(10,(0,Ar.inject)(He)),I(11,(0,Ar.inject)(gs)),I(12,(0,Ar.inject)(Sc)),I(13,(0,Ar.inject)(St)),I(13,(0,Ar.named)(ir)),I(14,(0,Ar.inject)(Ql))],fE);u();var kv=$(te()),Du=require("vscode");var mE=class{constructor(e,t,n,i){this.interactiveWindowProvider=e;this.kernelProvider=t;this.dataViewerFactory=n;this.disposables=i;this._onDidFinisheExecutingActiveNotebook=new Du.EventEmitter;this._onDidChangeActiveNotebook=new Du.EventEmitter;this._onDidRestartActiveNotebook=new Du.EventEmitter;this._executionCountTracker=new WeakMap;Du.window.onDidChangeActiveNotebookEditor(this.activeEditorChanged,this,this.disposables),Du.workspace.onDidCloseNotebookDocument(this.notebookEditorClosed,this,this.disposables),this.kernelProvider.onDidRestartKernel(o=>{this.handleRestart({state:1,notebook:o.notebook})},this,this.disposables),Mr.onDidChangeNotebookCellExecutionState(this.onDidChangeNotebookCellExecutionState,this,this.disposables)}get onDidChangeActiveNotebook(){return this._onDidChangeActiveNotebook.event}get onDidFinishExecutingActiveNotebook(){return this._onDidFinisheExecutingActiveNotebook.event}get onDidRestartActiveNotebook(){return this._onDidRestartActiveNotebook.event}get activeKernel(){var s;let e=(s=Du.window.activeNotebookEditor)==null?void 0:s.notebook,t=(e==null?void 0:e.notebookType)==bt?this.kernelProvider.get(e):void 0;if(t)return t;let n=this.getActiveInteractiveWindowDocument(),i=n?this.kernelProvider.get(n):void 0;if(i)return i;let o=this.dataViewerFactory.activeViewer;return o?this.kernelProvider.kernels.find(a=>a===o.kernel):void 0}get activeNotebookExecutionCount(){var t;let e=(t=this.activeKernel)==null?void 0:t.notebook;return e?this._executionCountTracker.get(e):void 0}getActiveInteractiveWindowDocument(){let e=this.interactiveWindowProvider.getActiveOrAssociatedInteractiveWindow();if(e)return Du.workspace.notebookDocuments.find(t=>t===(e==null?void 0:e.notebookDocument))}onDidChangeNotebookCellExecutionState(e){hr(e.cell.notebook)&&e.state===1&&this.handleExecute({notebook:e.cell.notebook,state:0,cell:e.cell})}handleExecute(e){var t,n,i,o,s,a;this.isNonSilentExecution(e)&&(((n=(t=e.cell)==null?void 0:t.executionSummary)==null?void 0:n.executionOrder)!==void 0&&this._executionCountTracker.set(e.notebook,(i=e.cell.executionSummary)==null?void 0:i.executionOrder),this.isActiveNotebookEvent(e)&&((s=(o=e.cell)==null?void 0:o.executionSummary)==null?void 0:s.executionOrder)!==void 0&&this.activeKernel&&this.kernelProvider.getKernelExecution(this.activeKernel).pendingCells.length===0&&this._onDidFinisheExecutingActiveNotebook.fire({executionCount:(a=e.cell.executionSummary)==null?void 0:a.executionOrder}))}handleRestart(e){this._executionCountTracker.delete(e.notebook),this.isActiveNotebookEvent(e)&&this._onDidRestartActiveNotebook.fire()}notebookEditorClosed(e){this._executionCountTracker.delete(e)}activeEditorChanged(e){let t={};if(e&&hr(e.notebook)){let n=this._executionCountTracker.get(e.notebook);n&&(t.executionCount=n)}this._onDidChangeActiveNotebook.fire(t)}isNonSilentExecution(e){var t;return!!(e.state===0&&e.cell&&((t=e.cell.executionSummary)!=null&&t.executionOrder))}isActiveNotebookEvent(e){var t;return((t=this.activeKernel)==null?void 0:t.notebook)===e.notebook}};mE=E([(0,kv.injectable)(),I(0,(0,kv.inject)(gs)),I(1,(0,kv.inject)(He)),I(2,(0,kv.inject)(uE)),I(3,(0,kv.inject)(ie))],mE);u();var WD=$(te());var Qee=require("vscode");var Tm=class{constructor(e,t){this.serviceContainer=e;this.disposables=t;this.knownViewers=new Set;t.push(this),this.viewContext=new mr(br.IsDataViewerActive),this.disposables.push(Qee.commands.registerCommand(Q.RefreshDataViewer,this.refreshDataViewer,this))}dispose(){for(let e of this.knownViewers)e.dispose()}async create(e,t){let n,i=this.serviceContainer.get(iO);try{this.knownViewers.add(i),i.onDidDisposeDataViewer(this.updateOpenDataViewers,this,this.disposables),i.onDidChangeDataViewerViewState(this.updateViewStateContext,this,this.disposables),await i.showData(e,t),n=i}finally{n||i.dispose()}return n}get activeViewer(){return[...this.knownViewers.values()].find(e=>e.active)}updateOpenDataViewers(e){this.knownViewers.delete(e)}async updateViewStateContext(){let e=!1;this.knownViewers.forEach(t=>{t.active&&(e=!0)}),await this.viewContext.set(e)}refreshDataViewer(){for(let e of this.knownViewers)e.active&&e.refreshData().then(y,y)}};E([Nr("DATASCIENCE.START_SHOW_DATA_EXPLORER")],Tm.prototype,"create",1),E([t1(1e3)],Tm.prototype,"refreshDataViewer",1),Tm=E([(0,WD.injectable)(),I(0,(0,WD.inject)(Kr)),I(1,(0,WD.inject)(ie))],Tm);u();var Pu=$(te()),Is=require("vscode");u();var uO=class{constructor(e,t,n){this.disposedCallback=n,this.callback=e,this.viewChanged=t}dispose(){this.disposedCallback()}onMessage(e,t){this.callback(e,t)}onChangeViewState(e){this.viewChanged(e)}};u();u();var e9;function t9(r,e){return e9&&e9.hasOwnProperty(r)?e9[r]:e}function r9(r,...e){return r.replace(/{(\d+)}/g,(t,n)=>e[n]===void 0?t:e[n])}var S_e=/^\s*((?<StartRange>-?\d+:)|(?<StopRange>-?:\d+)|(?:(?<Start>-?\d+)(?::(?<Stop>-?\d+))?(?::(?<Step>-?\d+))?))\s*$/;function n9(r){let e=r.length-2;return"["+r.map(()=>e>0?(e-=1,"0"):":").join(", ")+"]"}function __e(r,e){if(r.startsWith("[")&&r.endsWith("]")){let t,n=r.substring(1,r.length-1).split(",").map((i,o)=>{var a;let s=S_e.exec(i);if((a=s==null?void 0:s.groups)!=null&&a.Start&&!s.groups.Stop){let l=parseInt(s.groups.Start),c=e[o];return(l>=0&&l>=c||l<0&&l<-c)&&(t={shapeIndex:o,value:l}),l}});if(t){let{shapeIndex:i,value:o}=t,s=t9("sliceIndexError","Index {0} out of range for axis {1} with {2} elements");return r9(s,o.toString(),i.toString(),e[i].toString())}else if(n&&n.length!==e.length){let i=t9("sliceMismatchedAxesError","Expected {0} axes, got {1} in slice expression");return r9(i,e.length.toString(),n.length.toString())}}return""}function Xee(r,e){return __e(r,e)===""}u();var gE=class extends op{constructor(t,n,i,o,s,a,l){super(t,o,s);this.configService=t;this.provider=n;this._title=a;this.viewColumn=l;this.viewState={visible:!1,active:!1};this.webPanelViewStateChanged=t=>{let n=t.isVisible(),i=t.isActive(),o={visible:n,active:i},s={visible:this.viewState.visible,active:this.viewState.active};this.viewState.visible=n,this.viewState.active=i,this.onViewStateChanged({current:o,previous:s})};this.messageListener=i(this.onMessage.bind(this),this.webPanelViewStateChanged.bind(this),this.dispose.bind(this))}get isDisposed(){return this.disposed}get webPanel(){if(this.webview)return this.webview}async show(t){this.isDisposed||this.webPanel&&await this.webPanel.show(t)}dispose(){this.isDisposed||this.webPanel&&this.webPanel.close(),super.dispose()}get title(){return this._title}setTitle(t){this._title=t,!this.isDisposed&&this.webPanel&&this.webPanel.setTitle(t)}onViewStateChanged(t){}async provideWebview(t,n,i,o){return this.provider.create({viewColumn:this.viewColumn,listener:this.messageListener,title:this.title,rootPath:this.rootPath,scripts:this.scripts,settings:n,cwd:t,webviewHost:o,additionalPaths:i?[i]:[]})}};var Zee="JupyterDataViewerPreferredViewColumn",Nv=class extends gE{constructor(t,n,i,o,s){var l;let a=Hi(s.extensionUri,"dist","webviews","webview-side","viewers");super(n,t,(c,d,p)=>new uO(c,d,p),a,[Hi(a,"dataExplorer.js")],C.dataExplorerTitle,(l=i.get(Zee))!=null?l:Is.ViewColumn.One);this.globalMemento=i;this.errorHandler=o;this.context=s;this.pendingRowsCount=0;this.sentDataViewerSliceDimensionalityTelemetry=!1;this._onDidDisposeDataViewer=new Is.EventEmitter;this._onDidChangeDataViewerViewState=new Is.EventEmitter;this.onDidDispose(this.dataViewerDisposed,this)}get active(){var t;return!!((t=this.webPanel)!=null&&t.isActive())}get refreshPending(){return this.pendingRowsCount>0}get onDidDisposeDataViewer(){return this._onDidDisposeDataViewer.event}get onDidChangeDataViewerViewState(){return this._onDidChangeDataViewerViewState.event}async showData(t,n){if(!this.isDisposed){this.dataProvider=t,await super.loadWebview(Is.Uri.file(process.cwd())).catch(b.error),super.setTitle(n),await super.show(!0);let i=await this.prepDataFrameInfo();if(i.shape&&i.shape.length>2){this.maybeSendSliceDataDimensionalityTelemetry(i.shape.length);let o=n9(i.shape);i=await this.getDataFrameInfo(o)}this.postMessage(ys.InitializeData,i).catch(y)}}get kernel(){if(this.dataProvider&&"kernel"in this.dataProvider)return this.dataProvider.kernel}dataViewerDisposed(){this._onDidDisposeDataViewer.fire(this)}async refreshData(){let t=this.currentSliceExpression;this.dataFrameInfoPromise=void 0;let n=await this.getDataFrameInfo(void 0,!0);if(t!==void 0&&n.shape!==void 0)if(Xee(t,n.shape))n=await this.getDataFrameInfo(t);else{let i=n9(n.shape);n=await this.getDataFrameInfo(i)}b.info(`Refreshing data viewer for variable ${n.name}`),this.postMessage(ys.InitializeData,n).catch(y)}dispose(){super.dispose(),this.dataProvider&&(this.dataProvider.dispose(),this.dataProvider=void 0)}async onViewStateChanged(t){var n;t.current.active&&t.current.visible&&t.previous.active&&t.current.visible&&await this.globalMemento.update(Zee,(n=this.webPanel)==null?void 0:n.viewColumn),this._onDidChangeDataViewerViewState.fire()}get owningResource(){}onMessage(t,n){switch(t){case ys.GetAllRowsRequest:this.getAllRows(n).catch(y);break;case ys.GetRowsRequest:this.getRowChunk(n).catch(y);break;case ys.GetSliceRequest:this.getSlice(n).catch(y);break;case ys.RefreshDataViewer:this.refreshData().catch(y),J("DATASCIENCE.REFRESH_DATA_VIEWER");break;case ys.SliceEnablementStateChanged:J("DATASCIENCE.DATA_VIEWER_SLICE_ENABLEMENT_STATE_CHANGED",void 0,{newState:n.newState?"checked":"unchecked"});break;case ys.DeprecationWarningClicked:Is.commands.executeCommand("workbench.extensions.search","@tag:jupyterVariableViewers").then(y,y);break;default:break}super.onMessage(t,n)}getDataFrameInfo(t,n){return(!this.dataFrameInfoPromise||t!==this.currentSliceExpression)&&(this.dataFrameInfoPromise=this.dataProvider?this.dataProvider.getDataFrameInfo(t,n):Promise.resolve({}),this.currentSliceExpression=t),this.dataFrameInfoPromise}async prepDataFrameInfo(){this.rowsTimer=new It;let t=await this.getDataFrameInfo();try{J("DATASCIENCE.SHOW_DATA_EXPLORER",void 0,{rows:t.rowCount?t.rowCount:0,columns:t.columns?t.columns.length:0}),this.pendingRowsCount=t.rowCount?t.rowCount:0}catch(n){}return t}async getAllRows(t){return this.wrapRequest(async()=>{if(this.dataProvider){let n=await this.dataProvider.getAllRows(t);return this.pendingRowsCount=0,this.postMessage(ys.GetAllRowsResponse,n)}})}getSlice(t){return this.wrapRequest(async()=>{var n;if(this.dataProvider){let i=await this.getDataFrameInfo(t.slice);return(n=i.shape)!=null&&n.length&&this.maybeSendSliceDataDimensionalityTelemetry(i.shape.length),J("DATASCIENCE.DATA_VIEWER_SLICE_OPERATION",void 0,{source:t.source}),this.postMessage(ys.InitializeData,i)}})}getRowChunk(t){return this.wrapRequest(async()=>{if(this.dataProvider){let n=await this.getDataFrameInfo(t.sliceExpression),i=await this.dataProvider.getRows(t.start,Math.min(t.end,n.rowCount?n.rowCount:0),t.sliceExpression);return this.pendingRowsCount=Math.max(0,this.pendingRowsCount-i.length),this.postMessage(ys.GetRowsResponse,{rows:i,start:t.start,end:t.end})}})}async wrapRequest(t){try{return await t()}catch(n){if(n instanceof sE){b.error(n.message);let i=C.pythonInteractiveHelpLink;Is.window.showErrorMessage(C.jupyterDataRateExceeded,i).then(o=>{o===i&&Is.env.openExternal(Is.Uri.parse(YD.JupyterDataRateHelpLink))},y),this.dispose()}b.error(n),this.errorHandler.handleError(n).then(y,y)}finally{this.sendElapsedTimeTelemetry()}}sendElapsedTimeTelemetry(){this.rowsTimer&&this.pendingRowsCount===0&&J("DATASCIENCE.SHOW_DATA_EXPLORER_ROWS_LOADED",void 0,{rowsTimer:this.rowsTimer.elapsedTime})}maybeSendSliceDataDimensionalityTelemetry(t){this.sentDataViewerSliceDimensionalityTelemetry||(J("DATASCIENCE.DATA_VIEWER_DATA_DIMENSIONALITY",{numberOfDimensions:t}),this.sentDataViewerSliceDimensionalityTelemetry=!0)}};E([Nr("DATAVIEWER.WEBVIEW_LOADED")],Nv.prototype,"showData",1),Nv=E([(0,Pu.injectable)(),I(0,(0,Pu.inject)(PI)),I(1,(0,Pu.inject)(Ae)),I(2,(0,Pu.inject)(St)),I(2,(0,Pu.named)(ir)),I(3,(0,Pu.inject)(Cn)),I(4,(0,Pu.inject)(ot))],Nv);u();var ete=$(te());u();u();u();var dO="0.20.0";var pO=require("vscode");var VD=class{async getVersion(e,t){try{let n=await this._getVersion(e,t);return typeof n=="string"?vG(n):n}catch(n){b.warn(C.failedToGetVersionOfPandas,n.message);return}}async promptInstall(e,t,n){let i=n?C.pandasTooOldForViewingFormat(n,dO):C.pandasRequiredForViewing(dO);if((g9()?Fe.install:await pO.window.showErrorMessage(i,{modal:!0},Fe.install))===Fe.install)await this._doInstall(e,t);else throw J("DATASCIENCE.USER_DID_NOT_INSTALL_PANDAS"),new Error(i)}async checkOrInstall(e){let t=new pO.CancellationTokenSource;try{let n=await this.getVersion(e,t.token);if(t.token.isCancellationRequested){J("DS_INTERNAL.SHOW_DATA_PANDAS_INSTALL_CANCELED");return}if(n){if(n.compare(dO)>0){J("DS_INTERNAL.SHOW_DATA_PANDAS_OK");return}J("DS_INTERNAL.SHOW_DATA_PANDAS_TOO_OLD");let i=`${n.major}.${n.minor}.${n.build}`;await this.promptInstall(e,t,i)}J("DS_INTERNAL.SHOW_DATA_NO_PANDAS"),await this.promptInstall(e,t)}finally{t.dispose()}}};E([Nr("DS_INTERNAL.PYTHON_MODULE_INSTALL",{action:"displayed",moduleName:wi.get(23)})],VD.prototype,"promptInstall",1);var i9="5dc3a68c-e34e-4080-9c3e-2a532b2ccb4d",E_e=`import pandas as _VSCODE_pandas;print(_VSCODE_pandas.__version__);print("${i9}"); del _VSCODE_pandas`;function C_e(r){return(r.kernelConnectionMetadata.interpreter&&zr(r.kernelConnectionMetadata.interpreter))==="Conda"?"%conda":"%pip"}var fO=class extends VD{async execute(e,t){var o;if(!((o=t.session)!=null&&o.kernel))throw new tn;let n=await Fi(t.session.kernel,e),i=n.find(s=>s.output_type==="error");return i&&b.warn(C.failedToGetVersionOfPandas,i.message),n.map(s=>{var a;return(a=s.text)==null?void 0:a.toString()})}async _getVersion(e){let n=(await this.execute(E_e,e)).map(s=>s?s.toString():void 0).find(s=>s);if(!(n!=null&&n.includes(i9)))return b.warn(C.failedToGetVersionOfPandas,`Output is ${n}`),"";let i=st(n.trim()),o=i.indexOf(i9);return o>=0?i[o-1]:""}async _doInstall(e){let t=`${C_e(e)} install pandas`;try{await this.execute(t,e),J("DATASCIENCE.USER_INSTALLED_PANDAS")}catch(n){throw J("DATASCIENCE.USER_INSTALLED_PANDAS",void 0,void 0,n),new Error(C.failedToInstallPandas)}}async checkAndInstallMissingDependencies(e){var t;if(J("DATAVIEWER.USING_KERNEL"),!((t=e.session)!=null&&t.kernel))throw J("DATASCIENCE.NO_ACTIVE_KERNEL_SESSION"),new Error("No no active kernel session.");await this.checkOrInstall(e)}};var hE=class{constructor(){this.withKernel=new fO}async checkAndInstallMissingDependencies(e){return this.withKernel.checkAndInstallMissingDependencies(e)}};hE=E([(0,ete.injectable)()],hE);u();var zs;(s=>(s.Started="started",s.UpdateSettings="update_settings",s.SendPlot="send_plot",s.CopyPlot="copy_plot",s.ExportPlot="export_plot",s.RemovePlot="remove_plot"))(zs||(zs={}));var tte=class{};zs.Started,zs.UpdateSettings,zs.SendPlot,zs.CopyPlot,zs.ExportPlot,zs.RemovePlot;var mO=Symbol("IPlotViewerProvider"),gO=Symbol("IPlotViewer");u();var Rv=$(te());var Tu=require("vscode");u();var hO=class{constructor(e,t,n){this.disposedCallback=n,this.callback=e,this.viewChanged=t}dispose(){this.disposedCallback()}onMessage(e,t){this.callback(e,t)}onChangeViewState(e){this.viewChanged&&this.viewChanged(e)}};var vE=class extends gE{constructor(t,n,i,o){let s=new It,a=Hi(o.extensionUri,"dist","webviews","webview-side","viewers");super(n,t,(l,c,d)=>new hO(l,c,d),a,[Hi(a,"plotViewer.js")],C.plotViewerTitle,Tu.ViewColumn.One);this.fs=i;this.context=o;this.closedEvent=new Tu.EventEmitter;this.removedEvent=new Tu.EventEmitter;this.addPlot=async t=>{this.isDisposed||(await super.show(!1),this.postMessage(zs.SendPlot,t).catch(y))};super.loadWebview(Tu.Uri.file(process.cwd())).catch(b.error).finally(()=>{J("PLOTVIEWER.WEBVIEW_LOADED",{duration:s.elapsedTime})})}get closed(){return this.closedEvent.event}get removed(){return this.removedEvent.event}async show(){if(!this.isDisposed)return super.show(!0)}dispose(){super.dispose(),this.removedEvent.dispose(),this.closedEvent&&this.closedEvent.fire(this)}get owningResource(){}onMessage(t,n){switch(t){case zs.CopyPlot:this.copyPlot(n.toString()).catch(y);break;case zs.ExportPlot:this.exportPlot(n).catch(y);break;case zs.RemovePlot:this.removePlot(n);break;default:break}super.onMessage(t,n)}removePlot(t){this.removedEvent.fire(t)}copyPlot(t){return Promise.resolve()}async exportPlot(t){b.info("exporting plot...");let n={};n[C.pngFilter]=["png"],n[C.svgFilter]=["svg"];let i=await Tu.window.showSaveDialog({saveLabel:C.exportPlotTitle,filters:n});try{if(i)switch(vp(i.path).toLowerCase()){case".png":let s=NR(t.png.replace("data:image/png;base64",""));await this.fs.writeFile(i,s);break;default:case".svg":await this.fs.writeFile(i,t.svg);break}}catch(o){b.error(o),Tu.window.showErrorMessage(C.exportImageFailed(o.toString())).then(y,y)}}};vE=E([(0,Rv.injectable)(),I(0,(0,Rv.inject)(PI)),I(1,(0,Rv.inject)(Ae)),I(2,(0,Rv.inject)(wt)),I(3,(0,Rv.inject)(ot))],vE);u();var jD=$(te());var yE=class{constructor(e,t){this.serviceContainer=e;this.imageList=[];this.closedViewer=()=>{this.currentViewer&&(this.currentViewer=void 0),this.currentViewerClosed&&(this.currentViewerClosed.dispose(),this.currentViewerClosed=void 0)};this.removedPlot=e=>{this.imageList.splice(e,1)};t.push(this)}dispose(){this.currentViewer&&this.currentViewer.dispose()}async showPlot(e){this.imageList.push(e);let t=this.currentViewer?[e]:this.imageList,n=await this.getOrCreate();await Promise.all(t.map(n.addPlot))}async getOrCreate(){return this.currentViewer||(this.currentViewer=this.serviceContainer.get(gO),this.currentViewerClosed=this.currentViewer.closed(this.closedViewer),this.currentViewer.removed(this.removedPlot),J("DATASCIENCE.OPEN_PLOT_VIEWER"),await this.currentViewer.show()),this.currentViewer}};yE=E([(0,jD.injectable)(),I(0,(0,jD.inject)(Kr)),I(1,(0,jD.inject)(ie))],yE);u();var yO=$(te()),km=require("vscode");var rte="image/svg+xml",vO={"image/png":"png","image/jpeg":"jpeg","image/gif":"gif",[rte]:"svg"},bE=class{constructor(e){this.fs=e}async savePlot(e,t,n){if(e.isClosed)return;let i=w_e(e,t,n);if(!i)return b.error(`No plot to save ${ve(e.uri)}, id: ${t} for ${n}`);if(!(n.toLowerCase()in vO))return b.error(`Unsupported MimeType ${ve(e.uri)}, id: ${t} for ${n}`);let o=await this.getSaveTarget(i,n);o&&(o.path.toLowerCase().endsWith("pdf")?await this.saveAsPdf(i,o):await this.saveAsImage(i,o))}getSaveTarget(e,t){var l;let n=vO[t.toLowerCase()],i={};e.items.find(c=>c.mime.toLowerCase()===rte)&&(i[C.pdfFilter]=["pdf"],i[C.svgFilter]=["svg"]),n==="png"&&(i[C.pngFilter]=["png"]),Object.keys(i).length===0&&(i.Images=[n]);let o=(((l=km.workspace.workspaceFolders)==null?void 0:l.length)||0)>0?km.workspace.workspaceFolders[0].uri:void 0,s="output",a=o?km.Uri.joinPath(o,s):km.Uri.file(s);return km.window.showSaveDialog({defaultUri:a,saveLabel:C.exportPlotTitle,filters:i})}async saveAsImage(e,t){let n=vp(t.path).substring(1),i=Object.keys(vO).find(s=>vO[s]===n),o=e.items.find(s=>s.mime===i);if(!o)throw new Error(`Unsupported MimeType ${t.toString()}, available mime Types: ${e.items.map(s=>s.mime).join(", ")}`);await this.fs.writeFile(t,o.data)}async saveAsPdf(e,t){return b.error("Save as PDF is not yet supported on the web.")}};bE=E([(0,yO.injectable)(),I(0,(0,yO.inject)(wt))],bE);function w_e(r,e,t){for(let n of r.getCells())for(let i of n.outputs)if(i.id===e&&i.items.find(o=>o.mime===t))return i}u();var bO=$(te());var x_e="image/svg+xml",D_e="image/png",cp=class{constructor(e){this.plotViewProvider=e}async openPlot(e,t){if(e.isClosed)return;let n=nte(e,t,x_e),i;if(n)i=new TextDecoder().decode(n.data);else{let o=nte(e,t,D_e);if(!o)return b.error(`No SVG or PNG Plot to open ${ve(e.uri)}, id: ${t}`);i=P_e(o)}i&&await this.plotViewProvider.showPlot(i)}};cp=E([(0,bO.injectable)(),I(0,(0,bO.inject)(mO))],cp);function nte(r,e,t){for(let n of r.getCells())for(let i of n.outputs)if(i.id===e)return i.items.find(o=>o.mime===t)}function P_e(r){let e=r.data,t=RR(e),n=T_e(e);return`<?xml version="1.0" encoding="utf-8" standalone="no"?>
<svg height="${n.height}" width="${n.width}" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
    <g>
        <image xmlns="http://www.w3.org/2000/svg" x="0" y="0" height="100%" width="100%" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="data:image/png;base64,${t}"/>
    </g>
</svg>`}function T_e(r){if(!k_e(r))throw new Error("The buffer is not a valid png");let e=new DataView(new Uint8Array(r).buffer);return{width:e.getUint32(16,!1),height:e.getUint32(20,!1)}}function k_e(r){return r[0]===137&&r[1]===80&&r[2]===78&&r[3]===71&&r[4]===13&&r[5]===10&&r[6]===26&&r[7]===10&&r.length>8+21}u();var BD=$(te()),SO=require("vscode");u();var IO=Symbol("IPlotSaveHandler");var IE=class{constructor(e,t){this.plotSaveHandler=e;this.plotViewHandler=t;this.disposables=[]}dispose(){fe(this.disposables)}activate(){this.activateImpl().catch(y)}async activateImpl(){let e=SO.extensions.getExtension(Kv);if(!e)return;e.isActive||await e.activate(),e.exports.onDidReceiveMessage(({editor:n,message:i})=>{var s;let o=n.notebook||((s=SO.window.activeNotebookEditor)==null?void 0:s.notebook);o&&(i.type==="saveImageAs"?this.plotSaveHandler.savePlot(o,i.outputId,i.mimeType).catch(y):i.type==="openImageInPlotViewer"&&this.plotViewHandler.openPlot(o,i.outputId).catch(y))},this,this.disposables)}};IE=E([(0,BD.injectable)(),I(0,(0,BD.inject)(IO)),I(1,(0,BD.inject)(cp))],IE);u();var HD=$(te()),_O=require("vscode");var SE=class{constructor(e,t){this.kernelProvider=e;this.controllers=t;this.disposables=[];this.widgetOutputsPerNotebook=new WeakMap}dispose(){fe(this.disposables)}activate(){let e=_O.notebooks.createRendererMessaging("jupyter-ipywidget-renderer");e.onDidReceiveMessage(this.onDidReceiveMessage.bind(this,e),this,this.disposables),this.kernelProvider.onDidStartKernel(this.onDidStartKernel,this,this.disposables)}onDidStartKernel(e){this.hookupKernel(e),e.onStarted(()=>this.hookupKernel(e),this,this.disposables),e.onRestarted(()=>this.hookupKernel(e),this,this.disposables)}hookupKernel(e){var s,a,l;this.widgetOutputsPerNotebook.delete(e.notebook);let t=(s=e.session)==null?void 0:s.kernel,n=(l=(a=e.session)==null?void 0:a.kernel)==null?void 0:l.iopubMessage;if(!n)return;let i=oi(),o=(c,d)=>{c===t&&(i.KernelMessage.isDisplayDataMsg(d)||i.KernelMessage.isUpdateDisplayDataMsg(d)||i.KernelMessage.isExecuteReplyMsg(d)||i.KernelMessage.isExecuteResultMsg(d))&&this.trackModelId(e.notebook,d)};n.connect(o),this.disposables.push(new _O.Disposable(()=>n.disconnect(o)))}trackModelId(e,t){let n=t.content;if(n.data&&typeof n.data=="object"&&go in n.data){let i=n.data[go];if(i&&"model_id"in i){let o=this.widgetOutputsPerNotebook.get(e)||new Set;o.add(i.model_id),this.widgetOutputsPerNotebook.set(e,o)}}}onDidReceiveMessage(e,{editor:t,message:n}){n&&typeof n=="object"&&n.command==="query-widget-state"&&this.queryWidgetState(e,t,n),n&&typeof n=="object"&&n.command==="ipywidget-renderer-loaded"&&this.sendWidgetVersionAndState(e,t)}queryWidgetState(e,t,n){let i=this.widgetOutputsPerNotebook.get(t.notebook),o=!!this.controllers.getSelected(t.notebook),s=!!(i!=null&&i.has(n.model_id));e.postMessage({command:"query-widget-state",model_id:n.model_id,hasWidgetState:s,kernelSelected:o},t).then(y,y)}sendWidgetVersionAndState(e,t){let n=this.kernelProvider.get(t.notebook),i=n==null?void 0:n.ipywidgetsVersion;n!=null&&n.ipywidgetsVersion&&b.trace(`IPyWidget version in Kernel is ${n==null?void 0:n.ipywidgetsVersion}.`);let o=!!this.controllers.getSelected(t.notebook);e.postMessage({command:"ipywidget-renderer-init",version:i,widgetState:void 0,kernelSelected:o},t).then(y,y)}};SE=E([(0,HD.injectable)(),I(0,(0,HD.inject)(He)),I(1,(0,HD.inject)(Tt))],SE);function ite(r){r.addSingleton(Ue,IE),r.addSingleton(Ue,fE),r.add(iO,Nv),r.addSingleton(uE,Tm),r.addSingleton(dE,hE),r.addSingleton(Ql,Ql),r.add(gO,vE),r.addSingleton(mO,yE),r.addSingleton(IO,bE),r.addSingleton(cp,cp),r.addSingleton(XM,mE),r.addSingleton(Ue,lE),r.addSingleton(Ue,SE),r.addSingleton(ZM,cE),r.add(oO,ap),r.addSingleton(sO,pE)}u();var dte=$(mL());u();var ote=$(te());var Av=class{constructor(e){this.container=e}getContainer(){return this.container}add(e,t,n,i){n?this.container.bind(e).to(t).whenTargetNamed(n):this.container.bind(e).to(t),i&&i.forEach(o=>{this.addBinding(e,o)})}addFactory(e,t){this.container.bind(e).toFactory(t)}addBinding(e,t){this.container.bind(t).toService(e)}addSingleton(e,t,n,i){n?this.container.bind(e).to(t).inSingletonScope().whenTargetNamed(n):this.container.bind(e).to(t).inSingletonScope(),i&&i.forEach(o=>{this.addBinding(e,o)})}addSingletonInstance(e,t,n){n?this.container.bind(e).toConstantValue(t).whenTargetNamed(n):this.container.bind(e).toConstantValue(t)}get(e,t){return t?this.container.getNamed(e,t):this.container.get(e)}tryGet(e,t){try{return t?this.container.getNamed(e,t):this.container.get(e)}catch(n){}}getAll(e,t){return t?this.container.getAllNamed(e,t):this.container.getAll(e)}rebind(e,t,n){n?this.container.rebind(e).to(t).whenTargetNamed(n):this.container.rebind(e).to(t)}rebindSingleton(e,t,n){n?this.container.rebind(e).to(t).inSingletonScope().whenTargetNamed(n):this.container.rebind(e).to(t).inSingletonScope()}rebindInstance(e,t,n){n?this.container.rebind(e).toConstantValue(t).whenTargetNamed(n):this.container.rebind(e).toConstantValue(t)}dispose(){this.container.unbindAll(),this.container.unload()}};E([Vv()],Av.prototype,"getContainer",1),Av=E([(0,ote.injectable)()],Av);var wn=require("vscode");u();var ate=require("vscode");function lte(r){let e=ate.window.createOutputChannel(C.jupyterServerConsoleOutputChannel,"log");r.push(e);let t={get(n,i){let o=n[i];if(typeof o=="function"){if(i==="append")return(...s)=>{e.append(...s),ste(...s)};if(i==="appendLine")return(...s)=>{e.appendLine(...s),ste(...s)}}return o}};return new Proxy(e,t)}function ste(...r){r.length===1?b.debug(st(r[0]).map((e,t)=>t===0?e:`    ${e}`).join(`
`)):b.debug(...r)}u();var cte=require("vscode");function ute(){let r=cte.workspace.getConfiguration("python"),e=r==null?void 0:r.get("languageServer");return!(e!=="Pylance"&&e!=="Default")}function pte(r,e){let t=YH(e);t.appendLine(`${wn.env.appName} (${wn.version}, ${wn.env.remoteName}, ${wn.env.appHost})`),t.appendLine(`Jupyter Extension Version: ${r.extension.packageJSON.version}.`);let n=wn.extensions.getExtension(Qs);n?t.appendLine(`Python Extension Version: ${n.packageJSON.version}.`):t.appendLine("Python Extension not installed.");let i=wn.extensions.getExtension(S9);return i?t.appendLine(`Pylance Extension Version${ute()?"":" (Not Used) "}: ${i.packageJSON.version}.`):t.appendLine("Pylance Extension not installed."),e!=null&&e.platform&&t.appendLine(`Platform: ${e.platform} (${e.arch}).`),!wn.workspace.workspaceFolders||wn.workspace.workspaceFolders.length===0?t.appendLine("No workspace folder opened."):wn.workspace.workspaceFolders.length===1?t.appendLine(`Workspace folder ${ve(wn.workspace.workspaceFolders[0].uri)}, Home = ${e==null?void 0:e.homePath}`):t.appendLine(`Multiple Workspace folders opened ${wn.workspace.workspaceFolders.map(o=>ve(o.uri)).join(", ")}`),t}function fte(r,e){let t=new dte.Container({skipBaseClassChecks:!0}),n=new Av(t),i=new rt(t);return n.addSingletonInstance(Kr,i),n.addSingletonInstance(eX,n),n.addSingletonInstance(ie,r.subscriptions),n.addSingletonInstance(St,r.globalState,ir),n.addSingletonInstance(St,r.workspaceState,Es),n.addSingletonInstance(ot,r),n.addSingletonInstance(Lm,e,Lv),n.addSingletonInstance(Lm,lte(r.subscriptions),I9),[n,i]}function mte(){let r=Te(),e={location:wn.ProgressLocation.Window,title:Fe.loadingExtension};return wn.window.withProgress(e,()=>r.promise).then(y,y),{dispose:()=>r.resolve()}}function gte(r,e,t){N_e(Fe.handleExtensionActivationError),console.error("extension activation failed",r),b.error("extension activation failed",r),hz(r,e,t)}function N_e(r){try{wn.window.showErrorMessage(r).then(y,y)}catch(e){b.error("failed to notify user",e)}}async function hte(r,e){let t=e.get(Sc),n=new It;await t.activate();let i=n.elapsedTime;J("DS_INTERNAL.EXPERIMENT_LOAD",{duration:i}),wn.commands.executeCommand("setContext","jupyter.vscode.channel",Kd()).then(y,y),e.get(x1).activate();let o=e.get(nT);o.initialize(),r.subscriptions.push(o)}var o9=class{constructor(){this.started=Date.now()}get elapsedTime(){return Date.now()-this.started}reset(){this.started=Date.now()}},_E=new o9,JD={totalActivateTime:0,codeLoadingTime:0,startActivateTime:0,endActivateTime:0,workspaceFolderCount:0};typeof requestAnimationFrame=="undefined"&&typeof setImmediate=="undefined"&&(self.setImmediate=r=>setTimeout(r),self.clearImmediate=r=>clearTimeout(r));JD.codeLoadingTime=_E.elapsedTime;var s9;async function R_e(r){JD.startActivateTime=_E.elapsedTime;let e=pte(r,{addConsoleLogger:vn()});_G(_E),tB(r.subscriptions),m9(Xl.env.uiKind==Xl.UIKind.Web),v9(!0),r.subscriptions.push({dispose:()=>CE.isExiting=!0});try{let[t,n]=M_e(r,e);return await n,gz(JD,_E),t}catch(t){return JD.endActivateTime=_E.elapsedTime,gte(t,JD,_E),b.error("Failed to active the Jupyter Extension",t),{ready:Promise.resolve(),registerPythonApi:y,registerRemoteServerProvider:()=>({dispose:y}),getKernelService:()=>Promise.resolve(void 0),addRemoteJupyterServer:()=>Promise.resolve(void 0),openNotebook:()=>Promise.reject(),createJupyterServerCollection:()=>{throw new Error("Not Implemented")},kernels:{getKernel:()=>Promise.resolve(void 0)}}}}function A_e(){if(CE.isExiting=!0,s9){let r=s9.get(Ha);if(r)return r.dispose()}return Promise.resolve()}function M_e(r,e){let t=mte();try{let[n,i]=fte(r,e);s9=i,yG(()=>Promise.resolve(new Map));let o=O_e(r,n,i);return[pz(o,n,i,r),o,i]}finally{t.dispose()}}async function O_e(r,e,t){let n=r.extensionMode===Xl.ExtensionMode.Development||Xl.workspace.getConfiguration("jupyter").get("development",!1);e.addSingletonInstance(ZH,n),n&&Xl.commands.executeCommand("setContext","jupyter.development",!0).then(y,y),Xl.commands.executeCommand("setContext","jupyter.webExtension",!0).then(y,y),mQ(e),aZ(e,n),ZQ(e,n),uee(e),pee(e),Jee(r,e,n),ite(e),await hte(r,t)}
/*! Bundled license information:

reflect-metadata/Reflect.js:
  (*! *****************************************************************************
  Copyright (C) Microsoft. All rights reserved.
  Licensed under the Apache License, Version 2.0 (the "License"); you may not use
  this file except in compliance with the License. You may obtain a copy of the
  License at http://www.apache.org/licenses/LICENSE-2.0
  
  THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
  WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
  MERCHANTABLITY OR NON-INFRINGEMENT.
  
  See the Apache Version 2.0 License for specific language governing permissions
  and limitations under the License.
  ***************************************************************************** *)

@microsoft/dynamicproto-js/lib/dist/esm/dynamicproto-js.js:
  (*!
   * Microsoft Dynamic Proto Utility, 1.1.8
   * Copyright (c) Microsoft and contributors. All rights reserved.
   *)

@lumino/polling/dist/index.js:
  (*! *****************************************************************************
      Copyright (c) Microsoft Corporation.
  
      Permission to use, copy, modify, and/or distribute this software for any
      purpose with or without fee is hereby granted.
  
      THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
      REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
      AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
      INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
      LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
      OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
      PERFORMANCE OF THIS SOFTWARE.
      ***************************************************************************** *)

@lumino/disposable/dist/index.js:
  (*! *****************************************************************************
      Copyright (c) Microsoft Corporation.
  
      Permission to use, copy, modify, and/or distribute this software for any
      purpose with or without fee is hereby granted.
  
      THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
      REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
      AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
      INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
      LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
      OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
      PERFORMANCE OF THIS SOFTWARE.
      ***************************************************************************** *)

strip-comments/index.js:
  (*!
   * strip-comments <https://github.com/jonschlinkert/strip-comments>
   * Copyright (c) 2014-present, Jon Schlinkert.
   * Released under the MIT License.
   *)
*/
